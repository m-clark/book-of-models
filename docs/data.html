<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.6">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Models Demystified – 9&nbsp; Dealing with Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./causal.html" rel="next">
<link href="./ml_more.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Models Demystified - 9&nbsp; Dealing with Data">
<meta property="og:description" content="">
<meta property="og:site_name" content="Models Demystified">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title"><span id="sec-data" class="quarto-section-identifier"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Dealing with Data</span></span></h1>
        </a>     
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Models Demystified</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/m-clark/book-of-models" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Linear Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">The Foundation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./knowing_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Knowing Your Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">How Did We Get Here?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./generalized_linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Generalized Linear Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear_model_extensions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Extending the Linear Model</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Machine Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machine_learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Core Concepts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ml_common_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Common Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ml_more.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">More ML</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Other Considerations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Dealing with Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./causal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Causal Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./danger_zone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Danger Zone</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./misc_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Until Next Time…</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">References</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dataset_descriptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Dataset Descriptions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matrix_operations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Matrix Operations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Using R and Python in ML</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix_placeholder.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Other to come</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#key-ideas" id="toc-key-ideas" class="nav-link active" data-scroll-target="#key-ideas"><span class="header-section-number">9.1</span> Key Ideas</a>
  <ul class="collapse">
  <li><a href="#sec-data-common-why-matters" id="toc-sec-data-common-why-matters" class="nav-link" data-scroll-target="#sec-data-common-why-matters"><span class="header-section-number">9.1.1</span> Why this matters</a></li>
  <li><a href="#sec-data-common-good-to-know" id="toc-sec-data-common-good-to-know" class="nav-link" data-scroll-target="#sec-data-common-good-to-know"><span class="header-section-number">9.1.2</span> Good to Know</a></li>
  </ul></li>
  <li><a href="#sec-data-transformations" id="toc-sec-data-transformations" class="nav-link" data-scroll-target="#sec-data-transformations"><span class="header-section-number">9.2</span> Standard Feature &amp; Target Transformations</a>
  <ul class="collapse">
  <li><a href="#sec-data-numeric" id="toc-sec-data-numeric" class="nav-link" data-scroll-target="#sec-data-numeric"><span class="header-section-number">9.2.1</span> Numeric variables</a></li>
  <li><a href="#sec-data-cat" id="toc-sec-data-cat" class="nav-link" data-scroll-target="#sec-data-cat"><span class="header-section-number">9.2.2</span> Categorical Variables</a></li>
  <li><a href="#sec-data-ordinal" id="toc-sec-data-ordinal" class="nav-link" data-scroll-target="#sec-data-ordinal"><span class="header-section-number">9.2.3</span> Ordinal Variables</a></li>
  </ul></li>
  <li><a href="#sec-data-missing" id="toc-sec-data-missing" class="nav-link" data-scroll-target="#sec-data-missing"><span class="header-section-number">9.3</span> Missing Data</a>
  <ul class="collapse">
  <li><a href="#sec-data-missing-complete" id="toc-sec-data-missing-complete" class="nav-link" data-scroll-target="#sec-data-missing-complete"><span class="header-section-number">9.3.1</span> Complete Case Analysis</a></li>
  <li><a href="#sec-data-missing-single" id="toc-sec-data-missing-single" class="nav-link" data-scroll-target="#sec-data-missing-single"><span class="header-section-number">9.3.2</span> Single Value Imputation</a></li>
  <li><a href="#sec-data-missing-model" id="toc-sec-data-missing-model" class="nav-link" data-scroll-target="#sec-data-missing-model"><span class="header-section-number">9.3.3</span> Model-based Imputation</a></li>
  <li><a href="#sec-data-missing-mi" id="toc-sec-data-missing-mi" class="nav-link" data-scroll-target="#sec-data-missing-mi"><span class="header-section-number">9.3.4</span> Multiple Imputation</a></li>
  <li><a href="#sec-data-missing-bayesian" id="toc-sec-data-missing-bayesian" class="nav-link" data-scroll-target="#sec-data-missing-bayesian"><span class="header-section-number">9.3.5</span> Bayesian Imputation</a></li>
  </ul></li>
  <li><a href="#sec-data-class-imbalance" id="toc-sec-data-class-imbalance" class="nav-link" data-scroll-target="#sec-data-class-imbalance"><span class="header-section-number">9.4</span> Class Imbalance</a>
  <ul class="collapse">
  <li><a href="#sec-data-calibration" id="toc-sec-data-calibration" class="nav-link" data-scroll-target="#sec-data-calibration"><span class="header-section-number">9.4.1</span> Calibration Issues in Classification</a></li>
  </ul></li>
  <li><a href="#sec-data-censoring" id="toc-sec-data-censoring" class="nav-link" data-scroll-target="#sec-data-censoring"><span class="header-section-number">9.5</span> Censoring and Truncation</a></li>
  <li><a href="#sec-data-time" id="toc-sec-data-time" class="nav-link" data-scroll-target="#sec-data-time"><span class="header-section-number">9.6</span> Time Series</a>
  <ul class="collapse">
  <li><a href="#time-based-targets" id="toc-time-based-targets" class="nav-link" data-scroll-target="#time-based-targets"><span class="header-section-number">9.6.1</span> Time-based Targets</a></li>
  <li><a href="#time-based-features" id="toc-time-based-features" class="nav-link" data-scroll-target="#time-based-features"><span class="header-section-number">9.6.2</span> Time-based Features</a></li>
  </ul></li>
  <li><a href="#sec-data-spatial" id="toc-sec-data-spatial" class="nav-link" data-scroll-target="#sec-data-spatial"><span class="header-section-number">9.7</span> Spatial Data</a></li>
  <li><a href="#multivariate-targets" id="toc-multivariate-targets" class="nav-link" data-scroll-target="#multivariate-targets"><span class="header-section-number">9.8</span> Multivariate Targets</a></li>
  <li><a href="#sec-data-latent" id="toc-sec-data-latent" class="nav-link" data-scroll-target="#sec-data-latent"><span class="header-section-number">9.9</span> Latent Variables</a></li>
  <li><a href="#sec-data-aug" id="toc-sec-data-aug" class="nav-link" data-scroll-target="#sec-data-aug"><span class="header-section-number">9.10</span> Data Augmentation</a></li>
  <li><a href="#wrapping-up" id="toc-wrapping-up" class="nav-link" data-scroll-target="#wrapping-up"><span class="header-section-number">9.11</span> Wrapping Up</a>
  <ul class="collapse">
  <li><a href="#the-common-thread" id="toc-the-common-thread" class="nav-link" data-scroll-target="#the-common-thread"><span class="header-section-number">9.11.1</span> The Common Thread</a></li>
  <li><a href="#choose-your-own-adventure" id="toc-choose-your-own-adventure" class="nav-link" data-scroll-target="#choose-your-own-adventure"><span class="header-section-number">9.11.2</span> Choose Your Own Adventure</a></li>
  <li><a href="#additional-resources" id="toc-additional-resources" class="nav-link" data-scroll-target="#additional-resources"><span class="header-section-number">9.11.3</span> Additional Resources</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/m-clark/book-of-models/edit/dev/data.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span id="sec-data" class="quarto-section-identifier"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Dealing with Data</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>It’s an inescapable fact that models need data to work. One of the dirty secrets in data science is that getting the data right will do more for your model than any fancy algorithm or hyperparameter tuning. Data is messy, and there are a lot of ways it can be messy. In addition, dealing with a target variable on its terms can lead to more interesting results. In this chapter we’ll discuss some of the most common data issues and things to consider. There’s a lot to know about data before you ever get into modeling your own, so we’ll give you some things to think about it in this chapter.</p>
<section id="key-ideas" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="key-ideas"><span class="header-section-number">9.1</span> Key Ideas</h2>
<ul>
<li>Data transformations can provide many modeling benefits.</li>
<li>Label and text-based data still needs a numeric representation, and this can be accomplished in a variety of ways.</li>
<li>The data type for the target may suggest a particular model, but does not necessitate one.</li>
<li>The data <em>structure</em>, e.g.&nbsp;temporal, spatial, censored, etc., may suggest a particular modeling domain to use.</li>
<li>Missing data can be handled in a variety of ways, and the simpler approaches are typically not great.</li>
<li>Class imbalance is a very common issue in classification problems, and there are a number of ways to deal with it.</li>
<li>Latent variables are everywhere!</li>
</ul>
<section id="sec-data-common-why-matters" class="level3" data-number="9.1.1">
<h3 data-number="9.1.1" class="anchored" data-anchor-id="sec-data-common-why-matters"><span class="header-section-number">9.1.1</span> Why this matters</h3>
<p>Knowing your data is one of the most important aspects of any application of <em>data</em> science. It’s not just about knowing what you have, but also what you can do with it. The data you have will influence the models you can potentially use, the features you can create and manipulate, and have a say on the results you can expect.</p>
</section>
<section id="sec-data-common-good-to-know" class="level3" data-number="9.1.2">
<h3 data-number="9.1.2" class="anchored" data-anchor-id="sec-data-common-good-to-know"><span class="header-section-number">9.1.2</span> Good to Know</h3>
<p>We’re talking very generally about data here, so not much background is needed. The models mentioned are covered in other chapters, or build upon those, but we’re not doing any actual modeling here.</p>
</section>
</section>
<section id="sec-data-transformations" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="sec-data-transformations"><span class="header-section-number">9.2</span> Standard Feature &amp; Target Transformations</h2>
<p>Transforming variables an provide several benefits in modeling, whether applied to the target, features, or both, and <em>should regularly be used for most model situations</em>. Some of these benefits include:</p>
<ul>
<li>More comparable feature effects and related parameters</li>
<li>Faster estimation</li>
<li>Easier convergence</li>
<li>Helping with heteroscedasticity</li>
</ul>
<p>For example, just centering features, i.e.&nbsp;subtracting the mean, provides a more interpretable intercept that will fall within the actual range of the target variable. After centering, the intercept tels us what the value of the target variable is when the features are at their means (or reference value if categorical). Centering also puts the intercept within the expected range of the target, which often makes for easier parameter estimation. So even if easier interpretation isn’t a major concern, variable transformations can help with convergence and speed up estimation, so can always be of benefit.</p>
<section id="sec-data-numeric" class="level3" data-number="9.2.1">
<h3 data-number="9.2.1" class="anchored" data-anchor-id="sec-data-numeric"><span class="header-section-number">9.2.1</span> Numeric variables</h3>
<p>The following table shows the interpretation of some very common transformations applied to numeric variables- logging and standardizing to mean zero, standard deviation of one.</p>
<div class="cell">
<div id="tbl-transformation" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-transformation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.1: Common numeric transformations
</figcaption>
<div aria-describedby="tbl-transformation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="bqqfsqssyk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#bqqfsqssyk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bqqfsqssyk thead, #bqqfsqssyk tbody, #bqqfsqssyk tfoot, #bqqfsqssyk tr, #bqqfsqssyk td, #bqqfsqssyk th {
  border-style: none;
}

#bqqfsqssyk p {
  margin: 0;
  padding: 0;
}

#bqqfsqssyk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bqqfsqssyk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bqqfsqssyk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bqqfsqssyk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bqqfsqssyk .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bqqfsqssyk .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bqqfsqssyk .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bqqfsqssyk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bqqfsqssyk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bqqfsqssyk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bqqfsqssyk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bqqfsqssyk .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bqqfsqssyk .gt_spanner_row {
  border-bottom-style: hidden;
}

#bqqfsqssyk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bqqfsqssyk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bqqfsqssyk .gt_from_md > :first-child {
  margin-top: 0;
}

#bqqfsqssyk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bqqfsqssyk .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bqqfsqssyk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#bqqfsqssyk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bqqfsqssyk .gt_row_group_first td {
  border-top-width: 2px;
}

#bqqfsqssyk .gt_row_group_first th {
  border-top-width: 2px;
}

#bqqfsqssyk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bqqfsqssyk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bqqfsqssyk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bqqfsqssyk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bqqfsqssyk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bqqfsqssyk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bqqfsqssyk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bqqfsqssyk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bqqfsqssyk .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#bqqfsqssyk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bqqfsqssyk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bqqfsqssyk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bqqfsqssyk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bqqfsqssyk .gt_left {
  text-align: left;
}

#bqqfsqssyk .gt_center {
  text-align: center;
}

#bqqfsqssyk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bqqfsqssyk .gt_font_normal {
  font-weight: normal;
}

#bqqfsqssyk .gt_font_bold {
  font-weight: bold;
}

#bqqfsqssyk .gt_font_italic {
  font-style: italic;
}

#bqqfsqssyk .gt_super {
  font-size: 65%;
}

#bqqfsqssyk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bqqfsqssyk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bqqfsqssyk .gt_indent_1 {
  text-indent: 5px;
}

#bqqfsqssyk .gt_indent_2 {
  text-indent: 10px;
}

#bqqfsqssyk .gt_indent_3 {
  text-indent: 15px;
}

#bqqfsqssyk .gt_indent_4 {
  text-indent: 20px;
}

#bqqfsqssyk .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Target">Target</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Feature">Feature</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Change in X">Change in X</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Change in Y">Change in Y</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Benefits">Benefits</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Target" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">y</td>
<td headers="Feature" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">x</td>
<td headers="Change in X" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">1 unit</td>
<td headers="Change in Y" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">B unit</td>
<td headers="Benefits" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Interpretation</td></tr>
    <tr><td headers="Target" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">log(y)</td>
<td headers="Feature" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">x</td>
<td headers="Change in X" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">1 unit</td>
<td headers="Change in Y" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">100 * (exp(B) -1) </td>
<td headers="Benefits" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Heteroscedasticity in y</td></tr>
    <tr><td headers="Target" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">log(y)</td>
<td headers="Feature" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">log(x)</td>
<td headers="Change in X" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">1% change</td>
<td headers="Change in Y" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">B% change</td>
<td headers="Benefits" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Interpretation, deal with feature extremes</td></tr>
    <tr><td headers="Target" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">y</td>
<td headers="Feature" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">scale(x)</td>
<td headers="Change in X" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">1 standard deviation</td>
<td headers="Change in Y" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">B unit</td>
<td headers="Benefits" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Interpretation, estimation</td></tr>
    <tr><td headers="Target" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">scale(y)</td>
<td headers="Feature" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">scale(x)</td>
<td headers="Change in X" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">1 standard deviation</td>
<td headers="Change in Y" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">B standard deviation</td>
<td headers="Benefits" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Interpretation, estimation</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>For example, it is very common to use <strong>standardized</strong> variables, or simply ‘scaling’ them. Some also call this <strong>normalizing</strong> but <a href="https://en.wikipedia.org/wiki/Normalization_(statistics)">this term can mean a lot of things</a>, so one should be clear in their communication. If <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> are both standardized, a one unit (i.e.&nbsp;one standard deviation) change in <span class="math inline">\(x\)</span> leads to a <span class="math inline">\(\beta\)</span> standard deviation change in <span class="math inline">\(y\)</span>. So, if <span class="math inline">\(\beta\)</span> was .5, a standard deviation change in <span class="math inline">\(x\)</span> leads to a half standard deviation change in <span class="math inline">\(y\)</span>. In general, there is nothing to lose by standardizing, so you should employ it often.</p>
<p>Another common transformation, particularly in machine learning, is <strong>min-max scaling</strong>. This involves changing variables to range from some minimum value to some maximum value, and usually this means zero and one respectively. This transformation can make numeric and categorical indicators more comparable, or at least put the on the same scale for estimation purposes, and so can help with convergence and speed up estimation.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">R</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>When using <code>sklearn</code>, it’s a bit of a verbose process to do such a simple transformation. However it is beneficial when you want to do more complicated things, especially when using data pipelines.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler, MinMaxScaler</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a sample dataset</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a random sample of integers</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.random.randint(low<span class="op">=</span><span class="dv">0</span>, high<span class="op">=</span><span class="dv">100</span>, size<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">3</span>))</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply StandardScaler</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>scaled_data <span class="op">=</span> scaler.fit_transform(data)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply MinMaxScaler</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>minmax_scaler <span class="op">=</span> MinMaxScaler()</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>minmax_scaled_data <span class="op">=</span> minmax_scaler.fit_transform(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>R, being made for statistics, makes it easy to do simple transformations, but you can also use tools like <code>recipes</code> and <code>mlr3</code> pipeline operations when needed to make sure your preprocessing is applied appropriately.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a sample dataset</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">15</span>), <span class="at">nrow =</span> <span class="dv">5</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardization</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>scaled_data <span class="ot">=</span> <span class="fu">scale</span>(data)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Min-Max Scaling</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>minmax_scaled_data <span class="ot">=</span> <span class="fu">apply</span>(data, <span class="dv">2</span>, <span class="cf">function</span>(x) {</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    (x <span class="sc">-</span> <span class="fu">min</span>(x)) <span class="sc">/</span> (<span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Using a <strong>log</strong> transformation for numeric targets and features is straightforward, and <a href="https://stats.stackexchange.com/questions/107610/what-is-the-reason-the-log-transformation-is-used-with-right-skewed-distribution">comes with several benefits</a>. For example, it can help with <strong>heteroscedasticity</strong>, which is when the variance of the target is not constant across the range of the predictions<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> (demonstrated below). It can also help to keep predictions positive after transformation, allows for interpretability gains, and more. One issue with logging is that it is not a linear transformation, which can help capture nonlinear feature-target relationships, but can also can make some post-modeling transformations more less straightforward. Also if you have a lot of zeros, ‘log plus one’ transformations are not going to be enough to help you overcome that hurdle<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. Logging also won’t help much when the variables in question have few distinct values, like ordinal variables, which we’ll discuss later in <a href="#sec-data-ordinal" class="quarto-xref"><span>Section 9.2.3</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-log-transformation-heteroscedasticity" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-log-transformation-heteroscedasticity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="data_files/figure-html/fig-log-transformation-heteroscedasticity-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-log-transformation-heteroscedasticity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.1: Log transformation and heteroscedasticity
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Categorizing continuous variables">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Categorizing continuous variables
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>It is rarely necessary or a good idea to transform a numeric feature or target to a categorical one. Doing so potentially throws away useful information by making the feature a less reliable measure of the underlying construct. For example, discretizing age to ‘young’ and ‘old’ does not help your model, and you can always get predictions for what you would consider ‘young’ and ‘old’ after the fact. Though extremely common, particularly in machine learning contexts when applied to target variables, it’s just not a statistically or practically sound thing to do, and can ultimately hinder interpretation.</p>
</div>
</div>
</div>
</section>
<section id="sec-data-cat" class="level3" data-number="9.2.2">
<h3 data-number="9.2.2" class="anchored" data-anchor-id="sec-data-cat"><span class="header-section-number">9.2.2</span> Categorical Variables</h3>
<p>Despite their ubiquity in data, we can’t analyze raw text information as it is. Character strings, and labeled features like factors, must be converted to a numeric representation before we can analyze them. For categorical features, we can use something called <strong>effects coding</strong> to test for specific types of group differences. Far and away the most common type is called <strong>dummy coding</strong> or <strong>one-hot encoding</strong><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>, which we visited previously <a href="linear_models.html#sec-lm-categorical-features" class="quarto-xref"><span>Section 1.7.2</span></a>. In these situations we create columns for each category, and the value of the column is 1 if the observation is in that category, and 0 otherwise. Here is a one-hot encoded version of the <code>season</code> feature that was demonstrated previously.</p>
<div class="cell">
<div id="tbl-one-hot" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-one-hot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.2: One-hot encoding
</figcaption>
<div aria-describedby="tbl-one-hot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="kpeudwcojg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#kpeudwcojg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kpeudwcojg thead, #kpeudwcojg tbody, #kpeudwcojg tfoot, #kpeudwcojg tr, #kpeudwcojg td, #kpeudwcojg th {
  border-style: none;
}

#kpeudwcojg p {
  margin: 0;
  padding: 0;
}

#kpeudwcojg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kpeudwcojg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kpeudwcojg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kpeudwcojg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kpeudwcojg .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kpeudwcojg .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kpeudwcojg .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kpeudwcojg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kpeudwcojg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kpeudwcojg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kpeudwcojg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kpeudwcojg .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kpeudwcojg .gt_spanner_row {
  border-bottom-style: hidden;
}

#kpeudwcojg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kpeudwcojg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kpeudwcojg .gt_from_md > :first-child {
  margin-top: 0;
}

#kpeudwcojg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kpeudwcojg .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kpeudwcojg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kpeudwcojg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kpeudwcojg .gt_row_group_first td {
  border-top-width: 2px;
}

#kpeudwcojg .gt_row_group_first th {
  border-top-width: 2px;
}

#kpeudwcojg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kpeudwcojg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kpeudwcojg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kpeudwcojg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kpeudwcojg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kpeudwcojg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kpeudwcojg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kpeudwcojg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kpeudwcojg .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#kpeudwcojg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kpeudwcojg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kpeudwcojg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kpeudwcojg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kpeudwcojg .gt_left {
  text-align: left;
}

#kpeudwcojg .gt_center {
  text-align: center;
}

#kpeudwcojg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kpeudwcojg .gt_font_normal {
  font-weight: normal;
}

#kpeudwcojg .gt_font_bold {
  font-weight: bold;
}

#kpeudwcojg .gt_font_italic {
  font-style: italic;
}

#kpeudwcojg .gt_super {
  font-size: 65%;
}

#kpeudwcojg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kpeudwcojg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kpeudwcojg .gt_indent_1 {
  text-indent: 5px;
}

#kpeudwcojg .gt_indent_2 {
  text-indent: 10px;
}

#kpeudwcojg .gt_indent_3 {
  text-indent: 15px;
}

#kpeudwcojg .gt_indent_4 {
  text-indent: 20px;
}

#kpeudwcojg .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="seasonFall">seasonFall</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="seasonSpring">seasonSpring</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="seasonSummer">seasonSummer</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="seasonWinter">seasonWinter</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="season">season</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="seasonFall" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">1</td>
<td headers="seasonSpring" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="seasonSummer" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="seasonWinter" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="season" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Fall</td></tr>
    <tr><td headers="seasonFall" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">1</td>
<td headers="seasonSpring" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="seasonSummer" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="seasonWinter" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="season" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Fall</td></tr>
    <tr><td headers="seasonFall" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">1</td>
<td headers="seasonSpring" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="seasonSummer" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="seasonWinter" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="season" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Fall</td></tr>
    <tr><td headers="seasonFall" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">1</td>
<td headers="seasonSpring" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="seasonSummer" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="seasonWinter" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="season" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Fall</td></tr>
    <tr><td headers="seasonFall" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="seasonSpring" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="seasonSummer" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">1</td>
<td headers="seasonWinter" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="season" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Summer</td></tr>
    <tr><td headers="seasonFall" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="seasonSpring" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="seasonSummer" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">1</td>
<td headers="seasonWinter" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="season" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Summer</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Dummy Coding Explained">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Dummy Coding Explained
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>For statistical models, when doing one-hot encoding all relevant information is incorporated in k-1 groups, where k is the number of groups, so one category will be dropped from the model matrix. This dropped category is called the <strong>reference</strong>. In a standard linear model, the intercept represents the mean of the target for the reference category. The coefficients for the other categories are the difference between the mean for the reference category and the group mean of the category being considered.</p>
<p>As an example, in the case of the <code>season</code> feature, if the dropped category is <code>winter</code>, the intercept tells us the mean rating for <code>winter</code>, and the coefficients for the other categories are the difference between the value for <code>winter</code> and the mean of the target for <code>fall</code>, <code>summer</code> and <code>spring</code>.</p>
<p>In other models, we include all categories in the model. The model learns how to use them best and might only consider some or one of them at a time.</p>
</div>
</div>
</div>
<p>When we encode categories for statistical analysis, we can summarize their impact on the target variable single measure. For a model with only categorical features, we can use an <strong>ANOVA</strong> (<a href="linear_models.html#sec-lm-categorical-anova" class="quarto-xref"><span>Section 1.7.2.1</span></a>) for this. But a similar approach can also be used for mixed models, splines, and other models. Techniques like SHAP also provide a way to summarize the total effect of a categorical feature.</p>
<section id="sec-data-embeddings" class="level4" data-number="9.2.2.1">
<h4 data-number="9.2.2.1" class="anchored" data-anchor-id="sec-data-embeddings"><span class="header-section-number">9.2.2.1</span> Text Embeddings</h4>
<p>When it comes to other character representations like text, we use other methods to represent them numerically. One important way to encode textis through an <strong>embedding</strong>. This is a way of representing the text as a vector of numbers, at which point the embedding feature is used in the model like anything else. The way to do this usually involves a model itself, one that learns the best way to represent the text or categories numerically. This is commonly used in deep learning and natural language processing in particular. However, embeddings can also be used as a preprocessing step in any modeling situation.</p>
<p>To understand how embeddings work, consider a one-hot encoded matrix for a categorical variable. This matrix then connects to a hidden layer of a neural network, and the weights of that layer are the embeddings for the categorical variable. While this isn’t the exact method used (there are more efficient methods that don’t require the actual matrix), the concept is the same. In addition, we normally don’t even use whole words. Instead, we break the text into smaller units called <strong>tokens</strong>, like characters or subwords, and then use embeddings for those units. <a href="https://huggingface.co/learn/nlp-course/en/chapter6/5">Tokenization</a> is is used in many of the most successful models in the in natural language processing domain, including those such as <a href="https://www.youtube.com/watch?v=zduSFxRajkE">ChatGPT</a>.</p>
<div id="fig-embedding" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-embedding-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/graphical-embedding.svg" class="img-fluid figure-img" style="width:25.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-embedding-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.2: Conceptual example of an embedding
</figcaption>
</figure>
</div>
</section>
<section id="sec-data-multiclass" class="level4" data-number="9.2.2.2">
<h4 data-number="9.2.2.2" class="anchored" data-anchor-id="sec-data-multiclass"><span class="header-section-number">9.2.2.2</span> Multiclass Targets</h4>
<p>We’ve talked and demonstrated binary targets a lot, but what about when there are more than two classes? In statistical settings, we can use a <strong>multinomial regression</strong>, which is a generalization of (binomial) logistic regression to more than two classes via the multinomial distribution. Depending on the tool, you may have to use a <em>multivariate</em> target of the counts, though most commonly they would be zeros and ones for a classification model, which then is just a one-hot encoded target. The following table demonstrates how this might look.</p>
<div class="cell">
<div id="tbl-multinomial-data" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-multinomial-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9.3: Multinomial data example
</figcaption>
<div aria-describedby="tbl-multinomial-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="aicybkdhtk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#aicybkdhtk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#aicybkdhtk thead, #aicybkdhtk tbody, #aicybkdhtk tfoot, #aicybkdhtk tr, #aicybkdhtk td, #aicybkdhtk th {
  border-style: none;
}

#aicybkdhtk p {
  margin: 0;
  padding: 0;
}

#aicybkdhtk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#aicybkdhtk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#aicybkdhtk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#aicybkdhtk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#aicybkdhtk .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aicybkdhtk .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aicybkdhtk .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aicybkdhtk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#aicybkdhtk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#aicybkdhtk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#aicybkdhtk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#aicybkdhtk .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#aicybkdhtk .gt_spanner_row {
  border-bottom-style: hidden;
}

#aicybkdhtk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#aicybkdhtk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#aicybkdhtk .gt_from_md > :first-child {
  margin-top: 0;
}

#aicybkdhtk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#aicybkdhtk .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#aicybkdhtk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#aicybkdhtk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#aicybkdhtk .gt_row_group_first td {
  border-top-width: 2px;
}

#aicybkdhtk .gt_row_group_first th {
  border-top-width: 2px;
}

#aicybkdhtk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aicybkdhtk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#aicybkdhtk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#aicybkdhtk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aicybkdhtk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aicybkdhtk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#aicybkdhtk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#aicybkdhtk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#aicybkdhtk .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#aicybkdhtk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aicybkdhtk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#aicybkdhtk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aicybkdhtk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#aicybkdhtk .gt_left {
  text-align: left;
}

#aicybkdhtk .gt_center {
  text-align: center;
}

#aicybkdhtk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#aicybkdhtk .gt_font_normal {
  font-weight: normal;
}

#aicybkdhtk .gt_font_bold {
  font-weight: bold;
}

#aicybkdhtk .gt_font_italic {
  font-style: italic;
}

#aicybkdhtk .gt_super {
  font-size: 65%;
}

#aicybkdhtk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#aicybkdhtk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#aicybkdhtk .gt_indent_1 {
  text-indent: 5px;
}

#aicybkdhtk .gt_indent_2 {
  text-indent: 10px;
}

#aicybkdhtk .gt_indent_3 {
  text-indent: 15px;
}

#aicybkdhtk .gt_indent_4 {
  text-indent: 20px;
}

#aicybkdhtk .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="x1">x1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="x2">x2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="target">target</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Class A">Class A</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Class B">Class B</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Class C">Class C</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="x1" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−1.41</td>
<td headers="x2" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">6</td>
<td headers="target" class="gt_row gt_center" style="font-family: 'Source Sans Pro'; font-weight: 400;">A</td>
<td headers="Class A" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">1</td>
<td headers="Class B" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="Class C" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td></tr>
    <tr><td headers="x1" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−1.13</td>
<td headers="x2" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">3</td>
<td headers="target" class="gt_row gt_center" style="font-family: 'Source Sans Pro'; font-weight: 400;">C</td>
<td headers="Class A" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="Class B" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="Class C" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">1</td></tr>
    <tr><td headers="x1" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.70</td>
<td headers="x2" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">6</td>
<td headers="target" class="gt_row gt_center" style="font-family: 'Source Sans Pro'; font-weight: 400;">C</td>
<td headers="Class A" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="Class B" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="Class C" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">1</td></tr>
    <tr><td headers="x1" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.32</td>
<td headers="x2" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">8</td>
<td headers="target" class="gt_row gt_center" style="font-family: 'Source Sans Pro'; font-weight: 400;">B</td>
<td headers="Class A" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="Class B" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">1</td>
<td headers="Class C" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td></tr>
    <tr><td headers="x1" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.84</td>
<td headers="x2" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5</td>
<td headers="target" class="gt_row gt_center" style="font-family: 'Source Sans Pro'; font-weight: 400;">A</td>
<td headers="Class A" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">1</td>
<td headers="Class B" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="Class C" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>With Bayesian tools, it’s common to use the <strong><a href="https://en.wikipedia.org/wiki/Categorical_distribution">categorical distribution</a></strong>, which is a different generalization of the Bernoulli distribution to more than two classes. Unlike the multinomial, it is not a count distribution, but an actual distribution over categories.</p>
<p>In the machine learning context, we can use a variety of models we’d use for binary classification. How the model is actually implemented will depend on the tool, but one of the more popular methods is to use <strong>one-vs-all</strong> or <strong>one-vs-one</strong> strategies, where you treat each class as the target in a binary classification problem. In the first case you would have a model for each class that predicts whether an observation is in that class or not. In the second case, you would have a model for each pair of classes. You should generally be careful with either approach if interpretation is important, as it can make the feature effects very difficult to understand. As an example, we can’t expect feature X to have the same effect on the target in a model for class A vs B, as it does in a model for class A vs.&nbsp;(B &amp; C) or A &amp; C. It also can be misleading when the models are conducted as if the categories are independent.</p>
<p>Regardless of the context, interpretation is now spread across multiple target output, and so it can be difficult to understand the overall effect of a feature on the target. Even in the statistical setting, you now have coefficients that regard <em>relative</em> effects for one class versus a reference group, and so they cannot tell you a general effect of a feature on the target. This is where tools like marginal effects and SHAP can be useful (<a href="knowing_models.html" class="quarto-xref"><span>Chapter 2</span></a>).</p>
</section>
<section id="sec-data-multilabel" class="level4" data-number="9.2.2.3">
<h4 data-number="9.2.2.3" class="anchored" data-anchor-id="sec-data-multilabel"><span class="header-section-number">9.2.2.3</span> Multilabel Targets</h4>
<p>Multilabel targets are a bit more complicated, and are not as common as multiclass targets. In this case, each observation can have multiple labels. For example, if we wanted to predict genre based on the movie review data, we could choose to allow a movie to be both a comedy and action film, a sci-fi horror, or a romantic comedy. In this setting, labels are not mutually exclusive.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Categorical Objective Functions">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Categorical Objective Functions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In many situations where you have a categorical target you will use a form of <strong>cross-entropy loss</strong> for the objective function. You may see other names such as <em>log loss</em> or <em>logistic loss</em> or <em>negative log likelihood</em> depending on the context, but usually it’s just a <a href="https://en.wikipedia.org/wiki/Cross-entropy#Cross-entropy_loss_function_and_logistic_regression">different name for the same underlying objective</a>.</p>
</div>
</div>
</div>
</section>
</section>
<section id="sec-data-ordinal" class="level3" data-number="9.2.3">
<h3 data-number="9.2.3" class="anchored" data-anchor-id="sec-data-ordinal"><span class="header-section-number">9.2.3</span> Ordinal Variables</h3>
<p>So far in our discussion of categorical data, it’s assumed to have no order. But it’s quite common to have labels like “low”, “medium”, and “high”, or “very bad”, “bad”, “neutral”, “good”, “very good”, or simply are a few numbers, like ratings from 1 to 5. <strong>Ordinal data</strong> is categorical data that has a known ordering, but which still has arbitrary labels. Let us repeat that, <em>ordinal data is categorical data</em>.</p>
<section id="sec-data-ordinal-features" class="level4" data-number="9.2.3.1">
<h4 data-number="9.2.3.1" class="anchored" data-anchor-id="sec-data-ordinal-features"><span class="header-section-number">9.2.3.1</span> Ordinal Features</h4>
<p>The simplest way to treat ordinal features is as if they were numeric. If you do this, then you’re just pretending that it’s not categorical, and this is usually fine. Most of the transformations we mentioned probably aren’t going to be as useful, but you can still use them if you want. For example, logging ratings 1-5 isn’t going to do anything for you model-wise, but it technically doesn’t hurt anything. But you should know that typical statistics like means and standard deviations don’t really make sense for ordinal data, so the main reason for treating them as numeric is for modeling convenience.</p>
<p>If you choose to treat an ordinal feature as categorical, you can ignore the ordering and do the same as you would with categorical data. This would allow for some nonlinearity since the category means whatever they need to be. There are also some specific techniques to coding ordinal data for use in linear models, but they are not commonly used, and they generally aren’t going to help the model performance or interpreting the feature, so we do not recommend them. You could however use old-school <strong>effects coding</strong> that you would incorporate traditional ANOVA models, but again, you’d need a good reason to do so.</p>
<p>The take home message for ordinal features is generally simple. Teat them as you would numeric features or non-ordered categorical features. Either is fine.</p>
</section>
<section id="sec-data-ordinal-targets" class="level4" data-number="9.2.3.2">
<h4 data-number="9.2.3.2" class="anchored" data-anchor-id="sec-data-ordinal-targets"><span class="header-section-number">9.2.3.2</span> Ordinal Targets</h4>
<p>Ordinal targets can be trickier to deal with. If you treat them as numeric, you’re assuming that the difference between 1 and 2 is the same as the difference between 2 and 3, and so on. This is probably not true. If you treat them as categorical and use standard models for that setting, you’re assuming that there is no connection between categories. So what should you do?</p>
<p>There are a number of ways to model ordinal targets, but probably the most common is the <strong>proportional odds model</strong>. This model can be seen as a generalization of the logistic regression model, and is very similar to it, and actually identical if you only had two categories. It basically is a model of 2 vs.&nbsp;1, 3 vs.&nbsp;(2, 1), 4 vs.&nbsp;(3, 2, 1), etc. But other models beyond proportional odds are also possible, and your results could return something that gives coefficients for the model for the 1-2 category change, the 2-3 category change, and so on.</p>
<p>Ordinality of a categorical outcome is largely ignored in machine learning applications. The outcome is either treated as numeric or multiclass classification. This is not necessarily a bad thing, especially if prediction is the primary goal. But if you need a categorical prediction, treating the target as numeric means you have to make an arbitrary choice to classify the predictions. And if you treat it as multiclass, you’re ignoring the ordinality of the target, which may not work as well.</p>
</section>
<section id="sec-data-rank" class="level4" data-number="9.2.3.3">
<h4 data-number="9.2.3.3" class="anchored" data-anchor-id="sec-data-rank"><span class="header-section-number">9.2.3.3</span> Rank Data</h4>
<p>Though ranks are ordered, with rank data we are referring to cases where the observations are uniquely ordered. An ordinal vector with numeric labels could be something like [2, 1, 1, 3, 4, 2], whereas rank data would be [2, 1, 3, 4, 5, 6]. For example, in sports, the actual finish of the runners in a race is what we’d want to predict. Assuming you have a modeling tool that actually handles this situation, the objective will be different than other scenarios. Statistical modeling methods include using the Plackett-Luce distribution (or the simpler variant Bradley-Terry model). In machine learning, you might use so-called <a href="https://en.wikipedia.org/wiki/Learning_to_rank">learning to rank methods</a>, like the <a href="https://icml.cc/Conferences/2015/wp-content/uploads/2015/06/icml_ranking.pdf">RankNet and LambdaRank algorithms</a>, and other variants for <a href="https://github.com/tensorflow/ranking">deep learning models</a>.</p>
</section>
</section>
</section>
<section id="sec-data-missing" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="sec-data-missing"><span class="header-section-number">9.3</span> Missing Data</h2>
<div class="cell">
<div id="fig-missing-data" class="cell-output-display quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-missing-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="yichzgjisd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#yichzgjisd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yichzgjisd thead, #yichzgjisd tbody, #yichzgjisd tfoot, #yichzgjisd tr, #yichzgjisd td, #yichzgjisd th {
  border-style: none;
}

#yichzgjisd p {
  margin: 0;
  padding: 0;
}

#yichzgjisd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yichzgjisd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yichzgjisd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yichzgjisd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yichzgjisd .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yichzgjisd .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yichzgjisd .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yichzgjisd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yichzgjisd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yichzgjisd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yichzgjisd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yichzgjisd .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yichzgjisd .gt_spanner_row {
  border-bottom-style: hidden;
}

#yichzgjisd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yichzgjisd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yichzgjisd .gt_from_md > :first-child {
  margin-top: 0;
}

#yichzgjisd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yichzgjisd .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yichzgjisd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yichzgjisd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yichzgjisd .gt_row_group_first td {
  border-top-width: 2px;
}

#yichzgjisd .gt_row_group_first th {
  border-top-width: 2px;
}

#yichzgjisd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yichzgjisd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yichzgjisd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yichzgjisd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yichzgjisd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yichzgjisd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yichzgjisd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yichzgjisd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yichzgjisd .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#yichzgjisd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yichzgjisd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yichzgjisd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yichzgjisd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yichzgjisd .gt_left {
  text-align: left;
}

#yichzgjisd .gt_center {
  text-align: center;
}

#yichzgjisd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yichzgjisd .gt_font_normal {
  font-weight: normal;
}

#yichzgjisd .gt_font_bold {
  font-weight: bold;
}

#yichzgjisd .gt_font_italic {
  font-style: italic;
}

#yichzgjisd .gt_super {
  font-size: 65%;
}

#yichzgjisd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yichzgjisd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yichzgjisd .gt_indent_1 {
  text-indent: 5px;
}

#yichzgjisd .gt_indent_2 {
  text-indent: 10px;
}

#yichzgjisd .gt_indent_3 {
  text-indent: 15px;
}

#yichzgjisd .gt_indent_4 {
  text-indent: 20px;
}

#yichzgjisd .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="x1">x1</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="x2">x2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="x3">x3</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="x1" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">4</td>
<td headers="x2" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">0</td>
<td headers="x3" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">?</td></tr>
    <tr><td headers="x1" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">7</td>
<td headers="x2" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">3</td>
<td headers="x3" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">B</td></tr>
    <tr><td headers="x1" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">?</td>
<td headers="x2" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">5</td>
<td headers="x3" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">A</td></tr>
    <tr><td headers="x1" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">8</td>
<td headers="x2" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">?</td>
<td headers="x3" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">B</td></tr>
    <tr><td headers="x1" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">?</td>
<td headers="x2" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">3</td>
<td headers="x3" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">C</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-missing-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.3
</figcaption>
</figure>
</div>
</div>
<p>Missing data is a common challenge in data science, and there are a number of ways to deal with it, usually by substituting, or <strong>imputing</strong>, the substituted value for the missing one. Here we’ll provide an overview of common techniques to deal with missing data.</p>
<section id="sec-data-missing-complete" class="level3" data-number="9.3.1">
<h3 data-number="9.3.1" class="anchored" data-anchor-id="sec-data-missing-complete"><span class="header-section-number">9.3.1</span> Complete Case Analysis</h3>
<p>The first way to deal with missing data is the simplest - <strong>complete case analysis</strong>. Here we only use observations that have no missing data and drop the rest. Unfortunately, can lead to a lot of lost data, and can lead to biased statistical results if the data is not <strong>missing completely at random</strong>. There are special cases of some models that by their nature can ignore the missingness under an assumption of <strong>missing at random</strong>, but even those models would likely benefit from some sort of imputation. If you don’t have much missing data though, dropping the missing data is fine for practical purposes<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>. How much is too much? Unfortunately that depends on the context, but if you have more than 10% missing, you should probably be looking at alternatives.</p>
</section>
<section id="sec-data-missing-single" class="level3" data-number="9.3.2">
<h3 data-number="9.3.2" class="anchored" data-anchor-id="sec-data-missing-single"><span class="header-section-number">9.3.2</span> Single Value Imputation</h3>
<p><strong>Single value imputation</strong>: Replace missing values with the mean, median, mode or some other typical value of the feature.This will probably rarely help your model for a variety of reasons. Consider a numeric feature that is 50% missing, and for which you replace the missing with the mean. How good do you think that feature will be when at least half the values are identical? Whatever variance it normally would have and share with the target is probably reduced, and possibly dramatically. Furthermore, you’ve also attenuated correlations it has with the other features, which may mute other modeling issues that you would otherwise deal with in some way (e.g.&nbsp;collinearity), or cause you to miss out on interactions.</p>
<p>Single value imputation makes perfect sense if you <em>know</em> that the missingness should be a specific value, like a count feature where missing means a count of zero. If you don’t have much missing data, it’s unlikely this would have any real benefit over complete case analysis, <em>except</em> if it allows you to use all the other features that would otherwise be dropped. But then, why not just drop this feature and keep the others?</p>
</section>
<section id="sec-data-missing-model" class="level3" data-number="9.3.3">
<h3 data-number="9.3.3" class="anchored" data-anchor-id="sec-data-missing-model"><span class="header-section-number">9.3.3</span> Model-based Imputation</h3>
<p><strong>Model-based imputation</strong> is more complicated, but can be very effective. In essence, you run a model for complete cases in which the feature with missing values is now the target, and all the other features and primary target are used to predict it. You then use that model to predict the missing values, and use those predictions as the imputed values. After these predictions are made, you move on to the next feature and do the same. There are no restrictions on which model you use for which feature. If the other features in the imputation model also have missing data, you can use something like mean imputation to get more complete data if necessary as a first step, and then when their turn comes, impute those values.</p>
<p>Although the implication is that you would have one model per feature and then be done, you can do this iteratively for several rounds, such that the initial imputed values are then used in subsequent models to reimpute the missing values. You can do this as many times as you want, but the returns will diminish. In this setting, we are assuming you’ll have a single value imputed for each missing one, but this approach is the precursor for our next method.</p>
</section>
<section id="sec-data-missing-mi" class="level3" data-number="9.3.4">
<h3 data-number="9.3.4" class="anchored" data-anchor-id="sec-data-missing-mi"><span class="header-section-number">9.3.4</span> Multiple Imputation</h3>
<p><strong>Multiple imputation</strong> (MI) is a more complicated technique, but can be very useful under some situations, depending on what you’re willing to sacrifice for having better uncertainty estimates versus a deeper dive into the model. The idea is that you create multiple imputed datasets, each of which is based on the <strong>predictive distribution</strong> of the model used in model-based imputation. Say we use a linear regression assuming a normal distribution to impute feature A. We would then draw repeatedly from the predictive distribution of that model to create multiple datasets with (randomly) imputed values for feature A</p>
<p>Let’s say we do this 10 times, and we now have 10 imputed data sets. We now run our actual model of interest on each of these datasets, and final model results are averaged in some way to get final parameter estimates. Doing so acknowledges that your single imputation methods have uncertainty in those imputed values, and that uncertainty is incorporated into the final model results.</p>
<p>MI can in theory handle any source of missingness and can be a very powerful technique. But it has several drawbacks. One is that you need a a specified target distribution for all imputation models used in order to generate random draws from. Your final model presumably is also a probabilistic model with coefficients and variances you are trying to estimate and understand. MI probably isn’t going to help a boosting or deep learning models that have native methods for dealing with missing values, or at least offer little if anything over single value imputation. If you have very large data and a complicated model, you could be waiting a long time, and as modeling is an iterative process itself, this can be rather tedious to work through. Finally, few data or post-model processing tools that you commonly use will work with MI results, especially visualization tools. So you will have to hope that whatever package you use for MI has what you need. As an example, you’d have to figure out how you’re going to impute interaction terms if you have them.</p>
<p><em>Practically speaking</em>, MI takes a lot of effort to often come to the same conclusions you would have with a single imputation method, or possibly fewer conclusions for anything beyond GLM coefficients and their standard errors. But if you want your uncertainty estimate for those models to be better, MI can be an option.</p>
</section>
<section id="sec-data-missing-bayesian" class="level3" data-number="9.3.5">
<h3 data-number="9.3.5" class="anchored" data-anchor-id="sec-data-missing-bayesian"><span class="header-section-number">9.3.5</span> Bayesian Imputation</h3>
<p>One final option is to run a Bayesian model where the missing values are treated as parameters to be estimated, and they would have priors just like other parameters as well. MI is basically a variant of Bayesian imputation that can be applied to the non-Bayesian model setting, so why not just use the actual Bayesian method? Some modeling packages can allow you to try this very easily, and it can be very effective. But it is also very computationally intensive, and can be very slow as you may be increasing the number of parameters to estimate dramatically. At least it would be more fun than standard MI!</p>
</section>
</section>
<section id="sec-data-class-imbalance" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="sec-data-class-imbalance"><span class="header-section-number">9.4</span> Class Imbalance</h2>
<div class="cell">
<div class="cell-output-display">
<div id="fig-class-imbalance" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-class-imbalance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="data_files/figure-html/fig-class-imbalance-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-class-imbalance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.4: Class Imbalance
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Class imbalance</strong> refers to the situation where the target variable has a large difference in the number of observations in each class. For example, if you have a binary target, and 90% of the observations are in one class, and 10% in the other, you would have class imbalance. You’ll almost never see a 50/50 split in the real world, but the issue is that as we move further away from that point, we can start to see problems in model estimation, prediction, and interpretation. With our example, if we just predict the majority class in a binary classification problem, our accuracy would 90%! Under other circumstances that might be a great result, but in this case it’s not. So right off the bat one of our favorite metrics to use for classification models isn’t going to help us much.</p>
<p>For classification problems, <em>class imbalance is the rule, not the exception</em>. This is because nature just doesn’t sort itself into nice and even bins. The majority of people of a random sample do not have cancer, the vast majority of people have not had a heart attack in the past year, most people do not default on their loans, and so on.</p>
<p>There are a number of ways to help deal with class imbalance, and the method that works best will depend on the situation. Some of the most common are:</p>
<ul>
<li><strong>Use different metrics</strong>: Use metrics that are less affected by class imbalance, such as area under a receiver operating characteristic curve (AUC), or those that balance the tradeoff between precision and recall, like the F1 score, or balance recall and true negative rate, like the balanced accuracy score.</li>
<li><strong>Oversampling/Undersampling</strong>: Randomly sample from the minority (majority) class to increase (decrease) the number of observations in that class.</li>
<li><strong>Weighted objectives</strong>: Weight the loss function to give more weight to the minority class. Although commonly employed, and a simple thing to use with models like lightgbm and xgboost, it often fails to help, and can cause other issues.</li>
<li><strong>Thresholding</strong>: Change the threshold for classification to be more sensitive to the minority class. Nothing says you have to use 0.5 as the threshold for classification, and you can change it to be more sensitive to the minority class. This is a very simple approach, and may be all you need.</li>
</ul>
<p>These are not necessarily mutually exclusive. For example, in the imbalanced setting it’s probably a good idea to switch your focus to a metric besides accuracy even as you employ other techniques.</p>
<section id="sec-data-calibration" class="level3" data-number="9.4.1">
<h3 data-number="9.4.1" class="anchored" data-anchor-id="sec-data-calibration"><span class="header-section-number">9.4.1</span> Calibration Issues in Classification</h3>
<p>Probability <strong>calibration</strong> is often an issue in classification problems, and is a bit more complicated than just class imbalance, but is often discussed in the same setting. Having calibrated probabilities refers to the situation where the predicted probabilities of the target match up well to the actual probabilities. For example, if you predict that 10% of people will default on their loans, and 10% of people actually do default on their loans, one would say your model is well calibrated. Conversely, if you predict that 10% of people will default on their loans, but 20% of people actually do default on their loans, your model is not so well-calibrated.</p>
<p>One way to assess calibration is to use a <strong>calibration curve</strong>, which is a plot of the predicted probabilities vs.&nbsp;the observed proportions. We bin the observations in some way, and then calculate the average predicted probability and the average observed proportion of the target in each bin. If the model is well-calibrated, the points should fall along the 45-degree line. If the model is not well-calibrated, the points will fall above or below the line. In the following, one model seems to align well with the observed proportions based on the chosen bins. The other model (dashed line) is not so well calibrated, and is overshooting with its predictions. For example, if the model’s average prediction predicts a 0.5 probability of default, the actual proportion of defaults is only around 0.6.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-calibration-plot" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-calibration-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="data_files/figure-html/fig-calibration-plot-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-calibration-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.5: Calibration Plot
</figcaption>
</figure>
</div>
</div>
</div>
<p>While the issue is an important one, it’s good to keep the issue of calibration and imbalance separate. As miscalibration implies bias, bias can happen irrespective of the class proportions, and can be due to a variety of factors related to the model, target, or features. Furthermore miscalibration is not inherent to any particular model.</p>
<p>Furthermore, the assessment of calibration in this manner has a few issues. For one, the observed ‘probabilities’ are proportions based on arbitrarily chosen bins, and the observed values are measured with some <strong>measurement error</strong> and have a natural variability with will partly reflect sample size<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>. These plots are often presented such that observed proportions are labeled as the “true” probabilities. However, you do not have the <em>true</em> probabilities, just the observed class labels, so whether your model’s predicted probabilities match observed proportions is a bit of a different question. The predictions obviously have uncertainty as well, and this will depend on the model, sample size, and other factors. And finally, the number of bins chosen can also affect the appearance of the plot in a notable way if the sample size is small.</p>
<p>All this is to say that each point in a calibration plot, along with the reference line itself, has some error bar around it, and the differences between models and the ‘best case scenario’ would need additional steps to suss out if we are interested in doing so in a statistically rigorous fashion. Some methods are available to calibrate probabilities, but they are not commonly implemented in practice, and often involve a model-based technique, with all of its own assumptions and limitations. It’s also not exactly clear that forcing your probabilities to be on the line is helping solve the actual modeling goal in any way<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>. But if you are interested, you can read more <a href="https://scikit-learn.org/stable/modules/calibration.html">here</a>.</p>
</section>
</section>
<section id="sec-data-censoring" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="sec-data-censoring"><span class="header-section-number">9.5</span> Censoring and Truncation</h2>
<div class="cell">
<div class="cell-output-display">
<div id="fig-censoring" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-censoring-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="data_files/figure-html/fig-censoring-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-censoring-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.6: Censoring for Time Until Death
</figcaption>
</figure>
</div>
</div>
</div>
<p>Sometimes, we just don’t see all the data there is to see. <strong>Censoring</strong> is a situation where the target variable is not fully observed. This is common in techniques where the target is the time to an event, like ‘death’, but the event has not yet occurred for some observations (thankfully!). Specifically this is called <strong>right censoring</strong>, and is the most common type of censoring, and depicted in the above plot, where several individuals are only observed to a certain age and were still alive at that time. There is also <a href="https://stats.stackexchange.com/questions/144037/right-censoring-and-left-censoring"><strong>left censoring</strong></a>, where the censoring happens from the other direction, and data before a certain point is unknown. Finally, there is <strong>interval censoring</strong>, where the event of interest occurs within some interval, but the exact value is unknown.</p>
<p><strong>Survival analysis</strong><a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> is a common modeling technique in this situation, but you may also be able to keep things even more simple via something like <a href="https://m-clark.github.io/models-by-example/tobit.html">tobit regression</a>. In this model, you assume that the target is fully observed, but that the values are censored, and you model the probability of censoring. This is a common technique in econometrics, and can keep you in a traditional linear model context.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-truncation" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-truncation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="data_files/figure-html/fig-truncation-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-truncation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.7: Truncation
</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Truncation</strong> is a situation where the target variable is only observed if it is above or below some value, even though we know other possibilities exist. One of the issues is that default distributional methods assume a distribution that is not necessarily bounded in the way that the data exhibits. In our plot above, we restrict our data to 70 and below for practical or other reasons, but typical modeling methods predicting age would not respect that.</p>
<p>You could truncate predictions after the fact, but this is a bit of a hack, and often results in lumpiness in the predictions at the boundary that likely isn’t realistic. Alternatively, Bayesian methods allow you to model the target as a distribution with truncated distributions, and so you can model the probability of the target being above or below some value. There are also models such as <strong>hurdle models</strong> that might prove useful where the truncation is theoretically motivated, e.g.&nbsp;a zero-inflated Poisson model for count data where the zero counts are due to a separate process than the non-zero counts.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Censoring vs. Truncation">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Censoring vs.&nbsp;Truncation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>One way to distinguish censored and truncated data is that censored data is usually due to some external process such that the target is not observed, but could be possible (capping reported income at $1 million). Truncated data, on the other hand, is due to some internal process that prevents the target from being observed, and is often derived from sample selection (we only want to model non-millionaires). We would not want predictions past the censored point to be unlikely, but we would want predictions past the truncated point to be impossible. Trickier still is that for bounded or truncated distributions that might be applied to the truncated scenario, such as folded vs.&nbsp;truncated distributions, they would not result in the same probability distributions even if they can be applied to the same data situation.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/trunc_vs_folded.png" class="img-fluid figure-img" style="width:33.0%"></p>
<figcaption>Folded and Truncated Distributions</figcaption>
</figure>
</div>
<p>Image from <a href="(https://stats.stackexchange.com/questions/16089/is-sampling-from-a-folded-normal-distribution-equivalent-to-sampling-from-a-norm)">StackExchange</a></p>
</div>
</div>
</div>
</section>
<section id="sec-data-time" class="level2" data-number="9.6">
<h2 data-number="9.6" class="anchored" data-anchor-id="sec-data-time"><span class="header-section-number">9.6</span> Time Series</h2>
<div class="cell">
<div class="cell-output-display">
<div id="fig-time-series" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-time-series-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="data_files/figure-html/fig-time-series-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-time-series-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.8: Time Series Data
</figcaption>
</figure>
</div>
</div>
</div>
<p>Time series data is any data that incorporates values over a period of time. This could be something like the a state’s population over years, or the max temperature of an area over days. Time series data is very common in data science, and there are a number of ways to model such data.</p>
<section id="time-based-targets" class="level3" data-number="9.6.1">
<h3 data-number="9.6.1" class="anchored" data-anchor-id="time-based-targets"><span class="header-section-number">9.6.1</span> Time-based Targets</h3>
<p>As in other settings, the most common approach when the target is some value that varies time is to use a linear model of some kind. While the target varies over time, the features may be time-varying or not. There are traditional autoregressive models that use the target’s past values as features, for example, autoregressive moving average (<strong>ARIMA</strong>) models. Others can incorporate historical information in other ways such as is done in Bayesian methods to marketing data or in reinforcement learning (<a href="ml_more.html#sec-ml-more-reinforcement" class="quarto-xref"><span>Section 8.3</span></a>). Still others can get quite complex, such <strong>recurrent neural networks</strong> and their generalizations that form the backbone of modern AI models. Lately <a href="https://research.google/blog/a-decoder-only-foundation-model-for-time-series-forecasting/">transformer-based models</a> have looked promising.</p>
<p><strong>Longitudinal data</strong><a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> is a special case of time series data, where the target is a function of time, but it is typically grouped in some fashion. An example is a model for school performance for students over several semesters, where values are clustered within students over time. In this case, you can use some sort of time series regression, but you can also use a <strong>mixed model</strong> (<a href="linear_model_extensions.html#sec-lm-extend-mixed-models" class="quarto-xref"><span>Section 5.3</span></a>), where you model the target as a function of time, but also include a random effect for the grouping variable, in this case, students. This is a very common approach in many domains, and can be very effective in terms of performance as well. It can also be used for time series data that is not longitudinal, where the random effects are based on autoregressive covariance matrices. In this case, an ARIMA component is added to linear model as a random effect to account for the time series nature of the data. This is fairly common in Bayesian contexts.</p>
<p>In general lots of models can be found specific to time series data, and the choice of model will depend on the data, the questions we want to ask, and the goals we have.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Time Series vs. Longitudinal">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Time Series vs.&nbsp;Longitudinal
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The primary distinguishing feature for referring data as ‘time-series’ and ‘longitudinal’ is the number of time points, where the latter typically has relatively few. This arbitrary though.</p>
</div>
</div>
</div>
</section>
<section id="time-based-features" class="level3" data-number="9.6.2">
<h3 data-number="9.6.2" class="anchored" data-anchor-id="time-based-features"><span class="header-section-number">9.6.2</span> Time-based Features</h3>
<p>When it comes to time-series features, we can apply time-specific transformations. One technique is the <a href="https://betterexplained.com/articles/an-interactive-guide-to-the-fourier-transform/"><strong>fourier transform</strong></a>, which can be used to decompose a time series into its component frequencies, much like how we use PCA (<a href="ml_more.html#sec-ml-more-unsuper" class="quarto-xref"><span>Section 8.2</span></a>). This can be useful for identifying periodicity in the data, which can be used as a feature in a model.</p>
<p>In marketing contexts, some perform <strong>adstocking</strong> with features. This method models the delayed effect of features over time, such that they may have their most important impact immediately, but still can impact the present target from past values. For example, a marketing campaign might have the most significant impact immediately after it’s launched, but it can still influence the target variable at later time points. Adstocking helps capture this delayed effect without having to include multiple lagged features in the model. That said, including lagged features is also an option. In this case, you would have a feature for the current time point (<em>t</em>), the same feature for the previous time point (<em>t-1</em>), the feature for the time point before that (<em>t-2</em>), and so on.</p>
<p>If you have the year as a feature, you can use it as a numeric feature or as a categorical feature. If you treat it as numeric, you need to consider what a zero means. In a linear model, the intercept usually represents the outcome when all features are zero. But with something like year, a zero year isn’t meaningful in most contexts. To solve this, you can shift the values so that the earliest time point, like the first year in your data, becomes zero. This way, the intercept in your model will represent the outcome for this first time point, which is more meaningful. The same goes if you are using months or days as a numeric feature. It doesn’t really matter which year/month/day is zero, just that zero refers to one of the actual time points observed.</p>
<p>Dates and/or times can be it bit trickier. Often you can just split dates out into year, month, day, etc., and proceed as discussed. In other cases you’d want to track the time period to assess possible seasonal effects. You can use something lie a <strong>cyclic</strong> approach (e.g.&nbsp;<a href="https://developer.nvidia.com/blog/three-approaches-to-encoding-time-information-as-features-for-ml-models/">cyclic spline or sine/cosine transformation</a>) to get at yearly or within-day seasonal effects. As mentioned, a fourier transform can also be used to decompose the time series into its component frequencies for use as model features. Time components like hours, minutes, and seconds can often be dealt with in similar ways, but you will more often deal with the periodicity in the data. For example, if you are looking at hourly data, you may want to consider the 24-hour cycle.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Calendars are hard.">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Calendars are hard.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><em>Weeks are not universal</em>. Some start on Sunday, others Monday. Some data contexts only consider weekdays. <a href="https://en.wikipedia.org/wiki/ISO_week_date">Some systems</a> may have 52 or 53 weeks in a year, and dates may not be in the same week from one year to the next, etc. So use caution when considering weeks as a feature.</p>
</div>
</div>
</div>
<section id="covariance-structures" class="level4" data-number="9.6.2.1">
<h4 data-number="9.6.2.1" class="anchored" data-anchor-id="covariance-structures"><span class="header-section-number">9.6.2.1</span> Covariance Structures</h4>
<p>In many cases you’ll have features that vary over time but are not a time-oriented feature like year or month. For example, you might have a feature that is the number of people who visited a website over days. This is a time-varying feature, but it’s not a time metric in and of itself.</p>
<p>In general, we’d like to account for the time-dependent correlations in our data, and the main way to do so is to posit a covariance structure that accounts for this in some fashion. This helps us understand how data points are related to each other over time, and requires us to estimate the correlations between observations. As a starting point, consider linear regression. In a standard linear regression model, we assume that the samples are independent of one another, with a constant variance and no covariance.</p>
<p>Instead, we can also use something like a <strong>mixed model</strong>, where we include a random effect for each group and estimate the variance attributable to the grouping effect. By default, this ultimately assumes a constant correlation from time point to time point, but many tools allow you to specify a more complex covariance structure. A common method is to use autoregressive covariance structure that allows for correlations further apart in time to lessen. In this sense the covariance comes in as an added <em>random effect</em>, rather than being a model in and of itself as with ARIMA. Many such approaches to covariance structures are special cases of <strong>gaussian processes</strong>, which are a very general technique to model time series, spatial, and other types of data.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-covariance-structure" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-covariance-structure-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="data_files/figure-html/fig-covariance-structure-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-covariance-structure-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.9: AR (1) Covariance Structure Visualized
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="sec-data-spatial" class="level2" data-number="9.7">
<h2 data-number="9.7" class="anchored" data-anchor-id="sec-data-spatial"><span class="header-section-number">9.7</span> Spatial Data</h2>
<div id="fig-spatial-data" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-spatial-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/data-spatial_data.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-spatial-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.10: Spatial Weighting Applied to the Dallas-Fort Worth Area Census Tracts
</figcaption>
</figure>
</div>
<p>We visited spatial data in a discussion on non-tabular data (<a href="ml_more.html#sec-ml-more-spatial" class="quarto-xref"><span>Section 8.4.1</span></a>), but here we want to talk about it from a modeling perspective, especially within the tabular domain. Say you have a target that is a function of location, such as the proportion of people voting a certain way in a county, or the number of crimes in a city. You can use a <strong>spatial regression</strong> model, where the target is a function of location among other features that may or may not be spatially oriented. Two approaches already discussed may be applied in the case of having continuous spatial features, such as latitude and longitude, or discrete features like county. For the continuous case, we could use a GAM (<a href="linear_model_extensions.html#sec-gam" class="quarto-xref"><span>Section 5.4</span></a>), where we use a smooth interaction of latitude and longitude. For the discrete setting, we can use a mixed model, where we include a random effect for county.</p>
<p>There are other traditional techniques to spatial regression, especially in the continuous spatial domain, such as using a <strong>spatial lag</strong>, where we incorporate information about the neighborhood of a observation’s location into the model (e.g.&nbsp;a weighted mean of neighboring values, as in the visualization above based on code from <span class="citation" data-cites="walker_analyzing_2023">Walker (<a href="references.html#ref-walker_analyzing_2023" role="doc-biblioref">2023</a>)</span>). Such models fall under names such as CAR (conditional autoregressive), SAR (spatial autoregressive), BYM, kriging, and so on. These models can be very effective, but are in general different forms of random effects models very similar to those used for time-based settings, and likewise can be seen as special cases of gaussian processes.</p>
</section>
<section id="multivariate-targets" class="level2" data-number="9.8">
<h2 data-number="9.8" class="anchored" data-anchor-id="multivariate-targets"><span class="header-section-number">9.8</span> Multivariate Targets</h2>
<p>Often you will encounter settings where the target is not a single value, but a vector of values. This is often called a <strong>multivariate target</strong> in statistical settings, or just the norm for deep learning. For example, you might be interested in predicting the number of people who will buy a product, the number of people who will click on an ad, and the number of people who will sign up for a newsletter. This is a common setting in marketing, where you are interested in multiple outcomes. The main idea is that there is a relationship among the targets, and you want to take this into account.</p>
<p>One model example we’ve already seen is the case where we have more than two categories for the target. Some default approaches may take that input and just do a one-vs-all, for each category, but this kind of misses the point. Others will simultaneously model the multiple targets in some way. On the other hand, it can be difficult to interpret results with multiple targets. Because of this, you’ll often see results presented in terms of the respective targets anyway, and often even ignoring parameters specifically associated with such a model<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>.</p>
<p>In deep learning contexts, the multivariate setting is ubiquitous. For example, if you want to classify the content of an image, you might have to predict something like different species of animals, or different types of car models. In natural language processing, you might want to predict the probability of different words in a sentence. In some cases, there are even multiple kinds of targets considered simultaneously! It can get very complex, but often in these settings prediction performance far outweighs the need to interpret specific parameters, and so it’s a good fit.</p>
<!-- :::{.callout-tip }
Some are a little too eager to jump to simultaneously modeling multiple target variables, e.g. in structural equation modeling or multivariate regression. It's not wrong to do so, but given the difficulty our brains have with interpreting results for a single target, you might think twice. However, for scenarios focused much more on prediction performance that involve method like deep learning, it makes more sense, and is actually required.
::: -->
</section>
<section id="sec-data-latent" class="level2" data-number="9.9">
<h2 data-number="9.9" class="anchored" data-anchor-id="sec-data-latent"><span class="header-section-number">9.9</span> Latent Variables</h2>
<!-- TODO: maybe update to look like other nnet plots? -->
<div id="fig-graphical-bifactor" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-graphical-bifactor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/graphical-bifactor.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphical-bifactor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9.11: Latent Variable Model (Bifactor)
</figcaption>
</figure>
</div>
<p>Latent variables are a fundamental aspect of modeling, and simply put, are variables that are not directly observed, but are inferred from other variables. Here are some examples of what might be called latent variables:</p>
<ul>
<li>The linear combination of features in a linear regression model is a latent variable, but usually we only think of it as such before the link transformation in GLMs (<a href="generalized_linear_models.html" class="quarto-xref"><span>Chapter 4</span></a>).</li>
<li>The error term in any model is a latent variable representing all the unknown/unobserved/unmodeled factors that influence the target (<a href="linear_models.html#eq-lm-observed" class="quarto-xref">Equation&nbsp;<span>1.3</span></a>).</li>
<li>The principal components in PCA (<a href="ml_more.html" class="quarto-xref"><span>Chapter 8</span></a>).</li>
<li>The measurement error in any feature or target.</li>
<li>The factor scores in a factor analysis model or structural equation (visualization above).</li>
<li>The true target underlying the censored values (<a href="#sec-data-censoring" class="quarto-xref"><span>Section 9.5</span></a>).</li>
<li>The clusters in cluster analysis/mixture models (<a href="ml_more.html#sec-ml-more-clusters-latent" class="quarto-xref"><span>Section 8.2.1.1</span></a>).</li>
<li>The random effects in a mixed model (<a href="linear_model_extensions.html#sec-lm-extend-mixed-models" class="quarto-xref"><span>Section 5.3</span></a>).</li>
<li>The hidden states in a hidden Markov model.</li>
<li>The hidden layers in a deep learning model (<a href="ml_common_models.html#sec-ml-dl-nn" class="quarto-xref"><span>Section 7.7</span></a>).</li>
</ul>
<p>It’s easy to see from such a list that latent variables are very common in modeling, so it’s good to get comfortable with the concept. Whether they’re appropriate to your specific situation will depend on a variety of factors, but they can be very useful in many settings, if not a required part of the modeling approach.</p>
</section>
<section id="sec-data-aug" class="level2" data-number="9.10">
<h2 data-number="9.10" class="anchored" data-anchor-id="sec-data-aug"><span class="header-section-number">9.10</span> Data Augmentation</h2>
<p><strong><a href="https://aws.amazon.com/what-is/data-augmentation/">Data augmentation</a></strong> is a technique where you artificially increase the size of your dataset by creating new data points based on the existing data. This is a common technique in deep learning for computer vision, where you might rotate, flip, or crop images to create new training data. This can help improve the performance of your model, especially when you have a small dataset. Techniques are also available for text.</p>
<p>In the tabular domain, data augmentation is less common, but still possible. You’ll see it most commonly applied with class-imbalance settings (<a href="#sec-data-class-imbalance" class="quarto-xref"><span>Section 9.4</span></a>), where you might create new data points for the minority class to balance the dataset. This can be done by randomly sampling from the existing data points, or by creating new data points based on the existing data points. For the latter, SMOTE and many variants of it are quite common.</p>
<p>Unfortunately for tabular data, these techniques are not nearly as successful, nor consistently so. Part of the issue is that tabular data is very noisy and fraught with measurement error, so in a sense, such techniques are just adding noise to the modeling process<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>. Simple random upsampling can potentially lead to an overconfident model that still doesn’t generalize well. In the end, the best approach is to get more and/or better data, but hopefully more successful methods will be developed in the future.</p>
<!-- TODO: Should we have a section on measurement error? I removed this todo and now I'm putting it back in. -->
</section>
<section id="wrapping-up" class="level2" data-number="9.11">
<h2 data-number="9.11" class="anchored" data-anchor-id="wrapping-up"><span class="header-section-number">9.11</span> Wrapping Up</h2>
<p>There’s a lot going on with data before you ever get to modeling, and which will affect every aspect of your modeling approach. This chapter outlines common data types, issues, and associated modeling aspects, but in the end, you’ll always have to make decisions based on your specific situation, and they will often not be easy ones. These are only some of the things to consider, so be ready for surprises, and, be ready to learn from them!</p>
<section id="the-common-thread" class="level3" data-number="9.11.1">
<h3 data-number="9.11.1" class="anchored" data-anchor-id="the-common-thread"><span class="header-section-number">9.11.1</span> The Common Thread</h3>
<p>Many of the transformations and missing data techniques could possibly be applied in many modeling settings. Likewise, you may find yourself dealing with different target variable issues like imbalance or censoring, and deal with temporal, spatial or other structures, in a variety of models. The key is to understand the data, the target, and the features, and to make the best decisions you can based on that understanding.</p>
</section>
<section id="choose-your-own-adventure" class="level3" data-number="9.11.2">
<h3 data-number="9.11.2" class="anchored" data-anchor-id="choose-your-own-adventure"><span class="header-section-number">9.11.2</span> Choose Your Own Adventure</h3>
<p>Consider revisiting a model covered in the other parts of this book in light of the data issues discussed here. For example,might you deal with class imbalance for a boosted tree model? How would you deal with spatial structure in a neural network? How would you deal with a multivariate target in a time series model?</p>
</section>
<section id="additional-resources" class="level3" data-number="9.11.3">
<h3 data-number="9.11.3" class="anchored" data-anchor-id="additional-resources"><span class="header-section-number">9.11.3</span> Additional Resources</h3>
<p>Here are some additional resources to help you learn more about the topics covered in this chapter.</p>
<p><strong>Transformations</strong></p>
<ul>
<li><a href="https://sebastianraschka.com/Articles/2014_about_feature_scaling.html">About Feature Scaling and Normalization</a> (<span class="citation" data-cites="raschka_about_2014">Raschka (<a href="references.html#ref-raschka_about_2014" role="doc-biblioref">2014</a>)</span>)</li>
<li><a href="https://vickiboykis.com/what_are_embeddings/">What are Embedding</a> (<span class="citation" data-cites="boykis_what_2023">Boykis (<a href="references.html#ref-boykis_what_2023" role="doc-biblioref">2023</a>)</span>)</li>
</ul>
<p><strong>Class Imbalance</strong></p>
<ul>
<li><p><a href="https://developers.google.com/machine-learning/data-prep/construct/sampling-splitting/imbalanced-data">Brief Overview</a> (Google)</p></li>
<li><p><a href="https://towardsdatascience.com/handling-imbalanced-datasets-in-machine-learning-7a0e84220f28">Handling imbalanced datasets in machine learning</a> (<span class="citation" data-cites="rocca_handling_2019">Rocca (<a href="references.html#ref-rocca_handling_2019" role="doc-biblioref">2019</a>)</span>)</p></li>
<li><p><a href="https:strong.io/blog/imbalanced-outcomes-challenges-and-solutions">Imbalanced Outcomes: Challenges &amp; Solutions</a> (<span class="citation" data-cites="monroe_imbalanced_2024">Monroe and Clark (<a href="references.html#ref-monroe_imbalanced_2024" role="doc-biblioref">2024</a>)</span>, in preparation)</p></li>
<li><p><a href="https://machinelearningmastery.com/what-is-imbalanced-classification/">A Gentle Introduction to Imbalanced Classification</a> (<span class="citation" data-cites="brownlee_gentle_2019">Brownlee (<a href="references.html#ref-brownlee_gentle_2019" role="doc-biblioref">2019</a>)</span>)</p></li>
</ul>
<p><strong>Calibration</strong></p>
<ul>
<li><a href="https://stats.stackexchange.com/questions/452483/why-some-algorithms-produce-calibrated-probabilities">Why some algorithms produce calibrated probabilities</a> (StackExchange)</li>
<li><a href="https://www.cs.cornell.edu/~alexn/papers/calibration.icml05.crc.rev3.pdf">Predicting good probabilities with supervised learning</a> (<span class="citation" data-cites="niculescu-mizil_predicting_2005">Niculescu-Mizil and Caruana (<a href="references.html#ref-niculescu-mizil_predicting_2005" role="doc-biblioref">2005</a>)</span>)</li>
</ul>
<p><strong>Survival, Ordinal and Other Models</strong></p>
<ul>
<li>Regression Modeling Strategies is a great resource for statistical modeling in general (<span class="citation" data-cites="harrell_regression_2015">Harrell (<a href="references.html#ref-harrell_regression_2015" role="doc-biblioref">2015</a>)</span>)</li>
</ul>
<p><strong>Time Series</strong></p>
<ul>
<li><a href="https://otexts.com/fpp3/">Forecasting: Principles and Practice</a> (<span class="citation" data-cites="hyndman_forecasting_2021">Hyndman and Athanasopoulos (<a href="references.html#ref-hyndman_forecasting_2021" role="doc-biblioref">2021</a>)</span>)</li>
</ul>
<p><strong>Latent Variables</strong></p>
<p>There’s a ton of stuff, but one of your humble authors has an applied that is not far the conceptual approach of this text. However, we’d recommend more of an ‘awareness’ as you will likely be more interested in the specific context of your data and model.</p>
<p><a href="https://m-clark.github.io/sem/">Graphical and Latent Variable Modeling</a> (<span class="citation" data-cites="clark_graphical_2018">Clark (<a href="references.html#ref-clark_graphical_2018" role="doc-biblioref">2018</a>)</span>)</p>
<p><strong>Data Augmentation</strong></p>
<p><a href="https://aws.amazon.com/what-is/data-augmentation/">What is Data Augmentation?</a> (<span class="citation" data-cites="amazon_what_2024">Amazon (<a href="references.html#ref-amazon_what_2024" role="doc-biblioref">2024</a>)</span>)</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-amazon_what_2024" class="csl-entry" role="listitem">
Amazon. 2024. <span>“What Is <span>Data</span> <span>Augmentation</span>? - <span>Data</span> <span>Augmentation</span> <span>Techniques</span> <span>Explained</span> - <span>AWS</span>.”</span> <em>Amazon Web Services, Inc.</em> <a href="https://aws.amazon.com/what-is/data-augmentation/">https://aws.amazon.com/what-is/data-augmentation/</a>.
</div>
<div id="ref-boykis_what_2023" class="csl-entry" role="listitem">
Boykis, Vicki. 2023. <span>“What Are Embeddings?”</span> <a href="http://vickiboykis.com/what_are_embeddings/index.html">http://vickiboykis.com/what_are_embeddings/index.html</a>.
</div>
<div id="ref-brownlee_gentle_2019" class="csl-entry" role="listitem">
Brownlee, Jason. 2019. <span>“A <span>Gentle</span> <span>Introduction</span> to <span>Imbalanced</span> <span>Classification</span>.”</span> <em>MachineLearningMastery.com</em>. <a href="https://machinelearningmastery.com/what-is-imbalanced-classification/">https://machinelearningmastery.com/what-is-imbalanced-classification/</a>.
</div>
<div id="ref-clark_graphical_2018" class="csl-entry" role="listitem">
Clark, Michael. 2018. <em>Graphical &amp; <span>Latent</span> <span>Variable</span> <span>Modeling</span></em>. <a href="https://m-clark.github.io/sem/">https://m-clark.github.io/sem/</a>.
</div>
<div id="ref-harrell_regression_2015" class="csl-entry" role="listitem">
Harrell, Frank E. 2015. <em>Regression <span>Modeling</span> <span>Strategies</span>: <span>With</span> <span>Applications</span> to <span>Linear</span> <span>Models</span>, <span>Logistic</span> and <span>Ordinal</span> <span>Regression</span>, and <span>Survival</span> <span>Analysis</span></em>. 2nd ed. Springer <span>Series</span> in <span>Statistics</span>. Cham: Springer International Publishing. <a href="https://doi.org/10.1007/978-3-319-19425-7">https://doi.org/10.1007/978-3-319-19425-7</a>.
</div>
<div id="ref-hyndman_forecasting_2021" class="csl-entry" role="listitem">
Hyndman, Rob, and George Athanasopoulos. 2021. <em>Forecasting: <span>Principles</span> and <span>Practice</span> (3rd Ed)</em>. <a href="https://otexts.com/fpp3/">https://otexts.com/fpp3/</a>.
</div>
<div id="ref-monroe_imbalanced_2024" class="csl-entry" role="listitem">
Monroe, Elizabeth, and Michael Clark. 2024. <span>“Imbalanced <span>Outcomes</span>: <span>Challenges</span> and <span>Solutions</span>.”</span>
</div>
<div id="ref-niculescu-mizil_predicting_2005" class="csl-entry" role="listitem">
Niculescu-Mizil, Alexandru, and Rich Caruana. 2005. <span>“Predicting Good Probabilities with Supervised Learning.”</span> In <em>Proceedings of the 22nd International Conference on <span>Machine</span> Learning - <span>ICML</span> ’05</em>, 625–32. Bonn, Germany: ACM Press. <a href="https://doi.org/10.1145/1102351.1102430">https://doi.org/10.1145/1102351.1102430</a>.
</div>
<div id="ref-raschka_about_2014" class="csl-entry" role="listitem">
Raschka, Sebastian. 2014. <span>“About <span>Feature</span> <span>Scaling</span> and <span>Normalization</span>.”</span> <em>Sebastian Raschka, PhD</em>. <a href="https://sebastianraschka.com/Articles/2014_about_feature_scaling.html">https://sebastianraschka.com/Articles/2014_about_feature_scaling.html</a>.
</div>
<div id="ref-rocca_handling_2019" class="csl-entry" role="listitem">
Rocca, Baptiste. 2019. <span>“Handling Imbalanced Datasets in Machine Learning.”</span> <em>Medium</em>. <a href="https://towardsdatascience.com/handling-imbalanced-datasets-in-machine-learning-7a0e84220f28">https://towardsdatascience.com/handling-imbalanced-datasets-in-machine-learning-7a0e84220f28</a>.
</div>
<div id="ref-walker_analyzing_2023" class="csl-entry" role="listitem">
Walker, Kyle E. 2023. <em>Analyzing <span>US</span> <span>Census</span> <span>Data</span></em>. <a href="https://walker-data.com/census-r">https://walker-data.com/census-r</a>.
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>For the bazillionth time, logging does not make data ‘normal’ so that you can meet your normality assumption in linear regression. The only time that would work is if your data is log-normally distributed to begin with.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>That doesn’t mean you won’t see many people try (and fail).<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Note that one-hot encoding can refer to just the 1/0 coding for all categories, or to the specific case of dummy coding where one category is dropped. Make sure the context is clear.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>While many statisticians will possibly huff and puff at the idea of dropping data, there are two things to consider. With minimal missingness you’ll likely never come to a different conclusion unless you have very little data to come to a conclusion about, which is already the bigger problem. Secondly, it’s impossible to prove one way or another if the data is missing at random, because doing so would require knowing the missing values.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Note that each bin will reflect the portion of the test set size in this situation. If you have a small test set, the observed proportions will be more variable, and the calibration plot will be more variable as well.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Oftentimes we are only interested in the ordering of the predictions, and not the actual probabilities. For example, if we are trying to identify the top 10% of people most likely to default on their loans, we’ll just take the top 10% of predictions, and the actual probabilities are irrelevant for that goal.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>Survival analysis is also called event history analysis, and is widely used in biostatistics, sociology, demography, and other disciplines where the target is the time to an event, such as death, marriage, divorce, etc.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>You may also hear the term <strong>panel data</strong> in econometrics-oriented disciplines.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>It was common in social sciences back in the day to run a Multivariate ANOVA, and then if the result was statistically significant, and mostly because few practitioners knew what to do with the result, they would run separate ANOVAs for each target.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>Compare to the image settings where there is relatively little measurement error, by just rotating an image, you are still preserving the underlying structure of the data.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ml_more.html" class="pagination-link  aria-label=" &lt;span="" ml&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">More ML</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./causal.html" class="pagination-link" aria-label="<span class='chapter-number'>10</span>&nbsp; <span class='chapter-title'>Causal Modeling</span>">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Causal Modeling</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2024 CC-BY-NC-SA</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/m-clark/book-of-models/edit/dev/data.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/m-clark/book-of-models">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/statsdatasci">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>