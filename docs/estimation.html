<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>6&nbsp; Model Estimation and Optimization – Models Demystified</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./generalized_linear_models.html" rel="next">
<link href="./understanding_features.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-3a01e2046221230fdceeea94b1ec5d67.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-74e8c4dbc3b38357afd5009b93c858b0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="6&nbsp; Model Estimation and Optimization – Models Demystified">
<meta property="og:description" content="">
<meta property="og:site_name" content="Models Demystified">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title"><span id="sec-estimation" class="quarto-section-identifier"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Model Estimation and Optimization</span></span></h1>
        </a>     
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Models Demystified</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/m-clark/book-of-models" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Thinking About Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Foundation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./understanding_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Understanding the Model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./understanding_features.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Understanding the Features</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estimation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Model Estimation and Optimization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./generalized_linear_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Generalized Linear Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear_model_extensions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Extending the Linear Model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machine_learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Core Concepts in Machine Learning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ml_common_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Common Models in Machine Learning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ml_more.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">More Machine Learning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./causal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Causal Modeling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Dealing with Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./danger_zone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Danger Zone</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Until Next Time…</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Additional Topics</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./acknowledgments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Acknowledgments</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matrix_operations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Matrix Operations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./more_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">More Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">References &amp; Resources</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dataset_descriptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Dataset Descriptions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">References</span></span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#sec-estim-key-ideas" id="toc-sec-estim-key-ideas" class="nav-link active" data-scroll-target="#sec-estim-key-ideas"><span class="header-section-number">6.1</span> Key Ideas</a>
  <ul class="collapse">
  <li><a href="#sec-estim-why" id="toc-sec-estim-why" class="nav-link" data-scroll-target="#sec-estim-why"><span class="header-section-number">6.1.1</span> Why this matters</a></li>
  <li><a href="#sec-estim-good-to-know" id="toc-sec-estim-good-to-know" class="nav-link" data-scroll-target="#sec-estim-good-to-know"><span class="header-section-number">6.1.2</span> Helpful context</a></li>
  </ul></li>
  <li><a href="#sec-estim-data-setup" id="toc-sec-estim-data-setup" class="nav-link" data-scroll-target="#sec-estim-data-setup"><span class="header-section-number">6.2</span> Data Setup</a>
  <ul class="collapse">
  <li><a href="#other-setup" id="toc-other-setup" class="nav-link" data-scroll-target="#other-setup"><span class="header-section-number">6.2.1</span> Other Setup</a></li>
  </ul></li>
  <li><a href="#sec-estim-guessing" id="toc-sec-estim-guessing" class="nav-link" data-scroll-target="#sec-estim-guessing"><span class="header-section-number">6.3</span> Starting Out by Guessing</a></li>
  <li><a href="#sec-estim-prediction-error" id="toc-sec-estim-prediction-error" class="nav-link" data-scroll-target="#sec-estim-prediction-error"><span class="header-section-number">6.4</span> Prediction Error</a></li>
  <li><a href="#sec-estim-ols" id="toc-sec-estim-ols" class="nav-link" data-scroll-target="#sec-estim-ols"><span class="header-section-number">6.5</span> Ordinary Least Squares</a></li>
  <li><a href="#sec-estim-opt" id="toc-sec-estim-opt" class="nav-link" data-scroll-target="#sec-estim-opt"><span class="header-section-number">6.6</span> Optimization</a></li>
  <li><a href="#sec-estim-maxlike" id="toc-sec-estim-maxlike" class="nav-link" data-scroll-target="#sec-estim-maxlike"><span class="header-section-number">6.7</span> Maximum Likelihood</a>
  <ul class="collapse">
  <li><a href="#sec-estim-likelihood-deeper" id="toc-sec-estim-likelihood-deeper" class="nav-link" data-scroll-target="#sec-estim-likelihood-deeper"><span class="header-section-number">6.7.1</span> Diving deeper</a></li>
  </ul></li>
  <li><a href="#sec-estim-penalty" id="toc-sec-estim-penalty" class="nav-link" data-scroll-target="#sec-estim-penalty"><span class="header-section-number">6.8</span> Penalized Objectives</a></li>
  <li><a href="#sec-estim-classification" id="toc-sec-estim-classification" class="nav-link" data-scroll-target="#sec-estim-classification"><span class="header-section-number">6.9</span> Classification</a>
  <ul class="collapse">
  <li><a href="#sec-estim-misclass" id="toc-sec-estim-misclass" class="nav-link" data-scroll-target="#sec-estim-misclass"><span class="header-section-number">6.9.1</span> Misclassification Error</a></li>
  <li><a href="#sec-estim-logloss" id="toc-sec-estim-logloss" class="nav-link" data-scroll-target="#sec-estim-logloss"><span class="header-section-number">6.9.2</span> Log loss</a></li>
  </ul></li>
  <li><a href="#sec-estim-opt-algos" id="toc-sec-estim-opt-algos" class="nav-link" data-scroll-target="#sec-estim-opt-algos"><span class="header-section-number">6.10</span> Optimization Algorithms</a>
  <ul class="collapse">
  <li><a href="#sec-estim-opt-algos-common" id="toc-sec-estim-opt-algos-common" class="nav-link" data-scroll-target="#sec-estim-opt-algos-common"><span class="header-section-number">6.10.1</span> Common Methods</a></li>
  <li><a href="#sec-estim-opt-algos-gd" id="toc-sec-estim-opt-algos-gd" class="nav-link" data-scroll-target="#sec-estim-opt-algos-gd"><span class="header-section-number">6.10.2</span> Gradient descent</a></li>
  <li><a href="#sec-estim-opt-algos-sgd" id="toc-sec-estim-opt-algos-sgd" class="nav-link" data-scroll-target="#sec-estim-opt-algos-sgd"><span class="header-section-number">6.10.3</span> Stochastic gradient descent</a></li>
  </ul></li>
  <li><a href="#sec-estim-other" id="toc-sec-estim-other" class="nav-link" data-scroll-target="#sec-estim-other"><span class="header-section-number">6.11</span> Estimating Uncertainty</a>
  <ul class="collapse">
  <li><a href="#sec-estim-frequentist" id="toc-sec-estim-frequentist" class="nav-link" data-scroll-target="#sec-estim-frequentist"><span class="header-section-number">6.11.1</span> Standard Frequentist</a></li>
  <li><a href="#monte-carlo" id="toc-monte-carlo" class="nav-link" data-scroll-target="#monte-carlo"><span class="header-section-number">6.11.2</span> Monte Carlo</a></li>
  <li><a href="#sec-estim-bootstrap" id="toc-sec-estim-bootstrap" class="nav-link" data-scroll-target="#sec-estim-bootstrap"><span class="header-section-number">6.11.3</span> Bootstrap</a></li>
  <li><a href="#sec-estim-bayes" id="toc-sec-estim-bayes" class="nav-link" data-scroll-target="#sec-estim-bayes"><span class="header-section-number">6.11.4</span> Bayesian estimation</a></li>
  <li><a href="#sec-estim-conformal" id="toc-sec-estim-conformal" class="nav-link" data-scroll-target="#sec-estim-conformal"><span class="header-section-number">6.11.5</span> Conformal Methods</a></li>
  </ul></li>
  <li><a href="#sec-estim-wrap" id="toc-sec-estim-wrap" class="nav-link" data-scroll-target="#sec-estim-wrap"><span class="header-section-number">6.12</span> Wrapping Up</a>
  <ul class="collapse">
  <li><a href="#sec-estim-thread" id="toc-sec-estim-thread" class="nav-link" data-scroll-target="#sec-estim-thread"><span class="header-section-number">6.12.1</span> The common thread</a></li>
  <li><a href="#sec-estim-choose" id="toc-sec-estim-choose" class="nav-link" data-scroll-target="#sec-estim-choose"><span class="header-section-number">6.12.2</span> Choose your own adventure</a></li>
  <li><a href="#sec-estim-add-res" id="toc-sec-estim-add-res" class="nav-link" data-scroll-target="#sec-estim-add-res"><span class="header-section-number">6.12.3</span> Additional resources</a></li>
  </ul></li>
  <li><a href="#sec-estim-exercise" id="toc-sec-estim-exercise" class="nav-link" data-scroll-target="#sec-estim-exercise"><span class="header-section-number">6.13</span> Guided Exploration</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/m-clark/book-of-models/edit/dev/estimation.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span id="sec-estimation" class="quarto-section-identifier"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Model Estimation and Optimization</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><img src="img/chapter_gp_plots/gp_plot_3.svg" class="img-fluid" style="width:75.0%"></p>
<p>In our initial linear model, the coefficients for each feature are the key parameters. But how do we know what the coefficients are, and how did we come to those values? When we explore a linear model using some package function, they appear magically, but it’s worth knowing a little bit about how they come to be, so let’s try and dive a little deeper. As we do so, we’ll end up going a long way into ‘demystifying’ the modeling process.</p>
<p><strong>Model estimation</strong> is the process of finding the parameters associated with a model that allow us to reach a particular modeling goal. Different types of models will have different parameters to estimate, and there are different ways to estimate them. In general though, the goal is the same, find the set of parameters that will lead to the best predictions under the current data modeling context.</p>
<p>With model estimation, we can break things down into the following steps:</p>
<ol type="1">
<li>Start with an <strong>initial guess</strong> for the parameters.</li>
<li>Calculate the <strong>prediction error</strong> based on those parameters, or some function of it, or some other value that represents our model’s <strong>objective</strong>.</li>
<li><strong>Update</strong> the guess.</li>
<li>Repeat steps 2 &amp; 3 until we find a ‘best’ guess.</li>
</ol>
<p>Pretty straightforward, right? Well, it’s not always so simple, but this is the general idea in most applications, so keep it in mind! In this chapter, we’ll show how to do this ourselves to take away the mystery a bit from when you run standard model functions in typical contexts. Hopefully then you’ll gain more confidence when you do use them!</p>
<section id="sec-estim-key-ideas" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="sec-estim-key-ideas"><span class="header-section-number">6.1</span> Key Ideas</h2>
<p>A few concepts we’ll keep using here are fundamental to understanding estimation and optimization. We should note that we’re qualifying our present discussion of these topics to typical linear models, machine learning, and similar settings, but they are much more broad and general than presented here. We’ve seen some of this before, but we’ll be getting a bit cozier with the concepts now.</p>
<ul>
<li><strong>Parameters</strong> are the values associated with a model that we have to estimate.</li>
<li><strong>Estimation</strong> is the process of finding the parameters associated with a model.</li>
<li>The <strong>objective (loss) function</strong> takes input and produces a value that we want to maximize or minimize.</li>
<li><strong>Prediction error</strong> is the difference between the observed value of the target and the predicted value, and is often used to calculate the objective function.</li>
<li><strong>Optimization</strong> is the specific process of finding the parameters that maximize or minimize some objective function.</li>
<li><strong>Model Selection</strong> is the process of choosing the best model from a set of models.</li>
</ul>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Estimation vs. Optimization">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Estimation vs.&nbsp;Optimization
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We can use <strong>estimation</strong> as general term for finding parameters, while <strong>optimization</strong> can be seen as a term for finding parameters that maximize or minimize some <strong>objective function</strong>, or even a combination of objectives. In some cases, we can estimate parameters without optimization, because there is a known way of solving the problem, but in most modeling situations we are going to use some optimization approach to find a ‘best’ set of parameters.</p>
</div>
</div>
</div>
<section id="sec-estim-why" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="sec-estim-why"><span class="header-section-number">6.1.1</span> Why this matters</h3>
<p>When it comes to modeling, even knowing just a little bit about what goes on behind the scenes is a great demystifier. And if models are less of a mystery, you’ll feel more confident using them. Much of what you see here is part of almost every common model used for statistics and machine learning, providing you even more of a foundation for expanding your modeling skills.</p>
</section>
<section id="sec-estim-good-to-know" class="level3" data-number="6.1.2">
<h3 data-number="6.1.2" class="anchored" data-anchor-id="sec-estim-good-to-know"><span class="header-section-number">6.1.2</span> Helpful context</h3>
<p>This chapter is more involved and technical than most of the others, so might be more suited for those who like to get their hands dirty. It’s all about ‘rolling your own’, and so we’ll be doing a lot of the work ourselves. If you’re not one of those types of people that gets much out of that, that’s ok, you can skip this chapter and still get a lot out of the rest of the book. But if you’re curious about how models work, or you want to be able to do more than just run a canned function, then we think you’ll find the following useful. You’d want to at least have your linear model basics down (<a href="linear_models.html" class="quarto-xref"><span>Chapter 3</span></a>).</p>
</section>
</section>
<section id="sec-estim-data-setup" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="sec-estim-data-setup"><span class="header-section-number">6.2</span> Data Setup</h2>
<p>For the examples here, we’ll use the world happiness dataset for the year 2018. We’ll use the happiness score as our target. Let’s take an initial look at the data here, but for more information see the appendix <a href="dataset_descriptions.html#sec-dd-world-happiness-report" class="quarto-xref"><span>Section D.2</span></a>.</p>
<div id="fig-r-happiness-data" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-r-happiness-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/happiness_data_summary.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-r-happiness-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.1: World Happiness Data Summary
</figcaption>
</figure>
</div>
<p>Our happiness score has values from around 3-7, life expectancy and gdp appear to have some notable variability, and corruption perception is skewed toward lower values. We can also see that the features and target are correlated with each other, which is not surprising.</p>
<div class="cell">
<div id="tbl-r-happiness-data-correlation" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-r-happiness-data-correlation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6.1: Correlation Matrix for World Happiness Data
</figcaption>
<div aria-describedby="tbl-r-happiness-data-correlation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="ljqkxndgqe" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#ljqkxndgqe table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ljqkxndgqe thead, #ljqkxndgqe tbody, #ljqkxndgqe tfoot, #ljqkxndgqe tr, #ljqkxndgqe td, #ljqkxndgqe th {
  border-style: none;
}

#ljqkxndgqe p {
  margin: 0;
  padding: 0;
}

#ljqkxndgqe .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ljqkxndgqe .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ljqkxndgqe .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ljqkxndgqe .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ljqkxndgqe .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ljqkxndgqe .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ljqkxndgqe .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ljqkxndgqe .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ljqkxndgqe .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ljqkxndgqe .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ljqkxndgqe .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ljqkxndgqe .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ljqkxndgqe .gt_spanner_row {
  border-bottom-style: hidden;
}

#ljqkxndgqe .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ljqkxndgqe .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ljqkxndgqe .gt_from_md > :first-child {
  margin-top: 0;
}

#ljqkxndgqe .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ljqkxndgqe .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ljqkxndgqe .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ljqkxndgqe .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ljqkxndgqe .gt_row_group_first td {
  border-top-width: 2px;
}

#ljqkxndgqe .gt_row_group_first th {
  border-top-width: 2px;
}

#ljqkxndgqe .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ljqkxndgqe .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ljqkxndgqe .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ljqkxndgqe .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ljqkxndgqe .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ljqkxndgqe .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ljqkxndgqe .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ljqkxndgqe .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ljqkxndgqe .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#ljqkxndgqe .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ljqkxndgqe .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ljqkxndgqe .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ljqkxndgqe .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ljqkxndgqe .gt_left {
  text-align: left;
}

#ljqkxndgqe .gt_center {
  text-align: center;
}

#ljqkxndgqe .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ljqkxndgqe .gt_font_normal {
  font-weight: normal;
}

#ljqkxndgqe .gt_font_bold {
  font-weight: bold;
}

#ljqkxndgqe .gt_font_italic {
  font-style: italic;
}

#ljqkxndgqe .gt_super {
  font-size: 65%;
}

#ljqkxndgqe .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ljqkxndgqe .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ljqkxndgqe .gt_indent_1 {
  text-indent: 5px;
}

#ljqkxndgqe .gt_indent_2 {
  text-indent: 10px;
}

#ljqkxndgqe .gt_indent_3 {
  text-indent: 15px;
}

#ljqkxndgqe .gt_indent_4 {
  text-indent: 20px;
}

#ljqkxndgqe .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="happiness">happiness</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="life_exp">life_exp</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="log_gdp_pc">log_gdp_pc</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="corrupt">corrupt</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">happiness</td>
<td headers="happiness" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">1.00</td>
<td headers="life_exp" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.78</td>
<td headers="log_gdp_pc" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.82</td>
<td headers="corrupt" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.47</td></tr>
    <tr><td headers="term" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">life_exp</td>
<td headers="happiness" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.78</td>
<td headers="life_exp" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">1.00</td>
<td headers="log_gdp_pc" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.86</td>
<td headers="corrupt" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.34</td></tr>
    <tr><td headers="term" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">log_gdp_pc</td>
<td headers="happiness" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.82</td>
<td headers="life_exp" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.86</td>
<td headers="log_gdp_pc" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">1.00</td>
<td headers="corrupt" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.34</td></tr>
    <tr><td headers="term" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">corrupt</td>
<td headers="happiness" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.47</td>
<td headers="life_exp" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.34</td>
<td headers="log_gdp_pc" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.34</td>
<td headers="corrupt" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">1.00</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div class="cell-output-display">
<br>
</div>
</div>
</figure>
</div>
</div>
<p>For our purposes here, we’ll drop any rows with missing values, and we’ll use scaled features so that they have the same variance, which, as noted in the <a href="./data.html#sec-data-transformations">data chapter</a>, can help make estimation easier.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>df_happiness <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">'https://tinyurl.com/worldhappiness2018'</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>() <span class="sc">|&gt;</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">happiness =</span> happiness_score) <span class="sc">|&gt;</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>        country,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        happiness,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">contains</span>(<span class="st">'_sc'</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df_happiness <span class="op">=</span> (</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    pd.read_csv(<span class="st">'https://tinyurl.com/worldhappiness2018'</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    .dropna()</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    .rename(columns <span class="op">=</span> {<span class="st">'happiness_score'</span>: <span class="st">'happiness'</span>})</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(regex <span class="op">=</span> <span class="st">'_sc|country|happ'</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<section id="other-setup" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="other-setup"><span class="header-section-number">6.2.1</span> Other Setup</h3>
<p>For the R examples, after the above nothing beyond base R is needed. For Python examples, the following should be enough to get you through the examples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> minimize</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="sec-estim-guessing" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="sec-estim-guessing"><span class="header-section-number">6.3</span> Starting Out by Guessing</h2>
<p>So, we’ll start with a model in which we predict a country’s level of happiness by their life expectancy. If you can expect to live longer, maybe you’re probably in a country with better health care, higher incomes, and other important stuff. As such we can probably expect higher happiness scores with higher life expectancy. We’ll stick with a linear regression model as well to start out.</p>
<p>As a starting point we can just guess what the parameter should be. But how would we know what to guess? How would we know which guesses are better than others? Let’s try a couple guesses and see what happens. Let’s say that we think all countries start at the bottom on the happiness scale (around 3), but life expectancy makes a big impact- for every standard deviation of life expectancy we go up a whole point on happiness<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. We can plug this into the model and see what we get:</p>
<p><span class="math display">\[
\text{prediction} = 3.3 + 1\cdot\text{life\_exp}
\]</span></p>
<p>For a different model, we’ll say countries start with a mean of happiness score, and moving up a standard deviation of life expectancy would move us up a half point of happiness. <span class="math display">\[
\text{prediction} = \overline{\text{happiness}} + .5\cdot\text{life\_exp}
\]</span></p>
<p>How do we know which is better? Let’s find out!</p>
</section>
<section id="sec-estim-prediction-error" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="sec-estim-prediction-error"><span class="header-section-number">6.4</span> Prediction Error</h2>
<p>We’ve seen that a key component to model assessment involves comparing the predictions from the model to the actual values of the target. This difference is known as the <strong>prediction error</strong>, or <strong>residuals</strong> in more statistical contexts. We can express this as:</p>
<p><span class="math display">\[
\epsilon = y - \hat{y}
\]</span> <span class="math display">\[
\text{error} = \text{target} - \text{model-based guess}
\]</span></p>
<p>This prediction error tells us how far off our model prediction is from the observed target values, but it also gives us a way to compare models. How? With our measure of prediction error, we can calculate a total error for all observations/predictions (<a href="understanding_models.html#sec-knowing-model-metrics" class="quarto-xref"><span>Section 4.2</span></a>), or similarly, the average error. If one model or parameter set has less total or average error, we can say it’s a better model than one that has more (<a href="understanding_models.html#sec-knowing-model-compare" class="quarto-xref"><span>Section 4.3</span></a>). Ideally we’d like to choose a model with the least possible error, but we’ll see that this is not always possible<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>.</p>
<p>However, if we just take the average of our errors from a linear regression model, you’ll see that it is roughly zero! This is by design for many common models, and is even made explicit in their mathematical depiction. So, to get a meaningful error metric, we need to use the squared error value or the absolute value. These also allow errors of similar value above and below the observed value to cost the same<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. As we’ve done elsewhere, we’ll use squared error here, and we’ll calculate the mean of the squared errors for all our predictions, i.e.&nbsp;the <strong>mean squared error (MSE)</strong>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> df_happiness<span class="sc">$</span>happiness</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the error for the guess of 4</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>prediction <span class="ot">=</span> <span class="fu">min</span>(df_happiness<span class="sc">$</span>happiness) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span>df_happiness<span class="sc">$</span>life_exp_sc</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>mse_model_A <span class="ot">=</span> <span class="fu">mean</span>((y <span class="sc">-</span> prediction)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the error for our other guess</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>prediction <span class="ot">=</span> <span class="fu">mean</span>(y) <span class="sc">+</span> .<span class="dv">5</span> <span class="sc">*</span> df_happiness<span class="sc">$</span>life_exp_sc</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>mse_model_B <span class="ot">=</span> <span class="fu">mean</span>((y <span class="sc">-</span> prediction)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">'A'</span>, <span class="st">'B'</span>),</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">MSE =</span> <span class="fu">c</span>(mse_model_A, mse_model_B)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df_happiness[<span class="st">'happiness'</span>]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the error for the guess of four</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>prediction <span class="op">=</span> np.<span class="bu">min</span>(df_happiness[<span class="st">'happiness'</span>]) <span class="op">+</span> <span class="dv">1</span> <span class="op">*</span> df_happiness[<span class="st">'life_exp_sc'</span>]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>mse_model_A   <span class="op">=</span> np.mean((y <span class="op">-</span> prediction)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the error for our other guess</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>prediction <span class="op">=</span> y.mean() <span class="op">+</span> <span class="fl">.5</span> <span class="op">*</span> df_happiness[<span class="st">'life_exp_sc'</span>]</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>mse_model_B  <span class="op">=</span> np.mean((y <span class="op">-</span> prediction)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>pd.DataFrame({</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Model'</span>: [<span class="st">'A'</span>, <span class="st">'B'</span>],</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MSE'</span>: [mse_model_A, mse_model_B]</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Now let’s look at our MSE, and we’ll also inspect the square root of it, or the <strong>Root Mean Squared Error</strong>, as that puts things back on the original target scale, and tells us the standard deviation of our prediction errors. We also add the <strong>Mean Absolute Error</strong> (MAE) as another metric with straightforward interpretation.</p>
<div class="cell">
<div id="tbl-compare-error" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-compare-error-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6.2: Comparison of Error Metrics for Two Models
</figcaption>
<div aria-describedby="tbl-compare-error-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="qaviycuqah" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#qaviycuqah table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qaviycuqah thead, #qaviycuqah tbody, #qaviycuqah tfoot, #qaviycuqah tr, #qaviycuqah td, #qaviycuqah th {
  border-style: none;
}

#qaviycuqah p {
  margin: 0;
  padding: 0;
}

#qaviycuqah .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qaviycuqah .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qaviycuqah .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qaviycuqah .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qaviycuqah .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qaviycuqah .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qaviycuqah .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qaviycuqah .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qaviycuqah .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qaviycuqah .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qaviycuqah .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qaviycuqah .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qaviycuqah .gt_spanner_row {
  border-bottom-style: hidden;
}

#qaviycuqah .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qaviycuqah .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qaviycuqah .gt_from_md > :first-child {
  margin-top: 0;
}

#qaviycuqah .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qaviycuqah .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qaviycuqah .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qaviycuqah .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qaviycuqah .gt_row_group_first td {
  border-top-width: 2px;
}

#qaviycuqah .gt_row_group_first th {
  border-top-width: 2px;
}

#qaviycuqah .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qaviycuqah .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qaviycuqah .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qaviycuqah .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qaviycuqah .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qaviycuqah .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qaviycuqah .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qaviycuqah .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qaviycuqah .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#qaviycuqah .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qaviycuqah .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qaviycuqah .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qaviycuqah .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qaviycuqah .gt_left {
  text-align: left;
}

#qaviycuqah .gt_center {
  text-align: center;
}

#qaviycuqah .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qaviycuqah .gt_font_normal {
  font-weight: normal;
}

#qaviycuqah .gt_font_bold {
  font-weight: bold;
}

#qaviycuqah .gt_font_italic {
  font-style: italic;
}

#qaviycuqah .gt_super {
  font-size: 65%;
}

#qaviycuqah .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qaviycuqah .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qaviycuqah .gt_indent_1 {
  text-indent: 5px;
}

#qaviycuqah .gt_indent_2 {
  text-indent: 10px;
}

#qaviycuqah .gt_indent_3 {
  text-indent: 15px;
}

#qaviycuqah .gt_indent_4 {
  text-indent: 20px;
}

#qaviycuqah .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Model">Model</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="MSE">MSE</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="RMSE">RMSE</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="MAE">MAE</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="RMSE % drop">RMSE % drop</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="MAE % drop">MAE % drop</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Model" class="gt_row gt_center" style="font-family: 'Source Sans Pro'; font-weight: 400;">A</td>
<td headers="MSE" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.09</td>
<td headers="RMSE" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">2.26</td>
<td headers="MAE" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">1.52</td>
<td headers="RMSE % drop" class="gt_row gt_center" style="font-family: 'Source Sans Pro'; font-weight: 400;"></td>
<td headers="MAE % drop" class="gt_row gt_center" style="font-family: 'Source Sans Pro'; font-weight: 400;"></td></tr>
    <tr><td headers="Model" class="gt_row gt_center" style="font-family: 'Source Sans Pro'; font-weight: 400;">B</td>
<td headers="MSE" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.64</td>
<td headers="RMSE" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.80</td>
<td headers="MAE" class="gt_row gt_center" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.58</td>
<td headers="RMSE % drop" class="gt_row gt_center" style="font-family: 'Source Sans Pro'; font-weight: 400;">65%</td>
<td headers="MAE % drop" class="gt_row gt_center" style="font-family: 'Source Sans Pro'; font-weight: 400;">62%</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>Inspecting the metrics, we can see that we are off on average by over a point for model A (MAE), and a little over half a point on average for model B. So we can see that model B is not only better, but results in a 65% drop in RMSE, and similar for MAE. We’d definitely prefer it over model A. This approach is also how we can compare models in a general fashion.</p>
<p>Now all of this is useful, and at least we can say one model is better than another. But you’re probably hoping there is an easier way to get a good guess for our model parameters, especially when we have possibly dozens of features and/or parameters to keep track of, and there is!</p>
</section>
<section id="sec-estim-ols" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="sec-estim-ols"><span class="header-section-number">6.5</span> Ordinary Least Squares</h2>
<p>In a simple linear model, we often use the <strong>Ordinary Least Squares (OLS)</strong> method to estimate parameters. This method finds the coefficients that minimize the sum of the squared differences between the predicted and actual values<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>. In other words, it finds the coefficients that minimize the sum of the squared differences between the predicted values and the actual values, which is what we just did in our previous example. The sum of the squared errors is also called the <strong>residual sum of squares</strong> (RSS), as opposed to the ‘total’ sums of squares (i.e.&nbsp;the variance of the target), and the part explained by the model (‘model’ or ‘explained’ sums of squares). We can express this as follows, where <span class="math inline">\(y_i\)</span> is the observed value of the target for observation <span class="math inline">\(i\)</span>, and <span class="math inline">\(\hat{y_i}\)</span> is the predicted value from the model.</p>
<p><span id="eq-ols"><span class="math display">\[
\text{Value} = \sum_{i=1}^{n} (y_i - \hat{y_i})^2
\tag{6.1}\]</span></span></p>
<p>It’s called <em>ordinary</em> least squares because there are other least squares methods - generalized least squares, weighted least squares, and others, but we don’t need to worry about that for now. The sum or mean of the squared errors is our <strong>objective value</strong>. The <strong>objective function</strong> takes the predictions and observed target values as inputs, and returns the objective value as an output. We can use this value to find the best parameters for a specific model, as well as compare models with different parameters.</p>
<p>Now let’s calculate the OLS estimate for our model. We need our own function to do this, but it doesn’t take much to create one. We need to map our inputs to our output, which are the model predictions. We then calculate the error, square it, and then average the squared errors to provide the mean squared error.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for later comparison</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>model_lr_happy <span class="ot">=</span> <span class="fu">lm</span>(happiness <span class="sc">~</span> life_exp_sc, <span class="at">data =</span> df_happiness)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>ols <span class="ot">=</span> <span class="cf">function</span>(X, y, par) {</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add a column of 1s for the intercept</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span>, X)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the predicted values</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    y_hat <span class="ot">=</span> X <span class="sc">%*%</span> par  <span class="co"># %*% is matrix multiplication</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the error</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    error <span class="ot">=</span> y <span class="sc">-</span> y_hat</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the value as mean squared error</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    value <span class="ot">=</span> <span class="fu">sum</span>(error<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">nrow</span>(X)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the objective value</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(value)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for later comparison</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>model_lr_happy <span class="op">=</span> smf.ols(<span class="st">'happiness ~ life_exp_sc'</span>, data <span class="op">=</span> df_happiness).fit()</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ols(par, X, y):</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add a column of 1s for the intercept</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.c_[np.ones(X.shape[<span class="dv">0</span>]), X]</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the predicted values</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    y_hat <span class="op">=</span> X <span class="op">@</span> par  <span class="co"># @ is matrix multiplication</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the mean of the squared errors</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    value <span class="op">=</span> np.mean((y <span class="op">-</span> y_hat)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the objective value</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>We’ll want to make a bunch of guesses for the parameters, so let’s create data for those guesses. We’ll then choose the guess that gives us the lowest objective value. But before getting carried away, try it out for just one guess to see how it works!</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a grid of guesses</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>guesses <span class="ot">=</span> <span class="fu">crossing</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">b0 =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">7</span>, <span class="fl">0.1</span>),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">b1 =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Example for one guess</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ols</span>(</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">X =</span> df_happiness<span class="sc">$</span>life_exp_sc,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> df_happiness<span class="sc">$</span>happiness,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">par =</span> <span class="fu">unlist</span>(guesses[<span class="dv">1</span>, ])</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 23.78</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a grid of guesses</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>guesses <span class="op">=</span> pd.DataFrame(</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    product(</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        np.arange(<span class="dv">1</span>, <span class="dv">7</span>, <span class="fl">0.1</span>),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        np.arange(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    columns <span class="op">=</span> [<span class="st">'b0'</span>, <span class="st">'b1'</span>]</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Example for one guess</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>ols(</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    par <span class="op">=</span> guesses.iloc[<span class="dv">0</span>,:],</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> df_happiness[<span class="st">'life_exp_sc'</span>],</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> df_happiness[<span class="st">'happiness'</span>]</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>23.77700449624871</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Now we’ll calculate the loss for each guess and find which one gives us the smallest function value.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the function value for each guess, mapping over</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># each combination of b0 and b1</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>guesses <span class="ot">=</span> guesses <span class="sc">|&gt;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">objective =</span> <span class="fu">map2_dbl</span>(</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>            guesses<span class="sc">$</span>b0, </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>            guesses<span class="sc">$</span>b1,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>            \(b0, b1) <span class="fu">ols</span>(</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">par =</span> <span class="fu">c</span>(b0, b1), </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">X =</span> df_happiness<span class="sc">$</span>life_exp_sc, </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> df_happiness<span class="sc">$</span>happiness</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>min_loss <span class="ot">=</span> guesses <span class="sc">|&gt;</span> <span class="fu">filter</span>(objective <span class="sc">==</span> <span class="fu">min</span>(objective))</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>min_loss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
     b0    b1 objective
  &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
1   5.4   0.9     0.491</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the function value for each guess, mapping over</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># each combination of b0 and b1</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>guesses[<span class="st">'objective'</span>] <span class="op">=</span> guesses.<span class="bu">apply</span>(</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> x: ols(</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        par <span class="op">=</span> x, </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        X <span class="op">=</span> df_happiness[<span class="st">'life_exp_sc'</span>], </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> df_happiness[<span class="st">'happiness'</span>]</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    axis <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>min_loss <span class="op">=</span> guesses[guesses[<span class="st">'objective'</span>] <span class="op">==</span> guesses[<span class="st">'objective'</span>].<span class="bu">min</span>()]</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>min_loss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       b0    b1  objective
899 5.400 0.900      0.491</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The following plot shows the objective value for each guess in a smooth fashion as if we had a more continuous space. Darker values indicate we’re getting closer to our smallest objective value. The star notes our best guess.</p>
<div id="fig-r-ols-apply" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-r-ols-apply-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/estim-ols_guesses.svg" class="img-fluid figure-img" style="width:75.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-r-ols-apply-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.2: Results of parameter search
</figcaption>
</figure>
</div>
<p>Now let’s run the model using standard functions.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>model_lr_happy_life <span class="ot">=</span> <span class="fu">lm</span>(happiness <span class="sc">~</span> life_exp_sc, <span class="at">data =</span> df_happiness)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># not shown</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">coef</span>(model_lr_happy_life), performance<span class="sc">::</span><span class="fu">performance_mse</span>(model_lr_happy_life))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>model_lr_happy_life <span class="op">=</span> sm.OLS(df_happiness[<span class="st">'happiness'</span>], sm.add_constant(df_happiness[<span class="st">'life_exp_sc'</span>])).fit()</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># not shown</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>model_lr_happy_life.params, model_lr_happy_life.scale</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>If we inspect our results from the standard functions, we had estimates of 5.44 and 0.89 for our coefficients versus the best guess from our approach of 5.4 and 0.9. These are very similar but not exactly the same, but this is mostly due to the granularity of our guesses. Even so, in the end we can see that we get pretty dang close to what our basic <code>lm</code> or <code>statsmodels</code> functions would get us. Pretty neat!</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Estimation as 'Learning'">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Estimation as ‘Learning’
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Estimation and/or optimization can be seen as the process of a model <em>learning</em> which parameters will best allow the predictions to match the observed data, and hopefully, predict as-yet-unseen future data. This is a very common way to think about estimation in machine <em>learning</em>, and it is a useful way to think about our simple linear model also.</p>
<p>One thing to keep in mind is that it is not a magical process. It takes good data, a good idea (model), and an appropriate estimation method to get good results.</p>
</div>
</div>
</div>
</section>
<section id="sec-estim-opt" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="sec-estim-opt"><span class="header-section-number">6.6</span> Optimization</h2>
<p>Before we get into other objective functions, let’s think about a better way to find good parameters for our model. Rather than just guessing, we can use a more systematic approach, and thankfully, there are tools out there to help us. We just use a function like our OLS function, give it a starting point, and let the algorithms do the rest! These tools eventually arrive at a pretty good set of parameters, and are optimized for speed.</p>
<p>Previously we created a set of guesses, and tried each one. This approach is often called a <strong>grid search</strong>, as we search over a grid of possible parameters as in <a href="#fig-r-ols-apply" class="quarto-xref">Figure&nbsp;<span>6.2</span></a>, and it is a bit of a brute force approach to finding the best fitting model. You can maybe imagine a couple of unfortunate scenarios for this approach. One is just having a very large number of parameters to search, a common issue in deep learning. Or it may be that our range of guesses doesn’t allow us to find the right set of parameters. Or perhaps we specify a very large range, but the best fitting model is within a very narrow part of that, so that it takes a long time to find them. In any of these cases we waste a lot of time or may not find an optimal solution.</p>
<p>In general, we can think of <strong>optimization</strong> as employing a smarter, more efficient way to find what you’re looking for. Here’s how it works:</p>
<ul>
<li><strong>Start with an initial guess</strong> for the parameters.</li>
<li><strong>Calculate the objective function</strong> given the parameters.</li>
<li><strong>Update the parameters</strong> to a new guess (that hopefully improves the objective function).</li>
<li><strong>Repeat</strong>, until the improvement is small enough to not be worth continuing, or an arbitrary maximum number of iterations is reached.</li>
</ul>
<p>With optimization, the key aspect is how we <em>update</em> the old parameters with a new guess at each iteration. Different <strong>optimization algorithms</strong> use different approaches to find those new guesses. The process stops when the improvement is smaller than a set <strong>tolerance</strong> level, or the maximum number of iterations is reached. If the objective is met, we say that our model has <strong>converged</strong>. Sometimes, the number of iterations is not enough for us to reach convergence in terms of tolerance, and we have to try again with a different set of parameters, a different algorithm, maybe use some data transformations, or something else.</p>
<p>So, let’s try it out! We start out with several inputs:</p>
<ul>
<li>the objective function</li>
<li>the initial guess for the parameters to get things going</li>
<li>other related inputs to the objective function, such as the data</li>
<li>options for the optimization process, e.g.&nbsp;algorithm, maximum number of iterations, etc.</li>
</ul>
<p>With these inputs, we’ll let the chosen optimization function do the rest of the work. We’ll again compare our results to the standard functions to make sure we’re on the right track.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>We’ll use the <code>optim</code> function in R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>our_ols_optim <span class="ot">=</span> <span class="fu">optim</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">par =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),    <span class="co"># initial guess for the parameters</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">fn  =</span> ols,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">X   =</span> df_happiness<span class="sc">$</span>life_exp_sc,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y   =</span> df_happiness<span class="sc">$</span>happiness,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">method  =</span> <span class="st">'BFGS'</span>, <span class="co"># optimization algorithm</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(   </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">reltol   =</span> <span class="fl">1e-6</span>, <span class="co"># tolerance</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">maxit =</span> <span class="dv">500</span>   <span class="co"># max iterations</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    )  </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>our_ols_optim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>We’ll use the <code>minimize</code> function in Python.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> minimize</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>our_ols_optim <span class="op">=</span> minimize(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    fun  <span class="op">=</span> ols,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    x0   <span class="op">=</span> np.array([<span class="fl">1.</span>, <span class="fl">0.</span>]),  <span class="co"># initial guess for the parameters</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> (</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>        np.array(df_happiness[<span class="st">'life_exp_sc'</span>]), </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>        np.array(df_happiness[<span class="st">'happiness'</span>])</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    method  <span class="op">=</span> <span class="st">'BFGS'</span>,           <span class="co"># optimization algorithm</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    tol     <span class="op">=</span> <span class="fl">1e-6</span>,             <span class="co"># tolerance</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    options <span class="op">=</span> {</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">'maxiter'</span>: <span class="dv">500</span>          <span class="co"># max iterations</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>our_ols_optim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Optimization functions typically return multiple values, including the best parameters found, the value of the objective function at that point, and sometimes other information like the number of iterations it took to reach the returned value and whether or not the process converged. This can be quite a bit of stuff, so we don’t show the raw output, but we definitely encourage you to inspect it closely. The following table shows the estimated parameters and the objective value for our model, and we can compare it to the standard functions to see how we did.</p>
<div class="cell">
<div id="tbl-r-optim-ols" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-r-optim-ols-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6.3: Comparison of Our Results to a Standard Function
</figcaption>
<div aria-describedby="tbl-r-optim-ols-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="rbtyfltsac" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#rbtyfltsac table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rbtyfltsac thead, #rbtyfltsac tbody, #rbtyfltsac tfoot, #rbtyfltsac tr, #rbtyfltsac td, #rbtyfltsac th {
  border-style: none;
}

#rbtyfltsac p {
  margin: 0;
  padding: 0;
}

#rbtyfltsac .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rbtyfltsac .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rbtyfltsac .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rbtyfltsac .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rbtyfltsac .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rbtyfltsac .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rbtyfltsac .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rbtyfltsac .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rbtyfltsac .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rbtyfltsac .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rbtyfltsac .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rbtyfltsac .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rbtyfltsac .gt_spanner_row {
  border-bottom-style: hidden;
}

#rbtyfltsac .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rbtyfltsac .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rbtyfltsac .gt_from_md > :first-child {
  margin-top: 0;
}

#rbtyfltsac .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rbtyfltsac .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rbtyfltsac .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rbtyfltsac .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rbtyfltsac .gt_row_group_first td {
  border-top-width: 2px;
}

#rbtyfltsac .gt_row_group_first th {
  border-top-width: 2px;
}

#rbtyfltsac .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rbtyfltsac .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rbtyfltsac .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rbtyfltsac .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rbtyfltsac .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rbtyfltsac .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rbtyfltsac .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rbtyfltsac .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rbtyfltsac .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#rbtyfltsac .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rbtyfltsac .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rbtyfltsac .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rbtyfltsac .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rbtyfltsac .gt_left {
  text-align: left;
}

#rbtyfltsac .gt_center {
  text-align: center;
}

#rbtyfltsac .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rbtyfltsac .gt_font_normal {
  font-weight: normal;
}

#rbtyfltsac .gt_font_bold {
  font-weight: bold;
}

#rbtyfltsac .gt_font_italic {
  font-style: italic;
}

#rbtyfltsac .gt_super {
  font-size: 65%;
}

#rbtyfltsac .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rbtyfltsac .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rbtyfltsac .gt_indent_1 {
  text-indent: 5px;
}

#rbtyfltsac .gt_indent_2 {
  text-indent: 10px;
}

#rbtyfltsac .gt_indent_3 {
  text-indent: 15px;
}

#rbtyfltsac .gt_indent_4 {
  text-indent: 20px;
}

#rbtyfltsac .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Parameter">Parameter</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Standard">Standard</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Our Result">Our Result</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Intercept</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.4450</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.4450</td></tr>
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Life Exp. Coef.</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.8880</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.8880</td></tr>
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Objective/MSE</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.4890</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.4890</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>So, our little function and the right tool allows us to come up with the same thing as base R and <code>statsmodels</code>! I hope you’re feeling pretty good at this point because you should! You just proved you could do what seemed before to be like magic, but really all it took is just a little knowledge about some key concepts to demystify the process. So, let’s keep going!</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="A Note on Terminology">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
A Note on Terminology
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The objective function is often called the <strong>loss function</strong>, and sometimes the <strong>cost function</strong>. However, these both imply that we are trying to minimize the function, which is not always the case<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>, and it’s arbitrary whether you want to minimize or maximize the function.</p>
<p>The term <strong>metric</strong>, such as the MSE or AUC we’ve seen elsewhere, is a value that you might also want to use to evaluate the model. Some metrics are also used as an objective function. For instance, we might minimize MSE as our objective, but also calculate other metrics like Adjusted R-squared or Mean Absolute Error to evaluate the model. It’s fine to use MSE as the sole objective/metric as well.</p>
<p>This can be very confusing when starting out! We’ll try to stick to the term <em>metric</em> for additional values that we might want to examine, apart from the <em>objective function value</em>, which is specifically used for estimating model parameters.</p>
</div>
</div>
</div>
</section>
<section id="sec-estim-maxlike" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="sec-estim-maxlike"><span class="header-section-number">6.7</span> Maximum Likelihood</h2>
<p>In our example, we’ve been minimizing the mean of the squared errors to find the best parameters for our model. But let’s think about this differently. Now we’d like you to think about the <strong>data generating process</strong>. Ignoring the model, imagine that each happiness value is generated by some random process, like drawing from a normal distribution. So, something like this would describe it mathematically:</p>
<p><span class="math display">\[
\text{happiness} \sim N(\text{mean}, \text{sd})
\]</span></p>
<p>where the <code>mean</code> is just the mean of happiness, and <code>sd</code> is its standard deviation. In other words, we can think of happiness as a random variable that is drawn from a normal distribution with mean and standard deviation as the parameters of that distribution.</p>
<p>Let’s apply this idea to our linear model setting. In this case, the mean is a function of life expectancy, and we’re not sure what the standard deviation is, but we can go ahead and write our model as follows.</p>
<p><span class="math display">\[
\text{mean} = \beta_0 + \beta_1 * \text{life\_exp}
\]</span> <span class="math display">\[
\text{happiness} \sim N(\text{mean}, \text{sd})
\]</span></p>
<p>Now, our model is estimating the parameters of the normal distribution. We have an extra parameter to estimate - the standard deviation, which is similar to our RMSE.</p>
<p>In our analysis, instead of merely comparing the predicted happiness score to the actual score by looking at their difference, we do something a little different to get a sense of their correspondence. We consider how <em>likely</em> it is to observe the actual happiness score based on our prediction. The value known as the <strong>likelihood</strong>, depends on our model’s parameters. The likelihood is determined by the statistical distribution we’ve selected for our analysis. We can write this as:</p>
<p><span class="math display">\[
\text{Pr}(\text{happiness} \mid \text{life\_exp}, \beta_0, \beta_1, \text{sd})
\]</span></p>
<p><span class="math display">\[
\text{Pr}(\text{happiness} \mid \text{mean}, \text{sd})
\]</span></p>
<p>Thinking more generally, the likelihood gives us the probability of the observed data given the parameter estimates.</p>
<p><span class="math display">\[
\text{Pr}(\text{Data} \mid \text{Parameters})
\]</span></p>
<p>The following shows how to calculate a likelihood for our model. The values you see are called <strong>probability density</strong> values. They’re not exactly probabilities, but they show the <strong>relative likelihood</strong> of each observation<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>. You can think of them like you do for probabilities, but remember that likelihoods are slightly different.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># two example life expectancy scores, at the mean (0) and 1 sd above</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>life_expectancy <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># observed happiness scores</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>happiness <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">5.2</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># predicted happiness with rounded coefs</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">=</span> <span class="dv">5</span> <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> life_expectancy</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co"># just a guess for sigma</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> .<span class="dv">5</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood for each observation</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>L <span class="ot">=</span> <span class="fu">dnorm</span>(happiness, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>L</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1080 0.2218</code></pre>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># two example life expectancy scores, at the mean (0) and 1 sd above</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>life_expectancy <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># observed happiness scores</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>happiness <span class="op">=</span> np.array([<span class="dv">4</span>, <span class="fl">5.2</span>])</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co"># predicted happiness with rounded coefs</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>mu <span class="op">=</span> <span class="dv">5</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">*</span> life_expectancy</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co"># just a guess for sigma</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> <span class="fl">.5</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood for each observation</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> norm.pdf(happiness, loc <span class="op">=</span> mu, scale <span class="op">=</span> sigma)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>L</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array([0.1080, 0.2218])</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>With a guess for the parameters and an assumption about the data’s distribution, we can calculate the likelihood of each data point, which is what our final result <code>L</code> shows. We eventually get a total likelihood for all observations, similar to how we added squared errors previously. But unlike errors, we want <em>more</em> likelihood, not less. In theory, we’d multiply each likelihood, but in practice we sum the <em>log of the likelihood</em>, otherwise values would get too small for our computers to handle. We can also turn our problem into a minimization problem by calculating the negative log-likelihood, and then minimizing that value, which many optimization algorithms are designed to do<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>.</p>
<p>The following is a function we can use to calculate the likelihood of the data given our parameters. This value, just like MSE, can also be used to compare models with different parameter guesses<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>. For the estimate of sigma, note that we are estimating its log value by exponentiating the parameter guess. This will keep it positive, as the standard deviation must be positive. We’ll hold off with our result until the table shown next.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>max_likelihood <span class="ot">=</span> <span class="cf">function</span>(par, X, y) {</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># setup</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span>, X)     <span class="co"># add a column of 1s for the intercept</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    beta <span class="ot">=</span> par[<span class="sc">-</span><span class="dv">1</span>]      <span class="co"># coefficients</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    sigma <span class="ot">=</span> <span class="fu">exp</span>(par[<span class="dv">1</span>]) <span class="co"># error sd, exp keeps positive</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">=</span> <span class="fu">nrow</span>(X)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    LP <span class="ot">=</span> X <span class="sc">%*%</span> beta     <span class="co"># linear predictor</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">=</span> LP             <span class="co"># identity link in the glm sense</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate (log) likelihood</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    ll <span class="ot">=</span> <span class="fu">dnorm</span>(y, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma, <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    value <span class="ot">=</span> <span class="sc">-</span><span class="fu">sum</span>(ll)    <span class="co"># negative for minimization</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(value)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>our_max_like <span class="ot">=</span> <span class="fu">optim</span>(</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">par =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>),   <span class="co"># first param is sigma</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">fn  =</span> max_likelihood,</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">X   =</span> df_happiness<span class="sc">$</span>life_exp_sc,</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">y   =</span> df_happiness<span class="sc">$</span>happiness</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>our_max_like</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="co"># logLik(model_lr_happy_life) # one way to extract the log likelihood from a model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> max_likelihood(par, X, y):</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># setup</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.c_[np.ones(X.shape[<span class="dv">0</span>]), X]  <span class="co"># add a column of 1s for the intercept</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    beta <span class="op">=</span> par[<span class="dv">1</span>:]           <span class="co"># coefficients</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    sigma <span class="op">=</span> np.exp(par[<span class="dv">0</span>])   <span class="co"># error sd, exp keeps positive</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> X.shape[<span class="dv">0</span>]</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    LP <span class="op">=</span> X <span class="op">@</span> beta            <span class="co"># linear predictor</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> LP                  <span class="co"># identity link in the glm sense</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate (log) likelihood</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    ll <span class="op">=</span> norm.logpdf(y, loc <span class="op">=</span> mu, scale <span class="op">=</span> sigma)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    value <span class="op">=</span> <span class="op">-</span>np.<span class="bu">sum</span>(ll)      <span class="co"># negative for minimization</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> value</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>our_max_like <span class="op">=</span> minimize(</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    fun  <span class="op">=</span> max_likelihood,</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    x0   <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>]), <span class="co"># first param is sigma</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> (</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>        np.array(df_happiness[<span class="st">'life_exp_sc'</span>]), </span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>        np.array(df_happiness[<span class="st">'happiness'</span>])</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>our_max_like</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model_lr_happy_life.llf # one way to extract the log likelihood from a model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>We can compare our result to a built-in function that has capabilities beyond OLS, and the table shows we’re duplicating the basic result. We show more decimal places on the log likelihood estimate to prove we aren’t getting <em>exactly</em> the same result.</p>
<div class="cell">
<div id="tbl-r-likelihood" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-r-likelihood-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6.4: Comparison of Our Results to a Standard Function
</figcaption>
<div aria-describedby="tbl-r-likelihood-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="icacxhhysk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#icacxhhysk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#icacxhhysk thead, #icacxhhysk tbody, #icacxhhysk tfoot, #icacxhhysk tr, #icacxhhysk td, #icacxhhysk th {
  border-style: none;
}

#icacxhhysk p {
  margin: 0;
  padding: 0;
}

#icacxhhysk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#icacxhhysk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#icacxhhysk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#icacxhhysk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#icacxhhysk .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#icacxhhysk .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#icacxhhysk .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#icacxhhysk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#icacxhhysk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#icacxhhysk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#icacxhhysk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#icacxhhysk .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#icacxhhysk .gt_spanner_row {
  border-bottom-style: hidden;
}

#icacxhhysk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#icacxhhysk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#icacxhhysk .gt_from_md > :first-child {
  margin-top: 0;
}

#icacxhhysk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#icacxhhysk .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#icacxhhysk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#icacxhhysk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#icacxhhysk .gt_row_group_first td {
  border-top-width: 2px;
}

#icacxhhysk .gt_row_group_first th {
  border-top-width: 2px;
}

#icacxhhysk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#icacxhhysk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#icacxhhysk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#icacxhhysk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#icacxhhysk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#icacxhhysk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#icacxhhysk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#icacxhhysk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#icacxhhysk .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#icacxhhysk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#icacxhhysk .gt_footnote {
  margin: 0px;
  font-size: 10px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#icacxhhysk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#icacxhhysk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#icacxhhysk .gt_left {
  text-align: left;
}

#icacxhhysk .gt_center {
  text-align: center;
}

#icacxhhysk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#icacxhhysk .gt_font_normal {
  font-weight: normal;
}

#icacxhhysk .gt_font_bold {
  font-weight: bold;
}

#icacxhhysk .gt_font_italic {
  font-style: italic;
}

#icacxhhysk .gt_super {
  font-size: 65%;
}

#icacxhhysk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#icacxhhysk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#icacxhhysk .gt_indent_1 {
  text-indent: 5px;
}

#icacxhhysk .gt_indent_2 {
  text-indent: 10px;
}

#icacxhhysk .gt_indent_3 {
  text-indent: 15px;
}

#icacxhhysk .gt_indent_4 {
  text-indent: 20px;
}

#icacxhhysk .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Parameter">Parameter</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Standard">Standard</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Our Result">Our Result</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Intercept</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.445</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.445</td></tr>
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Life Exp. Coef.</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.888</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.888</td></tr>
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Sigma<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.705</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.699</td></tr>
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">LogLik (neg)</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">118.804</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">118.804</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> Parameter estimate is exponentiated for the by-hand approach</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>To use a maximum likelihood approach for linear models, you can use functions like <code>glm</code> in R or <code>GLM</code> in Python, which is the reference used in the table above. We can also use different likelihoods corresponding to the binomial, poisson and other distributions. Still other packages would allow even more distributions for consideration. In general, we choose a distribution that we feel best reflects the data generating process. For binary targets for example, we typically would feel a bernoulli or binomial distribution is appropriate. For count data, we might choose a poisson or negative binomial distribution. For targets that fall between 0 and 1, we might go for a beta distribution. You can see some of these demonstrated in <a href="generalized_linear_models.html" class="quarto-xref"><span>Chapter 7</span></a>.</p>
<p>There are many distributions to choose from, and the best one depends on your data. Sometimes, even if one distribution seems like a better fit, we might choose another one because it’s easier to use. Some distributions are special cases of others, or they might become more like a normal distribution under certain conditions. For example, the exponential distribution is a special case of the gamma distribution, and a t distribution with many degrees of freedom looks like a normal distribution. Here is a visualization of the relationships among some of the more common distributions (<span class="citation" data-cites="wikipedia_relationships_2023">Wikipedia (<a href="references.html#ref-wikipedia_relationships_2023" role="doc-biblioref">2023</a>)</span>).</p>
<!--  -->
<!-- \blandscape -->
<div id="fig-distribution-relationships" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-distribution-relationships-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/distribution_relationships.jpg" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-distribution-relationships-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.3: Relationships Among Some Probability Distributions
</figcaption>
</figure>
</div>
<!-- \elandscape -->
<!--  -->
<p>When you realize that many distributions are closely related, it’s easier to understand why we might choose one over another, but also why we might use a simpler option even if it’s not the best fit - you likely won’t come to a different conclusion about your model. Ultimately, you’ll get a better feel for this as you work with different types of data and models.</p>
<p>Here are examples of standard GLM functions, which just require an extra argument for the family of the distribution.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(happiness <span class="sc">~</span> life_exp_sc, <span class="at">data =</span> df_happiness, <span class="at">family =</span> gaussian)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(binary_target <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> some_data, <span class="at">family =</span> binomial)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(count <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> some_data, <span class="at">family =</span> poisson)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>smf.glm(</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'happiness ~ life_exp_sc'</span>, </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> df_happiness, </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    family <span class="op">=</span> sm.families.Gaussian()</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>smf.glm(</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'binary_target ~ x1 + x2'</span>, </span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> some_data, </span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    family <span class="op">=</span> sm.families.Binomial()</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>smf.glm(</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'count ~ x1 + x2'</span>, </span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> some_data, </span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    family <span class="op">=</span> sm.families.Poisson()</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<section id="sec-estim-likelihood-deeper" class="level3" data-number="6.7.1">
<h3 data-number="6.7.1" class="anchored" data-anchor-id="sec-estim-likelihood-deeper"><span class="header-section-number">6.7.1</span> Diving deeper</h3>
<p>Let’s think more about what’s going on here, as it applies to estimation and optimization in general. It turns out that our objective function defines a ‘space’ or ‘surface’. You can imagine the process as searching for the lowest point on a landscape, with each guess a point on this landscape. Let’s start to get a sense of this with the following visualization, based on a single parameter. The following visualization shows this for a single parameter. The data comes from a variable with a true average of 5. As our guesses get closer to 5, the likelihood increases. However, with more and more data, the final guess converges on the true value. Model estimation finds that maximum on the curve, and optimization algorithms are the means to find it.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-r-likelihood-plot" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-r-likelihood-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estimation_files/figure-html/fig-r-likelihood-plot-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-r-likelihood-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.4: Likelihood Function for One Parameter
</figcaption>
</figure>
</div>
</div>
</div>
<p>Now let’s add a parameter. If we have more than one parameter, we now have an objective surface to deal with. Given a starting point, an optimization procedure then travels along the surface looking for a minimum/maximum point. For simpler settings such as this, we can visualize the likelihood surface and its minimum point. However, even our simple model has three parameters plus the likelihood, so it would be difficult to visualize without additional complexity. Instead, we show the results for an alternate model where happiness is standardized also, which means the intercept is zero<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>, and so not shown.</p>
<div class="cell">
<div id="fig-r-likelihood-plot-3d" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-r-likelihood-plot-3d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="plotly html-widget html-fill-item" id="htmlwidget-2a358d522d1f42144f36" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-2a358d522d1f42144f36">{"x":{"visdat":{"7b1362a56c15":["function () ","plotlyVisDat"]},"cur_data":"7b1362a56c15","attrs":{"7b1362a56c15":{"z":{},"x":{},"y":{},"showscale":false,"colors":["#FDF4D9","#FCF4D8","#FBF2D7","#FBF1D6","#FAF0D5","#FBF0D4","#FAEFD3","#FAEED2","#F9EDD0","#F9EDCF","#F8ECCE","#F8EBCD","#F7EACC","#F7E9CB","#F6E8CA","#F6E8C9","#F5E7C8","#F6E6C6","#F5E5C5","#F5E5C4","#F4E4C3","#F4E3C2","#F3E2C1","#F3E1C0","#F2E0BF","#F2E0BE","#F1DFBD","#F2DEBB","#F1DDBA","#F1DDB9","#F0DCB8","#F0DBB7","#EFDAB6","#EFDAB5","#EED9B4","#EFD8B3","#EED7B2","#EED6B1","#EDD5B0","#EDD5AF","#ECD4AE","#EDD3AD","#ECD2AC","#ECD2AB","#EBD1AA","#EBD0A9","#EBCFA7","#EACEA6","#EACDA5","#E9CCA4","#EACCA3","#E9CBA2","#E9CAA1","#E8C9A0","#E9C99F","#E8C89E","#E8C79D","#E7C69C","#E8C69C","#E7C59B","#E7C49A","#E6C399","#E6C398","#E7C297","#E7C197","#E6C096","#E6C095","#E5BF94","#E5BE93","#E6BD92","#E5BD92","#E6BC91","#E6BC90","#E5BB8F","#E5BA8F","#E4B98E","#E4B98E","#E5B88D","#E5B88C","#E4B78B","#E4B68B","#E5B58A","#E5B58A","#E5B489","#E5B488","#E5B387","#E5B287","#E5B186","#E5B186","#E4B085","#E5B085","#E5AF84","#E4AE83","#E4AD82","#E5AC81","#E5AC81","#E6AB80","#E6AB80","#E5AA7F","#E5AA7F","#E6A97E","#E5A87E","#E6A77D","#E6A77D","#E5A67C","#E5A67C","#E6A57B","#E6A57B","#E7A47A","#E7A37A","#E6A279","#E7A279","#E6A178","#E6A178","#E7A077","#E7A077","#E89F76","#E89E77","#E79D76","#E89D76","#E79C75","#E79C75","#E89B74","#E89B74","#E99A73","#E99973","#E89872","#E89872","#E99771","#E99771","#E89670","#E89570","#E9946F","#E9946F","#EA936E","#EA926E","#E9916D","#EA906D","#EA906D","#EA8F6C","#E98E6C","#EA8D6B","#EA8D6B","#E98C6A","#E98B6A","#EA8A69","#EA8A69","#E98968","#E98868","#E88767","#E88768","#E98667","#E88567","#E98466","#E98466","#E88365","#E88265","#E78164","#E88165","#E78064","#E77F64","#E67E63","#E77E63","#E67D62","#E67C63","#E57B62","#E57B62","#E47A61","#E47A61","#E37960","#E37861","#E27760","#E27760","#E1765F","#E1765F","#E07560","#E07460","#DF735F","#DF735F","#DE725E","#DE725E","#DD715F","#DC705F","#DB705F","#DA6F5E","#DA6F5E","#D96E5D","#D86E5D","#D76D5E","#D76D5E","#D66C5D","#D56C5D","#D46B5E","#D46B5E","#D36A5D","#D26A5D","#D1695E","#D06A5E","#CF695D","#CF695D","#CE685E","#CD685E","#CC675F","#CB685F","#CA675E","#CA675E","#C9665F","#C8675F","#C7665E","#C6665E","#C5655F","#C5655F","#C46660","#C36660","#C2655F","#C1655F","#C06460","#BF6460","#BE6561","#BE6561","#BD6460","#BC6460","#BB6361","#BA6361","#B86462","#B86362","#B76461","#B66362","#B66362","#B46263","#B36262","#B26363","#B26363","#B16264","#B06264","#AF6363","#AE6363","#AD6264","#AD6264","#AC6365","#AB6365","#AA6264","#AA6264","#A96165","#A86165","#A76266","#A66265","#A56166","#A56166","#A46267","#A36267","#A26166","#A26166","#A16267","#A06267","#9F6168","#9F6167","#9E6268","#9D6268","#9C6169","#9B6169","#9A6068","#9A6068","#996169","#986169","#97606A","#976069","#96616A","#96606A","#95606B","#94606B","#93606A","#93606A","#91606B","#90606C","#90616C","#8F606B","#8E606B","#8D616C","#8D616C","#8C606D","#8C606C","#8B5F6D","#8A5F6D","#89606E","#89606E","#885F6D","#875F6D","#86606E","#865F6E","#855F6F","#855F6F","#845F6E","#835F6E","#825F6F","#825F6F","#815F70","#815F70","#805F6F","#805F6F","#7F6070","#7E6070","#7D5F71","#7D5F71","#7C6070","#7C6070","#7B5F71","#7A5F71","#795E72","#795E72","#785F71","#785F71","#775E72","#775F72","#765F73","#765F73","#755F72","#745F72","#735F73","#725F74","#725F74","#715F73","#715F74","#705F73","#705F73","#6F5F74","#6E5E74","#6D5F75","#6D5F75","#6C5E74","#6C5E74","#6B5F75","#6B5F75","#6A5E76","#6A5E76","#695D75","#695D75","#685E76","#685E76","#675D77","#665D77","#655E76","#655E77","#645E76","#645E76","#635D77","#635D77","#625E78","#625E78","#615D77","#615D78","#605E77","#605E77","#5F5D78","#5E5D78","#5D5C79","#5D5C79","#5C5D78","#5C5D79","#5B5C78","#5B5D78","#5A5C79","#5A5C79","#595D7A","#575C79","#575C79","#565B7A","#565B7A","#555C79","#545B79","#535C79","#535C79","#525B7A","#525B7A","#515A79","#505A79","#4F5B7A","#4F5B7A","#4E5A7B","#4D5A7B","#4C597A","#4C5A7A","#4B5979","#4A5979","#49587A","#48597A","#475879","#47587A","#465779","#455879","#44577A","#43577A","#425679","#415679","#405578","#3F5679","#3E5578","#3E5578","#3D5477","#3C5478","#3B5377","#3A5377","#395276","#385277","#375176","#365176","#355075","#345075","#324F74","#304E73","#2F4E73","#2E4D72","#2D4D72","#2C4C71","#2B4C71","#2A4B70","#294B70","#284A6F","#27496F","#26486E","#25486D","#24476C","#24476C","#23466B","#22466B","#21456A","#204469","#1F4368","#1E4368","#1D4267","#1D4266","#1C4165","#1B4064","#1A3F63","#193F63","#183E62","#183E61","#173D60","#163C5F","#153B5E","#153B5E","#143A5D","#14395C","#13385B","#13385A","#123759","#113758","#103657","#103557","#0F3456","#0F3455","#0E3354","#0E3353","#0D3152","#0C3050","#0D304F","#0C2F4E","#0C2E4D","#0B2D4C","#0B2D4B","#0A2C4A","#0A2C4A","#092B49","#0A2A48","#092947","#092946","#082845","#092844","#082743","#082642","#072541","#082540","#07243F","#07243E","#06233D","#06223C","#07213B","#07213A","#062039","#062038","#051F37","#051F37","#061E36","#061D35","#051C34","#051C33","#041B32","#041B31","#051A30","#041A2F","#05192E","#05182D","#04172C","#04172B","#03162A","#031629","#041528","#041428","#031327","#021326"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface"},"7b1362a56c15.1":{"z":104.93242508858232,"x":0.61751761812201755,"y":0.78437129136747719,"showscale":false,"colors":["#FDF4D9","#FCF4D8","#FBF2D7","#FBF1D6","#FAF0D5","#FBF0D4","#FAEFD3","#FAEED2","#F9EDD0","#F9EDCF","#F8ECCE","#F8EBCD","#F7EACC","#F7E9CB","#F6E8CA","#F6E8C9","#F5E7C8","#F6E6C6","#F5E5C5","#F5E5C4","#F4E4C3","#F4E3C2","#F3E2C1","#F3E1C0","#F2E0BF","#F2E0BE","#F1DFBD","#F2DEBB","#F1DDBA","#F1DDB9","#F0DCB8","#F0DBB7","#EFDAB6","#EFDAB5","#EED9B4","#EFD8B3","#EED7B2","#EED6B1","#EDD5B0","#EDD5AF","#ECD4AE","#EDD3AD","#ECD2AC","#ECD2AB","#EBD1AA","#EBD0A9","#EBCFA7","#EACEA6","#EACDA5","#E9CCA4","#EACCA3","#E9CBA2","#E9CAA1","#E8C9A0","#E9C99F","#E8C89E","#E8C79D","#E7C69C","#E8C69C","#E7C59B","#E7C49A","#E6C399","#E6C398","#E7C297","#E7C197","#E6C096","#E6C095","#E5BF94","#E5BE93","#E6BD92","#E5BD92","#E6BC91","#E6BC90","#E5BB8F","#E5BA8F","#E4B98E","#E4B98E","#E5B88D","#E5B88C","#E4B78B","#E4B68B","#E5B58A","#E5B58A","#E5B489","#E5B488","#E5B387","#E5B287","#E5B186","#E5B186","#E4B085","#E5B085","#E5AF84","#E4AE83","#E4AD82","#E5AC81","#E5AC81","#E6AB80","#E6AB80","#E5AA7F","#E5AA7F","#E6A97E","#E5A87E","#E6A77D","#E6A77D","#E5A67C","#E5A67C","#E6A57B","#E6A57B","#E7A47A","#E7A37A","#E6A279","#E7A279","#E6A178","#E6A178","#E7A077","#E7A077","#E89F76","#E89E77","#E79D76","#E89D76","#E79C75","#E79C75","#E89B74","#E89B74","#E99A73","#E99973","#E89872","#E89872","#E99771","#E99771","#E89670","#E89570","#E9946F","#E9946F","#EA936E","#EA926E","#E9916D","#EA906D","#EA906D","#EA8F6C","#E98E6C","#EA8D6B","#EA8D6B","#E98C6A","#E98B6A","#EA8A69","#EA8A69","#E98968","#E98868","#E88767","#E88768","#E98667","#E88567","#E98466","#E98466","#E88365","#E88265","#E78164","#E88165","#E78064","#E77F64","#E67E63","#E77E63","#E67D62","#E67C63","#E57B62","#E57B62","#E47A61","#E47A61","#E37960","#E37861","#E27760","#E27760","#E1765F","#E1765F","#E07560","#E07460","#DF735F","#DF735F","#DE725E","#DE725E","#DD715F","#DC705F","#DB705F","#DA6F5E","#DA6F5E","#D96E5D","#D86E5D","#D76D5E","#D76D5E","#D66C5D","#D56C5D","#D46B5E","#D46B5E","#D36A5D","#D26A5D","#D1695E","#D06A5E","#CF695D","#CF695D","#CE685E","#CD685E","#CC675F","#CB685F","#CA675E","#CA675E","#C9665F","#C8675F","#C7665E","#C6665E","#C5655F","#C5655F","#C46660","#C36660","#C2655F","#C1655F","#C06460","#BF6460","#BE6561","#BE6561","#BD6460","#BC6460","#BB6361","#BA6361","#B86462","#B86362","#B76461","#B66362","#B66362","#B46263","#B36262","#B26363","#B26363","#B16264","#B06264","#AF6363","#AE6363","#AD6264","#AD6264","#AC6365","#AB6365","#AA6264","#AA6264","#A96165","#A86165","#A76266","#A66265","#A56166","#A56166","#A46267","#A36267","#A26166","#A26166","#A16267","#A06267","#9F6168","#9F6167","#9E6268","#9D6268","#9C6169","#9B6169","#9A6068","#9A6068","#996169","#986169","#97606A","#976069","#96616A","#96606A","#95606B","#94606B","#93606A","#93606A","#91606B","#90606C","#90616C","#8F606B","#8E606B","#8D616C","#8D616C","#8C606D","#8C606C","#8B5F6D","#8A5F6D","#89606E","#89606E","#885F6D","#875F6D","#86606E","#865F6E","#855F6F","#855F6F","#845F6E","#835F6E","#825F6F","#825F6F","#815F70","#815F70","#805F6F","#805F6F","#7F6070","#7E6070","#7D5F71","#7D5F71","#7C6070","#7C6070","#7B5F71","#7A5F71","#795E72","#795E72","#785F71","#785F71","#775E72","#775F72","#765F73","#765F73","#755F72","#745F72","#735F73","#725F74","#725F74","#715F73","#715F74","#705F73","#705F73","#6F5F74","#6E5E74","#6D5F75","#6D5F75","#6C5E74","#6C5E74","#6B5F75","#6B5F75","#6A5E76","#6A5E76","#695D75","#695D75","#685E76","#685E76","#675D77","#665D77","#655E76","#655E77","#645E76","#645E76","#635D77","#635D77","#625E78","#625E78","#615D77","#615D78","#605E77","#605E77","#5F5D78","#5E5D78","#5D5C79","#5D5C79","#5C5D78","#5C5D79","#5B5C78","#5B5D78","#5A5C79","#5A5C79","#595D7A","#575C79","#575C79","#565B7A","#565B7A","#555C79","#545B79","#535C79","#535C79","#525B7A","#525B7A","#515A79","#505A79","#4F5B7A","#4F5B7A","#4E5A7B","#4D5A7B","#4C597A","#4C5A7A","#4B5979","#4A5979","#49587A","#48597A","#475879","#47587A","#465779","#455879","#44577A","#43577A","#425679","#415679","#405578","#3F5679","#3E5578","#3E5578","#3D5477","#3C5478","#3B5377","#3A5377","#395276","#385277","#375176","#365176","#355075","#345075","#324F74","#304E73","#2F4E73","#2E4D72","#2D4D72","#2C4C71","#2B4C71","#2A4B70","#294B70","#284A6F","#27496F","#26486E","#25486D","#24476C","#24476C","#23466B","#22466B","#21456A","#204469","#1F4368","#1E4368","#1D4267","#1D4266","#1C4165","#1B4064","#1A3F63","#193F63","#183E62","#183E61","#173D60","#163C5F","#153B5E","#153B5E","#143A5D","#14395C","#13385B","#13385A","#123759","#113758","#103657","#103557","#0F3456","#0F3455","#0E3354","#0E3353","#0D3152","#0C3050","#0D304F","#0C2F4E","#0C2E4D","#0B2D4C","#0B2D4B","#0A2C4A","#0A2C4A","#092B49","#0A2A48","#092947","#092946","#082845","#092844","#082743","#082642","#072541","#082540","#07243F","#07243E","#06233D","#06223C","#07213B","#07213A","#062039","#062038","#051F37","#051F37","#061E36","#061D35","#051C34","#051C33","#041B32","#041B31","#051A30","#041A2F","#05192E","#05182D","#04172C","#04172B","#03162A","#031629","#041528","#041428","#031327","#021326"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","showlegend":false,"inherit":true},"7b1362a56c15.2":{"z":{},"x":{},"y":{},"showscale":false,"colors":["#FDF4D9","#FCF4D8","#FBF2D7","#FBF1D6","#FAF0D5","#FBF0D4","#FAEFD3","#FAEED2","#F9EDD0","#F9EDCF","#F8ECCE","#F8EBCD","#F7EACC","#F7E9CB","#F6E8CA","#F6E8C9","#F5E7C8","#F6E6C6","#F5E5C5","#F5E5C4","#F4E4C3","#F4E3C2","#F3E2C1","#F3E1C0","#F2E0BF","#F2E0BE","#F1DFBD","#F2DEBB","#F1DDBA","#F1DDB9","#F0DCB8","#F0DBB7","#EFDAB6","#EFDAB5","#EED9B4","#EFD8B3","#EED7B2","#EED6B1","#EDD5B0","#EDD5AF","#ECD4AE","#EDD3AD","#ECD2AC","#ECD2AB","#EBD1AA","#EBD0A9","#EBCFA7","#EACEA6","#EACDA5","#E9CCA4","#EACCA3","#E9CBA2","#E9CAA1","#E8C9A0","#E9C99F","#E8C89E","#E8C79D","#E7C69C","#E8C69C","#E7C59B","#E7C49A","#E6C399","#E6C398","#E7C297","#E7C197","#E6C096","#E6C095","#E5BF94","#E5BE93","#E6BD92","#E5BD92","#E6BC91","#E6BC90","#E5BB8F","#E5BA8F","#E4B98E","#E4B98E","#E5B88D","#E5B88C","#E4B78B","#E4B68B","#E5B58A","#E5B58A","#E5B489","#E5B488","#E5B387","#E5B287","#E5B186","#E5B186","#E4B085","#E5B085","#E5AF84","#E4AE83","#E4AD82","#E5AC81","#E5AC81","#E6AB80","#E6AB80","#E5AA7F","#E5AA7F","#E6A97E","#E5A87E","#E6A77D","#E6A77D","#E5A67C","#E5A67C","#E6A57B","#E6A57B","#E7A47A","#E7A37A","#E6A279","#E7A279","#E6A178","#E6A178","#E7A077","#E7A077","#E89F76","#E89E77","#E79D76","#E89D76","#E79C75","#E79C75","#E89B74","#E89B74","#E99A73","#E99973","#E89872","#E89872","#E99771","#E99771","#E89670","#E89570","#E9946F","#E9946F","#EA936E","#EA926E","#E9916D","#EA906D","#EA906D","#EA8F6C","#E98E6C","#EA8D6B","#EA8D6B","#E98C6A","#E98B6A","#EA8A69","#EA8A69","#E98968","#E98868","#E88767","#E88768","#E98667","#E88567","#E98466","#E98466","#E88365","#E88265","#E78164","#E88165","#E78064","#E77F64","#E67E63","#E77E63","#E67D62","#E67C63","#E57B62","#E57B62","#E47A61","#E47A61","#E37960","#E37861","#E27760","#E27760","#E1765F","#E1765F","#E07560","#E07460","#DF735F","#DF735F","#DE725E","#DE725E","#DD715F","#DC705F","#DB705F","#DA6F5E","#DA6F5E","#D96E5D","#D86E5D","#D76D5E","#D76D5E","#D66C5D","#D56C5D","#D46B5E","#D46B5E","#D36A5D","#D26A5D","#D1695E","#D06A5E","#CF695D","#CF695D","#CE685E","#CD685E","#CC675F","#CB685F","#CA675E","#CA675E","#C9665F","#C8675F","#C7665E","#C6665E","#C5655F","#C5655F","#C46660","#C36660","#C2655F","#C1655F","#C06460","#BF6460","#BE6561","#BE6561","#BD6460","#BC6460","#BB6361","#BA6361","#B86462","#B86362","#B76461","#B66362","#B66362","#B46263","#B36262","#B26363","#B26363","#B16264","#B06264","#AF6363","#AE6363","#AD6264","#AD6264","#AC6365","#AB6365","#AA6264","#AA6264","#A96165","#A86165","#A76266","#A66265","#A56166","#A56166","#A46267","#A36267","#A26166","#A26166","#A16267","#A06267","#9F6168","#9F6167","#9E6268","#9D6268","#9C6169","#9B6169","#9A6068","#9A6068","#996169","#986169","#97606A","#976069","#96616A","#96606A","#95606B","#94606B","#93606A","#93606A","#91606B","#90606C","#90616C","#8F606B","#8E606B","#8D616C","#8D616C","#8C606D","#8C606C","#8B5F6D","#8A5F6D","#89606E","#89606E","#885F6D","#875F6D","#86606E","#865F6E","#855F6F","#855F6F","#845F6E","#835F6E","#825F6F","#825F6F","#815F70","#815F70","#805F6F","#805F6F","#7F6070","#7E6070","#7D5F71","#7D5F71","#7C6070","#7C6070","#7B5F71","#7A5F71","#795E72","#795E72","#785F71","#785F71","#775E72","#775F72","#765F73","#765F73","#755F72","#745F72","#735F73","#725F74","#725F74","#715F73","#715F74","#705F73","#705F73","#6F5F74","#6E5E74","#6D5F75","#6D5F75","#6C5E74","#6C5E74","#6B5F75","#6B5F75","#6A5E76","#6A5E76","#695D75","#695D75","#685E76","#685E76","#675D77","#665D77","#655E76","#655E77","#645E76","#645E76","#635D77","#635D77","#625E78","#625E78","#615D77","#615D78","#605E77","#605E77","#5F5D78","#5E5D78","#5D5C79","#5D5C79","#5C5D78","#5C5D79","#5B5C78","#5B5D78","#5A5C79","#5A5C79","#595D7A","#575C79","#575C79","#565B7A","#565B7A","#555C79","#545B79","#535C79","#535C79","#525B7A","#525B7A","#515A79","#505A79","#4F5B7A","#4F5B7A","#4E5A7B","#4D5A7B","#4C597A","#4C5A7A","#4B5979","#4A5979","#49587A","#48597A","#475879","#47587A","#465779","#455879","#44577A","#43577A","#425679","#415679","#405578","#3F5679","#3E5578","#3E5578","#3D5477","#3C5478","#3B5377","#3A5377","#395276","#385277","#375176","#365176","#355075","#345075","#324F74","#304E73","#2F4E73","#2E4D72","#2D4D72","#2C4C71","#2B4C71","#2A4B70","#294B70","#284A6F","#27496F","#26486E","#25486D","#24476C","#24476C","#23466B","#22466B","#21456A","#204469","#1F4368","#1E4368","#1D4267","#1D4266","#1C4165","#1B4064","#1A3F63","#193F63","#183E62","#183E61","#173D60","#163C5F","#153B5E","#153B5E","#143A5D","#14395C","#13385B","#13385A","#123759","#113758","#103657","#103557","#0F3456","#0F3455","#0E3354","#0E3353","#0D3152","#0C3050","#0D304F","#0C2F4E","#0C2E4D","#0B2D4C","#0B2D4B","#0A2C4A","#0A2C4A","#092B49","#0A2A48","#092947","#092946","#082845","#092844","#082743","#082642","#072541","#082540","#07243F","#07243E","#06233D","#06223C","#07213B","#07213A","#062039","#062038","#051F37","#051F37","#061E36","#061D35","#051C34","#051C33","#041B32","#041B31","#051A30","#041A2F","#05192E","#05182D","#04172C","#04172B","#03162A","#031629","#041528","#041428","#031327","#021326"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","contours":{"z":{"show":true,"usecolormap":true,"highlightcolor":"#ff0000","start":104.93242508858232,"end":128.76351163328218,"size":1,"project":{"z":true}}},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"zeroline":false,"showgrid":false},"yaxis":{"zeroline":false,"showgrid":false},"plot_bgcolor":"transparent","paper_bgcolor":"transparent","scene":{"xaxis":{"title":"sigma","range":[0.5,1]},"yaxis":{"title":"b1","range":[0.5,1]},"zaxis":{"title":"-LL","angle":-90,"range":[100,135]},"camera":{"eye":{"x":1.25,"y":2,"z":1}},"paper_bgcolor":"rgba(0,0,0,0)","plot_bgcolor":"rgba(0,0,0,0)"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"displayModeBar":false},"data":[{"colorbar":{"title":"llsurf<br />llsurf","ticklen":2},"colorscale":[["0","rgba(253,244,217,1)"],["0.0416666666666664","rgba(244,227,194,1)"],["0.0833333333333334","rgba(236,210,172,1)"],["0.125","rgba(230,195,152,1)"],["0.166666666666667","rgba(229,180,137,1)"],["0.208333333333333","rgba(229,166,124,1)"],["0.25","rgba(233,153,115,1)"],["0.291666666666667","rgba(234,138,105,1)"],["0.333333333333334","rgba(229,123,98,1)"],["0.375","rgba(216,110,93,1)"],["0.416666666666667","rgba(199,102,94,1)"],["0.458333333333333","rgba(181,98,99,1)"],["0.5","rgba(164,98,103,1)"],["0.541666666666667","rgba(148,96,107,1)"],["0.583333333333334","rgba(133,95,111,1)"],["0.625","rgba(119,94,114,1)"],["0.666666666666667","rgba(106,94,118,1)"],["0.708333333333333","rgba(95,93,120,1)"],["0.75","rgba(81,90,121,1)"],["0.791666666666667","rgba(63,86,121,1)"],["0.833333333333333","rgba(41,75,112,1)"],["0.875","rgba(23,61,96,1)"],["0.916666666666667","rgba(12,46,77,1)"],["0.958333333333334","rgba(6,32,57,1)"],["1","rgba(2,19,38,1)"]],"showscale":false,"z":[[128.65821515364468,127.72679805445392,126.84497804526282,126.01060333692098,125.22163028819374,124.47611707543908,123.77221778689805,123.10817690948716,122.48232417868203,121.89306976453183,121.33889976906922,120.81837201240856,120.33011208666105,119.87280965847899,119.44521500256737,119.04613574989712,118.67443383562838,118.32902263291707,118.00886425984304,117.71296704767042,117.44038315954705,117.19020634956641,116.96156985286503,116.75364439812138,116.56563633445059,116.39678586527583,116.24636538229051,116.11367789311763,115.99805553672911,115.8988581811068,115.81547209800777,115.74730871006138,115.69380340574814,115.65441441811625,115.62862176337626,115.61592623576904,115.6158484553491,115.62792796554346,115.65172237755756,115.68680655888733,115.73277186338004,115.78922540044498,115.85578934117561,115.93210025928298,116.01780850487377,116.11257760923209,116.21608371887579,116.32801505726745,116.44807141265998,116.5759636506474,116.71141325008176,116.85415186109486,117.0039208840404,117.1604710682436,117.32356212950913,117.49296238540197,117.6684484073719,117.84980468884797,118.03682332847741,118.22930372773317,118.42705230215695,118.6298822055476,118.83761306644058,119.05007073626636,119.26708704860229,119.4884995889732,119.71415147467714,119.94389114415067,120.17757215540493,120.41505299309726,120.65619688382185,120.9008716192257,121.1489493865792,121.40030660644743,121.65482377712976,121.91238532554881,122.17287946429219,122.43619805451878,122.7022364744623,122.97089349327459,123.24207114996631,123.51567463721307,123.79161218981011,124.06979497756336,124.35013700242399,124.63255499967343,124.91696834298368,125.2032989531812,125.49147121055239,125.78141187053771,126.07304998266713,126.366316812598,126.66114576712161,126.95747232201327,127.25523395260437,127.55437006696162,127.85482194156425,128.15653265937547,128.45944705020682,128.76351163328218],[128.02619686796831,127.1073569326625,126.23774236073054,125.41521586884004,124.6377476208439,123.90340893768816,123.2103664292641,122.55687651629432,121.94128031302449,121.36199884392875,120.81752856985084,120.30643720101071,119.82735977614132,119.37899498868352,118.96010174249109,118.56949592087949,118.20604735412255,117.86867697165705,117.55635412631143,117.26809407884575,117.00295563197744,116.7600389038779,116.53848323187505,116.33746519777786,116.15619676687081,115.99392353320552,115.84992306434411,115.72350333920512,115.61400127310998,115.52078132454464,115.44323417853693,115.38077550190079,115.33284476593026,115.29890413242329,115.27843739919996,115.27094900153458,115.27596306616317,115.293022514748,115.32168821388801,115.36153816895283,115.41216675919736,115.47318401177593,115.5442149124289,115.62489875075711,115.71488849812941,115.81385021639289,115.92146249566942,116.03741591962847,116.16141255672431,116.29316547598006,116.43239828598493,116.57884469585423,116.73224809697345,116.89236116442116,117.05894547702876,117.23177115509694,117.41061651484685,117.59526773873635,117.78551856082292,117.98116996640023,118.18202990518238,118.38791301734783,118.59864037179483,118.81403921599826,119.03394273688887,119.25818983220944,119.48662489183364,119.71909758855789,119.95546267790792,120.19557980652149,120.43931332869725,120.68653213071653,120.93710946257134,121.19092277674515,121.44785357371781,121.70778725387775,121.97061297554396,122.2362235188165,122.5045151549846,122.77538752124089,123.04874350045743,123.32448910579606,123.60253336993543,123.88278823870597,124.16516846893791,124.44959153033517,124.73597751119654,125.02424902781657,125.31433113740428,125.60615125436775,125.89963906981724,126.19472647415166,126.49134748259233,126.78943816354121,127.08893656964341,127.3897826714383,127.69191829349292,127.99528705291176,128.2998343001253,128.60550706186311],[127.40550395725377,126.49901581087114,125.64138796234664,124.83049737423087,124.0643277680856,123.3409633739017,122.65858309884106,122.01545508358573,121.40993161725068,120.84044438423102,120.30550001855769,119.80367594333188,119.33361647463056,118.89402917092892,118.48368141060028,118.10139718142774,117.74605406732375,117.4165804186017,117.11195269319626,116.83119295719155,116.57336653389723,116.33757979152281,116.12297806023972,115.92874367010288,115.75409410192842,115.59828024379905,115.46058474639763,115.34032047085581,115.23682902325487,115.14947937032633,115.07766653128532,115.02081034107752,114.97835428064887,114.94976437014635,114.93452812123547,114.93215354497893,114.94216821195666,114.96411836153038,114.99756805735788,115.04209838645374,115.09730669926707,115.16280588841289,115.2382237038421,115.32320210237813,115.41739662968045,115.52047583281291,115.6321207017139,115.75202413796622,115.87989044936555,116.01543486888026,116.15838309667308,116.30847086394694,116.46544351744126,116.62905562347962,116.79907059053575,116.97526030934242,117.1574048096267,117.34529193260911,117.53871701845154,117.73748260788743,117.94139815731189,118.15027976664803,118.36394991934644,118.58223723391046,118.80497622637232,119.03200708317939,119.26317544397638,119.4983321938012,119.73733326423536,119.98003944307501,120.22631619211539,120.47603347265726,120.72906557837055,120.98529097516614,121.24459214774588,121.50685545251974,121.77197097659166,122.03983240253567,122.31033687869393,122.58338489474461,122.85888016229957,123.13672950030485,123.41684272502484,123.69913254440831,123.98351445663803,124.26990665267935,124.55822992265266,124.84840756585814,125.14036530429755,125.43403119953767,125.72933557277305,126.02621092794904,126.32459187781407,126.62441507277758,126.92561913245271,127.22814457977309,127.53193377757142,127.83693086752247,128.1430817113465,128.45033383418439],[126.79613642150092,125.90177468907972,125.05591485011118,124.25644785309342,123.50137072991851,122.78878038407984,122.11686779562889,121.48391261136128,120.88827809136072,120.32840638543875,119.80281411518982,119.31008823937209,118.84888218212875,118.41791220521505,118.0159540068949,117.64183953154209,117.294453975232,116.97273297375079,116.67565996049737,116.40226368270763,116.15161586530648,115.92282901250097,115.71505433795889,115.52747981509651,115.35932833962332,115.20985599705645,115.0783504284511,114.96412928806964,114.86653878716366,114.78495231845166,114.7187691562529,114.66741322759145,114.630331949904,114.60699513128536,114.59689392948279,114.59953986610196,114.61446389272949,114.64121550589059,114.67936190796715,114.72848721138996,114.78819168358908,114.85809103035612,114.93781571541524,115.02701031414595,115.1253328995267,115.23245445849224,115.34805833700932,115.4718397122806,115.60350509058395,115.74277182934799,115.889367682146,116.04303036537297,116.20350714544378,116.37055444541893,116.5439374700302,116.72342984813842,116.90881329171147,117.09987727046605,117.29641870136302,117.49824165219465,117.70515705854552,117.9169824534483,118.13354170909557,118.35466479000272,118.58018751705268,118.80995134188278,119.04380313110532,119.28159495988075,119.52318391438729,119.76843190275775,120.01720547407638,120.26937564504772,120.52481773397699,120.78341120171038,121.0450394992139,121.3095899214749,121.57695346743535,121.84702470567636,122.11970164558996,122.39488561378521,122.67248113549284,122.9523958207396,123.2345402550785,123.51882789467062,123.8051749655241,124.09350036670607,124.38372557735208,124.67577456730591,124.96957371123182,125.26505170604752,125.56213949153478,125.8607701739902,126.16087895278696,126.46240304972213,126.76528164103244,127.06945579196577,127.37486839379983,127.68146410320777,127.98918928387054,128.2979919502462],[126.19809426070972,125.31563356728832,124.48132302402419,123.69306730542775,122.94887650634287,122.24685996822238,121.58522051962761,120.96224909962098,120.37631973535463,119.82588484755176,119.30947085974712,118.82567408913127,118.37315689863601,117.95064409154205,117.55691953137499,117.19082297122249,116.85124707784723,116.53713463710434,116.24747592821501,115.9813062553941,115.73770362620509,115.51578656681257,115.31471206503257,115.13367363275886,114.97189947995551,114.82865079297777,114.70322011050462,114.59492979084652,114.50313056483658,114.42720016892079,114.36654205343976,114.32058416144274,114.28877777369541,114.27059641584034,114.26553482394178,114.27310796490387,114.29285010848184,114.32431394782861,114.3670697657159,114.42070464376165,114.48482171216348,114.55903943760541,114.64299094714835,114.73632338606056,114.8386973076682,114.94978609343077,115.06927540155569,115.19686264257166,115.3322564803792,115.47517635738333,115.62535204240395,115.78252320013232,115.94643898098107,116.11685763023915,116.29354611551219,116.47627977148495,116.66484196110105,116.85902375230719,117.05862360955753,117.26344709932194,117.47330660888316,117.68802107774852,117.90741574104209,118.13132188427512,118.35957660892983,118.59202260831961,118.82850795322049,119.06888588679634,119.31301462836355,119.56075718556978,119.81198117458003,120.06655864788814,120.32436592939047,120.58528345637801,120.84919562812186,121.11599066074314,121.38556044807481,121.65780042823857,121.93260945567285,122.20988967836308,122.48954642003726,122.77148806710026,123.05562596009619,123.34187428949258,123.63014999559617,123.92037267241514,124.21246447529464,124.50635003215987,124.80195635820735,125.09921277389742,125.39805082610231,125.69840421227518,126.00020870751101,126.30340209437512,126.60792409538253,126.91371630801655,127.2207221421782,127.52888675996763,127.83815701769753,128.14848141004839],[125.6113774748804,124.74059244549693,123.91761248408554,123.14035573123383,122.40684509735858,121.71520212632946,121.06364127083731,120.45046454836488,119.87405654923235,119.33287977057012,118.82547025222978,118.35043349260937,117.90644062415228,117.49222482990993,117.10657798404051,116.74834750046882,116.41643337516936,116.10978540866246,115.82740059634899,115.56832067525087,115.33162981659314,115.11645245445743,114.92195124146085,114.74732512308978,114.59180752292502,114.45466463156296,114.33519379255809,114.23272197918655,114.14660435627349,114.07622292173359,114.02098522284581,113.98032314263124,113.95369175202339,113.94056822381123,113.9404508046126,113.95285784138449,113.97732685921363,114.01341368734444,114.06069163060405,114.11875068356862,114.18719678499025,114.2656511101608,114.35374939904148,114.45114131812198,114.55748985410499,114.67247073762866,114.79577189535281,114.92709292883956,115.06614461875147,115.21264845298626,115.36633617744681,115.52694936822512,115.69423902405313,115.86796517794021,116.04789652698156,116.23381007938198,116.42549081779562,116.62273137813264,116.82533174303504,117.03309894926934,117.24584680832484,117.46339563954881,117.68557201518601,117.91220851672773,118.14314350200402,118.37822088248998,118.61728991032193,118.86020497454807,119.1068254061643,119.35701529151105,119.61064329362658,119.86758248117826,120.12771016461109,120.39090773916888,120.65706053446981,120.92605767032455,121.19779191851032,121.47215957022219,121.74906030894249,122.02839708847817,122.31007601593271,122.59400623938691,122.8800998400781,123.16827172887454,123.45843954685438,123.7505235698066,124.04444661648057,124.34013396041992,124.63751324522399,124.93651440308726,125.23706957647559,125.53911304280392,125.84258114198602,126.14741220673639,126.45354649550301,126.76092612792527,127.06949502270643,127.37919883780201,127.68998491282714,128.00180221359105],[125.0359860640127,124.1766513237055,123.36478323029532,122.59831313051156,121.87527650296578,121.19380685840106,120.5521300492578,119.94855895759289,119.38148853299396,118.84939115449376,118.35081229263764,117.88436644980661,117.44873335867761,117.04265442031858,116.66492936489148,116.3144131192813,115.99001286719864,115.69068528842502,115.41543396489939,115.16330694227807,114.93339443647076,114.72482667543566,114.53677186724366,114.36843428608948,114.21905246853188,114.08789751281205,113.97427147461168,113.87750585308963,113.7969601614745,113.73202057689032,113.68209866447111,113.64663017115706,113.62507388488783,113.6169105551982,113.62164187149523,113.63878949554385,113.66789414492483,113.70851472443822,113.76022750263168,113.82262533081118,113.8953169020694,113.97792604802233,114.07009107109444,114.17146411033015,114.28171053883709,114.40050839108574,114.52754781840092,114.66253057108415,114.80516950570066,114.95518811615672,115.11232008727454,115.27630886965109,115.44690727465991,115.62387708852225,115.80698870443834,115.99602077182955,116.190759861795,116.39100014794221,116.59654310179538,116.80719720203673,117.02277765687062,117.24310613884896,117.46801053152744,117.69732468736046,117.93088819627512,118.16854616439389,118.4101490024096,118.65555222313591,118.90461624778955,119.15720622058156,119.41319183121578,119.67244714491837,119.93485043963882,120.20028405008313,120.46863421825758,120.73979095021902,121.01364787874169,121.29010213162741,121.569054205399,121.8504078441304,122.13406992317923,122.4199503375994,122.70796189502406,122.99802021281634,123.29004361929866,123.58395305888052,123.87967200090966,124.17712635208618,124.47624437228181,124.7769565936171,125.07919574265482,125.38289666557634,125.68799625621229,125.99443338680597,126.30214884139382,126.61108525169207,126.92118703538456,127.23240033671091,127.54467296925954,127.85795436087415],[124.47192002810674,123.62381020191422,122.82283526265351,122.06693950326108,121.35417072316426,120.68267416443703,120.05068685488919,119.45653232730503,118.89861568663932,118.3754189993229,117.88549698097086,117.42747296072282,117.0000351022119,116.60193286276809,116.23197367392794,115.88901982765972,115.57198555393478,115.27983427639226,115.01157603386613,114.76626505647558,114.54299748583777,114.34090922974713,114.15917394238103,113.99700112175766,113.85363431677602,113.72834943672505,113.62045315666515,113.52928141255593,113.45419798043937,113.39459313439066,113.34988237831548,113.31950524702013,113.30292417228871,113.29962341000113,113.30910802458955,113.33090292738203,113.36455196561529,113.40961705910985,113.46567738179873,113.53232858548913,113.60918206340097,113.69586425119005,113.79201596330743,113.89729176268514,114.01135936186441,114.13389905380203,114.26460317069996,114.4031755693055,114.54933114122693,114.70279534689479,114.86330377188719,115.03060170441056,115.20444373280152,115.38459336198507,115.57082264788252,115.76291184882757,115.96064909309935,116.16383006173596,116.37225768583887,116.58574185762423,116.8040991545205,117.02715257564927,117.25473129006639,117.48667039617348,117.72281069174288,117.96299845403118,118.20708522948348,118.45492763255976,118.70638715323926,118.96132997278127,119.21962678734771,119.48115263910817,119.74578675447373,120.01341238912066,120.28391667948537,120.5571905004267,120.83312832876902,121.11162811245401,121.39259114504237,121.67592194531994,121.96152814177682,122.24932036173793,122.53921212493431,122.83111974131783,123.12496221292902,123.42066113963682,123.71814062858201,124.01732720715866,124.31814973938086,124.62053934548688,124.92442932463977,125.22975508059255,125.53645405018958,125.8444656345839,126.15373113305492,126.46419367931684,126.77579818021262,127.08849125669444,127.40222118699482,127.71693785189767],[123.9191793671626,123.08206908012284,122.2917685811602,121.54623484948235,120.84352775795419,120.18180404443768,119.55931168773147,118.97438465750145,118.42543801016849,117.91096330505727,117.42952431722922,116.97975302535806,116.56034585475524,116.17006015725835,115.80771091114978,115.47216762560414,115.16235143537796,114.87723237256398,114.61582680324936,114.37719501784338,114.16043896469424,113.96470011739193,113.78915746687295,113.63302563009462,113.49555306765757,113.37602040330199,113.27373883871866,113.18804865758527,113.11831781316837,113.06394059423477,113.0243363643792,112.99894837022046,112.98724261422595,112.98870678822006,113.0028492638957,113.029198136899,113.06730032128544,113.1167206913593,113.17704126810517,113.24786044760246,113.32879226898477,113.41946571966378,113.51952407568034,113.62862427518698,113.746436323187,113.87264272577767,114.0069379522498,114.14902792350355,114.29862952533009,114.45547014520034,114.6192872312848,114.78982787250321,114.96684839847781,115.15011399832885,115.3393983573142,115.53448331037615,115.73515851170858,115.94122111951403,116.15247549516528,116.3687329160318,116.58981130127447,116.81553494994951,117.04573429080266,117.28024564316651,117.51891098840767,117.76157775140202,118.0080985915436,118.25833120281985,118.51213812251339,118.76938654811039,119.02994816202248,119.29369896374784,119.56051910911565,119.83029275628148,120.10290791815312,120.37825632094741,120.65623326859226,120.93673751270218,121.21967112787253,121.50493939204648,121.7924506717255,122.08211631180228,122.37385052980848,122.66757031437926,122.96319532774542,123.26064781207559,123.55985249949757,123.86073652563722,124.16322934652113,124.46726265869665,124.77277032243062,125.07968828785258,125.38795452391801,125.69750895007014,126.0082933704864,126.32025141079968,126.63332845719054,126.9474715977525,127.26262956603277,127.57875268666164],[123.37776408118013,122.55142795833139,121.77158318581517,121.03619916917542,120.34334760733547,119.69119649840263,119.07800454778459,118.50211594818192,117.96195550358162,117.45602407169697,116.98289430141283,116.54120664371226,116.12966561630751,115.74703630378943,115.39214107655708,115.06385651311467,114.76111051152814,114.48287957694015,114.22818627304889,113.99609682638157,113.78571887304011,113.59619933837017,113.42672244071937,113.27650781110006,113.14480872117637,113.03091041254268,112.93412852077218,112.85380758817774,112.78931965966152,112.74006295642268,112.7054606226622,112.68495954075814,112.67802921069975,112.68416068985492,112.70286558941361,112.73367512409465,112.77613921193486,112.82982562118666,112.89431916155107,112.96922091715109,113.05414751882103,113.1487304534437,113.25261540821326,113.36546164783553,113.48694142280489,113.61673940701249,113.75455216305056,113.90008763367837,114.05306465801029,114.21321251107359,114.38027046546733,114.55398737392925,114.73412127168896,114.9204389975535,115.11271583273331,115.31073515647532,115.51428811762268,115.72317332127625,115.93719652977464,116.15617037725941,116.37991409713239,116.60825326174975,116.84101953373639,117.07805042833979,117.31918908626929,117.56428405650637,117.81318908858985,118.06576293391602,118.32186915561199,118.58137594656864,118.84415595524003,119.11008611883729,119.37904750356475,119.65092515156563,119.92560793426071,120.20298841178135,120.48296269821137,120.76543033237178,121.0502941538895,121.33746018431032,121.62683751302528,121.91833818779264,122.21187710964689,122.50737193200055,122.80474296374791,123.10391307619679,123.40480761365643,123.70735430752195,124.01148319370253,124.31712653324637,124.6242187360273,124.93269628735631,125.24249767739748,125.55356333326485,125.86583555368827,126.17925844614049,126.49377786631838,126.80934135988507,127.12589810637357,127.44339886516603],[122.84767417015942,122.03188683654,121.26227907661868,120.53683246234014,119.85363027130819,119.21085152633228,118.60676543504862,118.03972619934652,117.50816816687846,117.0106012992421,116.54560693352187,116.11183381578543,115.70799438686883,115.33286130236134,114.9852641701499,114.66408649019107,114.36826278238527,114.09677588952086,113.84865444326486,113.62297048209012,113.4188372108754,113.23540689268174,113.07186886392039,112.92744766477426,112.80140127733249,112.69301946444737,112.60162220282567,112.5265582043333,112.4672035199185,112.42296022095428,112.39325515316433,112.37753875863304,112.37528396170988,112.38598511490581,112.40915700114329,112.44433388896917,112.49106863756364,112.54893184859181,112.61751106213646,112.69640999413529,112.78524781290963,112.88365845252973,112.99128996090604,113.1078038806309,113.23287466071807,113.36618909750663,113.50744580310221,113.65635469982999,113.81263653926742,113.97602244451431,114.14625347443479,114.32308020868868,114.50626235243477,114.69556835965902,114.89077507413985,115.09166738712486,115.29803791084166,115.50968666702262,115.72642078966693,115.94805424130706,116.17440754209447,116.40530751104993,116.64058701886766,116.88008475169309,117.12364498532791,117.37111736934416,117.62235672062239,117.87722282584825,118.13558025253495,118.39729816815608,118.66225016700041,118.93031410437668,119.20137193782095,119.47530957497312,119.75201672780837,120.03138677292823,120.31331661762641,120.59770657146281,120.88446022309336,121.17348432211126,121.46468866567608,121.75798598970884,122.05329186444945,122.35052459418158,122.64960512093636,122.95045693200039,123.2530059710585,123.55718055281297,123.86291128092508,124.17013096913614,124.47877456542973,124.7887790791038,125.10008351062814,125.41262878416771,125.72635768266056,126.04121478533924,126.3571464075961,126.67410054309219,126.99202680801719,127.31087638741089],[122.32890963410051,121.52344571474859,120.76385625357052,120.04813472897665,119.37437574987227,118.74076912822625,118.14559434952351,117.58721541099537,117.06407600005913,116.57469498769254,116.11766221355597,115.69163454157771,115.29533216643924,114.92753515297413,114.58708019192811,114.27285755683363,113.98380824794944,113.71892131030607,113.47723131389721,113.25781598496908,113.0597939782002,112.88232278032663,112.72459673647595,112.58584519111702,112.46533073612595,112.36234755901586,112.2762198848792,112.20630050605203,112.15196939393961,112.11263238782963,112.08771995588567,112.07668602384521,112.0790068672566,112.09418006337265,112.12172349908465,112.1611744315224,112.21208859817202,112.27403937357479,112.34661696986122,112.42942767855477,112.52209315125066,112.62424971692184,112.73554773375878,112.85565097357309,112.98423603692656,113.12099179725998,113.26561887240474,113.41782912195823,113.57734516910156,113.74389994552263,113.91723625818715,114.0971063767814,114.28327164071541,114.4755020846454,114.67357608153381,114.87728000232494,115.08640789136547,115.30076115675345,115.52014827484221,115.74438450817479,115.97329163616067,116.20669769785016,116.44443674619629,116.68634861322667,116.93227868558327,117.18207768991549,117.43560148764121,117.69271087861675,117.95327141328245,118.21715321287296,118.48423079730338,118.75438292036577,119.02749241188434,119.30344602650381,119.58213429879584,119.86345140438846,120.14729502683737,120.43356622997551,120.72216933548395,121.01301180544941,121.30600412967809,121.60105971755101,121.89809479421614,122.1970283009225,122.49778179931087,122.80027937948633,123.10444757170377,123.41021526151009,123.71751360818878,124.02627596636579,124.336437810638,124.64793666309515,124.96071202360983,125.274705302779,125.58985975740308,125.90612042839602,126.22343408102374,126.54174914737396,126.86101567096357,127.18118525339615],[121.82147047300325,121.02610459295721,120.27631471667083,119.57010596908491,118.90558404302766,118.28094930408481,117.69449129120937,117.14458358312838,116.62967900312377,116.14830513704835,115.69906014151537,115.28060882108893,114.89167895501852,114.53105785562765,114.1975891418918,113.89016971304217,113.60774690822068,113.34931583929583,113.11391688494589,112.90063333501833,112.70858917501442,112.53694700130481,112.38490605838609,112.25170039012845,112.13659709755667,112.03889469624838,111.95792156693273,111.89303449333384,111.8436172817247,111.8090794570488,111.78885503082626,111.78240133639473,111.78919792733967,111.80874553525544,111.84056508323788,111.88419675175443,111.93919909375968,112.00514819613574,112.08163688472538,112.16827397040983,112.26468353384398,112.3705042466201,112.48538872677159,112.60900292666213,112.74102555143021,112.88114750627271,113.02907137095822,113.18451090006313,113.3471905475128,113.51684501409848,113.69321881672444,113.87606587820741,114.06514913653075,114.26024017251271,114.46111885491538,114.66757300207561,114.87939805919426,115.09639679046838,115.31837898530054,115.54516117786265,115.77656637933089,116.01242382215037,116.25256871572235,116.49684201294041,116.74509018703556,116.99716501822026,117.25292338964618,117.51222709222121,117.77494263785435,118.04094108071891,118.31009784614929,118.58229256680475,118.85740892575481,119.13533450615796,119.41596064722339,119.69918230616159,119.98489792584435,120.27300930790958,120.56342149106133,120.85604263432477,121.15078390503108,121.44755937131906,121.74628589894699,122.04688305222327,122.34927299887158,122.65338041865478,122.95913241559239,123.26645843361349,123.57529017549376,123.88556152493547,124.19720847165217,124.51016903933019,124.82438321634271,125.1397928890986,125.45634177791604,125.77397537531081,126.0926408866013,126.4122871727302,126.7328646952127,127.05432546312181],[121.32535668686775,120.53986347116587,119.79965446591955,119.10274618266486,118.44725515077445,117.83139205390789,117.25345626010609,116.71183071574545,116.20497717607216,115.7314317473095,115.28980071740003,114.87875665431932,114.49703475260687,114.14342941032199,113.81679102004078,113.51602295881673,113.24007876319874,112.98795947649013,112.75871115641101,112.55142253223799,112.36522280131808,112.19927955561636,112.0527968296508,111.92501326180846,111.81520036162479,111.72266087614473,111.64672724898622,111.58676016617881,111.5421471832738,111.51230142861169,111.49666037798605,111.49468469628145,111.5058571419592,111.52968153055426,111.56568175360283,111.61340084966521,111.67240012432687,111.74225831627447,111.82257080672898,111.91294886970023,112.01301896068975,112.12242204162456,112.24081293994423,112.36785973989785,112.50324320422918,112.64665622454457,112.79780329876255,112.95640003414489,113.12217267450079,113.29485765024199,113.47420115004667,113.65995871296681,113.85189483988084,114.0497826232609,114.25340339428421,114.46254638637677,114.6770084143279,114.89659356816745,115.12111292104169,115.35038425037054,115.58423177160515,115.82248588395063,116.06498292744598,116.3115649508342,116.56207948968475,116.81637935425863,117.07432242663742,117.33577146666187,117.60059392625072,117.86866177169422,118.13985131353786,118.41404304369351,118.69112147943235,118.97097501393523,119.25349577309079,119.538579478248,119.82612531464703,120.1160358052651,120.40821668982568,120.70257680873726,120.99902799173528,121.29748495101308,121.59786517864187,121.90008884808383,122.20407871961827,122.50976004950567,122.81706050272423,123.1259100691229,123.43624098283986,123.74798764484514,124.06108654847215,124.37547620780907,124.69109708882657,125.00789154312658,125.32580374419929,125.6447796260837,125.96476682432875,126.28571461916101,126.60757388076475,126.93029701658797],[120.84056827569395,120.06472234937441,119.33387550131673,118.64605536971659,117.99938907311268,117.39209737769549,116.8224892562137,116.28895680884681,115.78997051890434,115.32407481847599,114.88988394121004,114.48607804126854,114.1113995592042,113.76464981705718,113.44468582637548,113.15041729415731,112.88080381288393,112.63485222188886,112.41161412829253,112.21018357662803,112.02969485711125,111.86932044326122,111.72826905026994,111.60578380615726,111.50114052833017,111.41364609870492,111.34263693103971,111.28747752458683,111.24755909858702,111.22229830251825,111.21113599736502,111.21353610350552,111.22898451111529,111.25698804926894,111.29707351017964,111.3487867252548,111.41169168987342,111.48536973399099,111.56941873587212,111.66345237642601,111.76709943178778,111.88000310193509,112.00182037327687,112.13222141328036,112.27088899532338,112.41751795207576,112.5718146558178,112.7334965242034,112.90229155006594,113.07793785395288,113.26018325815372,113.44878488105958,113.64350875076576,113.84412943688997,114.05042969964047,114.26220015522846,114.47923895676648,114.70135148985081,114.92835008206596,115.16005372569839,115.39628781298345,115.63688388325089,115.88167938136692,116.13051742690816,116.38324659353086,116.63972069803037,116.89979859861484,117.16334400193865,117.43022527847154,117.70031528579871,117.97349119946922,118.24963435103211,118.52863007291705,118.81036754983599,119.09473967639812,119.38164292064744,119.67097719324579,119.9626457220422,120.25655493177673,120.55261432868693,120.85073638979038,121.15083645663307,121.45283263330103,121.75664568850425,122.062198961551,122.36941827203893,122.67823183309926,122.98857016803858,123.30036603022712,123.6135543260947,123.92807204109793,124.24385816853169,124.56085364106163,124.87900126486291,125.19824565625296,125.51853318071447,125.83981189420608,126.16203148666632,126.48514322761945,126.80909991379454],[120.36710523948202,119.60068122758302,118.87897782286224,118.20003353024001,117.56198581004227,116.96306527544751,116.40159027953216,115.87596186243218,115.38465903162037,114.92623435054782,114.49930981294528,114.10257298193685,113.73477337481059,113.39471907583317,113.08127356089547,112.79335271906389,112.52992205727601,112.28999407549226,112.07262580059044,111.8769164681883,111.7020053423938,111.54706966423939,111.41132272024379,111.29401202317455,111.19441759767295,111.11185036392902,111.04565061309326,110.99518656855798,110.95985302766417,110.93907007876868,110.93228188896325,110.93895555806682,110.95858003480768,110.99066509139973,111.03474035296814,111.09035437852303,111.15707379039938,111.23448244928549,111.32218067215452,111.4197844905872,111.52692494713823,111.64324742755167,111.76841102676944,111.90208794680981,112.04396292471287,112.19373268886616,112.35110544212384,112.51580037023855,112.68754717420799,112.86608562523156,113.05116514104574,113.24254438248558,113.43999086918544,113.64328061339994,113.85219777098429,114.06653430863062,114.28608968650995,114.51067055551843,114.7400904683732,114.97416960384635,115.21273450346592,115.45561782005113,115.70265807748541,115.95369944116237,116.20859149857375,116.46718904953568,116.7293519055785,116.99494469805148,117.26383669451671,117.53590162303244,117.81101750394336,118.08906648882056,118.36993470620885,118.65351211385999,118.93969235714545,119.22837263336002,119.51945356164043,119.81283905824073,120.1084362169147,120.40615519417383,120.70590909919665,121.00761388817891,121.31118826292422,121.61655357348454,121.92363372466984,122.23235508625453,122.54264640671758,122.85443873036044,123.1676653176556,123.48226156868429,123.79816494952952,124.11531492149803,124.43365287304769,124.7531220543074,125.07366751407696,125.39523603920333,125.71777609623338,126.04123777524633,126.36557273577698,126.69073415474152],[119.90496757823175,119.14774010579168,118.4349614305562,117.76468066423521,117.13504536156327,116.54429574716404,115.99075933006149,115.47284587650181,114.98904271422025,114.53791034352511,114.11807833260576,113.72824147632404,113.36715619942602,113.03363718664994,112.72655422360094,112.44482923353655,112.18743349637522,111.95338503730002,111.74174617330469,111.55162120691901,111.38215425716574,111.23252721855093,111.10195783957208,110.98969791286052,110.89503156965306,110.81727367181703,110.75576829514678,110.7098872980922,110.6790289705055,110.66261675736274,110.66009805278074,110.67094305996537,110.69464371303663,110.73071265694648,110.77868228196844,110.8381038094702,110.90854642590483,110.98959646215775,111.08085661557645,111.18194521218382,111.29249550674106,111.41215501847438,111.54058490042203,111.67745934048595,111.82246499239767,111.97530043491581,112.13567565768091,112.30331157225048,112.47793954692706,112.65930096407772,112.84714679872276,113.04123721724497,113.24134119513981,113.44723615279084,113.65870760831558,113.87554884658333,114.09756060355824,114.32455076517014,114.55633407996336,114.79273188481444,115.03357184305239,115.2786876943514,115.52791901580125,115.78111099359664,116.03811420481355,116.29878440877448,116.56298234752843,116.83057355500041,117.10142817438648,117.3754207833955,117.65243022696032,117.93233945705879,118.21503537930781,118.50040870600733,118.78835381533264,119.07876861638574,119.37155441983101,119.6666158138607,119.96386054523944,120.26319940519785,120.56454611995402,120.86781724565071,121.17293206751157,121.47981250302462,121.78838300897475,122.0985704921526,122.41030422357908,122.72351575608839,123.03813884512529,123.35410937261381,123.67136527376707,123.98984646670816,124.30949478478495,124.63025391146033,124.95206931767125,125.27488820155018,125.59865943041052,125.92333348490078,126.24886240523733,126.5751997394289],[119.4541552919432,118.70589898400026,118.00182632439856,117.33999677170216,116.71856772767563,116.13578879284502,115.58999640780173,115.07960885105567,114.60312156670398,114.15910279740756,113.74618950019149,113.36308352443034,113.00854803305032,112.68140414950761,112.38052781449183,112.10484683757511,111.85333813018129,111.62502510731237,111.41897524643549,111.23429779282,111.07014160142714,110.92569310619579,110.800174408255,110.6928414752151,110.60298244427034,110.52991602236898,110.47298997720033,110.43157971318962,110.40508692711067,110.39293833830068,110.39458448881739,110.40949860920129,110.43717554580189,110.47713074590915,110.52889929718052,110.59203501809606,110.66610959638966,110.75071177260793,110.84544656613784,110.94993454121582,111.06381111059625,111.18672587470338,111.31834199423447,111.45833559430892,111.60639519837774,111.76222119022474,111.92552530248879,112.09603013023913,112.27346866822312,112.4575838704914,112.64812823118456,112.84486338533765,113.0475597286289,113.25599605506252,113.46995921163406,113.68924376908659,113.91365170791147,114.14299211880622,114.37708091683645,114.61574056860249,114.85879983174293,115.10609350615159,115.35746219631463,115.61275208421117,115.87181471225031,116.13450677574667,116.40068992446456,116.67023057278553,116.94299971808056,117.21887276688781,117.49772936852001,117.77945325574696,118.06393209221386,118.35105732627797,118.64072405095988,118.9328308697245,119.22727976781752,119.52397598890229,119.82282791675105,120.12374696175911,120.42664745206245,120.73144652904838,121.03806404706303,121.34642247712453,121.6564468144657,121.96806448973314,122.28120528368386,122.59580124522263,122.91178661263604,123.22909773788342,123.5476730138103,123.86745280416207,124.18837937627335,124.51039683632162,124.83345106703598,125.15748966775507,125.48246189673755,125.8083186156298,126.13501223600041,126.46249666785677],[119.0146683806164,118.27515786220889,117.57957250438936,116.92598185264085,116.31255290837936,115.73754441249059,115.19930151275285,114.69625078609349,114.22689558907159,113.7898117121955,113.38364331570247,113.00709912625567,112.65894887568375,112.33801996440612,112.04319433356821,111.77340553117979,111.52763595869447,111.30491428552924,111.10431301998256,110.9249462258914,110.76596737517801,110.62656732717397,110.50597242629242,110.40344271023841,110.3182702215251,110.24977741558476,110.19731565925377,110.16026381385012,110.13802689747995,110.13003482158223,110.13574119707329,110.15462220577434,110.18617553310375,110.22991935828783,110.28539139860432,110.35214800440072,110.42976330185387,110.51782838063595,110.61595052383863,110.72375247768331,110.84087175870374,110.96695999623834,111.101682308207,111.2447167082786,111.39575354265303,111.55449495479291,111.72065437654756,111.89395604420454,112.07413453809613,112.26093434447262,112.45410943843143,112.65342288676369,112.85864646965283,113.06956032021515,113.28595258094022,113.50761907614027,113.73436299956957,113.96599461642644,114.20233097899262,114.44319565521064,114.68841846953757,114.93783525545186,115.19128761902529,115.44862271300576,115.70969302088388,115.97435615045245,116.24247463638696,116.5139157514068,116.78855132559914,117.06625757350938,117.34691492862247,117.63040788488483,117.91662484492709,118.20545797467187,118.49680306402703,118.79055939337648,119.08662960559991,119.38491958336532,119.68533833144946,119.98779786385751,120.29221309552193,120.59850173837209,120.90658420157861,121.2163834957843,121.52782514114266,121.8408370789961,122.15534958703194,122.47129519776297,122.78860862018801,123.10722666449283,123.42708816965946,123.74813393385983,124.07030664751271,124.39355082889122,124.71781276217112,125.04304043781789,125.36918349521457,125.69619316743341,126.02402222806631,126.35262494002515],[118.58650684425139,117.85551674041744,117.16819997052856,116.52263590705128,115.91700090367451,115.34956260610058,114.81867464491481,114.32277168161554,113.86036478132293,113.43003708788879,113.03043977913876,112.66028828179991,112.31835872732613,112.00348463134529,111.71455378083,111.45050531435044,111.21032698191458,110.99305257195061,110.79775949394605,110.62356650613314,110.46963157841836,110.33514988148552,110.21935189368438,110.12150161793024,110.040894901417,109.97685785146449,109.92874534130729,109.89593960007373,109.87784888161325,109.87390620720758,109.88356817754837,109.90631384968479,109.94164367494199,109.98907849408255,110.04815858623994,110.11844276838414,110.19950754229758,110.29094628624185,110.39236848867887,110.50339902158622,110.62367745106378,110.75285738307947,110.89060584233931,111.03660268239523,111.19054002522368,111.35212172862038,111.52106287985727,111.6970893141466,111.87993715654613,112.06935238602161,112.2650904204631,112.46691572152307,112.67460141821152,112.88792894824874,113.10668771623375,113.3306747677445,113.55969447853259,113.7935582580309,114.03208426643168,114.27509714463889,114.52242775643634,114.77391294225205,115.02939528393358,115.28872287998054,115.55174913071437,115.81833253289172,116.08833648329555,116.36162909086406,116.63808299694227,116.91757520326009,117.19998690726767,117.48520334447261,117.77311363744737,118.06361065118914,118.35659085453412,118.65195418734147,118.94960393317831,119.24944659724977,119.55139178933466,119.85535211149325,120.1612430503325,120.46898287362163,120.77849253105839,121.08969555900389,121.40251798900573,121.71688825994148,122.03273713362313,122.34999761370948,122.66860486778124,122.98849615244228,123.30961074131439,123.63188985580121,123.9552765985033,124.27971588916917,124.6051544030765,124.9315405117388,125.25882422584137,125.58695714031147,125.91589238143509,126.24558455593377],[118.16967068284804,117.44697561862606,116.76770872281618,116.12995893493348,115.53191171356104,114.97184337367516,114.44811580428771,113.95917153762181,113.50352914345819,113.07977892448737,112.6865788905002,112.32265099106328,111.98677758797756,111.67779815032534,111.39460615627731,111.13614618708718,110.9014111998417,110.68943996657651,110.49931466832591,110.33015863354524,110.18113421114811,110.05144076913041,109.9403128104309,109.84701819829081,109.77085648394635,109.71115733000804,109.66727902336079,109.63860707186046,109.62455287951063,109.62455249517676,109.63806543024269,109.66457354093247,109.70357997131666,109.75460815329319,109.81720086008728,109.89091931004626,109.97534231772063,110.0700654894255,110.17470046065853,110.28887417292448,110.41222818767606,110.5444180352267,110.68511259663165,110.83399351665859,110.99075464608958,111.15510151170713,111.32675081241784,111.50542994006551,111.69087652357308,111.88283799513803,112.08107117727974,112.28534188961585,112.49542457430502,112.71110193916299,112.9321646175147,113.15841084389922,113.38964614480044,113.62568304361957,113.86634077915376,114.11144503688709,114.36082769243905,114.61432656655238,114.87178519103927,115.13305258513549,115.39798304174175,115.66643592306445,115.93827546519024,116.21337059115751,116.49159473210968,116.77282565614014,117.05694530445561,117.34383963451022,117.63339846977479,117.92551535582962,118.22008742248106,118.51701525161968,118.81620275055251,119.11755703055573,119.42098829040668,119.72640970466591,120.03373731649418,120.3428899347971,120.6537890355023,120.96635866678342,121.28052535805482,121.59621803256924,121.91336792345761,122.23190849306215,122.5517753554156,122.87290620173172,123.19524072877515,123.5187205699864,123.84328922924493,124.16889201715547,124.49547598975224,124.82298988951769,125.15138408861806,125.48061053426412,125.81062269610652,126.14137551558301],[117.76415989640641,117.04953449683465,116.37809876125222,115.74795093628734,115.15728533803893,114.60438671521418,114.0876249908715,113.60545035411219,113.15638867547725,112.73903722199137,112.35206064978701,111.99418725404561,111.66420545763798,111.36096052134627,111.08335145991001,110.83032814938984,110.6008886124758,110.39407646940695,110.20897854312214,110.0447226081277,109.90047527336732,109.77543999010862,109.66885517653206,109.57999245132,109.50815496911297,109.45267585121555,109.41291670541432,109.3882662292103,109.37813889117199,109.38197368548963,109.39923295515618,109.42940127951744,109.47198442222778,109.52650833591974,109.59251822014643,109.66957762938723,109.75726762812323,109.8551859901871,109.96294643977757,110.08017793169813,110.20652396854067,110.34164195268008,110.48520257108392,110.63688921106872,110.79639740525067,110.96343430405311,111.13771817422931,111.31897792196106,111.50695263917711,111.70139117182194,111.90205170888129,112.10870139104188,112.3211159379331,112.53907929295826,112.7623832847831,112.99082730460444,113.22421799837326,113.4623689731925,113.70510051715877,113.95223933195548,114.2036182775459,114.45907612835255,114.71845734034238,114.98161182847055,115.24839475396598,115.51866632097071,115.79229158207134,116.06914025228708,116.34908653110162,116.6320089321494,116.91779012018641,117.20631675499766,117.4974793419093,117.79117208859341,118.08729276786806,118.38574258621097,118.68642605772264,118.98925088328328,119.29412783466555,119.60097064337587,119.90969589400692,120.22022292189854,120.53247371491025,120.84637281912268,121.16184724829003,121.47882639687938,121.79724195653542,122.11702783582106,122.43812008309123,122.76045681236117,123.08397813204181,123.40862607641539,123.73434453973773,124.06107921285007,124.38877752219842,124.71738857115461,125.04686308354476,125.37715334929136,125.70821317208083,126.03999781897257],[117.36997448492654,116.66319337504329,115.99937008583665,115.37661191111302,114.79312177710821,114.24719263071765,113.73720220466615,113.2616081310868,112.81894337738015,112.40781198040058,112.02688505699903,111.67489707074687,111.35064233630747,111.05297174440803,110.78078969172815,110.53305120125859,110.30875921981688,110.10696208044192,109.92675111833482,109.76725842988051,109.62765476507593,109.50714754442014,109.40497899198765,109.32042437701776,109.25279035691689,109.20141341508685,109.16565838746786,109.14491707212326,109.13860691659737,109.14616977814624,109.16707075228892,109.20079706543964,109.24685702767538,109.30477904196232,109.37411066641734,109.45441772640699,109.54528347350518,109.64630778852654,109.75710642603607,109.87731029790726,110.00656479365772,110.14452913543961,110.29087576569621,110.44528976562562,110.60746830270706,110.7771201056583,110.95396496529162,111.13773325983338,111.32816550335801,111.52501191607352,111.72803201526779,111.93699422580121,112.15167550909602,112.37186100963446,112.597343718039,112.82792414986029,113.06341003925094,113.30361604674954,113.5483634804468,113.79748002984395,114.05079951175682,114.30816162765281,114.56941173184296,114.83440060998581,115.10298426738713,115.37502372661044,115.65038483393859,115.92893807425273,116.21055839391806,116.49512503128803,116.7825213544599,117.07263470593485,117.36535625385095,117.6605808494807,117.95820689069492,118.25813619111533,118.5602738546887,118.86452815543214,119.17081042211119,119.47903492762308,119.78911878287082,120.1009818349259,120.41454656928239,120.72973801602174,121.04648365971131,121.36471335287206,121.68435923285645,122.00535564198613,122.32763905080789,122.65114798433058,122.97582295111417,123.30160637508811,123.62844252998153,123.95627747625308,124.28505900041493,124.61473655664949,124.94526121062127,125.27658558539319,125.60866380935792,125.94145146610259],[116.98711444840851,116.28795225325193,115.63152269656956,115.01594185941038,114.43942103076895,113.90026112018577,113.39684744567172,112.92764486854556,112.49119324916681,112.08610319971521,111.71105211213631,111.36478044116727,111.0460882239859,110.75383181951057,110.4869208517318,110.24431534269337,110.02502302186497,109.82809679968135,109.65263239396388,109.49776609880371,109.36267268627402,109.24656343206499,109.14868425679791,109.0683139753842,109.00476264735826,108.95737002162215,108.92550406952127,108.90855960059935,108.90595695578675,108.91714077314666,108.94157882164096,108.97876089869929,109.02819778765942,109.08942027142089,109.1619781989,109.24543960110545,109.33938985386654,109.44343088444384,109.55718041943412,109.68027127155179,109.81235066302708,109.95307958350517,110.10213218046842,110.25919518032933,110.42396733845871,110.59615891652275,110.77549118560493,110.96169595368238,111.15451511611596,111.35370022789263,111.55901209643916,111.77022039389396,111.9871032877937,112.20944708919154,112.43704591728226,112.66970137966659,112.90722226743354,113.14942426429093,113.3961296690178,113.64716713055238,113.90237139507185,114.16158306445303,114.42464836554099,114.69141892968116,114.96175158200512,115.23550813998361,115.51255522079212,115.79276405705454,116.07601032055884,116.36217395355574,116.65113900727623,116.94279348732192,117.2370292055997,117.53374163849115,117.83282979096172,118.13419606633295,118.43774614145065,118.74338884700259,119.05103605274377,119.3606025574073,119.67200598308574,119.98516667387925,120.30000759861873,120.61645425748071,120.93443459231855,121.25387890054716,121.57471975242062,121.89689191155728,122.22033225856579,122.54497971763992,122.87077518599241,123.19766146600467,123.5255831999765,123.85448680736434,124.18432042440178,124.5150338460024,124.84657846984776,125.17890724256955,125.5119746079378,125.84573645697309],[116.61557978685219,115.92381113146055,115.27455659345088,114.66594078117957,114.09618309902096,113.56359218361825,113.06656071388812,112.60356056648835,112.17313829083733,111.77391087993536,111.4045618151989,111.0638373653066,110.75054312067331,110.46354074665383,110.20174493992083,109.96412057369412,109.74968001862014,109.55748062712527,109.38662237000935,109.2362456148972,109.10552903696157,108.99368765304318,108.89997097096258,108.82366124641931,108.76407184043684,108.72054567082125,108.69245375157477,108.67919381463848,108.68018900874024,108.69488667049076,108.72275716321215,108.76329277929607,108.81600670217998,108.88043202429549,108.95612081759448,109.04264325348269,109.13958676920728,109.246555277939,109.36316841997146,109.48906085263167,109.62388157664887,109.76729329687689,109.91897181540058,110.07860545517988,110.24589451250569,110.4205507366465,110.60229683516907,110.7908660035082,110.98600147745084,111.1874561072793,111.39499195239549,111.60837989532,111.82739927402621,112.05183753162942,112.28148988251297,112.51615899402339,112.75565468292095,112.99979362581649,113.24839908287179,113.50130063408091,113.75833392749085,114.01934043875332,114.28416724143642,114.55266678755679,114.82469669782007,115.10011956109031,115.37880274263181,115.6606182006925,115.94544231102415,116.23315569895277,116.52364307863526,116.81679309915879,117.11249819715566,117.41065445562501,117.71116146866854,118.01392221186359,118.31884291800866,118.6258329579946,118.93480472656306,119.24567353272882,119.5583574946517,119.87277743875838,120.18885680291916,120.50652154349947,120.82570004611192,121.14632303990453,121.46832351522809,121.79163664453468,122.11619970636488,122.44195201228926,122.7688348366765,123.0967913491649,123.4257665497226,123.75570720618394,124.08656179415897,124.41828043921332,124.7508148612241,125.08411832082037,125.41814556782043,125.75285279158406],[116.25537050025754,115.57077000966915,114.92847177648056,114.32660867642042,113.76340798186435,113.23718582101533,112.74634200931544,112.28935522491541,111.86477850239172,111.47123502106058,111.10741416618669,110.77206784316495,110.46400702636986,110.18209852583799,109.92526195629526,109.69246689426096,109.48273021008218,109.29511356277381,109.12872104647113,108.9826969781611,108.85622381713856,108.74852020735477,108.65883913448195,108.58646619012301,108.53071793615273,108.49094036268434,108.46650743362838,108.45681971424079,108.46130307545769,108.47940747017859,108.51060577700255,108.55439270723024,108.61028377123689,108.67781430058595,108.75653852250066,108.84602868353871,108.94587421952754,109.055680969012,109.17507042764824,109.30367904114696,109.44115753452297,109.58717027555478,109.74139467049264,109.90352059017718,110.07324982484795,110.25029556602954,110.43438191398407,110.62524340931066,110.82262458736274,111.02627955423364,111.23597158313673,111.45147273007943,111.67256346779341,111.89903233694822,112.13067561373109,112.36729699293065,112.60870728571331,112.85472413132625,113.10517172200863,113.35988054042949,113.61868710901402,113.8814337505536,114.14796835952929,114.41814418361244,114.69181961483183,114.96885798993063,115.24912739945775,115.53250050516644,115.81885436531387,116.10807026747911,116.4000335685371,116.69463354144547,116.99176322851868,117.29131930088199,117.59320192381524,117.89731462770732,118.20356418436249,118.51186048840793,118.82211644356924,119.13424785358747,119.44817331756876,119.76381412956349,120.08109418218369,120.39993987407811,120.7202800210914,121.0420457709445,121.36517052127893,121.68958984091829,122.01524139420518,122.34206486827863,122.67000190316639,122.99899602456895,123.32899257921972,123.65993867271192,123.99178310968652,124.32447633628226,124.65797038475039,124.99221882014587,125.32717668900584,125.66280046993538],[115.90648658862466,115.22882888787773,114.59326824565871,113.99794554513306,113.44109567929928,112.92104203237677,112.43619133195362,111.98502884382657,111.5661138838299,111.17807562309132,110.81960916509969,110.48947187474234,110.18647994107529,109.90950515706301,109.65747190085524,109.42935430439377,109.22417359625129,109.04099560662682,108.87892842334934,108.73712018859527,108.6147570268049,108.51106109499962,108.42528874735578,108.35672880649541,108.30470093450599,108.26855409721128,108.24766511568187,108.24143729940624,108.24929915593918,108.27070317221026,108.30512466301215,108.35206068250154,108.41102899483026,108.48156710029245,108.56323131361867,108.65559589127355,108.75825220482719,108.87080795766282,108.99288644246452,109.12412583709781,109.26417853664945,109.41271051953876,109.56940074574469,109.73394058532132,109.90603327548544,110.0853934046719,110.27174642205004,110.46482817108992,110.66438444585162,110.87017056875546,111.08195098866281,111.2994988981721,111.52259586909531,111.75103150514794,111.98460311093673,112.22311537638855,112.46638007581053,112.71421578082028,112.96644758642859,113.22290684959816,113.48343093964122,113.74786299985374,114.01605171981967,114.2878511178484,114.56312033304049,114.84172342650432,115.1235291912699,115.40841097047658,115.69624648342806,115.9869176591346,116.2803104769817,116.57631481418203,116.87482429968885,117.1757361742625,117.47895115640199,117.78437331386415,118.09190994051228,118.40147143824287,118.71297120376229,119.02632551998332,119.34145345183695,119.65827674629455,119.97671973641238,120.29670924921655,120.61817451725695,120.94104709366668,121.26526077057284,121.59075150070808,121.91745732208658,122.24531828560784,122.57427638546214,122.9042754922168,123.235261288468,123.56718120694816,123.89998437098443,124.23362153720922,124.56804504042658,124.90320874054578,125.23906797149411,125.57557949202713],[115.56892805195353,114.89798776608633,114.26894600098528,113.6799513873174,113.12924619132541,112.61516081770272,112.13610868180267,111.6905814232219,111.27714443515204,110.89443268602747,110.54114681193806,110.2160494600387,109.91796186478972,109.64576064032879,109.39837477360071,109.1747828040926,108.9740101771273,108.79512675868438,108.63724450064397,108.49951524619988,108.3811286659608,108.28131031597781,108.19931980958422,108.1344490955364,108.08602083549657,108.05338687440207,108.03592679773537,108.03304657013474,108.04417725018473,108.06877377658562,108.10631382124097,108.15629670511015,108.21824237296006,108.29169042341493,108.37619919094845,108.47134487668708,108.57672072510624,108.69193624389153,108.81661646442016,108.95040124048393,109.09294458302837,109.2439140288289,109.40299004115671,109.56986544061229,109.74424486441821,109.92584425257336,110.11439035936681,110.30962028884584,110.51128105291754,110.71912915084481,110.93293016897393,111.15245839959813,111.37749647793208,111.60783503622859,111.8432723741298,112.08361414439688,112.32867305321265,112.57826857429849,112.83222667613136,113.09037956158681,113.35256541937247,113.61862818665402,113.88841732230746,114.16178759026432,114.43859885244603,114.71871587081145,115.00200811806822,115.28834959662289,115.57761866536666,115.86969787391941,116.16447380396912,116.46183691736834,116.76168141066603,117.06390507576616,117.36840916642853,117.67509827033427,117.98388018645785,118.29466580749924,118.60736900714207,118.92190653191631,119.23819789745617,119.55616528895152,119.87573346560517,120.19682966891487,120.51938353460841,120.8433270080715,121.16859426311002,121.49512162390397,121.82284749000927,122.15171226427712,122.48165828356376,122.81262975210839,123.14457267746734,123.47743480889277,123.81116557805269,124.14571604199412,124.48103882825259,124.81708808202032,125.15381941528526,125.49118985785934],[115.24269489024407,114.57824664429496,113.95550504246012,113.37262620297351,112.82785951794301,112.31954217699327,111.8460940588627,111.40601296310143,110.99787015635783,110.62030620986879,110.27202710670164,109.95180059905405,109.65845279751326,109.39086497563538,109.1479705745316,108.92875239335747,108.73223995271034,108.55750701894645,108.4036692783551,108.26988215097484,108.15533873460612,108.0592678702893,107.98093232116715,107.91962705724596,107.87467763912443,107.84543869425684,107.83129247978883,107.83164752642638,107.84593735819426,107.87361928330475,107.91417325168899,107.96710077505615,108.03192390562639,108.1081842699534,108.19544215448995,108.29327563977948,108.4012797803648,108.51906582769806,108.64626049351531,108.78250525130552,108.92745567365958,109.08078080342506,109.24216255672869,109.41129515604995,109.5878845916462,109.77164810973419,109.96231372593455,110.15961976257849,110.36331440856027,110.57315530050185,110.78890912406989,111.01035123435754,111.23726529430358,111.46944293019008,111.70668340331022,111.94879329695576,112.19558621791968,112.44688251176098,112.70250899111731,112.96229867639558,113.22609054820779,113.49372931095422,113.7650651669927,114.03995360086057,114.3182551730485,114.59983532285212,114.88456417985293,115.17231638360522,115.46297091112972,115.75641091183347,116.05252354949917,116.35119985100461,116.65233456145046,116.95582600539322,117.2615759538951,117.56948949711744,117.87947492219941,118.19144359617719,118.50530985370868,118.82099088938654,119.13840665442653,119.45747975753444,119.77813536976221,120.10030113317293,120.42390707314605,120.7488855141586,121.0751709988905,121.40270021050607,121.73141189797303,122.06124680428636,122.39214759747111,122.72405880424373,123.05692674621793,123.39069947854567,123.72532673089138,124.06075985063704,124.39695174822862,124.73385684456943,125.07143102037898,125.40963156743194],[114.92778710349644,114.26960552250355,113.65294537008351,113.07596999210132,112.53693565915209,112.03418611024831,111.56614746313349,111.13132346346509,110.72829104744763,110.35569619461552,110.01225004939049,109.69672529178845,109.40795273924576,109.14481816298284,108.90625930364787,108.69126307218831,108.4988629230005,108.32813638741295,108.17820275648249,108.04822090292008,107.93738723274089,107.84493375793419,107.77012628210461,107.71226269162426,107.67067134538955,107.64470955677544,107.63376216184243,107.63724016828115,107.65457947996785,107.68523969236763,107.72870295435634,107.78447289233931,107.85207359282911,107.93104863990789,108.02096020424331,108.12138818055057,108.23192937060271,108.35219670908256,108.48181852974984,108.62043786956251,108.7677118085432,108.9233108433275,109.08691829246064,109.25822973163451,109.43695245716957,109.62280497615417,109.81551652175312,110.01482659228803,110.22048451278016,110.43224901772632,110.64988785395076,110.87317740245027,111.10190231820982,111.33585518703242,111.5748361984782,111.81865283406516,112.06711956993156,112.32005759320761,112.57729453138606,112.83866419402446,113.10400632614716,113.37316637275444,113.6459952538754,113.9223491496369,114.20208929484777,114.48508178262634,114.77119737662375,115.06031133142372,115.35230322071727,115.64705677287675,115.94445971357207,116.24440361509065,116.54678375204199,116.85149896314357,117.1584515188016,117.46754699421362,117.77869414773689,118.09180480427655,118.40679374346212,118.72357859239386,119.04207972274786,119.36222015204325,119.68392544888327,120.0071236419909,120.33174513286973,120.65772261192814,120.98499097791418,121.31348726051432,121.64315054597805,121.97392190563551,122.30574432718434,122.63856264862287,122.97232349471943,123.30697521590697,123.6424678295003,123.97875296313808,124.31578380035448,124.65351502819308,124.99190278677567,125.33090462074505],[114.6242046917105,113.97206440071217,113.36126698385542,112.78998275470096,112.2564746149524,111.75909261746774,111.29626889461524,110.86651292431291,110.46840710842109,110.10060264026767,109.7618156400046,109.45082353824183,109.16646168998727,108.90762020237108,108.67324096094964,108.46231484058529,108.27387908799754,108.10701486408398,107.96084493502624,107.83453150203576,107.72727416036501,107.63830797891245,107.56690169239671,107.51235599867113,107.47400195429216,107.45119946195788,107.44333584389584,107.44982449569903,107.47010361550547,107.50363500377424,107.54990292924278,107.60841305695976,107.67869143456826,107.76028353327827,107.8527533402083,107.95568249900042,108.06866949582002,108.19132888804477,108.3232905731238,108.46419909525491,108.61371298767921,108.77150414853594,108.93725724835245,109.11066916736586,109.29144846098811,109.47931485183354,109.67399874682259,109.87524077797418,110.08279136557694,110.2964103025184,110.51586635861666,110.74093690387626,110.97140754965082,111.20707180675571,111.44773075963359,111.69319275572505,111.94327310924842,112.19779381863853,112.45658329693794,112.71947611447337,112.98631275319063,113.25693937205467,113.53120758295557,113.80897423659331,114.09010121784395,114.37445525013395,114.66190770838075,114.95233444007833,115.24561559412918,115.5416354570494,115.84028229618775,116.14144820962649,116.4450289824406,116.75092394901719,117.05903586114799,117.369270761623,117.68153786307037,117.99574943179739,118.31182067640248,118.62966964093845,118.94921710242038,119.27038647247802,119.59310370296851,119.91729719536869,120.24289771377944,120.56983830138007,120.89805420018116,121.2274827739288,121.55806343402412,121.8897375683247,122.22244847270341,122.55614128524573,122.89076292297213,123.22626202097662,123.56258887387968,123.89969537949703,124.23753498463029,124.57606263289128,124.91523471447502,125.25500901779866],[114.33194765488628,113.68562327892079,113.08046988377561,112.5146644907723,111.98647638534412,111.49426169865178,111.03645835330788,110.61158134564486,110.21821833927851,109.85502554682502,109.5207238785439,109.21409533841421,108.93397964973775,108.67927109380014,108.44891554643679,108.24190769854809,108.05728844770157,107.8941424489596,107.7515958139864,107.62881394832166,107.52499951747861,107.43939053322396,107.37125855204333,107.31990697838665,107.28466946583198,107.26490840980435,107.26001352594936,107.26940050868001,107.29250976480715,107.32880521752459,107.37777317634848,107.43892126891753,107.51177743084392,107.59588895006465,107.69082156238512,107.79615859512911,107.91150015601681,108.03646236458489,108.17067662363719,108.31378892838271,108.46545921106748,108.62536071905055,108.79317942440426,108.96861346324388,109.15137260310193,109.34117773677205,109.53776040114302,109.74086231963697,109.95023496695067,110.16563915487806,110.3868446380674,110.61362973863569,110.84578098862657,111.08309278935982,111.32536708677644,111.57241306193545,111.82404683587013,112.08009118805363,112.34037528777259,112.60473443774228,112.87300982933822,113.14504830885491,113.42070215423308,113.69982886172998,113.98229094203708,114.2679557253751,114.55669517512412,114.84838570956903,115.14290803136564,115.44014696435107,115.73999129734619,116.04233363461223,116.34707025264632,116.65410096301423,116.96332898093431,117.27466079934547,117.5880060681997,117.90327747873974,118.22039065252953,118.53926403502027,118.85981879344396,119.18197871883874,119.50567013201781,119.83082179330634,120.15736481587525,120.48523258251444,120.8143606656913,121.14468675074936,121.4761505621114,121.80869379235388,122.14226003402824,122.4767947141124,122.81224503097597,123.14855989375455,123.48568986402933,123.82358709971399,124.16220530105588,124.50149965866406,124.84142680347716,125.18194475859258],[114.05101599302384,113.41028215712939,112.81055406984423,112.25001520031533,111.72694097032731,111.23969335380029,110.78671583921135,110.36652872746103,109.97772474001972,109.61896491428786,109.28897476500852,108.98654069230562,108.71050661849728,108.45977083727009,108.23328306010946,108.03004164607709,107.84909100211257,107.68951914203973,107.55045539336301,107.43106824177805,107.33056330408174,107.24818142086876,107.18319686104452,107.13491563077088,107.10267388000904,107.08583640031458,107.08379520800293,107.09596820722406,107.12179792787273,107.16075033361871,107.21231369567339,107.27599752821257,107.35133158165598,107.43786489026706,107.53516487077377,107.6428164689365,107.76042135119305,107.88759713870286,108.02397668129002,108.16920736894599,108.32295047870822,108.48488055487128,108.65468482061604,108.83206261926881,109.01672488351113,109.20839363096988,109.40680148471431,109.61169121727663,109.82281531690153,110.03993557480538,110.26282269230312,110.49125590672841,110.72502263513709,110.96391813484492,111.20774517990667,111.4563137526964,111.70944074979667,111.96694970145296,112.22867050389038,112.4944391638313,112.76409755458985,113.03749318315516,113.31447896770807,113.59491302504682,113.87865846742712,114.16558320834973,114.4555597768536,114.74846513989586,115.04418053242647,115.34259129478215,115.64358671704744,115.94705989004773,116.25290756265923,116.56103000513441,116.87133087816063,117.18371710738113,117.49809876312499,117.81438894510356,118.13250367184348,118.4523617746392,118.77388479581865,119.09699689112527,119.42162473603133,119.74769743580383,120.07514643915707,120.4039054553313,120.73391037444482,121.06509919097617,121.39741193023991,121.73079057772294,122.06517901115899,122.40052293522277,122.73676981873081,123.07386883424077,123.41177079994939,123.75042812378895,124.08979474963148,124.42982610551138,124.77047905378217,125.11171184312695],[113.7814097061231,113.146041035338,112.55151954206126,111.99603488333013,111.4778683699018,110.99538758291331,110.54704135232576,110.13135506976131,109.74692631064474,109.39242074265603,109.06656829939838,108.76815959991605,108.49604259626584,108.24911943278069,108.02634350196757,107.82671668317202,107.64928675123065,107.49314494332432,107.35742367315595,107.24129438240473,107.14396552017423,107.064680641847,107.00271661940016,106.95738195582365,106.92801519682354,106.91398343348874,106.91468089005645,106.92952759133128,106.95796810470243,106.99947035205655,107.05352448721759,107.11964183484488,107.1973538870045,107.28621135388539,107.38578326537414,107.49565612042271,107.61543308134866,107.74473321039869,107.88319074608229,108.03045441694456,108.18618679060131,108.35006365599807,108.52177343698776,108.7010166354405,108.88750530221547,109.08096253442694,109.28112199753643,109.48772747089301,109.70053241542922,109.91929956230008,110.14380052132367,110.37381540815446,110.60913248918233,110.84954784321081,111.09486503902434,111.3448948280078,111.59945485102814,111.85836935883654,112.12146894529107,112.38859029274042,112.65957592894549,112.93427399495545,113.21253802338063,113.49422672654374,113.77920379401392,114.06733769905789,114.35850151356938,114.65257273105874,114.94943309731171,115.24896844834247,115.55106855529137,115.85562697593308,116.16254091247919,116.47171107537798,116.78304155282684,117.09643968572985,117.41181594784609,117.72908383088885,118.04815973434422,118.3689628597953,118.69141510954434,119.01544098933788,119.34096751500898,119.66792412286111,119.99624258362502,120.3258569198306,120.65670332644147,120.98872009460914,121.32184753840971,121.65602792443208,121.99120540409548,122.327325948577,122.66433728623679,123.0021888424354,123.34083168163981,123.68021845172194,124.02030333035691,124.36104197343322,124.70239146538995,125.04431027140176],[113.52312879418415,112.89289991354663,112.30336630042672,111.75272353981673,111.2392585840678,110.76134438599072,110.31743489265101,109.90606037254574,109.52582305115365,109.17539303192949,108.85350448171357,108.55895206124551,108.2905875830433,108.04731688033219,107.8280968720111,107.63193280983303,107.45787569505569,107.30501985281354,107.17250065336535,107.05949237020181,106.96520616575621,106.88888819615856,106.82981782711049,106.78730595354516,106.7606934162753,106.74934950932679,106.75267057210993,106.77007866100163,106.8010202952962,106.84496527283821,106.9014055509809,106.96985418881442,107.04984434688949,107.14092834091971,107.24267674618628,107.35467754958769,107.47653534648367,107.60787057967244,107.74831881801404,107.89753007237859,108.05516814674671,108.220910022431,108.39444527351944,108.575475511759,108.76371385921514,108.9588844471433,109.16072193960952,109.36897108048608,109.58338626253399,109.80373111736246,110.02977812512917,110.26130824291377,110.49811055076235,110.73998191445759,110.98672666412952,111.23815628786976,111.49408913956451,111.75435016020423,112.01877061197474,112.28718782446948,112.55944495240524,112.83539074425563,113.11487932125048,113.39776996622093,113.68392692179759,113.9732191974995,114.26552038527132,114.56070848305787,114.8586657260215,115.15927842503199,115.46243681207811,115.76803489226818,116.07597030210624,116.38614417374485,116.69846100493298,117.01282853439169,117.32915762236328,117.64736213609572,117.96735884003179,118.2890672904886,118.61240973462112,118.93731101347632,119.26369846895075,119.59150185447821,119.92065324927898,120.25108697601219,120.5827395216813,120.91554946164834,121.24945738662056,121.58440583248114,121.92033921283782,122.25720375417495,122.59494743349386,122.93351991833833,123.27287250910061,123.61295808351289,123.9537310432323,124.29514726242965,124.63716403830048,124.97974004341705],[113.27617325720691,112.6508587917552,112.06609434494062,111.52008116977497,111.01111161282499,110.53756376303281,110.09789646018719,109.69064463581431,109.31441496154633,108.96788178210835,108.64978331195395,108.35891807629392,108.09414157882993,107.8543631799245,107.63854317024011,107.44569002605999,107.27485783358769,107.1251438705072,106.99568633399113,106.88566220516921,106.79428524082756,106.72080408380346,106.66450048417531,106.62468762393524,106.60070853836451,106.59193462782878,106.59776425416342,106.61762141623512,106.65095449965392,106.69723509596358,106.7559568869635,106.82663459012137,106.90880296131091,107.00201585137005,107.10584531321024,107.21988075643146,107.3437281465981,107.47700924652396,107.61936089708513,107.77043433524813,107.92989454714451,108.09741965417015,108.27270033021105,108.45543924822432,108.64535055451009,108.84215936911893,109.04560131093348,109.25542204605586,109.47137685821573,109.69323023999243,109.9207555037196,110.15373441100657,110.39195681987711,110.63522034858525,110.88333005522202,111.13609813228221,111.39334361540575,111.65489210555626,111.92057550394145,112.19023175901863,112.46370462496907,112.74084343105585,113.0215028613179,113.30554274407815,113.59282785077825,113.88322770367463,114.1766163919595,114.47287239589302,114.7718784185557,115.07352122485082,115.37769148740762,115.68428363905316,115.99319573154052,116.30432930023514,116.61758923447921,116.9328836533667,117.25012378667628,117.56922386072401,117.89010098890623,118.21267506671903,118.53686867104905,118.86260696354067,119.18981759785666,119.51843063065529,119.84837843611902,120.17959562387631,120.51201896016453,120.8455872920936,121.18024147487264,121.5159243018702,121.85258043738615,122.19015635201661,122.52860026050213,122.86786206194958,123.20789328233171,123.54864701916198,123.89007788825761,124.23214197250063,124.57479677251385,124.91800115917268],[113.04054309519138,112.41991766996377,111.83970367560293,111.298107773205,110.79342745617369,110.32404571403926,109.8884260549342,109.48510785956711,109.11270204182283,108.76988699319261,108.45540479011963,108.16805764506141,107.90670458362554,107.67025833155773,107.45768239665458,107.26798833185305,107.10023316682678,106.95351699640541,106.82698071503323,106.71980388730694,106.63120274538846,106.56042830478161,106.50676459059468,106.46952696699394,106.44806056309082,106.44173878899458,106.44996193621699,106.47215585703158,106.50777071777568,106.55627982143275,106.61717849516528,106.68998303876545,106.7742297302688,106.86947388523626,106.97528896644587,107.09126574095392,107.21701148169196,107.3521492109533,107.4963169832957,107.64916720555303,107.81036599179473,107.97959255121535,108.1565386070626,108.34090784483638,108.53241538810029,108.73078730035374,108.93576011150829,109.14708036760241,109.36450420247439,109.58779693018994,109.81673265709497,110.05109391243253,110.29067129652663,110.53526314559382,110.7846752123021,111.03872036124524,111.29721827855185,111.55999519489248,111.82688362119109,112.09772209638791,112.37235494663697,112.65063205535618,112.93240864358265,113.2175450601156,113.50590658095575,113.79736321758327,114.0917895336339,114.38906446956437,114.68907117491435,114.99169684779892,115.29683258127989,115.604373216288,115.91421720078181,116.22626645484864,116.5404262414653,116.85660504265473,117.17471444078524,117.49466900477377,117.8163861809675,118.1397861884867,118.46479191882803,118.791328839531,119.11932490172664,119.44871045139196,119.77941814414513,120.11138286342276,120.44454164189091,120.77883358594514,121.11419980316589,121.45058333259911,121.78792907774012,122.12618374210219,122.46529576726142,122.8052152732692,123.14589400133322,123.48728525866896,123.82934386543278,124.1720261036461,124.51528966802996,124.85909361866891],[112.81623830813763,112.20007654817248,111.62419429241362,111.08680335010682,110.58620611411375,110.12079023901022,109.68902367689211,109.28945004380407,108.92068429198328,108.58140866518215,108.27036891621053,107.98637076754784,107.72827659743008,107.49500233523159,107.28551455125447,107.09882772721217,106.93400169477272,106.79013923050813,106.66638379649183,106.56191741661509,106.4759586794387,106.40776085909317,106.35661014636864,106.3218239827213,106.30274949045463,106.29876199282438,106.30926361827048,106.3336819833913,106.37146894966151,106.42209944924551,106.4850703755863,106.55989953474692,106.64612465376312,106.74330244251857,106.85100770589337,106.9688325031552,107.09638535176535,107.2332904729606,107.37918707664566,107.53372868329329,107.69658248069723,107.86742871356667,108.0459601040741,108.23188130159524,108.42490835998571,108.62476824084796,108.831198341334,109.04394604512568,109.26276829531007,109.48743118795495,109.71770958525518,109.95338674719197,110.19425398071097,110.44011030548334,110.69076213536955,110.94602297475873,111.20571312900292,111.46965942821288,111.73769496372371,112.00965883657729,112.28539591740893,112.56475661715636,112.84759666804487,113.13377691433311,113.42316311233013,113.71562573922536,114.01103981029459,114.30928470407176,114.61024399509746,114.91380529387622,115.21986009369495,115.52830362397262,115.83903470983026,116.15195563758543,116.46697202589129,116.78399270225593,117.10292958469005,117.42369756824506,117.74621441621547,118.0704006557915,118.39617947795807,118.72347664144725,119.05222038056083,119.38234131668865,119.71377237335729,120.04644869465167,120.38030756686051,120.71528834320276,121.05133237150027,121.38838292466814,121.72638513389995,122.06528592443136,122.40503395377182,122.7455795522972,123.08687466610505,123.42887280203402,123.7715289747579,124.11479965586618,124.45864272484896,124.80301742190537],[112.60325889604567,111.99133542638096,111.41956619537275,110.88616790048033,110.38944758664515,109.92779733794571,109.49968932606095,109.10367118852513,108.73836171202738,108.40244679807707,108.09467569022667,107.81385744375332,107.55885762024369,107.32859519094637,107.12203963403979,106.93820821213711,106.77616341742578,106.63501057281537,106.5138955783668,106.41200279309349,106.32855304297848,106.26280174673806,106.2140371514971,106.18157867111732,106.16477532045568,106.16300423931801,106.17566930032396,106.20219979531407,106.24204919531132,106.29469397940217,106.35963252822657,106.43638407806564,106.52448773179388,106.62350152321679,106.73300153155263,106.85258104303524,106.98184975681804,107.12043303254571,107.26797117713512,107.42411876846896,107.58854401385219,107.76092814122414,107.94096482124564,108.12835961850092,108.32282947016651,108.52410219060127,108.73191600041073,108.94601907862572,109.1661691367227,109.39213301328765,109.62368628820045,109.8606129152847,110.10270487243001,110.34976182825362,110.60159082442445,110.85800597282274,111.11882816675882,111.38388480551755,111.65300953153921,111.92604197958663,112.20282753728497,112.48321711645661,112.76706693470464,113.05423830673084,113.34459744490137,113.63801526860095,113.9343672219414,114.23353309941523,114.53539687910492,114.83984656308283,115.14677402465274,115.45607486210704,115.76764825868588,116.08139684844562,116.39722658775723,116.71504663217034,117.03476921839081,117.3563095511378,117.67958569465036,118.00451846863351,118.33103134843921,118.65905036928943,118.98850403435914,119.31932322654512,119.65144112375549,119.98479311756303,120.31931673507344,120.65495156386659,120.99163917987588,121.3293230780771,121.66794860586565,122.00746289900442,122.34781482003329,122.68895489903336,123.03083527664722,123.37340964925701,123.71663321623281,124.06046262916084,124.40485594297063,124.74977256888238],[112.40160485891533,111.79369430458971,111.22581938448035,110.69620142432558,110.20315187376801,109.74506701084566,109.32042300244062,108.92777129373037,108.56573430195546,108.23300139187725,107.92832511216811,107.6505176736777,107.39844765206621,107.17103689870197,106.9672576450106,106.78612978662822,106.62671833478586,106.4881310233271,106.36951606065806,106.27006001674229,106.18898583600762,106.12555096771625,106.0790456059801,106.04879103218194,106.03413805309408,106.03446552847552,106.04917898237754,106.07770929279997,106.11951145472523,106.17406341190258,106.240864953086,106.31943666872162,106.40931896436111,106.51007112733097,106.62127044342364,106.74251136059405,106.87340469685022,107.0135768897086,107.16266928476398,107.32033746108006,107.48625059125948,107.66009083418768,107.84155275857702,108.03034279555335,108.22617871864249,108.42878914961395,108.63791308873819,108.85329946810243,109.07470672671235,109.30190240618782,109.53466276593046,109.77277241671077,110.01602397168386,110.26421771390488,110.51716127946678,110.77466935543724,111.03656339181966,111.30267132680639,111.5728273246378,111.84687152541611,112.12464980626507,112.40601355325677,112.69081944356178,112.97892923730876,113.27020957866961,113.56453180571009,113.86177176857449,114.16180965559492,114.46452982693698,114.76982065541864,115.07757437415333,115.3876869306914,115.70005784734853,116.014590087429,116.33118992706315,116.64976683239773,116.97023334188749,117.29250495345202,117.61650001627204,117.94213962701264,118.26934753027142,118.59805002305754,118.9281758631215,119.25965618096141,119.59242439533982,119.9264161321568,120.26156914652954,120.59782324793659,120.93512022829266,121.27340379282606,121.61261949363715,121.95271466582122,122.29363836604587,122.63534131347802,122.97777583295971,123.32089580033804,123.66465658985771,124.00901502353004,124.35392932239519,124.69935905959981],[112.21127619674685,111.60715318279824,111.04295385973631,110.51690392164257,110.02731897548217,109.57259925771012,109.15122470603121,108.76175035941978,108.40280206176733,108.07307244658286,107.77131718203481,107.49635145732125,107.24704669289778,107.02232745849838,106.82116858416684,106.64259245068534,106.48566644685276,106.34950058204336,106.23324524336584,106.13608908756153,106.05725705852622,105.99600852202772,105.95163550981772,105.92346106591521,105.91083768836975,105.91314586029694,105.92979266443101,105.960210475849,106.0038557279031,106.06020774674666,106.12876765016465,106.2090573067149,106.30061835146479,106.40301125486117,106.51581444150634,106.63862345583165,106.7710501718617,106.91272204444945,107.0632813995323,107.22238476112665,107.3897022129191,107.56491679245745,107.7477239160684,107.93783083275267,108.13495610541379,108.33882911788582,108.5491896063166,108.76578721355583,108.98838106527896,109.21673936665563,109.45063901844551,109.6898652514701,109.9342112784724,110.18347796243701,110.43747350049652,110.69601312260234,110.95891880418533,111.22601899207959,111.49714834301933,111.77214747406556,112.05086272434924,112.33314592755707,112.61885419461638,112.90784970606686,113.19999951363459,113.49517535055266,113.79325345019393,114.0941143726107,114.39764283859334,114.70372757088367,115.01226114219669,115.32313982972549,115.63626347581837,115.95153535453579,116.26886204380899,116.58815330293828,116.90932195518008,117.23228377518775,117.55695738108055,117.88326413092906,118.21112802345471,118.54047560275153,118.87123586684817,119.20334017993754,119.5367221881102,119.87131773843296,120.20706480122894,120.5439033954128,120.88177551675059,121.220625068915,121.56039779721449,121.90104122488172,122.24250459180962,122.58473879563097,122.92769633504265,123.27133125527712,123.61559909563246,123.9604568389737,124.30586286312256,124.65177689405766],[112.03227290953994,111.43171206100683,110.87096962114065,110.34827539243135,109.86194889178783,109.41039407853908,108.99209443683263,108.60560838559338,108.24956499146302,107.92265996219379,107.62365189982671,107.35135879468378,107.10465474273843,106.88246687033559,106.68377245150857,106.50759620430841,106.35300775362677,106.21911924896419,106.10508312648997,106.01009000555096,105.93336671053429,105.87417440967263,105.83180686300985,105.80558877231715,105.79487422628279,105.7990452347822,105.81751034648448,105.8497033444611,105.89508201484497,105.95312698393455,106.02334061946256,106.10524599204535,106.19838589310483,106.30232190580736,106.41663352580089,106.54091732874802,106.67478618185281,106.81786849676807,106.96980752144003,107.13026066860853,107.29889887883112,107.47540601603325,107.65947829371969,107.85082373009877,108.04916163048034,108.25422209541701,108.46574555314596,108.68348231498615,108.90719215242254,109.13664389469092,109.37161504574549,109.61189141956281,109.85726679279573,110.10754257384998,110.36252748751374,110.62203727431789,110.88589440385597,111.15392780133686,111.42597258668378,111.70186982553513,111.98146629153754,112.2646142393573,112.55117118786838,112.84099971300492,113.13396724979654,113.42994590312878,113.72881226679941,114.03044725046249,114.33473591407427,114.64156730947796,114.95083432878283,115.26243355920946,115.57626514409537,115.8922326497658,116.21024293799476,116.53020604379201,116.85203505826865,117.17564601634504,117.5009577890759,117.82789198038263,118.1563728279891,118.48632710837146,118.81768404553881,119.1503752234736,119.4843345020666,119.81949793639153,120.15580369917159,120.49319200629516,120.83160504524972,121.17098690634381,121.51128351659764,121.85244257618606,122.19441349732446,122.53714734549229,122.88059678289601,123.22471601407419,123.56946073355719,123.91478807549198,124.26065656515267,124.60702607225601],[111.86459499729492,111.26737093921551,110.70986666869345,110.19031583669179,109.70704162268487,109.25845147333251,108.84303219484501,108.45934537225109,108.10602309104254,107.78176393871004,107.48532926554392,107.21553968576526,106.971271801588,106.75145513421359,106.55506924703569,106.38114104749758,106.22874225510773,106.09698702408943,105.98502971003045,105.89206277071091,105.81731479203177,105.76004863065079,105.7195596655565,105.69517415138769,105.68624766683315,105.69216365193145,105.71233202853801,105.74618789863639,105.79319031555089,105.85282112346617,105.92458386097961,106.00800272471319,106.10262158928145,106.20800308016952,106.3237276963072,106.44939297934312,106.58461272682321,106.72901624666466,106.88224765048717,107.0439651835259,107.21384058899551,107.39155850491524,107.57681589153103,107.76932148759158,107.96879529384223,108.17496808220741,108.3875809292261,108.60638477239303,108.83113998814318,109.06161599029386,109.29759084783036,109.53885092098889,109.78519051465381,110.03641154814382,110.2923232405184,110.55274181058391,110.81749019083145,111.08639775457837,111.35930005563122,111.63603857982477,111.91646050782984,112.20041848865756,112.48777042331787,112.77837925812334,113.07211278715535,113.36884346343827,113.66844821839119,113.97080828915047,114.27580905337955,114.58333987120153,114.89329393391168,115.20556811914318,115.52006285217942,115.83668197311917,116.1553326096205,116.47592505495875,116.79837265115309,117.1225916769238,117.44850124025811,117.77602317537334,118.10508194387454,118.43560453991734,118.76752039919366,119.1007613115694,119.43526133720898,119.77095672603257,120.10778584035742,120.44568908058372,120.78460881379002,121.12448930511263,121.46527665178668,121.80691871973421,122.14936508259031,122.4925669630619,122.83647717651949,123.18105007672925,123.52624150363175,123.87200873308488,124.21831042848542,124.56510659419466],[111.70824246001163,111.1141298174241,110.55964500239466,110.04302525442407,109.56259716817316,109.11677144209051,108.70403798006822,108.32296131939287,107.972176360506,107.65038437613178,107.35634927918645,107.08889413056576,106.84689786944664,106.62929225013245,106.43505897074824,106.26322698025274,106.11286995129575,105.98310390741929,105.87308499398742,105.78200738304112,105.7091013030187,105.65363118496238,105.61489391745775,105.59221720312689,105.58495801002077,105.59250111174455,105.61425771059147,105.64966413837469,105.69818063002087,105.75929016534157,105.83249737471596,105.91732750471832,106.01332543999446,106.12005477794771,106.23709695302529,106.36405040761701,106.50052980677306,106.646165294139,106.80060178667377,106.96349830587866,107.13452734341224,107.31337425910321,107.49973670950222,107.69332410523124,107.8938570954993,108.10106707825705,108.31469573455726,108.53449458577671,108.7602245724408,108.99165565346435,109.22856642470015,109.47074375574825,109.71798244404653,109.97008488531871,110.22686075951047,110.48812673140053,110.75370616511181,111.02342885180414,111.29713074986164,111.57465373693444,111.8558453732262,112.1405586754578,112.42865190096481,112.71998834142184,113.01443612571103,113.31186803148134,113.61216130496922,113.91519748867461,114.22086225650932,114.52904525605439,114.83963995758337,115.15254350952675,115.46765660007058,115.78488332459588,116.10413105868611,116.42531033643866,116.74833473383345,117.07312075692394,117.39958773462705,117.72765771590122,118.05725537111111,118.38830789738911,118.72074492781265,119.05449844422513,119.38950269353752,119.72569410735602,120.06301122478656,120.40139461827837,120.74078682237149,121.08113226522151,121.42237720278149,121.76446965552603,122.10735934760737,122.45099764833985,122.7953375159135,123.14033344324233,123.4859414058562,123.83211881175224,124.17882445312108,124.5260184598739],[111.56321529768999,110.97198869563267,110.42030462224432,109.906403645628,109.42861552825293,108.98535398481296,108.57511179250231,108.19645622701898,107.84802479985314,107.5285212744588,107.23671194075412,106.97142212908524,106.7315329463143,106.51597821809219,106.32374162264632,106.15385400257401,106.00539084219072,105.87746989895366,105.76924897836071,105.67992384254167,105.60872624349511,105.55492207260725,105.51780961871364,105.49671792753472,105.49100525584578,105.50005761422153,105.52328739264506,105.56013206367622,105.61005295825485,105.6725341095607,105.7470811606715,105.83322033206068,105.93049744524393,106.03847699914181,106.15674129595511,106.28488961356967,106.42253742170239,106.56931563919122,106.72486992999977,106.88886003566681,107.06095914208142,107.24085327859741,107.42824074763348,107.6228315830177,107.82434703545167,108.03251908356599,108.24708996913915,108.46781175513708,108.69444590531518,108.92676288420238,109.16454177635481,109.40756992384097,109.65564258097424,109.90856258537428,110.16614004449005,110.42819203676763,110.6945423266971,110.96502109301414,111.23946466937518,111.51771529686424,111.79962088772666,112.08503479975803,112.3738156208092,112.66582696290057,112.96093726546366,113.25901960725788,113.55995152653342,113.86361484903485,114.16989552346354,114.47868346403645,114.78987239979774,115.10335973036025,115.41904638776894,115.73683670419589,116.05663828519168,116.37836188823169,116.7019213063097,117.0272332563456,117.35421727218288,117.68279560196632,118.01289310969872,118.3444371807868,118.67735763139578,119.01158662144059,119.34705857105212,119.68371008036183,120.02147985245884,120.36030861937932,120.70013907099418,121.04091578667027,121.38258516958207,121.72509538356165,122.06839629237554,122.41243940132613,122.75717780107783,123.10256611361336,123.44856044023057,123.79511831149414,124.14219863905966,124.48976166929349],[111.42951351033014,110.84094757384133,110.29184552824236,109.78045101030374,109.30509670292409,108.86419910149996,108.45625363214738,108.07983009512925,107.73356840908416,107.4161746336911,107.12641725024709,106.86312368132374,106.62517703219092,106.41151303809266,106.22111720272981,106.05302211446116,105.90630492779276,105.78008499869253,105.67352166315037,105.58581214921264,105.51618961346092,105.46392129358549,105.42830676932398,105.40867632461118,105.40438940430809,105.41483315936236,105.43942107469854,105.47759167454076,105.52880730025286,105.59255295612355,105.66833521884627,105.75568120674031,105.85413760502988,105.96326974375187,106.08266072509677,106.21191059720114,106.35063557161105,106.49846728182133,106.65505208046517,106.82005037289046,106.99313598500292,107.17399556339778,107.36232800592458,107.55784392095096,107.76026511369933,107.96932409813421,108.18476363297202,108.40633628047419,108.63380398676681,108.86693768250802,109.10551690279445,109.34932942526706,109.59817092543655,109.85184464831087,110.11016109545703,110.37293772668517,110.63999867558724,110.91117447820837,111.18630181417146,111.46522325961395,111.74778705133122,112.03384686155827,112.323261582851,112.61589512255937,112.91161620641313,113.21029819076793,113.51181888308389,113.81606037023111,114.12290885424221,114.4322544951478,114.74399126055496,115.05801678164347,115.37423221527432,115.69254211191917,116.01285428913724,116.33507971033792,116.65913236858191,116.98492917518878,117.31238985292545,117.64143683356862,117.97199515963744,118.30399239011048,118.63735850994304,118.97202584321599,119.30792896975274,119.64500464505015,119.98319172337445,120.32243108388633,120.66266555965805,121.00383986945907,121.34590055218854,121.68879590384104,122.03247591689475,122.37689222202074,122.72199803201254,123.06774808784247,123.41409860675491,123.7610072323106,124.10843298630097,124.45633622245354],[111.30713709793199,110.72100645204989,110.17426772038883,109.66516734845116,109.19204069218657,108.75330679215134,108.34746349900324,107.97308292372351,107.62880718819908,107.31334445382882,107.02546520766529,106.76399878728137,106.52783012707658,106.31589671013393,106.12718571099876,105.96073131591434,105.81561220810165,105.69094920663585,105.58590304835649,105.49967230305393,105.43149141291624,105.38062884789693,105.34638536928885,105.32809239435633,105.32511045540764,105.33682774716715,105.362658756752,105.40204297096845,105.45444365601493,105.51934670503017,105.59625954924023,105.68471012875725,105.78424591935226,105.89443301177792,106.01485524045016,106.14511335851135,106.28482425649922,106.43362022202929,106.59114823807012,106.75706931754945,106.93105787217678,107.11280111350422,107.30199848437569,107.498361119031,107.70161133024224,107.91148212196161,108.12771672605581,108.35006816178804,108.5782988167953,108.81218004838121,109.05149180401892,109.2960222600264,109.54556747743365,109.79993107412831,110.0589239124115,110.32236380115334,110.59007521178229,110.86188900738675,111.13764218425084,111.41717762518384,111.70034386403978,111.98699486085849,112.2769897870903,112.5701928203983,112.86647294855938,113.16570378201151,113.46776337462055,113.77253405226351,114.07990224884533,114.38975834938832,114.70199653985493,115.01651466337657,115.33321408258686,115.65199954776585,115.97277907052271,116.29546380275723,116.61996792065004,116.94620851345343,117.27410547685498,117.60358141070799,117.93456152092723,118.26697352536004,118.60074756345442,118.93581610955107,119.27211388963948,119.60957780142078,119.94814683753329,120.28776201179954,120.62836628836305,120.96990451358775,121.31232335060093,121.65557121636422,121.999598221165,122.34435611042367,122.68979820871758,123.0358793659296,123.38255590542913,123.72978557420173,124.07752749484492,124.42574211935401],[111.19608606049573,110.61216533025849,110.06757119868372,109.56055266007034,109.08944749604052,108.6526770567673,108.24874139307005,107.87621471280198,107.53374113719774,107.22003073487181,106.9338558130088,106.67404744695787,106.43949223097128,106.2291292342161,106.0419471474531,105.87698160693364,105.73331268311767,105.61006252278376,105.50639313397899,105.42150430406556,105.35463164186096,105.30504473554186,105.27204541860823,105.25496613677001,105.25316840914465,105.26604137763586,105.29300043880554,105.33348595295926,105.38696202554102,105.45291535628053,105.5308541518534,105.62030709811148,105.72082238821103,105.8319668032199,105.95332484201528,106.08449789750031,106.22510347636678,106.37477445981511,106.53315840281438,106.69991686964387,106.87472480360297,107.05726992891672,107.24725218298668,107.44438317725786,107.6483856850804,107.85899315504832,108.07594924839046,108.29900739907866,108.52793039540077,108.76248998182193,109.0024664800284,109.24764842811913,109.49783223696551,109.75282186282665,110.01242849535335,110.276470260172,110.5447719352823,110.81716468054941,111.09348577961318,111.37357839357381,111.65729132585253,111.94447879765877,112.23500023352697,112.52872005641744,112.82550749190264,113.12523638098847,113.42778500114349,113.7330358951321,114.04087570727292,114.35119502675823,114.66388823769762,114.97885337555948,115.29599198970651,115.61520901173571,115.9364126293482,116.25951416548955,116.5844279625141,116.9110712711396,117.23936414397127,117.56922933338463,117.90059219356812,118.23338058653557,118.56752479192986,118.90295742044613,119.2396133307123,119.57742954947395,119.9163451949354,120.25630140311893,120.59724125710922,120.93910971905648,121.28185356481903,121.62542132113114,121.9697632051865,122.31483106653491,122.66057833119299,123.00695994787473,123.35393233625324,123.70145333716727,124.04948216469181,124.39797935999489],[111.09636039802105,110.51442420846718,109.97175596312699,109.46660694516129,108.9973171144858,108.56230989534779,108.16008731434766,107.78922546236463,107.44837025608027,107.13623347682022,106.85158906627764,106.59326966035334,106.36016334387496,106.15121061033901,105.96540151209297,105.8017729875189,105.65940635284058,105.53742494713619,105.43499192001782,105.3513081522476,105.28561030029508,105.23716895652008,105.20528691728227,105.18929755185239,105.18856326551888,105.20247405076837,105.23044612085907,105.2719206205132,105.32636240883114,105.39325890987466,105.4721190266859,105.56247211480296,105.66386701160631,105.775871118078,105.89806952979224,106.03006421416809,106.17147323121372,106.32192999517876,106.48108257469816,106.64859302917371,106.82413677928156,107.0074020096354,107.19808910175769,107.39591009563151,107.60058817821388,107.81185719739435,108.02946119997598,108.25315399234593,108.48269872258328,108.71786748283021,108.95844093082282,109.20420792954513,109.45496520403215,109.71051701440588,109.97067484428261,110.23525710374116,110.5040888460871,110.77700149769632,111.0538326002585,111.33442556478377,111.61862943676917,111.90629867195901,112.19729292216118,112.49147683061676,112.78871983644277,113.08889598769902,113.39188376265258,113.69756589883684,114.00582922952489,114.31656452725726,114.62966635408313,114.94503291819221,115.26256593663327,115.58217050382895,115.90375496561356,116.22723079853513,116.55251249417408,116.87951744824721,117.20816585427434,117.53838060159842,117.87008717756005,118.203213573637,118.53769019536955,118.87344977590094,119.21042729297115,119.54855988920946,119.88778679558074,120.22804925784452,120.56929046589663,120.91145548586518,121.25449119484301,121.5983462181418,121.94297086895907,122.28831709035457,122.63433839943869,122.98098983367781,123.32822789922717,123.6760105212074,124.02429699584141,124.37304794437627],[111.00796011050812,110.42778308667576,109.88682201371871,109.38333020372394,108.91564954752246,108.48220530789268,108.08150126283614,107.71211517241146,107.37269454484661,107.06195267967398,106.77866496747157,106.52166542746788,106.2898434657875,106.08214083850277,105.89754880491827,105.73510545767014,105.59389321727055,105.47303647969308,105.37169940647301,105.28908384759991,105.2244273882187,105.17700151083156,105.14610986531083,105.13108663960342,105.13129502453042,105.14612576656477,105.17499580291256,105.2173469736302,105.27264480588531,105.3403773658125,105.4200541737374,105.51120517883173,105.61337978953796,105.72614595635197,105.84908930378094,105.98181230851461,106.12393352104013,106.27508682812024,106.43492075372134,106.60309779613895,106.77929379921252,106.96319735566024,107.15450924068863,107.35294187415195,107.5582188096426,107.77007424899956,107.98825258081247,108.21250794159003,108.44260379834273,108.67831255140612,108.91941515640215,109.16570076430452,109.41696637863352,109.67301652886592,109.93366295919935,110.1987243318608,110.46802594419681,110.74139945882737,111.0186826461867,111.29971913881383,111.58435819679001,111.8724544837592,112.16386785299277,112.45846314299618,112.75610998217977,113.05668260214304,113.36005965914795,113.66612406337762,113.97476281560134,114.2858668508857,114.59933088901141,114.91505329127479,115.23293592336718,115.55288402404547,115.87480607931886,116.19861370189368,116.5242215156299,116.85154704477635,117.18051060776429,117.51103521534938,117.84304647290304,118.17647248666432,118.51124377377332,118.8472931759156,119.18455577641598,119.52296882062737,119.86247163946926,120.20300557597631,120.54451391472526,120.88694181401377,121.23023624067282,121.57434590739634,121.91922121248273,122.2648141818825,122.61107841345488,122.9579690233389,123.30544259435106,123.65345712632205,124.0019719882939,124.35094787249801],[110.93088519795698,110.35224196488437,109.81276935045881,109.31072243575844,108.84444479515049,108.41236329440216,108.01298323853558,107.64488384294241,107.30671400349684,106.99718834343311,106.71508351659094,106.45923474830155,106.22853259670929,106.0219199187073,105.83838902592899,105.67697901738742,105.53677327640749,105.41689712045459,105.31651559334473,105.23483139012265,105.17108290563168,105.12454239847644,105.09451426269389,105.08033340002302,105.0813636861793,105.09699652502513,105.12664948496608,105.16976501231035,105.22580921670341,105.29427072409413,105.37465959300833,105.46650629019776,105.56936072200617,105.68279131804192,105.80638416398145,105.93974218053984,106.08248434584596,106.23424495863959,106.39467293988396,106.56343117053956,106.74019586339581,106.92465596699108,107.11651259977958,107.31547851281918,107.52127757936663,107.73364430986415,107.95232339089979,108.17706924681085,108.40764562267915,108.64382518754952,108.88538915676637,109.13212693239726,109.38383576076973,109.64032040620695,109.90139284010357,110.166871944531,110.43658322961137,110.71035856394265,110.98803591739798,111.26945911566392,111.55447760591487,111.84294623305948,112.13472502602184,112.42967899355571,112.72767792911355,113.02859622432051,113.33231269062955,113.63871038875452,113.94767646550225,114.2591019976432,114.57288184248246,114.8889144948072,115.20710194990818,115.5273495723853,115.84956597046406,116.1736628755655,116.49955502688177,116.82716006072697,117.15639840444108,117.4871931746376,117.81947007959721,118.15315732561756,118.48818552714116,118.82448762049015,119.16199878104699,119.50065634372775,119.84039972660111,120.18117035751419,120.52291160359498,120.86556870350246,121.20908870230843,121.55342038889449,121.89851423575745,122.24432234111876,122.59079837324131,122.93789751685807,123.28557642162492,123.6337931525114,123.98250714204903,124.33167914436024],[110.86513566036757,110.28780084309298,109.74959797334738,109.24878364126455,108.78370285736995,108.35278385487609,107.95453324144596,107.58753147395761,107.25042863203092,106.9419404680975,106.66084471363544,106.40597762285408,106.17623073663997,105.97054785095273,105.78792217512522,105.6273936666708,105.48804653025145,105.3690068694205,105.26944048063277,105.18855077981566,105.12557685253415,105.07979161945468,105.05050010943155,105.03703783311137,105.03876925046556,105.05508632614936,105.08540716701958,105.12917473655362,105.18585564128561,105.25493898471953,105.33593528449833,105.42837544890104,105.53180980901074,105.64580720314781,105.76995411039368,105.90385383024392,106.04712570563116,106.19940438673683,106.36033913318602,106.52959315237571,106.70684297183148,106.89177784362818,107.08409917903042,107.28352001163319,107.4897644873859,107.7025673799878,107.92167363023802,108.14683790800828,108.37782419559257,108.6144053912605,108.8563629319155,109.10348643382336,109.35557335044054,109.61242864642881,109.87386448699519,110.13969994175174,110.40976070233094,110.68387881304213,110.96189241389229,111.24364549533406,111.52898766414388,111.8177739198597,112.10986444124838,112.40512438229547,112.70342367724433,113.00463685423149,113.30864285709731,113.61532487496756,113.92457017922757,114.23626996753002,114.55031921449626,114.86661652878939,115.1850640162564,115.50556714884846,115.82803463904929,116.15237831955032,116.47851302792938,116.80635649609901,117.13582924430466,117.46685447946294,117.79935799764239,118.13326809049677,118.46851545547328,118.80503310962443,119.14275630686397,119.4816224585106,119.82157105697614,120.1625436024583,120.50448353250584,120.84733615433103,121.19104857974989,121.53556966263658,121.8808499387833,122.22684156806341,122.57349827879813,122.92077531423523,123.26862938104854,123.61701859977511,123.96590245710703,124.31524175996283],[110.81071149773987,110.23445972130159,109.69730788238439,109.19751382024245,108.73342373418079,108.30346698931451,107.90615127156708,107.54005806545695,107.2038384304488,106.89620905366729,106.61594855860518,106.36189405112565,106.13293788557964,105.92802463523884,105.74614825250681,105.58634940552015,105.44771297880231,105.32936572659101,105.23047406833723,105.15024201667906,105.08790922892618,105.0427491737662,105.01406740552382,105.00119993886834,105.00351171738907,105.02039516993746,105.05126884907307,105.09557614635997,105.15278407963177,105.22238214768865,105.30388124820766,105.39681265494168,105.50072705055182,105.61519361166981,105.73979914301763,105.8741472576268,106.01785760039583,106.17056511241189,106.33191933362755,106.50158374164714,106.67923512451962,106.86456298557135,107.05726897844117,107.25706637059405,107.46367953370043,107.67684345937079,107.89630329882711,108.12181392518251,108.35313951708302,108.59005316253915,108.83233648184957,109.07977926858271,109.33217914764623,109.58934124953154,109.85107789987421,110.11720832352295,110.38755836235526,110.6619602061259,110.94025213566945,111.22227827782437,111.50788837147689,111.79693754415993,112.08928609867232,112.38479930921544,112.68334722657201,112.98480449187599,113.28905015855139,113.59596752201671,113.90544395677735,114.21737076054616,114.53164300505277,114.84815939322148,115.16682212241173,115.48753675343494,115.81021208507443,116.13476003384831,116.46109551877309,116.78913635089268,117.11880312735502,117.45001912982544,117.78271022703866,118.11680478130191,118.45223355876944,118.78892964331865,119.12682835386701,119.46586716497576,119.80598563059444,120.14712531080862,120.48922970145799,120.83224416649966,121.17611587299719,121.52079372862234,121.86622832156024,122.21237186271638,122.5591781301253,122.90660241547035,123.25460147262218,123.60313346811344,123.95215793346784,124.30163571930595],[110.76761271007391,110.19221859951017,109.65589907756973,109.1569129726921,108.69360742558302,108.26441269771745,107.86783732889914,107.50246361744038,107.16694339875045,106.85999410014247,106.58039505150026,106.32698403311622,106.09865404352834,105.8943502715659,105.71306725807389,105.5538462339355,105.41577262206025,105.29797369196604,105.19961635645805,105.11990510071284,105.05808003480747,105.01341506141107,104.98521615097054,104.9728197172938,104.97559108694989,104.99292305638946,105.02423453112665,105.06896924172958,105.12659453174204,105.19660021300153,105.27849748413612,105.37181790831956,105.47611244662936,105.5909505436077,105.71591926185347,105.85062246268836,105.99468003013993,106.14772713566481,106.30941354120841,106.47940293835401,106.65737232146003,106.84301139282066,107.0360219980119,107.23611758970168,107.44302271831025,107.6564725480131,107.87621239666707,108.10199729833352,108.33359158715037,108.57076850138529,108.81330980656848,109.06100543667542,109.31365315238665,109.57105821551519,109.83303307874075,110.0993970898446,110.36997620968461,110.64460274319394,110.92311508272961,111.20535746313463,111.49117972791396,111.7804371059602,112.07298999829365,112.36870377431552,112.66744857709649,112.96909913725402,113.27353459499159,113.580638329902,113.89029779815158,114.20240437669148,114.51685321415211,114.83354308810334,115.15237626837404,115.47325838614474,115.79609830853944,116.12080801845943,116.44730249941252,116.77549962510771,117.10532005359229,117.4366871257252,117.76952676778603,118.10376739803293,118.43933983702969,118.77617722157258,119.11421492205618,119.45339046312341,119.79364344745593,120.13491548256501,120.47715011045122,120.82029274000818,121.1642905820502,121.50909258685179,121.85464938408832,122.20091322507763,122.54783792722283,122.89537882056355,123.24349269634568,123.5921377575264,123.94127357113145,124.29086102238944],[110.73583929736975,110.16107747771879,109.62537155890355,109.12698109861347,108.66425393157661,108.2356209800849,107.83959141344214,107.47474812990795,107.13974353693594,106.83329560752296,106.55418419232055,106.3012475688258,106.07337921048611,105.86952475993375,105.68867919182645,105.52988415191695,105.39222546002524,105.27483076554552,105.17686734499527,105.09754003191692,105.03608927017834,104.99178928238925,104.96394634577193,104.95189716838806,104.95500735914808,104.97266998550539,105.00430421318011,105.04935402266209,105.10728699761631,105.17759318065818,105.25978399228387,105.35339120903471,105.45796599724332,105.57307799896159,105.69831446690095,105.8332794454287,105.97759299486344,106.13089045649558,106.29282175592883,106.46305074249635,106.64125456265283,106.82712306537607,107.02035823774263,107.22067366895608,107.42779404121529,107.64145464591468,107.86140092375804,108.08738802746129,108.31918040579477,108.55655140779903,108.79928290607245,109.04716493810149,109.29999536466177,109.55757954437975,109.8197300235947,110.08626624071691,110.35701424431876,110.63180642424612,110.91048125507277,111.19288305126489,111.47886173345513,111.76827260526041,112.06097614011249,112.35683777759569,112.65572772881796,112.95752079036546,113.26209616641817,113.56933729862338,113.87913170335034,114.19137081596612,114.50594984179429,114.822767613435,115.14172645414357,115.46273204697785,115.78569330944448,116.11052227338362,116.43713396984795,116.76544631874424,117.09538002301632,117.42685846716198,117.75980761988446,118.09415594068997,118.42983429025416,118.76677584438647,119.10491601143138,119.44419235295339,119.78454450756074,120.12591411772759,120.46824475948573,120.81148187485667,121.15557270690925,121.50046623732506,121.8461131263675,122.19246565514725,122.53947767009073,122.8871045295146,123.23530305221912,123.58403146801381,123.93324937009781,124.28291766921342],[110.71539125962734,110.1410363559274,109.60572532638577,109.10771819800661,108.64536325216154,108.21709183641681,107.82141352519598,107.45691160285976,107.12223884500527,106.81611357580879,106.53731598106616,106.28468465825439,106.05711338645284,105.85354810034237,105.6729840537644,105.51446315946433,105.37707149269714,105.25993694732962,105.16222703394894,105.08314681029142,105.02193693503858,104.97787183670077,104.95025798992776,104.93843229215092,104.94176053398355,104.9596359572852,104.99147789523366,105.03673048915783,105.0948614772547,105.16536105065849,105.24774077265084,105.34153255708715,105.44628770239368,105.56157597773142,105.68698475816034,105.82211820584789,105.96659649456643,106.12005507490424,106.28214397778848,106.4525271540741,106.63088184809804,106.81689800323764,107.01027769763327,107.21073460835726,107.4179935024157,107.63178975307541,107.85186888009986,108.07798611256565,108.30990597301607,108.54740188178032,108.79025578036129,109.03825777286086,109.29120578447176,109.54890523612512,109.81116873443608,110.07781577613962,110.34867246625781,110.62357124928249,110.90235065269881,111.18485504221536,111.47093438810032,111.76044404206064,112.05324452412879,112.34920131905606,112.64818468173625,112.95006945121047,113.25473487283085,113.56206442818076,113.87194567237339,114.18427007836991,114.49893288797912,114.81583296921653,115.13487267972012,115.45595773593415,115.77899708778945,116.10390279862101,116.43058993007944,116.75897643180234,117.08898303562724,117.42053315413609,117.75355278333393,118.08797040927288,118.42371691844278,118.7607255117602,119.09893162199265,119.43827283446595,119.77868881090879,120.12012121629647,120.46251364856134,120.8058115710452,121.14996224757402,121.49491468004219,121.84061954839775,122.18702915292512,122.53409735872901,122.88177954232387,123.23003254024241,123.57881459957581,123.92808533036703,124.27780565977775],[110.70626859684654,110.13209523413603,109.59696038001638,109.09912427087147,108.63693538733797,108.20882526671321,107.81330366416067,107.44895403629575,107.11442932295853,106.808448005,106.52979041773695,106.27729530140205,106.04985657142858,105.84642029279185,105.66598184388789,105.50758325657779,105.37031072007608,105.25329223731816,105.15569542331892,105.07672543583625,105.01562302938829,104.97166272434561,104.94415108343814,104.93242508858232,104.93585061145633,104.95382097172883,104.98575557728714,105.03109864121672,105.08931797065699,105.15990382300262,105.24236782523695,105.33624195247681,105.44107756208055,105.55644447991727,105.68193013563136,105.81713874394582,105.9616905292488,106.11522099089069,106.27738020678777,106.44783217308722,106.62625417779559,106.81233620640519,107.00578037768385,107.2063004079053,107.4136211019113,107.62747786949552,107.84761626569251,108.07379155364676,108.30576828881443,108.54331992332911,108.78622842943503,109.03428394095359,109.28728441181642,109.54503529075151,109.80734921126493,110.07404569611289,110.34495087550177,110.61989721830311,110.89872327560795,111.18127343598584,111.46739769184968,111.75695141636093,112.0497951503425,112.34579439869665,112.64481943585142,112.9467451197889,113.25145071422979,113.55881971857437,113.86873970522102,114.18110216390305,114.49580235270672,114.81273915544784,115.13181494510391,115.45293545301389,115.77600964357433,116.10094959417157,116.42767038010675,116.75608996428187,117.08612909142485,117.41771118664732,117.75076225813457,118.08521080378173,118.42098772159547,118.75802622369376,119.0962617537399,119.43563190766081,119.7760763575,120.11753677827143,120.45995677767817,120.80328182857363,121.14745920404462,121.49243791500302,121.83816865017914,122.18460371841141,122.5316969931376,122.87940385899105,123.22768116041559,123.57648715221237,123.92578145193897,124.27552499408266],[110.70847130902752,110.13425411234462,109.59907671979545,109.10119931720811,108.63897033710572,108.21082127097417,107.81526183033624,107.45087543021576,107.11631497079551,106.81029889509654,106.53160750233307,106.27907949826869,106.05160876541328,105.84814133728214,105.66767256219674,105.50924444325719,105.37194314216192,105.25489663551123,105.15727251310531,105.07827590855143,105.01714755322743,104.97316194532382,104.94562562630315,104.93387555768244,104.93727759156647,104.95522502883642,104.98713725934064,105.03245847883861,105.09065647782329,105.16122149769049,105.24366515004229,105.33751939520378,105.44233557630383,105.55768350551908,105.68315059931423,105.81834105972243,105.96287509891057,106.11638820445502,106.27853044292631,106.44896579953571,106.62737155174545,106.81343767487908,107.00686627789442,107.20737106760005,107.41467683970218,107.6285189951748,107.84864308053605,108.07480435070471,108.30676735318973,108.54430553244558,108.78720085329363,109.0352434423796,109.28823124669582,109.54596970825867,109.80827145408118,110.0749560006367,110.34584947205066,110.62078433130797,110.89959912380003,111.18213823257641,111.46825164470309,111.75779472816104,112.05062801875366,112.34661701651726,112.64563199116348,112.94754779610084,113.2522436906149,113.55960316980411,113.86951380189299,114.18186707256537,114.49655823597715,114.81348617212905,115.13255325029475,115.453665198217,115.77673097679916,116.10166266003507,116.42837531992996,116.75678691618293,117.08681819040937,117.41839256469572,117.75143604428627,118.08587712421648,118.42164669971235,118.75867798018714,119.09690640667336,119.43626957253807,119.77670714733452,120.11816080365256,120.46057414683618,120.8038926474421,121.14806357632099,121.49303594220764,121.83876043171158,122.18518935160598,122.53227657331655,122.87997747951623,123.22824891273869,123.57704912592348,123.92633773481371,124.27607567212786],[110.72199939617028,110.14751299055324,109.6120743457229,109.11394333701647,108.65146810146487,108.22307984919956,107.82728802372276,107.46267578462006,107.12789578851638,106.82166624609842,106.54276723485437,106.29003724885432,106.06236996840707,105.85871123381327,105.67805620869109,105.51944671950262,105.38196875895486,105.26475014190881,105.16695830330812,105.08779822843692,105.02651050655598,104.98236949963541,104.95468161852267,104.94278369945125,104.94604147431394,104.96384812860791,104.99562294139417,105.04081000202366,105.09887699875368,105.1693140747221,105.25163274706689,105.34536488526808,105.45006174506365,105.56529305453691,105.69064614920889,105.82572515317793,105.9701502035518,106.12355671559727,106.28559468620446,106.45592803341972,106.63423396994774,106.82020240865896,107.01353539826491,107.21394658744171,107.42116071578836,107.63491313011333,107.85494932463048,108.08102450373933,108.31290316614204,108.55035870912958,108.79317305193723,109.041136277139,109.29404628911009,109.55170848864668,109.81393546288491,110.08054668971104,110.35136825590442,110.6262325882971,110.90497819727506,111.18744943198695,111.47349624666047,111.7629739774614,112.0557431293623,112.35166917251816,112.6506223476724,112.95247748014629,113.25711380198634,113.56441478186989,113.87426796238948,114.18656480435698,114.50120053779035,114.8180740192601,115.1370875952928,115.45814697154327,115.78116108746399,116.10604199621177,116.43270474954912,116.76106728750538,117.09105033258075,117.42257728828135,117.75557414178904,118.08996937057712,118.42569385279327,118.76268078124025,119.10086558079284,119.44018582909786,119.78058118041223,120.12199329243991,120.46436575603535,120.80764402765057,121.15177536440324,121.49670876165602,121.84239489299522,122.188786052509,122.53583609926589,122.88350040389946,123.23173579721174,123.58050052070917,123.92975417899123,124.27945769391351],[110.74685285827481,110.17187186876184,109.6359532577988,109.13735633029656,108.67442868041536,108.24560100138946,107.84938224432014,107.48435509950846,107.14917177612104,106.84255005800567,106.56326961530097,106.31016855315893,106.08214018040984,105.87812998238515,105.69713278337082,105.53819008531413,105.40038757045474,105.28285275651098,105.18475279392729,105.1052923954928,105.04371188937405,104.99928538728024,104.97131906009679,104.95914951388863,104.96214225969872,104.97969027104332,105.01121262344765,105.05615321077184,105.11397953344807,105.18418155409745,105.26627061631071,105.35977842266963,105.46425606835986,105.57927312697068,105.70441678531527,105.8392910243121,105.98351584317241,106.1367265243173,106.29857293662192,106.46871887473903,106.64684143240238,106.83263040774492,107.02578773879539,107.22602696743013,107.43307273016983,107.64666027431116,107.86653499797582,108.09245201275068,108.3241757276713,108.5614794533811,108.80414502536577,109.05196244523171,109.30472953905903,109.56225163191569,109.82434123767607,110.09081776333576,110.36150722706304,110.63624198927037,110.91486049603303,111.19720703421761,111.48313149772201,111.7724891642616,112.0651404821684,112.36095086669916,112.65979050537821,112.96153417192519,113.26606104834394,113.57325455477186,113.88300218671036,114.19519535927782,114.50972925814628,114.82650269684096,115.14541798009786,115.46638077299288,115.78929997556865,116.11408760270159,116.4406586689641,116.76893107824938,117.09882551793889,117.43026535740407,117.76317655064285,118.09748754286375,118.43312918083843,118.77003462685333,119.10813927609827,119.44738067733989,119.78769845673332,120.12903424463339,120.47133160527572,120.81453596919887,121.15859456829133,121.50345637334811,121.84907203402989,122.19539382112028,122.54237557098554,122.88997263214065,123.23814181383457,123.58684133656939,123.93603078447154,124.28567105943968],[110.78303169534098,110.2073307469704,109.67071345602305,109.17143829704837,108.70785207395726,108.27838472754389,107.88154449212841,107.51591337488098,107.18014293360956,106.87295033081826,106.59311464367283,106.33947341118258,106.11091940142163,105.90639758299785,105.72490228623606,105.56547454069164,105.42719957666164,105.30920447931756,105.21065598496286,105.13075840971902,105.06875170168151,105.02390960825853,104.99553795102534,104.98297300099468,104.98557994772082,105.00275145614253,105.0339063055012,105.07848810508314,105.13596408190655,105.20582393581662,105.28757875777366,105.38076000740845,105.48491854619246,105.59962372282043,105.72446250763348,105.8590386731251,106.00297201777252,106.15589763061523,106.31746519417889,106.48733832349387,106.66519393910937,106.85072167213706,107.04362329948586,107.24361220756529,107.45041288284652,107.66376042776822,107.88340010057215,108.1090868777388,108.34058503777753,108.57766776520026,108.82011677357913,109.06772194665774,109.32028099654275,109.57759913806548,109.83948877845472,110.10576922151115,110.37626638552653,110.65081253422782,110.92924602007402,111.21141103926828,111.49715739788766,111.78634028856182,112.07882007717187,112.37446209906035,112.67313646428092,112.9747178714376,113.27908542968774,113.58612248850997,113.89571647485577,114.20775873732794,114.52214439704493,114.83877220487157,115.15754440471005,115.47836660256586,115.8011476411133,116.12579947950459,116.4522370781751,116.78037828841488,117.11014374648394,117.44145677206411,117.77424327084783,118.10843164107625,118.44395268384767,118.78073951702619,119.11872749258985,119.45785411726453,119.79805897629751,120.13928366023305,120.48147169455727,120.82456847208725,121.16852118798518,121.51327877728411,121.85879185481559,122.20501265743987,122.55189498847557,122.89939416423985,123.24746696260749,123.59607157350419,123.94516755125471,124.29471576870628],[110.83053590736901,110.25388962517901,109.71635494039577,109.21618923727192,108.75173828209056,108.32143102766281,107.92377476714761,107.5573506107377,107.22080926098191,106.91286706453626,106.63230231996994,106.37795182292523,106.14870763144238,105.94351403565143,105.76136471728674,105.60130008563515,105.46240477757551,105.34380531032878,105.24466787641487,105.16419627111564,105.10162994347843,105.05624216257,105.02733829130857,105.01425416076931,105.01635453838016,105.03303168390568,105.06370398755469,105.1078146849576,105.16483064412897,105.23424121987945,105.31555717145596,105.40830963948461,105.51204917856153,105.62634484208617,105.75078331616342,105.88496809961688,106.02851872735201,106.18107003449099,106.34227145887523,106.5117863796841,106.68929149006874,106.87447620183536,107.06704208033617,107.26670230784732,107.47318117381852,107.68621359048454,107.90554463241929,108.13092909870353,108.3621310964608,108.5989236445869,108.84108829657751,109.08841478141714,109.34070066156117,109.59775100709624,109.85937808522074,110.12540106423694,110.39564573129496,110.66994422316961,110.94813476939795,111.23006144713915,111.51557394715721,111.80452735036206,112.09678191437283,112.39220286960156,112.69066022438051,112.99202857868353,113.29618694601791,113.60301858308416,113.91241082682558,114.22425493850727,114.53844595448646,114.85488254335206,115.17346686912941,115.49410446026209,115.81670408409791,116.14117762662067,116.46743997718202,116.79540891800183,117.12500501821575,117.4561515322612,117.78877430240379,118.12280166521477,118.45816436182103,118.79479545175886,119.13263023026751,119.4716061488715,119.811662739105,120.15274153923885,120.49478602388,120.83774153631559,121.18155522348496,121.52617597346371,121.8715543553525,122.2176425614678,122.56439435173597,122.91176500019711,123.25971124353009,123.60819123151347,123.95716447934062,124.30659182171323],[110.88936549435869,110.31154850338766,109.7728777109169,109.27160915096725,108.80608730481526,108.37473990174614,107.97607306937756,107.60866680707859,107.27117075823811,106.96230025915952,106.68083264419234,106.42560378838691,106.19550487047225,105.9894793403458,105.80652007652286,105.64566672014463,105.50600317319638,105.38665524954446,105.28678846828322,105.20560597968257,105.14234661476475,105.09628305021482,105.06672008094634,105.0529929932126,105.05446603167695,105.07053095433267,105.10060566960817,105.14413295039505,105.20057922011547,105.26943340628613,105.35020585735735,105.44242731889796,105.54564796546704,105.65943648476789,105.78337921090511,105.91707930378745,106.06015597191085,106.21224373594461,106.37299173071106,106.54206304330968,106.71913408528047,106.90389399683973,107.09604408134648,107.29529726827617,107.50137760308571,107.7140197624602,107.93296859351729,108.1579786756451,108.38881390372096,108.62524709154115,108.86705959436075,109.1140409495098,109.36598853411438,109.62270723900788,109.88400915797415,110.14971329151329,110.41964526436828,110.69363705609558,110.97152674400488,111.25315825782999,111.53838114553093,111.82705034966229,112.11902599377126,112.4141731783231,112.71236178567707,113.0134662936629,113.3173655973342,113.62394283849446,113.93308524261988,114.24468396281581,114.55863393047073,114.87483371228237,115.19318537335597,115.51359434608165,115.83596930452245,116.1602220440498,116.4862673659848,116.81402296701027,117.14340933313437,117.47434963799549,117.80676964531092,118.14059761527908,118.47576421475863,118.81220243105146,119.14984748913115,119.48863677216093,119.82850974515576,120.16940788165091,120.51127459324384,120.85405516188391,121.19769667479049,121.54214796188717,121.88735953564056,122.23328353320409,122.57987366076669,122.92708514001225,123.27487465660275,123.62320031059731,123.97202156872929,124.32129921846061],[110.95952045631012,110.38030738159625,109.84028176758649,109.33769803813436,108.87089914213134,108.43831134979406,108.03843939881853,107.6698619639036,107.33122742537812,107.02124991468816,106.73870561634003,106.48242930756759,106.251311118511,106.04429349708097,105.86036836394449,105.69857444422027,105.55799476352429,105.4377542969646,105.337017760568,105.25498753541987,105.1909017155406,105.1440322711931,105.1136833199386,105.09918949832452,105.09991442761093,105.11524926742362,105.14461135166171,105.18744290139571,105.24320980986595,105.31140049503648,105.39152481547801,105.48311304564861,105.58571490690908,105.69889865086554,105.82225019185853,105.95537228563668,106.09788375144912,106.24941873497608,106.40962600968628,106.57816831437073,106.75472172474457,106.93897505715027,107.13062930251681,107.32939708885166,107.53500217064827,107.74717894369508,107.96567198386619,108.19023560856344,108.42063345955822,108.656638106063,108.8980306669289,109.14460045093591,109.39614461420233,109.65246783380043,109.91338199671507,110.17870590334014,110.4482649847464,110.72189103300573,110.99942194389483,111.28070147134083,111.56557899300878,111.8539092864625,112.14555231536713,112.44037302522472,112.73824114817035,113.03903101637582,113.34262138363665,113.64889525474089,113.95773972223854,114.26904581025371,114.58270832499771,114.89862571166253,115.21669991738949,115.5368362600245,115.85894330238695,116.18293273179215,116.50871924458362,116.83622043544024,117.16535669123979,117.49605108926703,117.82822929956905,118.16181949126941,118.49675224266019,118.83296045490381,119.17037926918096,119.50894598713279,119.84859999444967,120.18928268746906,120.53093740264896,120.87350934879213,121.21694554190199,121.56119474255439,121.90620739567963,122.25193557264869,122.59833291556779,122.94535458368557,123.29295720182529,123.64109881075578,123.98973881942082,124.33883795894853],[111.04100079322328,110.46016625980485,109.91856711040454,109.41445589877311,108.94617379403878,108.51214537180651,108.11087375547035,107.74093608121278,107.40097926240205,107.08971603112209,106.80592123641286,106.54842838046719,106.31612637555882,106.10795650585696,105.92290957955144,105.76002325786183,105.61837954855916,105.49710245258927,105.39535575326914,105.31234093832752,105.24729524580584,105.19948982550461,105.16822800828548,105.15284367610509,105.15269972618238,105.16718662317844,105.19572103371523,105.2377445379595,105.29272241338053,105.36014248613061,105.439514045818,105.53036681973659,105.63225000288753,105.74473134037919,105.86739625902378,105.99984704516477,106.14170206596694,106.29259503158536,106.45217429580089,106.62010219286712,106.79605440846109,106.9797193827669,107.17079774384698,107.36900176957404,107.57405487650614,107.78569113418915,108.00365480346601,108.22769989745841,108.45758976397239,108.69309668815245,108.93400151428203,109.18009328569526,109.43116890182512,109.68703279147377,109.94749660144346,110.21237889971761,110.48150489242954,110.75470615390014,111.03182036906766,111.31269108767184,111.59716748959062,111.88510416076279,112.17636087916037,112.47080241030653,112.76829831186058,113.06872274682217,113.37195430492545,113.67787583182336,113.98637426568169,114.29734048082085,114.61066913806754,114.92625854149246,115.24401050123021,115.56383020209074,115.88562607769141,116.20930968984752,116.53479561297824,116.86200132329168,117.19084709253205,117.52125588607574,117.85315326517826,118.18646729318564,118.52112844552599,118.85706952331603,119.19422557041673,119.53253379378698,119.87193348698692,120.2123659566934,120.55377445209524,120.89610409704042,121.23930182481912,121.58331631546531,121.92809793546978,122.27359867980169,122.61977211613926,122.96657333121682,123.31395887919764,123.66188673198869,124.01031623141509,124.35920804317679],[111.13380650509825,110.55112513801352,110.00773373937085,109.50188273288367,109.03191126053757,108.59624196778337,108.19337613933303,107.82188915900612,107.48042626930967,107.16769860846151,106.88247950441102,106.62360100708594,106.38995064161568,106.18046836667376,105.99414372334397,105.83001316106945,105.68715752830103,105.56469971641856,105.46180244638664,105.37766618840553,105.31152720556048,105.26265571314948,105.23035414598679,105.21395552655433,105.21282192739099,105.22634302159717,105.25393471576874,105.29503786008634,105.3491170306591,105.41565937956847,105.49417354837711,105.58418864116173,105.68525325340251,105.79693455330886,105.91881741240088,106.0505035823716,106.1916109154641,106.34177262577249,106.50063658905505,106.66786467879896,106.8431321364299,107.02612697368967,107.2165494053372,107.41411131044319,107.61853572065915,107.82955633394258,108.04691705231672,108.2703715423302,108.4996828169636,108.73462283780941,108.97497213641996,109.220519453788,109.47106139698263,109.72640211202811,109.98635297215928,110.25073228064554,110.51936498741749,110.79208241877875,111.06872201952352,111.34912710682282,111.63314663527652,111.92063497256302,112.21145168515118,112.50546133356845,112.80253327674772,113.10254148500206,113.4053643612004,113.71088456974203,114.01898887294928,114.32956797451715,114.64251636968002,114.95773220177229,115.27511712487802,115.59457617228021,115.91601763043572,116.23935291821611,116.56449647116879,116.89136563056464,117.21988053701124,117.54996402842153,117.88154154213863,118.21454102102787,118.54889282335593,118.88452963628806,119.22138639283864,119.55940019212366,119.89851022276736,120.23865768932396,120.57978574158267,120.92183940662859,121.26476552354218,121.60851268062004,121.95303115501106,122.29827285466294,122.64419126248104,122.99074138260603,123.33787968871992,123.68556407429629,124.03375380471213,124.38240947114555],[111.23793759193489,110.65318401622211,110.10778165448563,109.59997854046597,109.1281115416278,108.69060113772473,108.28594655040656,107.91272119728369,107.56956844610119,107.25519764670616,106.96838042033446,106.70794718742361,106.47278391668146,106.2618290795314,106.07407079532183,105.9085441538431,105.76432870274981,105.64054608845228,105.53635783992064,105.45096328565388,105.38359759480464,105.33352993412764,105.30006173304277,105.2825250496722,105.280281031237,105.29271846267976,105.31925239782224,105.35932286777633,105.41239366170166,105.47795117535014,105.55550332315536,105.64457850992419,105.7447246584538,105.85550828965447,105.97651365198968,106.10734189725724,106.24761029994076,106.39695151753762,106.55501288944849,106.72145577216621,106.89595490865113,107.07819782991852,107.26788428698734,107.46472571145929,107.66844470310748,107.87877454295521,108.09545873041831,108.31825054317865,108.54691261853171,108.78121655503392,109.02094253334297,109.26587895521402,109.51582209967492,109.77057579546327,110.02995110886252,110.29376604612391,110.5618452697104,110.83401982764157,111.11012689526233,111.39000952879393,111.67351643006651,111.96050172186328,112.25082473333937,112.54434979501052,112.84094604283179,113.14048723091548,113.44285155246156,113.74792146849677,114.05558354404135,114.36572829134285,114.67825001983539,114.99304669250189,115.31001978833297,115.62907417059296,115.95011796062002,116.27306241689779,116.59782181915524,116.92431335725904,117.25245702467721,117.58217551630464,117.9133941304501,118.24604067479594,118.58004537615,118.91534079381992,119.2518617364466,119.58954518214273,119.92833020179107,120.26815788536068,120.60897127111124,120.95071527755685,121.29333663807107,121.63678383801854,121.98100705430346,122.32595809723252,122.67159035459331,123.01785873785332,123.3647196303922,123.71213083767834,124.06005153931196,124.4084422428547],[111.35339405373331,110.76634289443069,110.21871085574882,109.70874332151996,109.2347746373094,108.79522288163062,108.38858498869102,108.0134321960453,107.66840579277658,107.35221314585627,107.06362398418314,106.80146692148028,106.56462620075624,106.35203864442987,106.16269079548525,105.99561623618283,105.84989307190571,105.72464156869053,105.61902193387094,105.53223223007257,105.46350641353817,105.41211248843921,105.37735076945329,105.3585522454587,105.35507703772026,105.36631294642629,105.39167407987576,105.43059956102942,105.48255230650831,105.5470178734755,105.62350337015292,105.71153642602401,105.81066421804158,105.92045254941603,106.04048497779019,106.17036198982161,106.30970021939672,106.45813170688052,106.6153031969815,106.78087547296886,106.95452272512476,107.13593195145356,107.32480238879735,107.52084497262199,107.72378182385113,107.93334576122714,108.14927983777082,108.37133690000385,108.59927916867683,108.83287783982601,109.07191270505081,109.31617178997341,109.56545100990193,109.8195538417793,110.07829101155322,110.34148019615284,110.60894573930814,110.88051838048867,111.15603499628413,111.43533835358508,111.71827687396062,112.00470440866349,112.29448002372501,112.58746779463274,112.88353661011266,113.18255998456235,113.48441587870897,113.7889865280877,114.0961582789578,114.40582143129772,114.71787008853347,115.03220201368133,115.34871849159505,115.66732419702919,115.9879270682443,116.31043818589258,116.63477165693766,116.96084450337494,117.28857655552993,117.61789034972486,117.94871103011258,118.28096625448995,118.61458610390818,118.94950299591162,119.28565160124056,119.62296876384426,119.96139342405799,120.30086654480358,120.641331040681,120.98273170982495,121.32501516840577,121.6681297876608,122.01202563334694,122.35665440751045,122.7019693924758,123.04792539695865,123.39447870421428,123.74158702213499,124.08920943521467,124.43730635830434],[111.4801758904934,110.8906017726393,110.34052134316057,109.82817707604578,109.35190054758242,108.91010719950104,108.50129145418634,108.12402215529112,107.77693830933573,107.45874510591158,107.16821019595707,106.90416020925603,106.66547749384011,106.45109706136917,106.26000372383403,106.09122940808847,105.94385063576854,105.81698615713337,105.70979472823772,105.62147302166159,105.55125366176122,105.49840337608407,105.46222125521837,105.4420371139138,105.43720994684089,105.44712647283663,105.47119976192924,105.50886793984564,105.55959296507898,105.62285947394456,105.69817368936967,105.78506238946102,105.88307193216582,105.99176733259377,106.11073138980251,106.23956386006478,106.37788067383222,106.52531319380118,106.68150751165392,106.846123781207,107.01883558585065,107.19932933829463,107.3873037107674,107.58246909393154,107.78454708289001,107.99326998875826,108.20838037437422,108.42963061280581,108.65678246739895,108.88960669218569,109.1278826515436,109.37139795806615,109.61994812766369,109.87333625097625,110.13137268023124,110.39387473073231,110.66066639621084,110.93157807732001,111.20644632258889,111.4851135811963,111.76742796695875,112.05324303296378,112.34241755630802,112.63481533243505,112.93030497859043,113.22875974594271,113.53005733994266,113.83407974851464,114.14071307769879,114.44984739438181,114.76137657577435,115.07519816531064,115.39121323466425,115.70932625158858,116.02944495330848,116.35148022520045,116.67534598451596,117.00095906891229,117.32823912956952,117.65710852868219,117.98749224112615,118.31931776010993,118.65251500663055,118.98701624256323,119.32275598722063,119.65967093722821,119.99769988956814,120.33678366765263,120.67686505029201,121.01788870343316,121.35980111454634,121.70255052954687,122.04608689214162,122.39036178549674,122.73532837612863,123.08094135992192,123.42715691018633,123.7739326276662,124.12122749242006,124.46900181749433],[111.6182831022153,111.02596065084794,110.47321311672056,109.95827980404326,109.47948927244677,109.03525409133591,108.6240659468926,108.2444910750211,107.89516599577873,107.57479352687228,107.28213905565624,107.01602705075081,106.77533779593303,106.55900433034915,106.36600958036833,106.19538366956019,106.04620139433838,105.91757985378067,105.80867622302083,105.71868566042107,105.64683933947371,105.59240259706226,105.55467319033788,105.53297965503761,105.5266797585989,105.53515904191096,105.55782944398277,105.59412800422496,105.64351563741366,105.70547597675746,105.77951428080569,105.86515640023535,105.96194780082649,106.06945263918723,106.18725288802665,106.31494750798673,106.45215166324708,106.59849597829984,106.75362583346573,106.91720069688047,107.08889349082899,107.26838999044199,107.45538825289741,107.64959807538794,107.85074048022412,108.05854722554871,108.27276034022842,108.4931316815844,108.71942251469805,108.95140311211289,109.18885237282132,109.43155745949221,109.67931345296024,109.93192302305407,110.18919611489682,110.45094964986225,110.71700724041831,110.98719891813542,111.26136087417662,111.53933521162752,111.82096970906093,112.10611759476403,112.39463733108863,112.68639240841772,112.98125114826506,113.2790865150566,113.57977593616251,113.88320112977779,114.18924794026412,114.49780618059515,114.80876948155796,115.12203514738982,115.43750401754052,115.7550803342713,116.07467161581268,116.39618853482148,116.71954480189022,117.04465705387121,117.3714447467959,117.69983005317678,118.02973776349084,118.36109519165568,118.69383208431695,119.02788053377461,119.36317489438669,119.69965170229449,120.03724959832164,120.37590925390791,120.71557329994414,121.05618625838122,121.3976944764927,121.74004606367669,122.0831908306873,122.42708023119137,122.77166730555183,123.11690662674323,123.4627542483083,123.80916765427192,124.15610571092834,124.50352862042482],[111.76771568889887,111.17241952905651,110.61678617642906,110.09905150551249,109.61754081190251,109.17066355713527,108.75690846680966,108.37483895523528,108.02308885210562,107.70035840873844,107.40541056328065,107.13706744596446,106.89420710703484,106.67576045137014,106.48070836508808,106.30807902059784,106.15694534761515,106.02642265863243,105.91566641822034,105.82387014635083,105.75026344667562,105.69411015137378,105.65470657481215,105.63137986882997,105.62348647299412,105.63041065364909,105.65156312603632,105.68637975416736,105.73432032351238,105.79486738191407,105.86752514446086,105.95181845834702,106.04729182402363,106.15350846919674,106.27004947246246,106.39651293358745,106.53251318764137,106.67768006037623,106.83165816241694,106.99410621998942,107.16469644005967,107.34311390789533,107.52905601518731,107.72223191699103,107.92236201585352,108.12917747159837,108.34241973533361,108.56184010633986,108.78719931057414,109.01826709960771,109.25482186888394,109.49665029425155,109.74354698579147,109.99531415801277,110.25176131554987,110.51270495354265,110.77796827193072,111.04738090293513,111.32077865104729,111.59800324487887,111.87890210026724,112.16332809406424,112.45113934806659,112.74219902258035,113.03637511913662,113.33354029190394,113.63357166736863,113.93635067187701,114.241762866654,114.54969778993774,114.86004880588432,115.17271295991866,115.48759084022394,115.80458644507735,116.12360705575665,116.44456311475565,116.76736810906043,117.09193845825152,117.41819340720913,117.74605492320855,118.07544759720656,118.40629854912754,118.73853733696755,119.07209586954586,119.40690832273889,119.74291105904327,120.08004255031823,120.41824330356927,120.75745578963752,121.09762437466932,121.43869525424479,121.78061639005027,122.12333744898413,122.46680974459429,122.8109861807455,123.15582119742248,123.5012707185801,123.84729210195218,124.19384409073935,124.54088676709573],[111.92847365054426,111.32997840726516,110.77124052228586,110.25049218045355,109.76605516594964,109.31633559689924,108.89981901393767,108.51506579593358,108.1607068783163,107.8354397515099,107.53802471883044,107.26728139489721,107.02208542714574,106.80136542443182,106.60410007799324,106.42931546120155,106.27608249559904,106.14351457168877,106.03076531383624,105.93702647945092,105.86152598336695,105.80352603901862,105.76232140864079,105.73723775529102,105.72763009002679,105.73288130805112,105.75240080808977,105.7856231896729,105.8320070233751,105.89103368941443,105.96220628033531,106.04504856379592,106.13910400175723,106.24393482262226,106.35912114311012,106.48426013686687,106.61896524701505,106.76286544003061,106.91560449850765,107.07684035053367,107.24624443354276,107.4235010906548,107.60830699763721,107.80037061874097,107.99941168977826,108.20516072690722,108.41735855968966,108.63575588707199,108.86011285502717,109.0901986546701,109.32579113973144,109.56667646234428,109.81264872615752,110.06350965585237,110.31906828219026,110.57914064177372,110.84354949074806,111.11212403171912,111.38469965320103,111.66111768095026,111.94122514057761,112.2248745308645,112.51192360724197,112.80223517492324,113.09567689120503,113.39212107648471,113.69144453356101,113.99352837481231,114.29825785686826,114.60552222240963,114.91521454875348,115.22723160289746,115.54147370271453,115.85784458400676,116.17625127314064,116.49660396500293,116.81881590602643,117.14280328205339,117.4684851108092,117.79578313877745,118.1246217422734,118.45492783252524,118.78663076458231,119.11966224987687,119.45395627227718,119.78944900747446,120.12607874555822,120.46378581663693,120.80251251937197,121.14220305229739,121.48280344780289,121.82426150866763,122.16652674703207,122.50955032570553,122.85328500170942,123.19768507195982,123.54270632100177,123.88830597070705,124.2344426318532,124.58107625750708],[112.10055698715136,111.49863728547372,110.9365761542912,110.41260182886622,109.92503233458817,109.47227021062751,109.05279758827659,108.66517159711603,108.30802007441076,107.98003755518663,107.67998152230537,107.40666889754894,107.15897275626558,106.9358192495343,106.73618471908381,106.55909299137133,106.40361283828982,106.26885559294968,106.15397290986854,106.05815465972138,105.98062694954768,105.92065025999688,105.87751769182412,105.85055331442068,105.8391106096967,105.84257100511712,105.86034249014331,105.89185831074158,105.93657573700189,105.99397489925853,106.0635576884289,106.14484671658202,106.23738433402724,106.34073169946376,106.45446789996957,106.57818911782518,106.71150784136827,106.85405211726274,107.00546484173778,107.16540308851344,107.33353747127818,107.50955153872046,107.693141200247,107.88401418063779,108.08188950199823,108.28649699147546,108.49757681329662,108.71487902378088,108.93816314805717,109.16719777730005,109.40176018536393,109.64163596377026,109.88661867405828,110.13650951657287,110.39111701481818,110.6502567145552,110.91375089687024,111.1814283044873,111.45312388063769,111.72867851984169,112.00793882999207,112.29075690516471,112.57699010861484,112.86650086544628,113.1591564644704,113.454828868799,113.75339453473948,114.05473423858382,114.35873291090704,114.66527947801079,114.97426671016537,115.28559107632604,115.59915260501215,115.91485475105944,116.2326042679646,116.55231108556329,116.87388819278846,117.19725152527671,117.52231985759605,117.8490146998836,118.17726019869124,118.5069830418489,118.83811236716116,119.17057967476775,119.50431874300145,119.83926554758801,120.17535818404137,120.51253679311066,120.8507434891477,121.18992229126538,121.53001905716677,121.87098141952872,122.21275872483105,122.55530197452512,122.89856376844368,123.24249825035515,123.58706105557341,123.9322092605365,124.27790133426977,124.62409709165884],[112.28396569872018,111.67839616368235,111.11279307244489,110.58538045075073,110.09447231781806,109.63846739832046,109.21584418982631,108.82515635878265,108.46502844038912,108.1341518197688,107.83128097370565,107.55522995391969,107.30486909439453,107.07912192667769,106.87696228835989,106.69741161110707,106.53953637568762,106.40244572241507,106.28528920631724,106.18725468716225,106.10756634521789,106.0454828143084,106.00029542436189,105.97132654621898,105.95792803200391,105.95947974484693,105.97538817219676,106.00508511737333,106.04802646439268,106.10369101144644,106.17157936874175,106.25121291670546,106.3421328208337,106.44389909972125,106.55608974304067,106.67829987646208,106.81014097070084,106.95124009207277,107.10123919210731,107.2597944339286,107.42657555326598,107.60126525209212,107.78355862301683,107.97316260268131,108.1697954525134,108.37318626530293,108.58307449615451,108.79920951646643,109.02135018966418,109.24926446749751,109.48272900578129,109.72152879852969,109.96545682949389,110.21431374017428,110.46790751343349,110.72605317188716,110.98857249029743,111.25529372123968,111.52605133335726,111.80068576155324,112.07904316851054,112.36097521696493,112.6463388521852,112.93499609414948,113.22681383893254,113.52166366884684,113.81942167090429,114.11996826319123,114.42318802877021,114.72896955674115,115.03720529012018,115.34779138020438,115.66062754711693,115.97561694623538,116.29266604022853,116.61168447643676,116.93258496934635,117.25528318792158,117.5796976475698,117.90574960652683,118.23336296646028,118.56246417709843,118.89298214470416,119.22484814421854,119.55799573491183,119.8923606793841,120.22788086576782,120.56449623299058,120.90214869896457,121.24078209157341,121.58034208233646,121.92077612263364,122.26203338238123,122.60406469105311,122.94682248094841,123.29026073260842,123.63433492229498,123.97900197144038,124.32422019798921,124.66994926955114],[112.47869978525077,111.86925504189094,111.29989127674702,110.76882804610689,110.27437511563939,109.81492715997776,109.38895881858697,108.99502008093344,108.6317319762513,108.29778254525627,107.99192307303116,107.71296456400943,107.45977444153242,107.23127345586177,107.02643278582143,106.84427132040885,106.68385310779246,106.54428496008494,106.42471420318229,106.32432656177345,106.24234417037756,106.17802370195326,106.13065460625425,106.09955745068592,106.08408235694847,106.08360752724069,106.09753785425033,106.12530360956829,106.16635920554749,106.22018202597805,106.2862713212738,106.36414716416613,106.45334946217667,106.55343702339469,106.66398667232365,106.78459241277791,106.91486463501278,107.05442936446066,107.20292754961628,107.36001438677917,107.52535867950606,107.69864223076998,107.87955926594658,108.06781588487164,108.26312954132399,108.46522854838963,108.67385160826319,108.88874736512875,109.10967397984825,109.33639872526255,109.56869760098351,109.80635496662241,110.04916319246423,110.29692232665653,110.54943977803624,110.80653001376974,111.06801427102934,111.33372028197628,111.60348201135987,111.87713940608475,112.15453815613314,112.43552946626519,112.71996983795292,113.00772086103279,113.29864901459165,113.59262547662819,113.88952594205529,114.18923044863506,114.49162321045777,114.79659245860074,115.10403028861758,115.41383251453266,115.72589852902881,116.04013116953465,116.35643658993237,116.67472413762336,116.99490623570014,117.31689826998786,117.64061848073032,117.96598785870738,118.29293004558033,118.62137123827398,118.95124009721137,119.28246765822911,119.61498724800822,119.9487344028625,120.28364679073742,120.61966413627668,120.95672814882262,121.29478245322136,121.63377252331195,121.97364561798221,122.31435071968248,122.65583847528946,122.9980611392234,123.34097251871974,123.68452792116643,124.02868410341893,124.37339922301133,124.71863279118359],[112.68475924674306,112.07121392009958,111.49787076719761,110.96294461493491,110.46474072805204,110.00164949559966,109.57214147455851,109.17476276356838,108.8081306819974,108.47092973164918,108.16190782028184,107.87987272781828,107.62368879767928,107.39227383708682,107.1845962114684,106.99967211927668,106.83656303460427,106.69437330595933,106.57224790046371,106.46937028355495,106.38496042502675,106.31827292293147,106.26859523750117,106.23524602782153,106.21757358453034,106.21495435229829,106.22679153630384,106.25251378732629,106.29157396046637,106.34344794285344,106.40763354602507,106.48364945896419,106.57103425805602,106.66934547048405,106.77815868781833,106.89706672677241,107.02567883430423,107.16361993442636,107.31052991426473,107.46606294706513,107.62988684999863,107.80168247475399,107.98114312903623,108.16797402720883,108.36189176842971,108.56262384073565,108.76990814962282,108.98349256976778,109.20313451860928,109.42860055059518,109.65966597097071,109.89611446804848,110.13773776296924,110.38433527601963,110.63571380862645,110.89168724020274,111.1520762390662,111.41670798669716,111.68541591464549,111.95803945343641,112.23442379285974,112.51441965306537,112.79788306591813,113.08467516609632,113.37466199144761,113.66771429214295,113.96370734819251,114.26252079491481,114.56403845596986,114.86814818358967,115.17474170565782,115.48371447931066,115.79496555074789,116.10839742095726,116.42391591707619,116.74143006912317,117.06085199184996,117.38209677147567,117.70508235707767,118.029729456425,118.35596143605153,118.68370422537539,119.01288622468256,119.34343821679951,119.67529328229077,120.0083867180234,120.34265595895032,120.67804050296895,121.01448183872184,121.35192337620936,121.69031038009327,122.02958990557465,122.36971073673475,122.71062332723403,123.05227974326876,123.39463360868915,123.73764005218779,124.08125565647198,124.42543840933638,124.77014765655679],[112.90214408319713,112.28427279830822,111.70673154379656,111.16773015723463,110.66556915505609,110.19863440518596,109.76539215774091,109.36438440668748,108.99422455762722,108.65359337894731,108.34123521545779,108.05595444534598,107.79661216283527,107.56212307035254,107.3514525653008,107.16361400771052,106.99766615612303,106.85271076003825,106.72789029816161,106.62238585250685,106.53541510916527,106.466230477243,106.41411731810263,106.37839227762575,106.35840171474953,106.35352022001982,106.36314921835738,106.3867156506474,106.42367072914924,106.47348876207255,106.5356660429956,106.60971980109943,106.69518720847191,106.79162444098948,106.89860578952488,107.01572281844578,107.14258356857506,107.27881180196997,107.42404628605259,107.57794011478654,107.74016006474355,107.91038598404413,108.08831021228592,108.27363702969271,108.4660821338308,108.66537214234087,108.87124412023333,109.08344513038358,109.30173180594718,109.52586994349542,109.75563411574294,109.99080730280789,110.23118054100911,110.47655258826367,110.72672960520408,110.98152485118632,111.24075839440803,111.50425683540215,111.77185304321411,112.04338590360808,112.31870007869047,112.59764577736568,112.88007853608077,113.16585900933994,113.45485276950048,113.74693011539125,114.04196588931593,114.3398393020307,114.64043376530638,114.94363673170787,115.24933954124079,115.55743727453864,115.86782861227401,116.18041570050318,116.49510402165983,116.81180227093603,117.13042223779559,117.45087869238493,117.7730892766118,118.09697439967985,118.42245713787374,118.74946313840277,119.07792052711795,119.40775981992975,119.73891383775926,120.07131762486665,120.40490837040645,120.73962533306742,121.07540976866223,121.41220486053726,121.7499556526804,122.08860898541077,122.42811343353814,122.76841924688699,123.10947829308451,123.45124400251648,123.79367131535892,124.13671663059964,124.48033775696406,124.82449386567028],[113.13085429461286,112.50843167651679,111.92647360654396,111.38318467300604,110.87686039665159,110.40588188873687,109.96871086813418,109.56388501029066,109.19001360314087,108.84577348715086,108.52990525855905,108.24120971659281,107.97854453700016,107.74082115565919,107.52700184731862,107.33609698571033,107.16716247234883,107.01929732232173,106.89164139627586,106.78337326862916,106.69370822279328,106.6218963648879,106.56722084805862,106.52899620009859,106.50656674760606,106.49930513040528,106.50661090041081,106.52790919953161,106.56264951159613,106.61030448363543,106.67036881218527,106.74235819057202,106.82580831342418,106.92027393491088,107.02532797744311,107.14056068779784,107.26557883782539,107.40000496709135,107.54347666497986,107.69564588994336,107.85617832374076,108.02475275864032,108.20106051569542,108.38480489232344,108.57570063752713,108.77347345320533,108.97785952009474,109.18860504697609,109.4054658418621,109.62820690396322,109.8566020353,110.09043347090055,110.32949152658369,110.57357426338859,110.82248716776921,111.07604284672043,111.3340607370547,111.5963668280914,111.86279339706549,112.13317875659982,112.40736701362522,112.68520783916591,112.96655624844087,113.25127239076373,113.5392213487502,113.83027294637303,114.12430156542563,114.42118596998279,114.72080913846736,115.02305810295515,115.3278237953666,115.6350009002163,115.94448771360726,116.25618600817236,116.57000090368348,116.885840743062,117.20361697353725,117.52324403271568,117.84463923933282,118.16772268847181,118.49241715104699,118.81864797735598,119.14634300451755,119.47543246761984,119.80584891441387,120.13752712339233,120.47040402510584,120.80441862657203,121.13951193864375,121.47562690620514,121.81270834107343,122.15070285749083,122.48955881009273,122.82922623424824,123.16965678867059,123.51080370020181,123.85262171068007,124.19506702580176,124.53809726589465,124.88167141852418],[113.37088988099038,112.74369055472543,112.15709695543977,111.60930816224918,111.09861445283845,110.62339194625223,110.18209760573843,109.77326457437808,109.39549781853836,109.0474700562598,108.72791794958562,108.43563854155857,108.16948592017413,107.92836809300663,107.71124405752197,107.51712105327626,107.34505198328165,107.19413299280966,107.06350119480659,106.95233253192168,106.85983976591069,106.78527058586604,106.72790582736923,106.68705779524011,106.66206868309987,106.6523090834545,106.65717658246434,106.67609443397897,106.70851030780705,106.75389510754204,106.81174185359427,106.88156462738182,106.96289757291288,107.05529395224822,107.1583252515732,107.27158033482868,107.39466464205498,107.5271994297907,107.66882105104654,107.81918027253559,107.97794162699043,108.14478279854269,108.31939403926503,108.50147761510095,108.69074727951865,108.88692777332911,109.08975434920704,109.29897231954537,109.51433662635401,109.73561143199849,109.9625697296419,110.19499297232665,110.43267071969304,110.6754003013944,110.92298649632173,111.17524122680503,111.43198326700623,111.69303796476493,111.95823697620007,112.22741801241165,112.50042459766402,112.77710583846614,113.05731620299846,113.34091531036768,113.62776772919682,113.91774278508829,114.21071437652155,114.50656079877086,114.80516457545275,115.10641229733181,115.41019446803517,115.7164053563439,116.02494285474769,116.3357083439649,116.64860656314713,116.96354548550111,117.28043619907469,117.599192792468,117.9197322452407,118.24197432280107,118.56584147557142,118.89125874223518,119.21815365688113,119.54645615986981,119.87609851225456,120.20701521360041,120.53914292304837,120.87242038348285,121.20678834866668,121.54218951321299,121.87856844527226,122.21587152181451,122.55404686639831,122.89304428931781,123.232815230027,123.57331270174515,123.91449123815111,124.25630684207844,124.59871693612799,124.9416803151186],[113.62225084232969,112.99004943293409,112.39860159048399,111.84610062496418,111.33083132361661,110.85116457773209,110.40555237055351,109.99252309894963,109.61067720381969,109.25868308627396,108.93527328853739,108.63924092024341,108.3694363123571,108.12476388239484,107.90417919591067,107.70668621040815,107.53133468892148,107.37721777150215,107.24346969375357,107.12926364238467,107.03380973851759,106.9563531401776,106.89617225603432,106.85257706305025,106.82490752123101,106.81253207916768,106.81484626451781,106.83127135398944,106.86125311778203,106.9042606337924,106.95978516722235,107.0273391115289,107.10645498693809,107.19668449300157,107.29759761191495,107.40878175953831,107.52984098126412,107.66039519006782,107.80007944425272,107.94854326256315,108.10544997449242,108.27047610375114,108.44331078299449,108.62365519802526,108.81122205980553,109.00573510271205,109.20692860757023,109.4145469480914,109.62834415942291,109.84808352760145,110.07353719876882,110.30448580708601,110.54071812033712,110.78203070228112,111.02822759086168,111.27911999144008,111.53452598426269,111.79427024542261,112.05818378061745,112.32610367104358,112.59787283080702,112.8733397752664,113.15235839975342,113.43478776815174,113.72049191084027,114.00933963153709,114.30120432260374,114.59596378839518,114.89350007626261,115.19369931483769,115.49645155924637,115.80165064292126,116.10919403569515,116.41898270788073,116.73092100005063,117.0449164982533,117.36087991440814,117.67872497164169,117.99836829433525,118.31972930266735,118.64273011144692,118.96729543304035,119.29335248420891,119.62083089667956,119.94966263128129,120.27978189549103,120.61112506423424,120.94363060379983,121.2772389987306,121.61189268156087,121.94753596527694,122.28411497838194,122.62157760245503,122.9598734120958,123.29895361715384,123.63877100714653,123.97927989777206,124.32043607942974,124.66219676766417,125.00452055545342],[113.88493717863066,113.24750831114264,112.65098751167666,112.09356206115086,111.57351100898619,111.08919978317645,110.63907516257942,110.22166058400542,109.83555175898492,109.47941257719353,109.15197127541443,108.85201685264721,108.57839571354906,108.33000852382389,108.10580726248497,107.90479245710604,107.72601058926817,107.56855165839917,107.431546893117,107.31416660001793,107.21561814061391,107.13514402782242,107.07202013405404,107.02555400352904,106.99508326199944,106.97997411754478,106.97961994657139,106.99343995956302,107.02087794152098,107.06140106238657,107.11449875306978,107.17968164301331,107.25648055549971,107.34444555717089,107.44314505846852,107.55216496192676,107.67110785545275,107.79959224792282,107.93725184459828,108.08373486002617,108.2387033662468,108.40183267426579,108.57281074688395,108.75133764109644,108.93712497838776,109.12989544135434,109.32938229518429,109.53532893261404,109.7474884410689,109.96562319077194,110.18950444268067,110.41891197517873,110.65363372851594,110.89346546604865,111.1382104513891,111.38767914062571,111.64168888882399,111.90006367006457,112.16263381031787,112.42923573249543,112.699711713054,112.97390964956659,113.25168283870592,113.53288976411604,113.81739389368073,114.10506348571937,114.395771403672,114.68939493885554,114.98581564089699,115.28491915547278,115.58659506900048,115.8907367599484,116.19724125644983,116.50600909991985,116.81694421439414,117.12995378131862,117.44494811953747,117.76184057023701,118.08054738661681,118.40098762807099,118.72308305867344,119.0467580497714,119.37193948650086,119.69855667804903,120.02654127149403,120.35582716906399,120.68635044866336,121.01804928752296,121.3508638888356,121.68473641124866,122.01961090108736,122.35543322719322,122.69215101826293,123.02971360258202,123.36807195005096,123.70717861640593,124.04698768954289,124.38745473785548,124.72853676050313,125.07019213952861],[114.15894888989341,113.51606718935123,112.91425471901765,112.35169247080921,111.82665350894716,111.33749756258527,110.88266598181623,110.46067702954525,110.07012148403385,109.70965852901858,109.37801191021673,109.07396633877002,108.79636412375001,108.54410201729375,108.3161282572446,108.11143979337,107.92907968432198,107.76813465350072,107.62773279289681,107.50704140482158,107.40526497219969,107.32164324880068,107.25544946142827,107.20598861667642,107.17259590540526,107.15463519858579,107.15149762862487,107.16260025069968,107.18738477902401,107.22531639332443,107.2758826111364,107.33859222183494,107.41297427859774,107.4985771447562,107.59496759123384,107.7017299419939,107.81846526462063,107.94479060335571,108.08033825208329,108.22475506492465,108.37770180225351,108.53885251008649,108.70789393093337,108.88452494431436,109.06845603526513,109.25940878925589,109.45711541204926,109.66131827311351,109.87176947129177,110.08823042150993,110.31047146137738,110.53827147660481,110.77141754422955,111.00970459269713,111.25293507790397,111.5009186743619,111.75347198069029,112.01041823869072,112.27158706530136,112.53681419676744,112.80594124440506,113.07881546136687,113.35528951985577,113.63522129826038,113.918473677718,114.2049143476351,114.49441561972667,114.78685425015198,115.08211126935566,115.3800718192372,115.68062499729733,115.98366370742548,116.28908451701156,116.5967875200824,116.90667620617758,117.21865733469708,117.53264081446268,117.84853958825374,118.16626952208506,118.48574929901163,118.80690031725109,119.12964659242834,119.45391466375693,119.77963350397845,120.10673443289292,120.43515103431936,120.76481907633566,121.09567643465226,121.42766301898199,121.76072070227642,122.09479325270365,122.42982626824822,122.76576711382189,123.10256486077667,123.44017022871846,123.77853552952334,124.11761461346366,124.45736281735586,124.7977369146448,125.13869506734436],[114.4442859761179,113.79572606755987,113.18840321250718,112.62049185393941,112.09025882349952,111.59605791595864,111.13632482826397,110.70957243556936,110.31438637896676,109.94942094174887,109.61339519294432,109.30508937861183,109.02334154295995,108.76704436280454,108.53514218018972,108.32662821919997,108.14054197408268,107.97596675680671,107.83202739309304,107.7078880567956,107.60275023327488,107.51585080311222,107.44646023815709,107.3938809024925,107.35744545144831,107.33651532229065,107.33047931067841,107.33875222739951,107.36077363029094,107.39600662660608,107.44393674142219,107.50407084799394,107.57593615623234,107.65907925575739,107.75306521021095,107.85747669973988,107.97191320876806,108.09599025636636,108.22933866670776,108.37160387725852,108.52244528251268,108.68153561121333,108.84856033514271,109.02321710767907,109.20521523043783,109.39427514641669,109.59012795816516,109.79251496958966,110.00118725009155,110.21590521981557,110.43643825485903,110.66256431136416,110.89406956747793,111.13074808222642,111.37240147040626,111.61883859264849,111.86987525986137,112.12533395130117,112.38504354556768,112.64883906385954,112.91656142486013,113.1880572106671,113.46317844320311,113.74178237058501,114.023731262952,114.3088922172843,114.59713697076747,114.88834172228462,115.18238696163887,115.47915730613086,115.77854134413697,116.08043148535234,116.3847238173804,116.69131796836812,117.00011697540091,117.31102715838864,117.62395799918389,117.93882202569195,118.25553470074014,118.57401431548958,118.89418188717983,119.2159610610113,119.53927801597716,119.86406137446775,120.19024211547782,120.51775349125712,120.84653094725131,121.17651204518783,121.50763638916948,121.83984555464421,122.17308302012582,122.50729410154702,122.84242588913192,123.17842718667964,123.51524845315629,123.85284174649868,124.1911606695343,124.53016031793075,124.86979723008932,125.21002933890047],[114.7409484373041,114.08648494576845,113.47343299214506,112.89996021054131,112.36432695264331,111.86488084329646,111.40005170192256,110.96834680207743,110.56834644378338,110.19869981538447,109.85812112359713,109.54538597217272,109.25932797117893,108.99883556035593,108.76284903132029,108.55035773459592,108.36039745855051,108.1920479683173,108.04443069370568,107.91670655593998,107.80807392383959,107.71776669075713,107.64505246424039,107.58923086097715,107.54963190012877,107.52561448865941,107.51656499273192,107.52189588966236,107.5410444953221,107.57347176223141,107.6186611439272,107.67611752149007,107.7453661884033,107.82595189017465,107.91743791539986,108.01940523516458,108.13145168789488,108.25319120695494,108.38425308847161,108.52428129702781,108.67293380702412,108.82988197764631,108.99480995951198,109.16741413119055,109.34740256390576,109.53449451283679,109.72841993353188,109.92891902204259,110.1357417774684,110.34864758568875,110.56740482312553,110.79179047945691,111.0215897982611,111.25659593463668,111.49660962889594,111.7414388954857,111.99089872633733,112.24481080789565,112.50300325111701,112.76531033377161,113.03157225441934,113.30163489746725,113.5753496087479,113.85257298108971,114.13316664938311,114.41699709466712,114.70393545679454,114.99385735525333,115.28664271774649,115.58217561615373,115.88034410951934,116.181040093729,116.48415915755639,116.78960044477725,117.09726652206429,117.40706325239334,117.71889967370099,118.03268788255166,118.34834292258213,118.66578267750471,118.98492776845963,119.30570145552011,119.62802954316145,119.95184028951685,120.27706431924881,120.60363453987742,120.93148606141017,121.2605561191295,121.59078399939817,121.92211096835199,122.25448020335379,122.58783672708957,122.92212734419316,123.25730058029096,123.59330662336461,123.93009726733213,124.26762585775478,124.60584723958031,124.94471770683667,125.28419495419706],[115.04893627345206,114.38834382397707,113.76934405793139,113.19009754061491,112.6488578963785,112.14396634459884,111.67384660279205,111.23700012906983,110.83200167848389,110.45749514992544,110.11218970217517,109.79485611945246,109.50432340840699,109.23947560994831,108.9992488106363,108.78262833955795,108.58864613772523,108.41637828803236,108.26494269473471,108.13349690225473,108.02123604389367,107.92739091173523,107.85122613967815,107.79203849213049,107.74915525144654,107.7219326976921,107.7097546747854,107.71203123748847,107.72819737411717,107.7577118002005,107.80005581865143,107.85473224232366,107.92126437511077,107.99919504800793,108.08808570680048,108.18751554826808,108.29708070200114,108.41639345512139,108.54508151737485,108.68278732423251,108.8291673757879,108.98389160938535,109.14664280404125,109.31711601484889,109.49501803566898,109.68006688851604,109.87199133814964,110.07053043047217,110.27543305342223,110.48645751912952,110.70337116617709,110.92594998088292,111.15397823657892,111.38724814992784,111.62555955337314,111.86871958287333,112.1165423801183,112.36884880847452,112.62546618194938,112.88622800650379,113.15097373308262,113.41954852176754,113.6918030164901,113.96759312977461,114.24677983701106,114.52922897978337,114.81481107780773,115.1034011490582,115.39487853767857,115.68912674930593,115.98603329344449,116.28548953255554,116.58739053753955,116.89163494930952,117.19812484616749,117.50676561671121,117.81746583801407,118.13013715883277,118.44469418761092,118.76105438505702,119.0791379610905,119.39886777595486,119.72016924531002,120.04297024912579,120.36720104420581,120.69279418018009,121.01968441881223,121.34780865647731,121.67710584966794,122.00751694339965,122.33898480238764,122.67145414487585,123.00487147900533,123.33918504161048,123.67434473934314,124.01030209202352,124.34701017812529,124.68442358230432,125.02249834488674,125.36119191323401],[115.36824948456177,114.7013027021857,114.07613640986611,113.4909038441603,112.9438516547049,112.4333144198657,111.95770953087236,111.51553241654635,111.10535208306828,110.7258069453718,110.37560092867855,110.05349982045138,109.75832785464398,109.48896451158144,109.24434151813772,109.02344003408594,108.82528801160699,108.64895771595197,108.49356339618009,108.35825909573983,108.24223659343716,108.14472346604681,108.06498126447069,108.00230379595241,107.95601550540155,107.92546994938866,107.91004835683886,107.90915827087753,107.92223226667633,107.94872674051345,107.98812076559493,108.03991501049438,108.10363071635457,108.1788087292571,108.26500858441293,108.36180763905034,108.46880025108671,108.5855970008656,108.71182395341762,108.84712195887258,108.99114598880416,109.14356450643061,109.30405886873046,109.47232275865399,109.64806164572744,109.83099227345464,110.02084217201808,110.21734919487855,110.42026107795307,110.62933502013784,110.84433728401348,111.06504281564231,111.2912348824316,111.52270472809981,111.75925124383771,112.00068065481153,112.24680622120404,112.49744795303752,112.75243233806472,113.01159208205603,113.27476586084994,113.54179808356777,113.81253866642972,114.08684281663969,114.36457082583586,114.64558787263312,114.92976383380721,115.21697310369913,115.50709442143513,115.80001070558725,116.09560889591238,116.3937798018319,116.69441795732978,116.99742148196525,117.30269194771067,117.61013425134213,117.91965649212293,118.23116985453549,118.54458849582645,118.85982943814643,119.17681246507243,119.4954600223155,119.81569712242253,120.13745125329449,120.46065229034892,120.78523241216507,121.11112601945754,121.43826965723127,121.76660193997898,122.09606347978739,122.42659681722718,122.75814635490602,123.09065829356869,123.42408057063844,123.75836280109203,124.09345622057292,124.42931363064562,124.76588934610284,125.10313914423956,125.44102021601144],[115.69888807063315,115.02536158039432,114.39381004794919,113.80237912117745,113.24930822762292,112.73292506909701,112.25164048616371,111.80394366450706,111.38839765753647,111.00363520172345,110.64835480310711,110.32131707516925,110.02134130988996,109.74730226525541,109.49812715382464,109.27279281817994,109.07032308019575,108.88978625207602,108.73029279804177,108.59099313639517,108.4710755724702,108.36976435369171,108.28631783861769,108.22002677244308,108.17021266199394,108.13622624374906,108.11744603889248,108.11327698982984,108.1231491729995,108.14651658317004,108.1828559847575,108.23166582600244,108.29246521213486,108.36479293392225,108.4482065482371,108.54228150751129,108.64661033515178,108.76080184418777,108.88448039659977,109.01728520094807,109.15886964607266,109.3089006687819,109.46705815357963,109.63303436260593,109.8065333940812,109.9872706676524,110.17497243513755,110.36937531526171,110.57022585106087,110.77728008871371,110.99030317663475,111.20906898373499,111.43335973581904,111.66296566915273,111.89768470028973,112.13732211130019,112.38169024959475,112.63060824158485,112.88390171946297,113.14140256042838,113.40294863772138,113.66838358286802,113.93755655856684,114.21032204168488,114.48653961585754,114.76607377321626,115.04879372479294,115.33457321917621,115.62329036901612,115.91482748499794,116.20907091692307,116.50591090155798,116.80524141692717,117.10696004274429,117.41096782669383,117.71716915628615,118.0254716360278,118.33578596965965,118.64802584722888,118.96210783677304,119.2779512804055,119.59547819460217,119.91461317449928,120.23528330202311,120.55741805767803,120.88094923583249,121.20581086334614,121.53193912139155,121.85927227033119,122.18775057751499,122.51731624787264,122.84791335717985,123.17948778788326,123.51198716737474,123.84536080861136,124.17955965298044,124.51453621531589,124.8502445309761,125.18664010489533,125.52367986252931],[116.04085203166636,115.36052045860288,114.72236497218077,114.1245233716663,113.56522761513216,113.04279829229282,112.55563946866577,112.10223387295186,111.68113840188845,111.29097991898047,110.93045132546096,110.59830788360613,110.29336377414499,110.01448887097021,109.76060571769698,109.53068669183999,109.32375134349148,109.13886389640476,108.97513090032007,108.83169902422094,108.70775298099259,108.60251357466993,108.51523586211923,108.44520742160232,108.39174672122364,108.35420158077345,108.33194772094593,108.32438739434524,108.33094809308665,108.35108132817041,108.38426147613949,108.42998468884772,108.48776786245172,108.55714766200347,108.63767959827308,108.72893715365107,108.83051095419631,108.94200798508774,109.06305084692139,109.193277050459,109.33233834759366,109.47990009643932,109.63564065858876,109.79925082670458,109.97043328073026,110.1489020711095,110.33438212750782,110.52660879162148,110.72532737274564,110.93029272485711,111.14126884404108,111.35802848516106,111.58035279674115,111.80803097308655,112.04085992272928,112.27864395233949,112.52119446529029,112.76832967411633,113.01987432614422,113.2756594416207,113.53552206369683,113.79930501966825,114.06685669290144,114.33803080491023,114.61268620707605,114.89068668153287,115.17190075076486,115.45620149548941,115.74346638042155,116.03357708753785,116.32641935647652,116.62188283173401,116.91986091633164,117.22025063164656,117.52295248311694,117.82787033154334,118.13491126972865,118.4439855042053,118.75500624181811,119.06788958093681,119.38255440708963,119.6989222928147,120.01691740154017,120.33646639531156,120.65749834619329,120.97994465118248,121.30373895047794,121.62881704895786,121.95511684072459,122.28257823658261,122.61114309432388,122.94075515169749,123.27135996194876,123.60290483181926,123.93533876190102,124.26861238924583,124.60267793213602,124.9374891369237,125.27300122685381,125.60917085278754],[116.39414136766122,115.70677933681151,115.06180118256076,114.45733659562687,113.8916098172328,113.36293408945308,112.8697064783788,112.41040304188078,111.98357431612426,111.58784109714294,111.22189049574003,110.88447224576196,110.57439524740897,110.29052432872577,110.03177720975478,109.79712165506614,109.58557280149414,109.3961906489379,109.22807770301469,109.08037675921705,108.95226881900446,108.8429711289814,108.75173533497535,108.67784574343023,108.62061768309063,108.57939596046164,108.5535534029994,108.54248948442371,108.54562902693786,108.56242097551456,108.59233723974054,108.63487159903045,108.68953866730496,108.75587291350054,108.83342773452077,108.92177457746966,109.02050210822023,109.1292154235656,109.24753530438242,109.37509750740539,109.51155209336692,109.65656278940294,109.80980638375776,109.97097215095008,110.1397613056746,110.31588648382582,110.49907124912912,110.68904962395804,110.88556564300737,111.08837292856815,111.29723428623221,111.51192131992045,111.73221406519804,111.95790063990114,112.18877691115618,112.42464617792915,112.66531886829078,112.910612250632,113.16035015810843,113.41436272563313,113.67248613877641,113.93456239396848,114.20043906943336,114.46996910631567,114.74301059949157,115.01942659758316,115.29908491172311,115.58185793263867,115.86762245565137,116.15625951320703,116.44765421457278,116.74169559235985,117.03827645554311,117.33729324867217,117.6386459169799,117.94223777711362,118.24797539322527,118.55576845817241,118.8655296795942,119.17717467063785,119.49062184512481,119.80579231695313,120.12260980354523,120.44100053315982,120.76089315589459,121.08221865821474,121.404910280853,121.72890343993045,122.05413565115913,122.38054645699017,122.70807735658107,123.03667173845882,123.36627481576538,123.69683356397223,124.02829666096105,124.36061442936931,124.69373878110603,125.0276231639459,125.362222510115,125.6974931867863],[116.75875607861796,116.06413821502012,115.41211867908915,114.80081879305926,114.22845483392493,113.69333246057801,113.19384151530274,112.728451171294,112.29570540024392,111.89421873621065,111.52267231394441,111.17981016163688,110.86443572968206,110.57540863852212,110.31164162999811,110.07209770785821,109.85578745420393,109.6617665096755,109.48913320612563,109.33702634138352,109.20462308650578,109.09113701662626,108.99581625718596,108.91794173792667,108.85682554759495,108.81180938281375,108.782263085053,108.76758326006536,108.76719197455307,108.7805355252024,108.80708327556087,108.84632655655025,108.89777762669462,108.9609686884137,109.03545095698027,109.12079377896708,109.21658379722362,109.32242415962125,109.4379337689829,109.5627465717871,109.69651088339263,109.8388887476726,109.98955532908677,110.14819833534236,110.3145174689141,110.48822390580149,110.66903980000123,110.85669781227135,111.05094066184607,111.25152069984672,111.45819950320831,111.67074748801312,111.88894354118972,112.11257466959673,112.34143566557056,112.57532878806943,112.81406345859614,113.05745597113193,113.30532921535564,113.55751241246561,113.81384086296001,114.07415570576882,114.3383036881629,114.60613694590133,114.8775127931039,115.1522935213669,115.43034620766741,115.71154253062407,115.99575859470569,116.28287476200535,116.57277549121173,116.86534918343553,117.16048803456192,117.45808789382113,117.75804812828279,118.06027149299703,118.36466400651788,118.67113483156106,118.97959616055707,119.28996310587598,119.60215359451115,119.91608826701751,120.23169038051439,120.54888571556799,120.86760248678186,121.18777125692949,121.50932485447127,121.83219829430918,122.15632870163488,122.48165523873782,122.80811903464392,123.13566311746405,123.4642323493332,123.79377336383355,124.12423450579134,124.45556577335074,124.78771876222598,125.12064661204271,125.45430395467905,125.78864686452548],[117.13469616453628,116.43259709322872,115.77331746176594,115.1549699639633,114.57576266520834,114.03399340566729,113.52804457943756,113.05637826119134,112.61753165424746,112.21011283618371,111.83279678007408,111.48432163123073,111.16348522096409,110.86914180035942,110.60019897842672,110.3556148502163,110.13439530162069,109.93559147861775,109.75829740965301,109.60164777072038,109.46481578349656,109.34701123760448,109.24747862875118,109.16549540509186,109.10037031473672,109.05144184782976,109.01807676710648,108.99966872127004,108.9956369359324,109.005424977234,109.02849958360041,109.06434956140741,109.11248474062066,109.1724349867428,109.24374926565159,109.3259947581431,109.41875602120638,109.52163419325477,109.63424624072279,109.75622424360428,109.88721471767064,110.0268779712484,110.17488749457574,110.33092937988143,110.49470177044897,110.66591433703634,110.84428778012423,111.02955335656142,111.22145242926177,111.41973603869292,111.62416449496931,111.83450698943918,112.05054122471614,112.27205306217319,112.49883618597244,112.73069178276025,112.96742823620635,113.20886083561602,113.45481149788586,113.70510850211818,113.95958623624774,114.21808495506899,114.48045054908972,114.74653432366719,115.0161927879131,115.28928745288403,115.56568463859807,115.84525528944562,116.12787479758454,116.41342283393303,116.70178318639346,116.99284360496091,117.28649565338775,117.58263456709338,117.88115911702572,118.18197147919352,118.48497710960636,118.79008462437122,119.09720568470671,119.40625488665137,119.71714965524846,120.02981014300785,120.3441591324476,120.66012194253589,120.97762633885534,121.29660244732662,121.61698267133281,121.93870161209402,122.26169599215179,122.5859045818253,122.91126812851273,123.23772928871293,123.56523256265199,123.89372423140314,124.2231522963921,124.55346642119018,124.88461787549581,125.21655948121402,125.54924556054584,125.88263188600503],[117.52196162541647,116.81215597143733,116.14539753059113,115.51979010833911,114.93353331108322,114.38491692472107,113.87231567078327,113.39418431157274,112.94905307813475,112.53552339706215,112.15226389412894,111.79800665454364,111.47154372125509,111.17172381423748,110.89744925504093,110.64767308214044,110.42139634374428,110.21766555576444,110.03557031359674,109.8742410472276,109.73284690997676,109.61059379191599,109.5067224496709,109.42050674492569,109.35125198451557,109.29829335550961,109.26099444915999,109.23874586803788,109.23096391107561,109.23708933160937,109.25658616385921,109.28894061360187,109.33366000908326,109.39027180848787,109.45832266053465,109.53737751499797,109.62701878016857,109.72684552446626,109.83647271960216,109.95553052285688,110.08366359620108,110.22053046013038,110.36580288022465,110.51916528456732,110.68031421027906,110.84895777753043,111.02481518949806,111.20761625682813,111.39710094525444,111.59301894510662,111.79512926151526,112.00319982419863,112.21700711577735,112.43633581763055,112.66097847236169,112.89073516200149,113.12541320112152,113.36482684408438,113.60879700569893,113.85715099459078,114.10972225863951,114.36635014186921,114.62687965221409,114.89116123961315,115.15905058391922,115.43040839213471,115.70510020451488,115.98299620910329,116.26397106428766,116.54790372898991,116.83467730011803,117.12417885693624,117.41629931202064,117.71093326848892,118.00797888320855,118.3073377357032,118.60891470249085,118.91261783660279,119.21835825204327,119.52605001296385,119.83561002733693,120.14695794492404,120.46001605934505,120.77470921406362,121.09096471211478,121.40871222940615,121.72788373143764,122.04841339328512,122.37023752270991,122.69329448625287,123.0175246381873,123.3428702522056,123.66927545572211,123.99668616668116,124.32505003276319,124.65431637288765,124.98443612091563,125.31536177145995,125.64704732771551,125.97944825122502],[117.92055246125828,117.20281484964597,116.52835888556471,115.89527922618669,115.30176677154948,114.74610301773939,114.22665478933972,113.74186932243842,113.29026967190597,112.87045041884596,112.48107365610909,112.12086523157555,111.78861123055516,111.48315468015633,111.20339245984046,110.94827240363063,110.71679058057504,110.5079887411157,110.32095191795689,110.15480617090518,110.00871646594642,109.8818846795609,109.77354771994519,109.68297575742803,109.60947055693194,109.55236390585341,109.51101613121348,109.48481470036882,109.47317289998294,109.47552858832853,109.49134301633717,109.52009971313362,109.56130343208228,109.61447915364893,109.67917114162941,109.75494204953165,109.8413720741102,109.93805815325555,110.04461320562093,110.16066540954479,110.28585751898387,110.4198462143185,110.56230148603355,110.71290604940002,110.87135478840446,111.03735422728383,111.21062202812281,111.39088651307164,111.57788620982411,111.77136941908792,111.97109380284613,112.17682599229133,112.38834121437331,112.60542293596869,112.82786252473838,113.05545892579327,113.28801835334151,113.52535399653698,113.76728573879504,114.01363988988342,114.26424893013528,114.51895126616947,114.77759099753594,115.04001769373929,115.30608618112214,115.57565633911886,115.84859290541803,116.12476528959702,116.40404739481545,116.68631744717607,116.97145783238533,117.25935493936142,117.54989901046071,117.84298399800784,118.13850742683134,118.43637026252598,118.73647678517119,119.03873446825585,119.34305386256661,119.64934848481353,119.95753471077651,120.26753167276621,120.57926116120656,120.89264753015128,121.20761760656029,121.52410060316822,121.84202803478559,122.16133363788229,122.48195329330915,122.80382495202034,123.12688856366776,123.45108600794204,123.77636102854322,124.10265916966745,124.42992771490462,124.75811562844319,125.08717349848526,125.4170534827804,125.74770925618797,126.07909596018561],[118.33046867206185,117.60457372785457,116.92220152668689,116.28143731750598,115.68046304660702,115.11755168472222,114.59106193510723,114.09943329378815,113.6411814355609,113.21489390153504,112.81922606601448,112.4528973623265,112.11468774886427,111.80343439811598,111.51802859282553,111.25741281468676,111.02057801211274,110.80656103467146,110.61444222273342,110.44334314175309,110.29242445140547,110.1608839005391,110.04795443957408,109.95290244259913,109.8750260319855,109.81365349886117,109.76814181326698,109.73787521826286,109.72226390265429,109.72074274739138,109.73277014103438,109.7578268600026,109.79541500961773,109.84505702222587,109.90629470893604,109.97868836174408,110.06181590303122,110.15527207962252,110.25866769877904,110.3716289036682,110.49379648601898,110.62482523381269,110.76438331200234,110.91215167437949,111.0678235048252,111.23110368629645,111.40170829599853,111.57936412529182,111.76380822297084,111.95478746063668,112.15205811896186,112.35538549371735,112.56454352050402,112.77931441718781,112.99948834310251,113.22486307413557,113.45524369286649,113.6904422929738,113.93027769717418,114.17457518799615,114.42316625073522,114.67588832796972,114.93258458505507,115.19310368604556,115.45729957952206,115.72503129383654,115.99616274130729,116.27056253092694,116.54810378916756,116.8286639884915,117.11212478319536,117.39837185223638,117.6872947487079,117.97878675564999,118.27274474789401,118.56906905966186,118.86766335764749,119.16843451933049,119.47129251627679,119.77615030220045,120.08292370556707,120.39153132653428,120.70189443803226,121.01393689079869,121.32758502219188,121.6427675686126,121.95941558137693,122.27746234588571,122.59684330394963,122.91749597912775,123.23935990495403,123.56237655592226,123.88648928111536,124.21164324036197,124.53778534281639,124.86486418785663,125.19283000820484,125.52163461517534,125.85123134596309,126.18157501288646],[118.75171025782724,118.01743260606314,117.3269254539573,116.67826438229704,116.06962213625599,115.49926292566951,114.9655371080855,114.46687622562203,114.00178836909976,113.5688538451296,113.16672112384512,112.79410304679641,112.44977327618237,112.13256296811645,111.84135765399604,111.575094315309,111.33275863835743,111.11338243643168,110.91604122792639,110.73985195977124,110.58397086635401,110.44759145485062,110.32994260855746,110.2302868004388,110.14791840967642,110.08216213453272,110.03237149532058,109.99792742172008,109.97823691908964,109.97273180879803,109.98086753795079,110.0021220542089,110.03599474168968,110.0820054142189,110.13969336245438,110.20861645163519,110.28835026693173,110.37848730356755,110.47863619907665,110.58842100522706,110.70748049730653,110.83546751861294,110.9720483581311,111.11690215950573,111.2697203595411,111.43020615456837,111.59807399312517,111.77304909348877,111.95486698469448,112.14327306975315,112.33802220986259,112.53887832847671,112.74561403416949,112.9580102612878,113.17585592745412,113.39894760702836,113.62708921969624,113.86009173339477,114.09777288083617,114.33995688892891,114.58647422043919,114.83716132726997,115.09186041477183,115.35041921653196,115.61269077911879,115.87853325628764,116.14780971218285,116.42038793309294,116.69614024734415,116.97494335293617,117.25667815254818,117.54122959556112,117.82848652676223,118.11834154141549,118.41069084639675,118.70543412711091,119.00247441991969,119.30171798982651,119.60307421317385,119.90645546512457,120.2117770117088,120.51895690622835,120.82791588982207,121.13857729600601,121.45086695900953,121.76471312573949,122.08004637121135,122.39679951729536,122.71490755463125,123.03430756757521,123.35493866204607,123.67674189614634,123.99966021343863,124.32363837876497,124.64862291649851,124.97456205112819,125.30140565007426,125.62910516864494,125.95761359704113,126.28688540932775],[119.18427721855429,118.44139148427179,117.74253066737622,117.08576042055982,116.46924404049633,115.89123674058133,115.3500803082748,114.84419811794019,114.37209047252247,113.93233024962942,113.52355882960104,113.14448228498533,112.79386781250952,112.47054039015772,112.17337964335201,111.90131690549721,111.65333245930915,111.42845294639646,111.22574893353574,111.04433262495985,110.88335571079203,110.74200734249547,110.61951222689544,110.51512883094721,110.42814769000476,110.35788981286818,110.30370517737398,110.26497131074036,110.24109194928913,110.2314957725484,110.23563520708649,110.25298529575241,110.28304262829801,110.32532432962796,110.37936710218446,110.44472631920517,110.52097516581165,110.6077038250904,110.70451870651375,110.81104171422126,110.92690955284638,111.05177306871934,111.18529662441979,111.32715750477881,111.47704535255231,111.63466163209952,111.79971911950257,111.97194141766244,112.15106249499506,112.33682624643717,112.52898607554816,112.72730449656942,112.93155275536969,113.14151046826863,113.35696527779312,113.57771252447165,113.80355493383094,114.03430231780005,114.26977128978123,114.50978499268182,114.75417283924722,115.00277026407018,115.25541848668598,115.5119642851986,115.77225977991243,116.03616222647229,116.30353381804451,116.57424149609506,116.84815676934512,117.12515554051006,117.40511794044377,117.68792816933571,117.97347434462365,118.26164835530427,118.5523457223394,118.84546546487303,119.14090997198778,119.43858487974407,119.73839895325769,120.04026397358568,120.34409462920158,120.64980841184824,120.95732551657596,121.26656874577314,121.57746341701326,121.8899372745487,122.20392040428914,122.51934515211119,122.83614604535404,123.15425971736259,123.47362483494393,123.79418202861402,124.11587382551309,124.43864458487616,124.76244043595099,125.08720921825761,125.41290042409366,125.73946514318902,126.06685600942197,126.39502714950957],[119.62816955424313,118.87645036248036,118.16901716694353,117.50392543229438,116.87932875932813,116.29347312945768,115.74469153567482,115.23139897074236,114.75208774582902,114.30532311503464,113.88973918328224,113.50403507689322,113.14697135784553,112.81736666423984,112.5140945608934,112.23608058525144,111.98229947496779,111.75177256456581,111.54356533956138,111.35678513731884,111.19057898471937,111.04413156347366,110.91666329458799,110.8074285341241,110.71571387297024,110.64083653386753,110.58214285942756,110.5390068853237,110.51082899325253,110.49703463864249,110.49707314844132,110.51041658463325,110.53655866944277,110.57501376845288,110.62531592812634,110.68701796445386,110.75969059967095,110.84292164419104,110.93631522109025,111.03949103065091,111.15208365263865,111.27374188413199,111.40412811086857,111.54291771019869,111.68979848385877,111.84447011888992,112.00664367513095,112.17604109781284,112.35239475387262,112.5354469906887,112.72494971601866,112.92066399799553,113.12235968410467,113.32981503813045,113.54281639411954,113.76115782646553,113.98464083527047,114.21307404618952,114.44627292400925,114.68405949925469,114.92626210715939,115.17271513837042,115.4232588007975,115.67773889204534,115.93600658190293,116.19791820439046,116.46333505889253,116.73212321993324,117.00415335517054,117.27930055121321,117.55744414688215,117.83846757356018,118.12225820229222,118.40870719731633,118.69770937572184,118.9891630729482,119.28297001385187,119.57903518908314,119.87726673652827,120.17757582758422,120.47987655804543,120.78408584339414,121.09012331829412,121.39791124010014,121.70737439620301,122.01844001504044,122.33103768061004,122.6450992503331,122.96055877611812,123.27735242848995,123.59541842364773,123.91469695332556,124.23513011733853,124.55666185869586,124.87923790117388,125.20280568924514,125.52731433026293,125.85271453880772,126.17895858310555,126.50600023343178],[120.08338726489369,119.32260924068902,118.60638495265921,117.93275941750068,117.29987629275126,116.70597209229844,116.14937079028586,115.6284787840288,115.1417801890193,114.68783244134511,114.26526218488868,113.87276142252021,113.5090839121907,113.17304179036279,112.8635024066202,112.57938535457168,112.31965968533351,112.0833412909396,111.86949044600351,111.67720949684808,111.50564068813622,111.35396411778522,111.22139581163502,111.1071859099697,111.01061695857317,110.93100229753081,110.86768454148104,110.82003414547025,110.78744805098,110.76934840708037,110.76518136201535,110.77441592085137,110.79654286512408,110.83107373069383,110.87753984027999,110.93549138738133,111.00449656850962,111.0841407608696,111.17402574280611,111.27376895451602,111.38300279668329,111.50137396485064,111.62854281747715,111.76418277576533,111.90797975346049,112.05963161493962,112.21884766001016,112.38534813394004,112.55886376132727,112.73913530250786,112.92591313127409,113.1189568327549,113.31803482037436,113.52292397087309,113.73340927643348,113.94928351300997,114.17034692401501,114.39640691856327,114.6272777835202,114.86278040864777,115.10274202417548,115.34699595017072,115.59538135710649,115.84774303707228,116.10393118509033,116.36380119004208,116.62721343472673,116.89403310460762,117.16413000482046,117.43737838504563,117.7136567718633,117.9928478082344,118.2748380997679,118.55951806745172,118.84678180654434,119.13652695133659,119.42865454551176,119.72306891784361,120.01967756298571,120.31839102711977,120.61912279824035,120.92178920086593,121.22630929497626,121.53260477898684,121.84059989657878,122.15022134721447,122.46139820017434,122.77406181196112,123.08814574692323,123.40358570095738,123.72031942815732,124.03828667028088,124.3574290889152,124.67769020022375,124.99901531216716,125.3213514640907,125.64464736858204,125.96885335550085,126.29392131809189,126.61980466109441],[120.54993035050595,119.77986811889764,119.05463402452337,118.37226237617865,117.73088664076583,117.12873362910368,116.56411807210772,116.03543755779945,115.54116780209344,115.07985822856098,114.65012783442037,114.25066132186615,113.88020547554477,113.53756576852656,113.2216031805325,112.93123121345801,112.66541309040613,112.42315912551788,112.20352425286205,112.00560570354777,111.82854082104249,111.67150500543006,111.53370977803665,111.41440095848394,111.31285694681335,111.22838710385791,111.1603302235346,111.10805309117985,111.07094912247148,111.04843707786198,111.03995984780867,111.04498330440678,111.06299521534177,111.09350421635069,111.13603883864542,111.19014658798763,111.25539307232785,111.33136117512596,111.41765027166149,111.51387548581646,111.61966698498026,111.73466931087543,111.85854074424573,111.9909527014788,112.13158916135751,112.28014612024857,112.43633107414034,112.59986252604384,112.77046951735878,112.94789118189452,113.13187632131445,113.32218300084762,113.51857816417886,113.72083726649657,113.92874392473482,114.14208958410475,114.36067320006434,114.58430093492122,114.81278586831421,115.0459477208607,115.28361259029575,115.52561269947088,115.771786155613,116.02197672027931,116.27603358947465,116.53381118342715,116.7951689455472,117.05997115011805,117.32808671829483,117.59938904200729,117.87375581538718,118.15106887335851,118.43121403705064,118.71408096571052,118.99956301480678,119.2875571000381,119.57796356696768,119.87068606602564,120.16563143262999,120.46270957219257,120.76183334978643,121.06291848426368,121.36588344662265,121.67064936243352,121.97713991814072,122.28528127107103,122.59500196298185,122.9062328369954,123.21890695776958,123.53295953476467,123.84832784847264,124.16495117947989,124.48277074024286,124.80172960946004,125.12177266893066,125.44284654279421,125.76489953905116,126.08788159326862,126.41174421438116,126.73644043249742],[121.02779881107995,120.2482269971062,119.51376438253592,118.82243430832838,118.17235980337169,117.56175773987353,116.98893338114047,116.45227529205417,115.95025058505145,115.48140047668227,115.04433613187736,114.63773477493112,114.26033604790796,113.91093859873111,113.58839688263026,113.29161816191025,113.01955969018589,112.77122606830079,112.54566676013697,112.34197375741776,112.15927938343823,111.99675422640829,111.8536051937928,111.72907367966694,111.62243383769089,111.53299095284891,111.46007990558803,111.40306372245267,111.36133220772692,111.3343006509874,111.32140860582118,111.32211873529943,111.33591572009585,111.3623052254236,111.40081292322267,111.45098356627273,111.51238011112537,111.58458288696021,111.66718880765627,111.75981062455239,111.86207621752956,111.97362792220633,112.0941218911743,112.22322748733906,112.36062670754984,112.50601363481671,112.6590939175214,112.81958427412447,112.98721202196735,113.16171462884876,113.34283928613978,113.53034250227367,113.72398971551807,113.92355492500108,114.12882033902355,114.3395760397502,114.55561966341864,114.77675609526329,115.00279717839113,115.23356143589379,115.46887380552006,115.70856538627113,115.95247319631687,116.2004399416665,116.45231379505586,116.70794818454581,116.9672015913538,117.22993735646462,117.49602349559358,117.76533252209818,118.03774127745386,118.31313076893237,118.59138601414055,118.87239589209248,119.15605300050917,119.44225351905268,119.73089707821947,120.02188663362921,120.31512834546113,120.61053146280251,120.90800821268351,121.20747369358735,121.5088457732332,121.81204499044001,122.11699446088862,122.4236197866099,122.73184896903261,123.04161232543584,123.35284240865707,123.66547392991191,123.97944368459385,124.29469048092274,124.61115507132169,124.9287800864047,125.24750997146455,125.56729092535579,125.88807084167011,126.2097992521109,126.53242727197308,126.85590754764098]],"x":[0.5,0.50505050505050508,0.51010101010101006,0.51515151515151514,0.52020202020202022,0.5252525252525253,0.53030303030303028,0.53535353535353536,0.54040404040404044,0.54545454545454541,0.5505050505050505,0.55555555555555558,0.56060606060606055,0.56565656565656564,0.57070707070707072,0.5757575757575758,0.58080808080808077,0.58585858585858586,0.59090909090909094,0.59595959595959602,0.60101010101010099,0.60606060606060608,0.61111111111111116,0.61616161616161613,0.62121212121212122,0.6262626262626263,0.63131313131313127,0.63636363636363635,0.64141414141414144,0.64646464646464641,0.65151515151515149,0.65656565656565657,0.66161616161616166,0.66666666666666674,0.67171717171717171,0.6767676767676768,0.68181818181818188,0.68686868686868685,0.69191919191919193,0.69696969696969702,0.70202020202020199,0.70707070707070707,0.71212121212121215,0.71717171717171713,0.72222222222222221,0.72727272727272729,0.73232323232323238,0.73737373737373746,0.74242424242424243,0.74747474747474751,0.7525252525252526,0.75757575757575757,0.76262626262626265,0.76767676767676774,0.77272727272727271,0.77777777777777779,0.78282828282828287,0.78787878787878785,0.79292929292929293,0.79797979797979801,0.80303030303030298,0.80808080808080818,0.81313131313131315,0.81818181818181823,0.82323232323232332,0.82828282828282829,0.83333333333333337,0.83838383838383845,0.84343434343434343,0.84848484848484851,0.85353535353535359,0.85858585858585856,0.86363636363636365,0.86868686868686873,0.8737373737373737,0.8787878787878789,0.88383838383838387,0.88888888888888884,0.89393939393939403,0.89898989898989901,0.90404040404040409,0.90909090909090917,0.91414141414141414,0.91919191919191923,0.92424242424242431,0.92929292929292928,0.93434343434343436,0.93939393939393945,0.94444444444444442,0.94949494949494961,0.95454545454545459,0.95959595959595956,0.96464646464646475,0.96969696969696972,0.97474747474747481,0.97979797979797989,0.98484848484848486,0.98989898989898994,0.99494949494949503,1],"y":[0.5,0.50505050505050508,0.51010101010101006,0.51515151515151514,0.52020202020202022,0.5252525252525253,0.53030303030303028,0.53535353535353536,0.54040404040404044,0.54545454545454541,0.5505050505050505,0.55555555555555558,0.56060606060606055,0.56565656565656564,0.57070707070707072,0.5757575757575758,0.58080808080808077,0.58585858585858586,0.59090909090909094,0.59595959595959602,0.60101010101010099,0.60606060606060608,0.61111111111111116,0.61616161616161613,0.62121212121212122,0.6262626262626263,0.63131313131313127,0.63636363636363635,0.64141414141414144,0.64646464646464641,0.65151515151515149,0.65656565656565657,0.66161616161616166,0.66666666666666674,0.67171717171717171,0.6767676767676768,0.68181818181818188,0.68686868686868685,0.69191919191919193,0.69696969696969702,0.70202020202020199,0.70707070707070707,0.71212121212121215,0.71717171717171713,0.72222222222222221,0.72727272727272729,0.73232323232323238,0.73737373737373746,0.74242424242424243,0.74747474747474751,0.7525252525252526,0.75757575757575757,0.76262626262626265,0.76767676767676774,0.77272727272727271,0.77777777777777779,0.78282828282828287,0.78787878787878785,0.79292929292929293,0.79797979797979801,0.80303030303030298,0.80808080808080818,0.81313131313131315,0.81818181818181823,0.82323232323232332,0.82828282828282829,0.83333333333333337,0.83838383838383845,0.84343434343434343,0.84848484848484851,0.85353535353535359,0.85858585858585856,0.86363636363636365,0.86868686868686873,0.8737373737373737,0.8787878787878789,0.88383838383838387,0.88888888888888884,0.89393939393939403,0.89898989898989901,0.90404040404040409,0.90909090909090917,0.91414141414141414,0.91919191919191923,0.92424242424242431,0.92929292929292928,0.93434343434343436,0.93939393939393945,0.94444444444444442,0.94949494949494961,0.95454545454545459,0.95959595959595956,0.96464646464646475,0.96969696969696972,0.97474747474747481,0.97979797979797989,0.98484848484848486,0.98989898989898994,0.99494949494949503,1],"type":"surface","frame":null},{"z":[104.93242508858232],"x":[0.61751761812201755],"y":[0.78437129136747719],"showscale":false,"type":"scatter3d","mode":"markers","showlegend":false,"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"frame":null},{"colorbar":{"title":"llsurf<br />llsurf","ticklen":2},"colorscale":[["0","rgba(253,244,217,1)"],["0.0416666666666664","rgba(244,227,194,1)"],["0.0833333333333334","rgba(236,210,172,1)"],["0.125","rgba(230,195,152,1)"],["0.166666666666667","rgba(229,180,137,1)"],["0.208333333333333","rgba(229,166,124,1)"],["0.25","rgba(233,153,115,1)"],["0.291666666666667","rgba(234,138,105,1)"],["0.333333333333334","rgba(229,123,98,1)"],["0.375","rgba(216,110,93,1)"],["0.416666666666667","rgba(199,102,94,1)"],["0.458333333333333","rgba(181,98,99,1)"],["0.5","rgba(164,98,103,1)"],["0.541666666666667","rgba(148,96,107,1)"],["0.583333333333334","rgba(133,95,111,1)"],["0.625","rgba(119,94,114,1)"],["0.666666666666667","rgba(106,94,118,1)"],["0.708333333333333","rgba(95,93,120,1)"],["0.75","rgba(81,90,121,1)"],["0.791666666666667","rgba(63,86,121,1)"],["0.833333333333333","rgba(41,75,112,1)"],["0.875","rgba(23,61,96,1)"],["0.916666666666667","rgba(12,46,77,1)"],["0.958333333333334","rgba(6,32,57,1)"],["1","rgba(2,19,38,1)"]],"showscale":false,"z":[[128.65821515364468,127.72679805445392,126.84497804526282,126.01060333692098,125.22163028819374,124.47611707543908,123.77221778689805,123.10817690948716,122.48232417868203,121.89306976453183,121.33889976906922,120.81837201240856,120.33011208666105,119.87280965847899,119.44521500256737,119.04613574989712,118.67443383562838,118.32902263291707,118.00886425984304,117.71296704767042,117.44038315954705,117.19020634956641,116.96156985286503,116.75364439812138,116.56563633445059,116.39678586527583,116.24636538229051,116.11367789311763,115.99805553672911,115.8988581811068,115.81547209800777,115.74730871006138,115.69380340574814,115.65441441811625,115.62862176337626,115.61592623576904,115.6158484553491,115.62792796554346,115.65172237755756,115.68680655888733,115.73277186338004,115.78922540044498,115.85578934117561,115.93210025928298,116.01780850487377,116.11257760923209,116.21608371887579,116.32801505726745,116.44807141265998,116.5759636506474,116.71141325008176,116.85415186109486,117.0039208840404,117.1604710682436,117.32356212950913,117.49296238540197,117.6684484073719,117.84980468884797,118.03682332847741,118.22930372773317,118.42705230215695,118.6298822055476,118.83761306644058,119.05007073626636,119.26708704860229,119.4884995889732,119.71415147467714,119.94389114415067,120.17757215540493,120.41505299309726,120.65619688382185,120.9008716192257,121.1489493865792,121.40030660644743,121.65482377712976,121.91238532554881,122.17287946429219,122.43619805451878,122.7022364744623,122.97089349327459,123.24207114996631,123.51567463721307,123.79161218981011,124.06979497756336,124.35013700242399,124.63255499967343,124.91696834298368,125.2032989531812,125.49147121055239,125.78141187053771,126.07304998266713,126.366316812598,126.66114576712161,126.95747232201327,127.25523395260437,127.55437006696162,127.85482194156425,128.15653265937547,128.45944705020682,128.76351163328218],[128.02619686796831,127.1073569326625,126.23774236073054,125.41521586884004,124.6377476208439,123.90340893768816,123.2103664292641,122.55687651629432,121.94128031302449,121.36199884392875,120.81752856985084,120.30643720101071,119.82735977614132,119.37899498868352,118.96010174249109,118.56949592087949,118.20604735412255,117.86867697165705,117.55635412631143,117.26809407884575,117.00295563197744,116.7600389038779,116.53848323187505,116.33746519777786,116.15619676687081,115.99392353320552,115.84992306434411,115.72350333920512,115.61400127310998,115.52078132454464,115.44323417853693,115.38077550190079,115.33284476593026,115.29890413242329,115.27843739919996,115.27094900153458,115.27596306616317,115.293022514748,115.32168821388801,115.36153816895283,115.41216675919736,115.47318401177593,115.5442149124289,115.62489875075711,115.71488849812941,115.81385021639289,115.92146249566942,116.03741591962847,116.16141255672431,116.29316547598006,116.43239828598493,116.57884469585423,116.73224809697345,116.89236116442116,117.05894547702876,117.23177115509694,117.41061651484685,117.59526773873635,117.78551856082292,117.98116996640023,118.18202990518238,118.38791301734783,118.59864037179483,118.81403921599826,119.03394273688887,119.25818983220944,119.48662489183364,119.71909758855789,119.95546267790792,120.19557980652149,120.43931332869725,120.68653213071653,120.93710946257134,121.19092277674515,121.44785357371781,121.70778725387775,121.97061297554396,122.2362235188165,122.5045151549846,122.77538752124089,123.04874350045743,123.32448910579606,123.60253336993543,123.88278823870597,124.16516846893791,124.44959153033517,124.73597751119654,125.02424902781657,125.31433113740428,125.60615125436775,125.89963906981724,126.19472647415166,126.49134748259233,126.78943816354121,127.08893656964341,127.3897826714383,127.69191829349292,127.99528705291176,128.2998343001253,128.60550706186311],[127.40550395725377,126.49901581087114,125.64138796234664,124.83049737423087,124.0643277680856,123.3409633739017,122.65858309884106,122.01545508358573,121.40993161725068,120.84044438423102,120.30550001855769,119.80367594333188,119.33361647463056,118.89402917092892,118.48368141060028,118.10139718142774,117.74605406732375,117.4165804186017,117.11195269319626,116.83119295719155,116.57336653389723,116.33757979152281,116.12297806023972,115.92874367010288,115.75409410192842,115.59828024379905,115.46058474639763,115.34032047085581,115.23682902325487,115.14947937032633,115.07766653128532,115.02081034107752,114.97835428064887,114.94976437014635,114.93452812123547,114.93215354497893,114.94216821195666,114.96411836153038,114.99756805735788,115.04209838645374,115.09730669926707,115.16280588841289,115.2382237038421,115.32320210237813,115.41739662968045,115.52047583281291,115.6321207017139,115.75202413796622,115.87989044936555,116.01543486888026,116.15838309667308,116.30847086394694,116.46544351744126,116.62905562347962,116.79907059053575,116.97526030934242,117.1574048096267,117.34529193260911,117.53871701845154,117.73748260788743,117.94139815731189,118.15027976664803,118.36394991934644,118.58223723391046,118.80497622637232,119.03200708317939,119.26317544397638,119.4983321938012,119.73733326423536,119.98003944307501,120.22631619211539,120.47603347265726,120.72906557837055,120.98529097516614,121.24459214774588,121.50685545251974,121.77197097659166,122.03983240253567,122.31033687869393,122.58338489474461,122.85888016229957,123.13672950030485,123.41684272502484,123.69913254440831,123.98351445663803,124.26990665267935,124.55822992265266,124.84840756585814,125.14036530429755,125.43403119953767,125.72933557277305,126.02621092794904,126.32459187781407,126.62441507277758,126.92561913245271,127.22814457977309,127.53193377757142,127.83693086752247,128.1430817113465,128.45033383418439],[126.79613642150092,125.90177468907972,125.05591485011118,124.25644785309342,123.50137072991851,122.78878038407984,122.11686779562889,121.48391261136128,120.88827809136072,120.32840638543875,119.80281411518982,119.31008823937209,118.84888218212875,118.41791220521505,118.0159540068949,117.64183953154209,117.294453975232,116.97273297375079,116.67565996049737,116.40226368270763,116.15161586530648,115.92282901250097,115.71505433795889,115.52747981509651,115.35932833962332,115.20985599705645,115.0783504284511,114.96412928806964,114.86653878716366,114.78495231845166,114.7187691562529,114.66741322759145,114.630331949904,114.60699513128536,114.59689392948279,114.59953986610196,114.61446389272949,114.64121550589059,114.67936190796715,114.72848721138996,114.78819168358908,114.85809103035612,114.93781571541524,115.02701031414595,115.1253328995267,115.23245445849224,115.34805833700932,115.4718397122806,115.60350509058395,115.74277182934799,115.889367682146,116.04303036537297,116.20350714544378,116.37055444541893,116.5439374700302,116.72342984813842,116.90881329171147,117.09987727046605,117.29641870136302,117.49824165219465,117.70515705854552,117.9169824534483,118.13354170909557,118.35466479000272,118.58018751705268,118.80995134188278,119.04380313110532,119.28159495988075,119.52318391438729,119.76843190275775,120.01720547407638,120.26937564504772,120.52481773397699,120.78341120171038,121.0450394992139,121.3095899214749,121.57695346743535,121.84702470567636,122.11970164558996,122.39488561378521,122.67248113549284,122.9523958207396,123.2345402550785,123.51882789467062,123.8051749655241,124.09350036670607,124.38372557735208,124.67577456730591,124.96957371123182,125.26505170604752,125.56213949153478,125.8607701739902,126.16087895278696,126.46240304972213,126.76528164103244,127.06945579196577,127.37486839379983,127.68146410320777,127.98918928387054,128.2979919502462],[126.19809426070972,125.31563356728832,124.48132302402419,123.69306730542775,122.94887650634287,122.24685996822238,121.58522051962761,120.96224909962098,120.37631973535463,119.82588484755176,119.30947085974712,118.82567408913127,118.37315689863601,117.95064409154205,117.55691953137499,117.19082297122249,116.85124707784723,116.53713463710434,116.24747592821501,115.9813062553941,115.73770362620509,115.51578656681257,115.31471206503257,115.13367363275886,114.97189947995551,114.82865079297777,114.70322011050462,114.59492979084652,114.50313056483658,114.42720016892079,114.36654205343976,114.32058416144274,114.28877777369541,114.27059641584034,114.26553482394178,114.27310796490387,114.29285010848184,114.32431394782861,114.3670697657159,114.42070464376165,114.48482171216348,114.55903943760541,114.64299094714835,114.73632338606056,114.8386973076682,114.94978609343077,115.06927540155569,115.19686264257166,115.3322564803792,115.47517635738333,115.62535204240395,115.78252320013232,115.94643898098107,116.11685763023915,116.29354611551219,116.47627977148495,116.66484196110105,116.85902375230719,117.05862360955753,117.26344709932194,117.47330660888316,117.68802107774852,117.90741574104209,118.13132188427512,118.35957660892983,118.59202260831961,118.82850795322049,119.06888588679634,119.31301462836355,119.56075718556978,119.81198117458003,120.06655864788814,120.32436592939047,120.58528345637801,120.84919562812186,121.11599066074314,121.38556044807481,121.65780042823857,121.93260945567285,122.20988967836308,122.48954642003726,122.77148806710026,123.05562596009619,123.34187428949258,123.63014999559617,123.92037267241514,124.21246447529464,124.50635003215987,124.80195635820735,125.09921277389742,125.39805082610231,125.69840421227518,126.00020870751101,126.30340209437512,126.60792409538253,126.91371630801655,127.2207221421782,127.52888675996763,127.83815701769753,128.14848141004839],[125.6113774748804,124.74059244549693,123.91761248408554,123.14035573123383,122.40684509735858,121.71520212632946,121.06364127083731,120.45046454836488,119.87405654923235,119.33287977057012,118.82547025222978,118.35043349260937,117.90644062415228,117.49222482990993,117.10657798404051,116.74834750046882,116.41643337516936,116.10978540866246,115.82740059634899,115.56832067525087,115.33162981659314,115.11645245445743,114.92195124146085,114.74732512308978,114.59180752292502,114.45466463156296,114.33519379255809,114.23272197918655,114.14660435627349,114.07622292173359,114.02098522284581,113.98032314263124,113.95369175202339,113.94056822381123,113.9404508046126,113.95285784138449,113.97732685921363,114.01341368734444,114.06069163060405,114.11875068356862,114.18719678499025,114.2656511101608,114.35374939904148,114.45114131812198,114.55748985410499,114.67247073762866,114.79577189535281,114.92709292883956,115.06614461875147,115.21264845298626,115.36633617744681,115.52694936822512,115.69423902405313,115.86796517794021,116.04789652698156,116.23381007938198,116.42549081779562,116.62273137813264,116.82533174303504,117.03309894926934,117.24584680832484,117.46339563954881,117.68557201518601,117.91220851672773,118.14314350200402,118.37822088248998,118.61728991032193,118.86020497454807,119.1068254061643,119.35701529151105,119.61064329362658,119.86758248117826,120.12771016461109,120.39090773916888,120.65706053446981,120.92605767032455,121.19779191851032,121.47215957022219,121.74906030894249,122.02839708847817,122.31007601593271,122.59400623938691,122.8800998400781,123.16827172887454,123.45843954685438,123.7505235698066,124.04444661648057,124.34013396041992,124.63751324522399,124.93651440308726,125.23706957647559,125.53911304280392,125.84258114198602,126.14741220673639,126.45354649550301,126.76092612792527,127.06949502270643,127.37919883780201,127.68998491282714,128.00180221359105],[125.0359860640127,124.1766513237055,123.36478323029532,122.59831313051156,121.87527650296578,121.19380685840106,120.5521300492578,119.94855895759289,119.38148853299396,118.84939115449376,118.35081229263764,117.88436644980661,117.44873335867761,117.04265442031858,116.66492936489148,116.3144131192813,115.99001286719864,115.69068528842502,115.41543396489939,115.16330694227807,114.93339443647076,114.72482667543566,114.53677186724366,114.36843428608948,114.21905246853188,114.08789751281205,113.97427147461168,113.87750585308963,113.7969601614745,113.73202057689032,113.68209866447111,113.64663017115706,113.62507388488783,113.6169105551982,113.62164187149523,113.63878949554385,113.66789414492483,113.70851472443822,113.76022750263168,113.82262533081118,113.8953169020694,113.97792604802233,114.07009107109444,114.17146411033015,114.28171053883709,114.40050839108574,114.52754781840092,114.66253057108415,114.80516950570066,114.95518811615672,115.11232008727454,115.27630886965109,115.44690727465991,115.62387708852225,115.80698870443834,115.99602077182955,116.190759861795,116.39100014794221,116.59654310179538,116.80719720203673,117.02277765687062,117.24310613884896,117.46801053152744,117.69732468736046,117.93088819627512,118.16854616439389,118.4101490024096,118.65555222313591,118.90461624778955,119.15720622058156,119.41319183121578,119.67244714491837,119.93485043963882,120.20028405008313,120.46863421825758,120.73979095021902,121.01364787874169,121.29010213162741,121.569054205399,121.8504078441304,122.13406992317923,122.4199503375994,122.70796189502406,122.99802021281634,123.29004361929866,123.58395305888052,123.87967200090966,124.17712635208618,124.47624437228181,124.7769565936171,125.07919574265482,125.38289666557634,125.68799625621229,125.99443338680597,126.30214884139382,126.61108525169207,126.92118703538456,127.23240033671091,127.54467296925954,127.85795436087415],[124.47192002810674,123.62381020191422,122.82283526265351,122.06693950326108,121.35417072316426,120.68267416443703,120.05068685488919,119.45653232730503,118.89861568663932,118.3754189993229,117.88549698097086,117.42747296072282,117.0000351022119,116.60193286276809,116.23197367392794,115.88901982765972,115.57198555393478,115.27983427639226,115.01157603386613,114.76626505647558,114.54299748583777,114.34090922974713,114.15917394238103,113.99700112175766,113.85363431677602,113.72834943672505,113.62045315666515,113.52928141255593,113.45419798043937,113.39459313439066,113.34988237831548,113.31950524702013,113.30292417228871,113.29962341000113,113.30910802458955,113.33090292738203,113.36455196561529,113.40961705910985,113.46567738179873,113.53232858548913,113.60918206340097,113.69586425119005,113.79201596330743,113.89729176268514,114.01135936186441,114.13389905380203,114.26460317069996,114.4031755693055,114.54933114122693,114.70279534689479,114.86330377188719,115.03060170441056,115.20444373280152,115.38459336198507,115.57082264788252,115.76291184882757,115.96064909309935,116.16383006173596,116.37225768583887,116.58574185762423,116.8040991545205,117.02715257564927,117.25473129006639,117.48667039617348,117.72281069174288,117.96299845403118,118.20708522948348,118.45492763255976,118.70638715323926,118.96132997278127,119.21962678734771,119.48115263910817,119.74578675447373,120.01341238912066,120.28391667948537,120.5571905004267,120.83312832876902,121.11162811245401,121.39259114504237,121.67592194531994,121.96152814177682,122.24932036173793,122.53921212493431,122.83111974131783,123.12496221292902,123.42066113963682,123.71814062858201,124.01732720715866,124.31814973938086,124.62053934548688,124.92442932463977,125.22975508059255,125.53645405018958,125.8444656345839,126.15373113305492,126.46419367931684,126.77579818021262,127.08849125669444,127.40222118699482,127.71693785189767],[123.9191793671626,123.08206908012284,122.2917685811602,121.54623484948235,120.84352775795419,120.18180404443768,119.55931168773147,118.97438465750145,118.42543801016849,117.91096330505727,117.42952431722922,116.97975302535806,116.56034585475524,116.17006015725835,115.80771091114978,115.47216762560414,115.16235143537796,114.87723237256398,114.61582680324936,114.37719501784338,114.16043896469424,113.96470011739193,113.78915746687295,113.63302563009462,113.49555306765757,113.37602040330199,113.27373883871866,113.18804865758527,113.11831781316837,113.06394059423477,113.0243363643792,112.99894837022046,112.98724261422595,112.98870678822006,113.0028492638957,113.029198136899,113.06730032128544,113.1167206913593,113.17704126810517,113.24786044760246,113.32879226898477,113.41946571966378,113.51952407568034,113.62862427518698,113.746436323187,113.87264272577767,114.0069379522498,114.14902792350355,114.29862952533009,114.45547014520034,114.6192872312848,114.78982787250321,114.96684839847781,115.15011399832885,115.3393983573142,115.53448331037615,115.73515851170858,115.94122111951403,116.15247549516528,116.3687329160318,116.58981130127447,116.81553494994951,117.04573429080266,117.28024564316651,117.51891098840767,117.76157775140202,118.0080985915436,118.25833120281985,118.51213812251339,118.76938654811039,119.02994816202248,119.29369896374784,119.56051910911565,119.83029275628148,120.10290791815312,120.37825632094741,120.65623326859226,120.93673751270218,121.21967112787253,121.50493939204648,121.7924506717255,122.08211631180228,122.37385052980848,122.66757031437926,122.96319532774542,123.26064781207559,123.55985249949757,123.86073652563722,124.16322934652113,124.46726265869665,124.77277032243062,125.07968828785258,125.38795452391801,125.69750895007014,126.0082933704864,126.32025141079968,126.63332845719054,126.9474715977525,127.26262956603277,127.57875268666164],[123.37776408118013,122.55142795833139,121.77158318581517,121.03619916917542,120.34334760733547,119.69119649840263,119.07800454778459,118.50211594818192,117.96195550358162,117.45602407169697,116.98289430141283,116.54120664371226,116.12966561630751,115.74703630378943,115.39214107655708,115.06385651311467,114.76111051152814,114.48287957694015,114.22818627304889,113.99609682638157,113.78571887304011,113.59619933837017,113.42672244071937,113.27650781110006,113.14480872117637,113.03091041254268,112.93412852077218,112.85380758817774,112.78931965966152,112.74006295642268,112.7054606226622,112.68495954075814,112.67802921069975,112.68416068985492,112.70286558941361,112.73367512409465,112.77613921193486,112.82982562118666,112.89431916155107,112.96922091715109,113.05414751882103,113.1487304534437,113.25261540821326,113.36546164783553,113.48694142280489,113.61673940701249,113.75455216305056,113.90008763367837,114.05306465801029,114.21321251107359,114.38027046546733,114.55398737392925,114.73412127168896,114.9204389975535,115.11271583273331,115.31073515647532,115.51428811762268,115.72317332127625,115.93719652977464,116.15617037725941,116.37991409713239,116.60825326174975,116.84101953373639,117.07805042833979,117.31918908626929,117.56428405650637,117.81318908858985,118.06576293391602,118.32186915561199,118.58137594656864,118.84415595524003,119.11008611883729,119.37904750356475,119.65092515156563,119.92560793426071,120.20298841178135,120.48296269821137,120.76543033237178,121.0502941538895,121.33746018431032,121.62683751302528,121.91833818779264,122.21187710964689,122.50737193200055,122.80474296374791,123.10391307619679,123.40480761365643,123.70735430752195,124.01148319370253,124.31712653324637,124.6242187360273,124.93269628735631,125.24249767739748,125.55356333326485,125.86583555368827,126.17925844614049,126.49377786631838,126.80934135988507,127.12589810637357,127.44339886516603],[122.84767417015942,122.03188683654,121.26227907661868,120.53683246234014,119.85363027130819,119.21085152633228,118.60676543504862,118.03972619934652,117.50816816687846,117.0106012992421,116.54560693352187,116.11183381578543,115.70799438686883,115.33286130236134,114.9852641701499,114.66408649019107,114.36826278238527,114.09677588952086,113.84865444326486,113.62297048209012,113.4188372108754,113.23540689268174,113.07186886392039,112.92744766477426,112.80140127733249,112.69301946444737,112.60162220282567,112.5265582043333,112.4672035199185,112.42296022095428,112.39325515316433,112.37753875863304,112.37528396170988,112.38598511490581,112.40915700114329,112.44433388896917,112.49106863756364,112.54893184859181,112.61751106213646,112.69640999413529,112.78524781290963,112.88365845252973,112.99128996090604,113.1078038806309,113.23287466071807,113.36618909750663,113.50744580310221,113.65635469982999,113.81263653926742,113.97602244451431,114.14625347443479,114.32308020868868,114.50626235243477,114.69556835965902,114.89077507413985,115.09166738712486,115.29803791084166,115.50968666702262,115.72642078966693,115.94805424130706,116.17440754209447,116.40530751104993,116.64058701886766,116.88008475169309,117.12364498532791,117.37111736934416,117.62235672062239,117.87722282584825,118.13558025253495,118.39729816815608,118.66225016700041,118.93031410437668,119.20137193782095,119.47530957497312,119.75201672780837,120.03138677292823,120.31331661762641,120.59770657146281,120.88446022309336,121.17348432211126,121.46468866567608,121.75798598970884,122.05329186444945,122.35052459418158,122.64960512093636,122.95045693200039,123.2530059710585,123.55718055281297,123.86291128092508,124.17013096913614,124.47877456542973,124.7887790791038,125.10008351062814,125.41262878416771,125.72635768266056,126.04121478533924,126.3571464075961,126.67410054309219,126.99202680801719,127.31087638741089],[122.32890963410051,121.52344571474859,120.76385625357052,120.04813472897665,119.37437574987227,118.74076912822625,118.14559434952351,117.58721541099537,117.06407600005913,116.57469498769254,116.11766221355597,115.69163454157771,115.29533216643924,114.92753515297413,114.58708019192811,114.27285755683363,113.98380824794944,113.71892131030607,113.47723131389721,113.25781598496908,113.0597939782002,112.88232278032663,112.72459673647595,112.58584519111702,112.46533073612595,112.36234755901586,112.2762198848792,112.20630050605203,112.15196939393961,112.11263238782963,112.08771995588567,112.07668602384521,112.0790068672566,112.09418006337265,112.12172349908465,112.1611744315224,112.21208859817202,112.27403937357479,112.34661696986122,112.42942767855477,112.52209315125066,112.62424971692184,112.73554773375878,112.85565097357309,112.98423603692656,113.12099179725998,113.26561887240474,113.41782912195823,113.57734516910156,113.74389994552263,113.91723625818715,114.0971063767814,114.28327164071541,114.4755020846454,114.67357608153381,114.87728000232494,115.08640789136547,115.30076115675345,115.52014827484221,115.74438450817479,115.97329163616067,116.20669769785016,116.44443674619629,116.68634861322667,116.93227868558327,117.18207768991549,117.43560148764121,117.69271087861675,117.95327141328245,118.21715321287296,118.48423079730338,118.75438292036577,119.02749241188434,119.30344602650381,119.58213429879584,119.86345140438846,120.14729502683737,120.43356622997551,120.72216933548395,121.01301180544941,121.30600412967809,121.60105971755101,121.89809479421614,122.1970283009225,122.49778179931087,122.80027937948633,123.10444757170377,123.41021526151009,123.71751360818878,124.02627596636579,124.336437810638,124.64793666309515,124.96071202360983,125.274705302779,125.58985975740308,125.90612042839602,126.22343408102374,126.54174914737396,126.86101567096357,127.18118525339615],[121.82147047300325,121.02610459295721,120.27631471667083,119.57010596908491,118.90558404302766,118.28094930408481,117.69449129120937,117.14458358312838,116.62967900312377,116.14830513704835,115.69906014151537,115.28060882108893,114.89167895501852,114.53105785562765,114.1975891418918,113.89016971304217,113.60774690822068,113.34931583929583,113.11391688494589,112.90063333501833,112.70858917501442,112.53694700130481,112.38490605838609,112.25170039012845,112.13659709755667,112.03889469624838,111.95792156693273,111.89303449333384,111.8436172817247,111.8090794570488,111.78885503082626,111.78240133639473,111.78919792733967,111.80874553525544,111.84056508323788,111.88419675175443,111.93919909375968,112.00514819613574,112.08163688472538,112.16827397040983,112.26468353384398,112.3705042466201,112.48538872677159,112.60900292666213,112.74102555143021,112.88114750627271,113.02907137095822,113.18451090006313,113.3471905475128,113.51684501409848,113.69321881672444,113.87606587820741,114.06514913653075,114.26024017251271,114.46111885491538,114.66757300207561,114.87939805919426,115.09639679046838,115.31837898530054,115.54516117786265,115.77656637933089,116.01242382215037,116.25256871572235,116.49684201294041,116.74509018703556,116.99716501822026,117.25292338964618,117.51222709222121,117.77494263785435,118.04094108071891,118.31009784614929,118.58229256680475,118.85740892575481,119.13533450615796,119.41596064722339,119.69918230616159,119.98489792584435,120.27300930790958,120.56342149106133,120.85604263432477,121.15078390503108,121.44755937131906,121.74628589894699,122.04688305222327,122.34927299887158,122.65338041865478,122.95913241559239,123.26645843361349,123.57529017549376,123.88556152493547,124.19720847165217,124.51016903933019,124.82438321634271,125.1397928890986,125.45634177791604,125.77397537531081,126.0926408866013,126.4122871727302,126.7328646952127,127.05432546312181],[121.32535668686775,120.53986347116587,119.79965446591955,119.10274618266486,118.44725515077445,117.83139205390789,117.25345626010609,116.71183071574545,116.20497717607216,115.7314317473095,115.28980071740003,114.87875665431932,114.49703475260687,114.14342941032199,113.81679102004078,113.51602295881673,113.24007876319874,112.98795947649013,112.75871115641101,112.55142253223799,112.36522280131808,112.19927955561636,112.0527968296508,111.92501326180846,111.81520036162479,111.72266087614473,111.64672724898622,111.58676016617881,111.5421471832738,111.51230142861169,111.49666037798605,111.49468469628145,111.5058571419592,111.52968153055426,111.56568175360283,111.61340084966521,111.67240012432687,111.74225831627447,111.82257080672898,111.91294886970023,112.01301896068975,112.12242204162456,112.24081293994423,112.36785973989785,112.50324320422918,112.64665622454457,112.79780329876255,112.95640003414489,113.12217267450079,113.29485765024199,113.47420115004667,113.65995871296681,113.85189483988084,114.0497826232609,114.25340339428421,114.46254638637677,114.6770084143279,114.89659356816745,115.12111292104169,115.35038425037054,115.58423177160515,115.82248588395063,116.06498292744598,116.3115649508342,116.56207948968475,116.81637935425863,117.07432242663742,117.33577146666187,117.60059392625072,117.86866177169422,118.13985131353786,118.41404304369351,118.69112147943235,118.97097501393523,119.25349577309079,119.538579478248,119.82612531464703,120.1160358052651,120.40821668982568,120.70257680873726,120.99902799173528,121.29748495101308,121.59786517864187,121.90008884808383,122.20407871961827,122.50976004950567,122.81706050272423,123.1259100691229,123.43624098283986,123.74798764484514,124.06108654847215,124.37547620780907,124.69109708882657,125.00789154312658,125.32580374419929,125.6447796260837,125.96476682432875,126.28571461916101,126.60757388076475,126.93029701658797],[120.84056827569395,120.06472234937441,119.33387550131673,118.64605536971659,117.99938907311268,117.39209737769549,116.8224892562137,116.28895680884681,115.78997051890434,115.32407481847599,114.88988394121004,114.48607804126854,114.1113995592042,113.76464981705718,113.44468582637548,113.15041729415731,112.88080381288393,112.63485222188886,112.41161412829253,112.21018357662803,112.02969485711125,111.86932044326122,111.72826905026994,111.60578380615726,111.50114052833017,111.41364609870492,111.34263693103971,111.28747752458683,111.24755909858702,111.22229830251825,111.21113599736502,111.21353610350552,111.22898451111529,111.25698804926894,111.29707351017964,111.3487867252548,111.41169168987342,111.48536973399099,111.56941873587212,111.66345237642601,111.76709943178778,111.88000310193509,112.00182037327687,112.13222141328036,112.27088899532338,112.41751795207576,112.5718146558178,112.7334965242034,112.90229155006594,113.07793785395288,113.26018325815372,113.44878488105958,113.64350875076576,113.84412943688997,114.05042969964047,114.26220015522846,114.47923895676648,114.70135148985081,114.92835008206596,115.16005372569839,115.39628781298345,115.63688388325089,115.88167938136692,116.13051742690816,116.38324659353086,116.63972069803037,116.89979859861484,117.16334400193865,117.43022527847154,117.70031528579871,117.97349119946922,118.24963435103211,118.52863007291705,118.81036754983599,119.09473967639812,119.38164292064744,119.67097719324579,119.9626457220422,120.25655493177673,120.55261432868693,120.85073638979038,121.15083645663307,121.45283263330103,121.75664568850425,122.062198961551,122.36941827203893,122.67823183309926,122.98857016803858,123.30036603022712,123.6135543260947,123.92807204109793,124.24385816853169,124.56085364106163,124.87900126486291,125.19824565625296,125.51853318071447,125.83981189420608,126.16203148666632,126.48514322761945,126.80909991379454],[120.36710523948202,119.60068122758302,118.87897782286224,118.20003353024001,117.56198581004227,116.96306527544751,116.40159027953216,115.87596186243218,115.38465903162037,114.92623435054782,114.49930981294528,114.10257298193685,113.73477337481059,113.39471907583317,113.08127356089547,112.79335271906389,112.52992205727601,112.28999407549226,112.07262580059044,111.8769164681883,111.7020053423938,111.54706966423939,111.41132272024379,111.29401202317455,111.19441759767295,111.11185036392902,111.04565061309326,110.99518656855798,110.95985302766417,110.93907007876868,110.93228188896325,110.93895555806682,110.95858003480768,110.99066509139973,111.03474035296814,111.09035437852303,111.15707379039938,111.23448244928549,111.32218067215452,111.4197844905872,111.52692494713823,111.64324742755167,111.76841102676944,111.90208794680981,112.04396292471287,112.19373268886616,112.35110544212384,112.51580037023855,112.68754717420799,112.86608562523156,113.05116514104574,113.24254438248558,113.43999086918544,113.64328061339994,113.85219777098429,114.06653430863062,114.28608968650995,114.51067055551843,114.7400904683732,114.97416960384635,115.21273450346592,115.45561782005113,115.70265807748541,115.95369944116237,116.20859149857375,116.46718904953568,116.7293519055785,116.99494469805148,117.26383669451671,117.53590162303244,117.81101750394336,118.08906648882056,118.36993470620885,118.65351211385999,118.93969235714545,119.22837263336002,119.51945356164043,119.81283905824073,120.1084362169147,120.40615519417383,120.70590909919665,121.00761388817891,121.31118826292422,121.61655357348454,121.92363372466984,122.23235508625453,122.54264640671758,122.85443873036044,123.1676653176556,123.48226156868429,123.79816494952952,124.11531492149803,124.43365287304769,124.7531220543074,125.07366751407696,125.39523603920333,125.71777609623338,126.04123777524633,126.36557273577698,126.69073415474152],[119.90496757823175,119.14774010579168,118.4349614305562,117.76468066423521,117.13504536156327,116.54429574716404,115.99075933006149,115.47284587650181,114.98904271422025,114.53791034352511,114.11807833260576,113.72824147632404,113.36715619942602,113.03363718664994,112.72655422360094,112.44482923353655,112.18743349637522,111.95338503730002,111.74174617330469,111.55162120691901,111.38215425716574,111.23252721855093,111.10195783957208,110.98969791286052,110.89503156965306,110.81727367181703,110.75576829514678,110.7098872980922,110.6790289705055,110.66261675736274,110.66009805278074,110.67094305996537,110.69464371303663,110.73071265694648,110.77868228196844,110.8381038094702,110.90854642590483,110.98959646215775,111.08085661557645,111.18194521218382,111.29249550674106,111.41215501847438,111.54058490042203,111.67745934048595,111.82246499239767,111.97530043491581,112.13567565768091,112.30331157225048,112.47793954692706,112.65930096407772,112.84714679872276,113.04123721724497,113.24134119513981,113.44723615279084,113.65870760831558,113.87554884658333,114.09756060355824,114.32455076517014,114.55633407996336,114.79273188481444,115.03357184305239,115.2786876943514,115.52791901580125,115.78111099359664,116.03811420481355,116.29878440877448,116.56298234752843,116.83057355500041,117.10142817438648,117.3754207833955,117.65243022696032,117.93233945705879,118.21503537930781,118.50040870600733,118.78835381533264,119.07876861638574,119.37155441983101,119.6666158138607,119.96386054523944,120.26319940519785,120.56454611995402,120.86781724565071,121.17293206751157,121.47981250302462,121.78838300897475,122.0985704921526,122.41030422357908,122.72351575608839,123.03813884512529,123.35410937261381,123.67136527376707,123.98984646670816,124.30949478478495,124.63025391146033,124.95206931767125,125.27488820155018,125.59865943041052,125.92333348490078,126.24886240523733,126.5751997394289],[119.4541552919432,118.70589898400026,118.00182632439856,117.33999677170216,116.71856772767563,116.13578879284502,115.58999640780173,115.07960885105567,114.60312156670398,114.15910279740756,113.74618950019149,113.36308352443034,113.00854803305032,112.68140414950761,112.38052781449183,112.10484683757511,111.85333813018129,111.62502510731237,111.41897524643549,111.23429779282,111.07014160142714,110.92569310619579,110.800174408255,110.6928414752151,110.60298244427034,110.52991602236898,110.47298997720033,110.43157971318962,110.40508692711067,110.39293833830068,110.39458448881739,110.40949860920129,110.43717554580189,110.47713074590915,110.52889929718052,110.59203501809606,110.66610959638966,110.75071177260793,110.84544656613784,110.94993454121582,111.06381111059625,111.18672587470338,111.31834199423447,111.45833559430892,111.60639519837774,111.76222119022474,111.92552530248879,112.09603013023913,112.27346866822312,112.4575838704914,112.64812823118456,112.84486338533765,113.0475597286289,113.25599605506252,113.46995921163406,113.68924376908659,113.91365170791147,114.14299211880622,114.37708091683645,114.61574056860249,114.85879983174293,115.10609350615159,115.35746219631463,115.61275208421117,115.87181471225031,116.13450677574667,116.40068992446456,116.67023057278553,116.94299971808056,117.21887276688781,117.49772936852001,117.77945325574696,118.06393209221386,118.35105732627797,118.64072405095988,118.9328308697245,119.22727976781752,119.52397598890229,119.82282791675105,120.12374696175911,120.42664745206245,120.73144652904838,121.03806404706303,121.34642247712453,121.6564468144657,121.96806448973314,122.28120528368386,122.59580124522263,122.91178661263604,123.22909773788342,123.5476730138103,123.86745280416207,124.18837937627335,124.51039683632162,124.83345106703598,125.15748966775507,125.48246189673755,125.8083186156298,126.13501223600041,126.46249666785677],[119.0146683806164,118.27515786220889,117.57957250438936,116.92598185264085,116.31255290837936,115.73754441249059,115.19930151275285,114.69625078609349,114.22689558907159,113.7898117121955,113.38364331570247,113.00709912625567,112.65894887568375,112.33801996440612,112.04319433356821,111.77340553117979,111.52763595869447,111.30491428552924,111.10431301998256,110.9249462258914,110.76596737517801,110.62656732717397,110.50597242629242,110.40344271023841,110.3182702215251,110.24977741558476,110.19731565925377,110.16026381385012,110.13802689747995,110.13003482158223,110.13574119707329,110.15462220577434,110.18617553310375,110.22991935828783,110.28539139860432,110.35214800440072,110.42976330185387,110.51782838063595,110.61595052383863,110.72375247768331,110.84087175870374,110.96695999623834,111.101682308207,111.2447167082786,111.39575354265303,111.55449495479291,111.72065437654756,111.89395604420454,112.07413453809613,112.26093434447262,112.45410943843143,112.65342288676369,112.85864646965283,113.06956032021515,113.28595258094022,113.50761907614027,113.73436299956957,113.96599461642644,114.20233097899262,114.44319565521064,114.68841846953757,114.93783525545186,115.19128761902529,115.44862271300576,115.70969302088388,115.97435615045245,116.24247463638696,116.5139157514068,116.78855132559914,117.06625757350938,117.34691492862247,117.63040788488483,117.91662484492709,118.20545797467187,118.49680306402703,118.79055939337648,119.08662960559991,119.38491958336532,119.68533833144946,119.98779786385751,120.29221309552193,120.59850173837209,120.90658420157861,121.2163834957843,121.52782514114266,121.8408370789961,122.15534958703194,122.47129519776297,122.78860862018801,123.10722666449283,123.42708816965946,123.74813393385983,124.07030664751271,124.39355082889122,124.71781276217112,125.04304043781789,125.36918349521457,125.69619316743341,126.02402222806631,126.35262494002515],[118.58650684425139,117.85551674041744,117.16819997052856,116.52263590705128,115.91700090367451,115.34956260610058,114.81867464491481,114.32277168161554,113.86036478132293,113.43003708788879,113.03043977913876,112.66028828179991,112.31835872732613,112.00348463134529,111.71455378083,111.45050531435044,111.21032698191458,110.99305257195061,110.79775949394605,110.62356650613314,110.46963157841836,110.33514988148552,110.21935189368438,110.12150161793024,110.040894901417,109.97685785146449,109.92874534130729,109.89593960007373,109.87784888161325,109.87390620720758,109.88356817754837,109.90631384968479,109.94164367494199,109.98907849408255,110.04815858623994,110.11844276838414,110.19950754229758,110.29094628624185,110.39236848867887,110.50339902158622,110.62367745106378,110.75285738307947,110.89060584233931,111.03660268239523,111.19054002522368,111.35212172862038,111.52106287985727,111.6970893141466,111.87993715654613,112.06935238602161,112.2650904204631,112.46691572152307,112.67460141821152,112.88792894824874,113.10668771623375,113.3306747677445,113.55969447853259,113.7935582580309,114.03208426643168,114.27509714463889,114.52242775643634,114.77391294225205,115.02939528393358,115.28872287998054,115.55174913071437,115.81833253289172,116.08833648329555,116.36162909086406,116.63808299694227,116.91757520326009,117.19998690726767,117.48520334447261,117.77311363744737,118.06361065118914,118.35659085453412,118.65195418734147,118.94960393317831,119.24944659724977,119.55139178933466,119.85535211149325,120.1612430503325,120.46898287362163,120.77849253105839,121.08969555900389,121.40251798900573,121.71688825994148,122.03273713362313,122.34999761370948,122.66860486778124,122.98849615244228,123.30961074131439,123.63188985580121,123.9552765985033,124.27971588916917,124.6051544030765,124.9315405117388,125.25882422584137,125.58695714031147,125.91589238143509,126.24558455593377],[118.16967068284804,117.44697561862606,116.76770872281618,116.12995893493348,115.53191171356104,114.97184337367516,114.44811580428771,113.95917153762181,113.50352914345819,113.07977892448737,112.6865788905002,112.32265099106328,111.98677758797756,111.67779815032534,111.39460615627731,111.13614618708718,110.9014111998417,110.68943996657651,110.49931466832591,110.33015863354524,110.18113421114811,110.05144076913041,109.9403128104309,109.84701819829081,109.77085648394635,109.71115733000804,109.66727902336079,109.63860707186046,109.62455287951063,109.62455249517676,109.63806543024269,109.66457354093247,109.70357997131666,109.75460815329319,109.81720086008728,109.89091931004626,109.97534231772063,110.0700654894255,110.17470046065853,110.28887417292448,110.41222818767606,110.5444180352267,110.68511259663165,110.83399351665859,110.99075464608958,111.15510151170713,111.32675081241784,111.50542994006551,111.69087652357308,111.88283799513803,112.08107117727974,112.28534188961585,112.49542457430502,112.71110193916299,112.9321646175147,113.15841084389922,113.38964614480044,113.62568304361957,113.86634077915376,114.11144503688709,114.36082769243905,114.61432656655238,114.87178519103927,115.13305258513549,115.39798304174175,115.66643592306445,115.93827546519024,116.21337059115751,116.49159473210968,116.77282565614014,117.05694530445561,117.34383963451022,117.63339846977479,117.92551535582962,118.22008742248106,118.51701525161968,118.81620275055251,119.11755703055573,119.42098829040668,119.72640970466591,120.03373731649418,120.3428899347971,120.6537890355023,120.96635866678342,121.28052535805482,121.59621803256924,121.91336792345761,122.23190849306215,122.5517753554156,122.87290620173172,123.19524072877515,123.5187205699864,123.84328922924493,124.16889201715547,124.49547598975224,124.82298988951769,125.15138408861806,125.48061053426412,125.81062269610652,126.14137551558301],[117.76415989640641,117.04953449683465,116.37809876125222,115.74795093628734,115.15728533803893,114.60438671521418,114.0876249908715,113.60545035411219,113.15638867547725,112.73903722199137,112.35206064978701,111.99418725404561,111.66420545763798,111.36096052134627,111.08335145991001,110.83032814938984,110.6008886124758,110.39407646940695,110.20897854312214,110.0447226081277,109.90047527336732,109.77543999010862,109.66885517653206,109.57999245132,109.50815496911297,109.45267585121555,109.41291670541432,109.3882662292103,109.37813889117199,109.38197368548963,109.39923295515618,109.42940127951744,109.47198442222778,109.52650833591974,109.59251822014643,109.66957762938723,109.75726762812323,109.8551859901871,109.96294643977757,110.08017793169813,110.20652396854067,110.34164195268008,110.48520257108392,110.63688921106872,110.79639740525067,110.96343430405311,111.13771817422931,111.31897792196106,111.50695263917711,111.70139117182194,111.90205170888129,112.10870139104188,112.3211159379331,112.53907929295826,112.7623832847831,112.99082730460444,113.22421799837326,113.4623689731925,113.70510051715877,113.95223933195548,114.2036182775459,114.45907612835255,114.71845734034238,114.98161182847055,115.24839475396598,115.51866632097071,115.79229158207134,116.06914025228708,116.34908653110162,116.6320089321494,116.91779012018641,117.20631675499766,117.4974793419093,117.79117208859341,118.08729276786806,118.38574258621097,118.68642605772264,118.98925088328328,119.29412783466555,119.60097064337587,119.90969589400692,120.22022292189854,120.53247371491025,120.84637281912268,121.16184724829003,121.47882639687938,121.79724195653542,122.11702783582106,122.43812008309123,122.76045681236117,123.08397813204181,123.40862607641539,123.73434453973773,124.06107921285007,124.38877752219842,124.71738857115461,125.04686308354476,125.37715334929136,125.70821317208083,126.03999781897257],[117.36997448492654,116.66319337504329,115.99937008583665,115.37661191111302,114.79312177710821,114.24719263071765,113.73720220466615,113.2616081310868,112.81894337738015,112.40781198040058,112.02688505699903,111.67489707074687,111.35064233630747,111.05297174440803,110.78078969172815,110.53305120125859,110.30875921981688,110.10696208044192,109.92675111833482,109.76725842988051,109.62765476507593,109.50714754442014,109.40497899198765,109.32042437701776,109.25279035691689,109.20141341508685,109.16565838746786,109.14491707212326,109.13860691659737,109.14616977814624,109.16707075228892,109.20079706543964,109.24685702767538,109.30477904196232,109.37411066641734,109.45441772640699,109.54528347350518,109.64630778852654,109.75710642603607,109.87731029790726,110.00656479365772,110.14452913543961,110.29087576569621,110.44528976562562,110.60746830270706,110.7771201056583,110.95396496529162,111.13773325983338,111.32816550335801,111.52501191607352,111.72803201526779,111.93699422580121,112.15167550909602,112.37186100963446,112.597343718039,112.82792414986029,113.06341003925094,113.30361604674954,113.5483634804468,113.79748002984395,114.05079951175682,114.30816162765281,114.56941173184296,114.83440060998581,115.10298426738713,115.37502372661044,115.65038483393859,115.92893807425273,116.21055839391806,116.49512503128803,116.7825213544599,117.07263470593485,117.36535625385095,117.6605808494807,117.95820689069492,118.25813619111533,118.5602738546887,118.86452815543214,119.17081042211119,119.47903492762308,119.78911878287082,120.1009818349259,120.41454656928239,120.72973801602174,121.04648365971131,121.36471335287206,121.68435923285645,122.00535564198613,122.32763905080789,122.65114798433058,122.97582295111417,123.30160637508811,123.62844252998153,123.95627747625308,124.28505900041493,124.61473655664949,124.94526121062127,125.27658558539319,125.60866380935792,125.94145146610259],[116.98711444840851,116.28795225325193,115.63152269656956,115.01594185941038,114.43942103076895,113.90026112018577,113.39684744567172,112.92764486854556,112.49119324916681,112.08610319971521,111.71105211213631,111.36478044116727,111.0460882239859,110.75383181951057,110.4869208517318,110.24431534269337,110.02502302186497,109.82809679968135,109.65263239396388,109.49776609880371,109.36267268627402,109.24656343206499,109.14868425679791,109.0683139753842,109.00476264735826,108.95737002162215,108.92550406952127,108.90855960059935,108.90595695578675,108.91714077314666,108.94157882164096,108.97876089869929,109.02819778765942,109.08942027142089,109.1619781989,109.24543960110545,109.33938985386654,109.44343088444384,109.55718041943412,109.68027127155179,109.81235066302708,109.95307958350517,110.10213218046842,110.25919518032933,110.42396733845871,110.59615891652275,110.77549118560493,110.96169595368238,111.15451511611596,111.35370022789263,111.55901209643916,111.77022039389396,111.9871032877937,112.20944708919154,112.43704591728226,112.66970137966659,112.90722226743354,113.14942426429093,113.3961296690178,113.64716713055238,113.90237139507185,114.16158306445303,114.42464836554099,114.69141892968116,114.96175158200512,115.23550813998361,115.51255522079212,115.79276405705454,116.07601032055884,116.36217395355574,116.65113900727623,116.94279348732192,117.2370292055997,117.53374163849115,117.83282979096172,118.13419606633295,118.43774614145065,118.74338884700259,119.05103605274377,119.3606025574073,119.67200598308574,119.98516667387925,120.30000759861873,120.61645425748071,120.93443459231855,121.25387890054716,121.57471975242062,121.89689191155728,122.22033225856579,122.54497971763992,122.87077518599241,123.19766146600467,123.5255831999765,123.85448680736434,124.18432042440178,124.5150338460024,124.84657846984776,125.17890724256955,125.5119746079378,125.84573645697309],[116.61557978685219,115.92381113146055,115.27455659345088,114.66594078117957,114.09618309902096,113.56359218361825,113.06656071388812,112.60356056648835,112.17313829083733,111.77391087993536,111.4045618151989,111.0638373653066,110.75054312067331,110.46354074665383,110.20174493992083,109.96412057369412,109.74968001862014,109.55748062712527,109.38662237000935,109.2362456148972,109.10552903696157,108.99368765304318,108.89997097096258,108.82366124641931,108.76407184043684,108.72054567082125,108.69245375157477,108.67919381463848,108.68018900874024,108.69488667049076,108.72275716321215,108.76329277929607,108.81600670217998,108.88043202429549,108.95612081759448,109.04264325348269,109.13958676920728,109.246555277939,109.36316841997146,109.48906085263167,109.62388157664887,109.76729329687689,109.91897181540058,110.07860545517988,110.24589451250569,110.4205507366465,110.60229683516907,110.7908660035082,110.98600147745084,111.1874561072793,111.39499195239549,111.60837989532,111.82739927402621,112.05183753162942,112.28148988251297,112.51615899402339,112.75565468292095,112.99979362581649,113.24839908287179,113.50130063408091,113.75833392749085,114.01934043875332,114.28416724143642,114.55266678755679,114.82469669782007,115.10011956109031,115.37880274263181,115.6606182006925,115.94544231102415,116.23315569895277,116.52364307863526,116.81679309915879,117.11249819715566,117.41065445562501,117.71116146866854,118.01392221186359,118.31884291800866,118.6258329579946,118.93480472656306,119.24567353272882,119.5583574946517,119.87277743875838,120.18885680291916,120.50652154349947,120.82570004611192,121.14632303990453,121.46832351522809,121.79163664453468,122.11619970636488,122.44195201228926,122.7688348366765,123.0967913491649,123.4257665497226,123.75570720618394,124.08656179415897,124.41828043921332,124.7508148612241,125.08411832082037,125.41814556782043,125.75285279158406],[116.25537050025754,115.57077000966915,114.92847177648056,114.32660867642042,113.76340798186435,113.23718582101533,112.74634200931544,112.28935522491541,111.86477850239172,111.47123502106058,111.10741416618669,110.77206784316495,110.46400702636986,110.18209852583799,109.92526195629526,109.69246689426096,109.48273021008218,109.29511356277381,109.12872104647113,108.9826969781611,108.85622381713856,108.74852020735477,108.65883913448195,108.58646619012301,108.53071793615273,108.49094036268434,108.46650743362838,108.45681971424079,108.46130307545769,108.47940747017859,108.51060577700255,108.55439270723024,108.61028377123689,108.67781430058595,108.75653852250066,108.84602868353871,108.94587421952754,109.055680969012,109.17507042764824,109.30367904114696,109.44115753452297,109.58717027555478,109.74139467049264,109.90352059017718,110.07324982484795,110.25029556602954,110.43438191398407,110.62524340931066,110.82262458736274,111.02627955423364,111.23597158313673,111.45147273007943,111.67256346779341,111.89903233694822,112.13067561373109,112.36729699293065,112.60870728571331,112.85472413132625,113.10517172200863,113.35988054042949,113.61868710901402,113.8814337505536,114.14796835952929,114.41814418361244,114.69181961483183,114.96885798993063,115.24912739945775,115.53250050516644,115.81885436531387,116.10807026747911,116.4000335685371,116.69463354144547,116.99176322851868,117.29131930088199,117.59320192381524,117.89731462770732,118.20356418436249,118.51186048840793,118.82211644356924,119.13424785358747,119.44817331756876,119.76381412956349,120.08109418218369,120.39993987407811,120.7202800210914,121.0420457709445,121.36517052127893,121.68958984091829,122.01524139420518,122.34206486827863,122.67000190316639,122.99899602456895,123.32899257921972,123.65993867271192,123.99178310968652,124.32447633628226,124.65797038475039,124.99221882014587,125.32717668900584,125.66280046993538],[115.90648658862466,115.22882888787773,114.59326824565871,113.99794554513306,113.44109567929928,112.92104203237677,112.43619133195362,111.98502884382657,111.5661138838299,111.17807562309132,110.81960916509969,110.48947187474234,110.18647994107529,109.90950515706301,109.65747190085524,109.42935430439377,109.22417359625129,109.04099560662682,108.87892842334934,108.73712018859527,108.6147570268049,108.51106109499962,108.42528874735578,108.35672880649541,108.30470093450599,108.26855409721128,108.24766511568187,108.24143729940624,108.24929915593918,108.27070317221026,108.30512466301215,108.35206068250154,108.41102899483026,108.48156710029245,108.56323131361867,108.65559589127355,108.75825220482719,108.87080795766282,108.99288644246452,109.12412583709781,109.26417853664945,109.41271051953876,109.56940074574469,109.73394058532132,109.90603327548544,110.0853934046719,110.27174642205004,110.46482817108992,110.66438444585162,110.87017056875546,111.08195098866281,111.2994988981721,111.52259586909531,111.75103150514794,111.98460311093673,112.22311537638855,112.46638007581053,112.71421578082028,112.96644758642859,113.22290684959816,113.48343093964122,113.74786299985374,114.01605171981967,114.2878511178484,114.56312033304049,114.84172342650432,115.1235291912699,115.40841097047658,115.69624648342806,115.9869176591346,116.2803104769817,116.57631481418203,116.87482429968885,117.1757361742625,117.47895115640199,117.78437331386415,118.09190994051228,118.40147143824287,118.71297120376229,119.02632551998332,119.34145345183695,119.65827674629455,119.97671973641238,120.29670924921655,120.61817451725695,120.94104709366668,121.26526077057284,121.59075150070808,121.91745732208658,122.24531828560784,122.57427638546214,122.9042754922168,123.235261288468,123.56718120694816,123.89998437098443,124.23362153720922,124.56804504042658,124.90320874054578,125.23906797149411,125.57557949202713],[115.56892805195353,114.89798776608633,114.26894600098528,113.6799513873174,113.12924619132541,112.61516081770272,112.13610868180267,111.6905814232219,111.27714443515204,110.89443268602747,110.54114681193806,110.2160494600387,109.91796186478972,109.64576064032879,109.39837477360071,109.1747828040926,108.9740101771273,108.79512675868438,108.63724450064397,108.49951524619988,108.3811286659608,108.28131031597781,108.19931980958422,108.1344490955364,108.08602083549657,108.05338687440207,108.03592679773537,108.03304657013474,108.04417725018473,108.06877377658562,108.10631382124097,108.15629670511015,108.21824237296006,108.29169042341493,108.37619919094845,108.47134487668708,108.57672072510624,108.69193624389153,108.81661646442016,108.95040124048393,109.09294458302837,109.2439140288289,109.40299004115671,109.56986544061229,109.74424486441821,109.92584425257336,110.11439035936681,110.30962028884584,110.51128105291754,110.71912915084481,110.93293016897393,111.15245839959813,111.37749647793208,111.60783503622859,111.8432723741298,112.08361414439688,112.32867305321265,112.57826857429849,112.83222667613136,113.09037956158681,113.35256541937247,113.61862818665402,113.88841732230746,114.16178759026432,114.43859885244603,114.71871587081145,115.00200811806822,115.28834959662289,115.57761866536666,115.86969787391941,116.16447380396912,116.46183691736834,116.76168141066603,117.06390507576616,117.36840916642853,117.67509827033427,117.98388018645785,118.29466580749924,118.60736900714207,118.92190653191631,119.23819789745617,119.55616528895152,119.87573346560517,120.19682966891487,120.51938353460841,120.8433270080715,121.16859426311002,121.49512162390397,121.82284749000927,122.15171226427712,122.48165828356376,122.81262975210839,123.14457267746734,123.47743480889277,123.81116557805269,124.14571604199412,124.48103882825259,124.81708808202032,125.15381941528526,125.49118985785934],[115.24269489024407,114.57824664429496,113.95550504246012,113.37262620297351,112.82785951794301,112.31954217699327,111.8460940588627,111.40601296310143,110.99787015635783,110.62030620986879,110.27202710670164,109.95180059905405,109.65845279751326,109.39086497563538,109.1479705745316,108.92875239335747,108.73223995271034,108.55750701894645,108.4036692783551,108.26988215097484,108.15533873460612,108.0592678702893,107.98093232116715,107.91962705724596,107.87467763912443,107.84543869425684,107.83129247978883,107.83164752642638,107.84593735819426,107.87361928330475,107.91417325168899,107.96710077505615,108.03192390562639,108.1081842699534,108.19544215448995,108.29327563977948,108.4012797803648,108.51906582769806,108.64626049351531,108.78250525130552,108.92745567365958,109.08078080342506,109.24216255672869,109.41129515604995,109.5878845916462,109.77164810973419,109.96231372593455,110.15961976257849,110.36331440856027,110.57315530050185,110.78890912406989,111.01035123435754,111.23726529430358,111.46944293019008,111.70668340331022,111.94879329695576,112.19558621791968,112.44688251176098,112.70250899111731,112.96229867639558,113.22609054820779,113.49372931095422,113.7650651669927,114.03995360086057,114.3182551730485,114.59983532285212,114.88456417985293,115.17231638360522,115.46297091112972,115.75641091183347,116.05252354949917,116.35119985100461,116.65233456145046,116.95582600539322,117.2615759538951,117.56948949711744,117.87947492219941,118.19144359617719,118.50530985370868,118.82099088938654,119.13840665442653,119.45747975753444,119.77813536976221,120.10030113317293,120.42390707314605,120.7488855141586,121.0751709988905,121.40270021050607,121.73141189797303,122.06124680428636,122.39214759747111,122.72405880424373,123.05692674621793,123.39069947854567,123.72532673089138,124.06075985063704,124.39695174822862,124.73385684456943,125.07143102037898,125.40963156743194],[114.92778710349644,114.26960552250355,113.65294537008351,113.07596999210132,112.53693565915209,112.03418611024831,111.56614746313349,111.13132346346509,110.72829104744763,110.35569619461552,110.01225004939049,109.69672529178845,109.40795273924576,109.14481816298284,108.90625930364787,108.69126307218831,108.4988629230005,108.32813638741295,108.17820275648249,108.04822090292008,107.93738723274089,107.84493375793419,107.77012628210461,107.71226269162426,107.67067134538955,107.64470955677544,107.63376216184243,107.63724016828115,107.65457947996785,107.68523969236763,107.72870295435634,107.78447289233931,107.85207359282911,107.93104863990789,108.02096020424331,108.12138818055057,108.23192937060271,108.35219670908256,108.48181852974984,108.62043786956251,108.7677118085432,108.9233108433275,109.08691829246064,109.25822973163451,109.43695245716957,109.62280497615417,109.81551652175312,110.01482659228803,110.22048451278016,110.43224901772632,110.64988785395076,110.87317740245027,111.10190231820982,111.33585518703242,111.5748361984782,111.81865283406516,112.06711956993156,112.32005759320761,112.57729453138606,112.83866419402446,113.10400632614716,113.37316637275444,113.6459952538754,113.9223491496369,114.20208929484777,114.48508178262634,114.77119737662375,115.06031133142372,115.35230322071727,115.64705677287675,115.94445971357207,116.24440361509065,116.54678375204199,116.85149896314357,117.1584515188016,117.46754699421362,117.77869414773689,118.09180480427655,118.40679374346212,118.72357859239386,119.04207972274786,119.36222015204325,119.68392544888327,120.0071236419909,120.33174513286973,120.65772261192814,120.98499097791418,121.31348726051432,121.64315054597805,121.97392190563551,122.30574432718434,122.63856264862287,122.97232349471943,123.30697521590697,123.6424678295003,123.97875296313808,124.31578380035448,124.65351502819308,124.99190278677567,125.33090462074505],[114.6242046917105,113.97206440071217,113.36126698385542,112.78998275470096,112.2564746149524,111.75909261746774,111.29626889461524,110.86651292431291,110.46840710842109,110.10060264026767,109.7618156400046,109.45082353824183,109.16646168998727,108.90762020237108,108.67324096094964,108.46231484058529,108.27387908799754,108.10701486408398,107.96084493502624,107.83453150203576,107.72727416036501,107.63830797891245,107.56690169239671,107.51235599867113,107.47400195429216,107.45119946195788,107.44333584389584,107.44982449569903,107.47010361550547,107.50363500377424,107.54990292924278,107.60841305695976,107.67869143456826,107.76028353327827,107.8527533402083,107.95568249900042,108.06866949582002,108.19132888804477,108.3232905731238,108.46419909525491,108.61371298767921,108.77150414853594,108.93725724835245,109.11066916736586,109.29144846098811,109.47931485183354,109.67399874682259,109.87524077797418,110.08279136557694,110.2964103025184,110.51586635861666,110.74093690387626,110.97140754965082,111.20707180675571,111.44773075963359,111.69319275572505,111.94327310924842,112.19779381863853,112.45658329693794,112.71947611447337,112.98631275319063,113.25693937205467,113.53120758295557,113.80897423659331,114.09010121784395,114.37445525013395,114.66190770838075,114.95233444007833,115.24561559412918,115.5416354570494,115.84028229618775,116.14144820962649,116.4450289824406,116.75092394901719,117.05903586114799,117.369270761623,117.68153786307037,117.99574943179739,118.31182067640248,118.62966964093845,118.94921710242038,119.27038647247802,119.59310370296851,119.91729719536869,120.24289771377944,120.56983830138007,120.89805420018116,121.2274827739288,121.55806343402412,121.8897375683247,122.22244847270341,122.55614128524573,122.89076292297213,123.22626202097662,123.56258887387968,123.89969537949703,124.23753498463029,124.57606263289128,124.91523471447502,125.25500901779866],[114.33194765488628,113.68562327892079,113.08046988377561,112.5146644907723,111.98647638534412,111.49426169865178,111.03645835330788,110.61158134564486,110.21821833927851,109.85502554682502,109.5207238785439,109.21409533841421,108.93397964973775,108.67927109380014,108.44891554643679,108.24190769854809,108.05728844770157,107.8941424489596,107.7515958139864,107.62881394832166,107.52499951747861,107.43939053322396,107.37125855204333,107.31990697838665,107.28466946583198,107.26490840980435,107.26001352594936,107.26940050868001,107.29250976480715,107.32880521752459,107.37777317634848,107.43892126891753,107.51177743084392,107.59588895006465,107.69082156238512,107.79615859512911,107.91150015601681,108.03646236458489,108.17067662363719,108.31378892838271,108.46545921106748,108.62536071905055,108.79317942440426,108.96861346324388,109.15137260310193,109.34117773677205,109.53776040114302,109.74086231963697,109.95023496695067,110.16563915487806,110.3868446380674,110.61362973863569,110.84578098862657,111.08309278935982,111.32536708677644,111.57241306193545,111.82404683587013,112.08009118805363,112.34037528777259,112.60473443774228,112.87300982933822,113.14504830885491,113.42070215423308,113.69982886172998,113.98229094203708,114.2679557253751,114.55669517512412,114.84838570956903,115.14290803136564,115.44014696435107,115.73999129734619,116.04233363461223,116.34707025264632,116.65410096301423,116.96332898093431,117.27466079934547,117.5880060681997,117.90327747873974,118.22039065252953,118.53926403502027,118.85981879344396,119.18197871883874,119.50567013201781,119.83082179330634,120.15736481587525,120.48523258251444,120.8143606656913,121.14468675074936,121.4761505621114,121.80869379235388,122.14226003402824,122.4767947141124,122.81224503097597,123.14855989375455,123.48568986402933,123.82358709971399,124.16220530105588,124.50149965866406,124.84142680347716,125.18194475859258],[114.05101599302384,113.41028215712939,112.81055406984423,112.25001520031533,111.72694097032731,111.23969335380029,110.78671583921135,110.36652872746103,109.97772474001972,109.61896491428786,109.28897476500852,108.98654069230562,108.71050661849728,108.45977083727009,108.23328306010946,108.03004164607709,107.84909100211257,107.68951914203973,107.55045539336301,107.43106824177805,107.33056330408174,107.24818142086876,107.18319686104452,107.13491563077088,107.10267388000904,107.08583640031458,107.08379520800293,107.09596820722406,107.12179792787273,107.16075033361871,107.21231369567339,107.27599752821257,107.35133158165598,107.43786489026706,107.53516487077377,107.6428164689365,107.76042135119305,107.88759713870286,108.02397668129002,108.16920736894599,108.32295047870822,108.48488055487128,108.65468482061604,108.83206261926881,109.01672488351113,109.20839363096988,109.40680148471431,109.61169121727663,109.82281531690153,110.03993557480538,110.26282269230312,110.49125590672841,110.72502263513709,110.96391813484492,111.20774517990667,111.4563137526964,111.70944074979667,111.96694970145296,112.22867050389038,112.4944391638313,112.76409755458985,113.03749318315516,113.31447896770807,113.59491302504682,113.87865846742712,114.16558320834973,114.4555597768536,114.74846513989586,115.04418053242647,115.34259129478215,115.64358671704744,115.94705989004773,116.25290756265923,116.56103000513441,116.87133087816063,117.18371710738113,117.49809876312499,117.81438894510356,118.13250367184348,118.4523617746392,118.77388479581865,119.09699689112527,119.42162473603133,119.74769743580383,120.07514643915707,120.4039054553313,120.73391037444482,121.06509919097617,121.39741193023991,121.73079057772294,122.06517901115899,122.40052293522277,122.73676981873081,123.07386883424077,123.41177079994939,123.75042812378895,124.08979474963148,124.42982610551138,124.77047905378217,125.11171184312695],[113.7814097061231,113.146041035338,112.55151954206126,111.99603488333013,111.4778683699018,110.99538758291331,110.54704135232576,110.13135506976131,109.74692631064474,109.39242074265603,109.06656829939838,108.76815959991605,108.49604259626584,108.24911943278069,108.02634350196757,107.82671668317202,107.64928675123065,107.49314494332432,107.35742367315595,107.24129438240473,107.14396552017423,107.064680641847,107.00271661940016,106.95738195582365,106.92801519682354,106.91398343348874,106.91468089005645,106.92952759133128,106.95796810470243,106.99947035205655,107.05352448721759,107.11964183484488,107.1973538870045,107.28621135388539,107.38578326537414,107.49565612042271,107.61543308134866,107.74473321039869,107.88319074608229,108.03045441694456,108.18618679060131,108.35006365599807,108.52177343698776,108.7010166354405,108.88750530221547,109.08096253442694,109.28112199753643,109.48772747089301,109.70053241542922,109.91929956230008,110.14380052132367,110.37381540815446,110.60913248918233,110.84954784321081,111.09486503902434,111.3448948280078,111.59945485102814,111.85836935883654,112.12146894529107,112.38859029274042,112.65957592894549,112.93427399495545,113.21253802338063,113.49422672654374,113.77920379401392,114.06733769905789,114.35850151356938,114.65257273105874,114.94943309731171,115.24896844834247,115.55106855529137,115.85562697593308,116.16254091247919,116.47171107537798,116.78304155282684,117.09643968572985,117.41181594784609,117.72908383088885,118.04815973434422,118.3689628597953,118.69141510954434,119.01544098933788,119.34096751500898,119.66792412286111,119.99624258362502,120.3258569198306,120.65670332644147,120.98872009460914,121.32184753840971,121.65602792443208,121.99120540409548,122.327325948577,122.66433728623679,123.0021888424354,123.34083168163981,123.68021845172194,124.02030333035691,124.36104197343322,124.70239146538995,125.04431027140176],[113.52312879418415,112.89289991354663,112.30336630042672,111.75272353981673,111.2392585840678,110.76134438599072,110.31743489265101,109.90606037254574,109.52582305115365,109.17539303192949,108.85350448171357,108.55895206124551,108.2905875830433,108.04731688033219,107.8280968720111,107.63193280983303,107.45787569505569,107.30501985281354,107.17250065336535,107.05949237020181,106.96520616575621,106.88888819615856,106.82981782711049,106.78730595354516,106.7606934162753,106.74934950932679,106.75267057210993,106.77007866100163,106.8010202952962,106.84496527283821,106.9014055509809,106.96985418881442,107.04984434688949,107.14092834091971,107.24267674618628,107.35467754958769,107.47653534648367,107.60787057967244,107.74831881801404,107.89753007237859,108.05516814674671,108.220910022431,108.39444527351944,108.575475511759,108.76371385921514,108.9588844471433,109.16072193960952,109.36897108048608,109.58338626253399,109.80373111736246,110.02977812512917,110.26130824291377,110.49811055076235,110.73998191445759,110.98672666412952,111.23815628786976,111.49408913956451,111.75435016020423,112.01877061197474,112.28718782446948,112.55944495240524,112.83539074425563,113.11487932125048,113.39776996622093,113.68392692179759,113.9732191974995,114.26552038527132,114.56070848305787,114.8586657260215,115.15927842503199,115.46243681207811,115.76803489226818,116.07597030210624,116.38614417374485,116.69846100493298,117.01282853439169,117.32915762236328,117.64736213609572,117.96735884003179,118.2890672904886,118.61240973462112,118.93731101347632,119.26369846895075,119.59150185447821,119.92065324927898,120.25108697601219,120.5827395216813,120.91554946164834,121.24945738662056,121.58440583248114,121.92033921283782,122.25720375417495,122.59494743349386,122.93351991833833,123.27287250910061,123.61295808351289,123.9537310432323,124.29514726242965,124.63716403830048,124.97974004341705],[113.27617325720691,112.6508587917552,112.06609434494062,111.52008116977497,111.01111161282499,110.53756376303281,110.09789646018719,109.69064463581431,109.31441496154633,108.96788178210835,108.64978331195395,108.35891807629392,108.09414157882993,107.8543631799245,107.63854317024011,107.44569002605999,107.27485783358769,107.1251438705072,106.99568633399113,106.88566220516921,106.79428524082756,106.72080408380346,106.66450048417531,106.62468762393524,106.60070853836451,106.59193462782878,106.59776425416342,106.61762141623512,106.65095449965392,106.69723509596358,106.7559568869635,106.82663459012137,106.90880296131091,107.00201585137005,107.10584531321024,107.21988075643146,107.3437281465981,107.47700924652396,107.61936089708513,107.77043433524813,107.92989454714451,108.09741965417015,108.27270033021105,108.45543924822432,108.64535055451009,108.84215936911893,109.04560131093348,109.25542204605586,109.47137685821573,109.69323023999243,109.9207555037196,110.15373441100657,110.39195681987711,110.63522034858525,110.88333005522202,111.13609813228221,111.39334361540575,111.65489210555626,111.92057550394145,112.19023175901863,112.46370462496907,112.74084343105585,113.0215028613179,113.30554274407815,113.59282785077825,113.88322770367463,114.1766163919595,114.47287239589302,114.7718784185557,115.07352122485082,115.37769148740762,115.68428363905316,115.99319573154052,116.30432930023514,116.61758923447921,116.9328836533667,117.25012378667628,117.56922386072401,117.89010098890623,118.21267506671903,118.53686867104905,118.86260696354067,119.18981759785666,119.51843063065529,119.84837843611902,120.17959562387631,120.51201896016453,120.8455872920936,121.18024147487264,121.5159243018702,121.85258043738615,122.19015635201661,122.52860026050213,122.86786206194958,123.20789328233171,123.54864701916198,123.89007788825761,124.23214197250063,124.57479677251385,124.91800115917268],[113.04054309519138,112.41991766996377,111.83970367560293,111.298107773205,110.79342745617369,110.32404571403926,109.8884260549342,109.48510785956711,109.11270204182283,108.76988699319261,108.45540479011963,108.16805764506141,107.90670458362554,107.67025833155773,107.45768239665458,107.26798833185305,107.10023316682678,106.95351699640541,106.82698071503323,106.71980388730694,106.63120274538846,106.56042830478161,106.50676459059468,106.46952696699394,106.44806056309082,106.44173878899458,106.44996193621699,106.47215585703158,106.50777071777568,106.55627982143275,106.61717849516528,106.68998303876545,106.7742297302688,106.86947388523626,106.97528896644587,107.09126574095392,107.21701148169196,107.3521492109533,107.4963169832957,107.64916720555303,107.81036599179473,107.97959255121535,108.1565386070626,108.34090784483638,108.53241538810029,108.73078730035374,108.93576011150829,109.14708036760241,109.36450420247439,109.58779693018994,109.81673265709497,110.05109391243253,110.29067129652663,110.53526314559382,110.7846752123021,111.03872036124524,111.29721827855185,111.55999519489248,111.82688362119109,112.09772209638791,112.37235494663697,112.65063205535618,112.93240864358265,113.2175450601156,113.50590658095575,113.79736321758327,114.0917895336339,114.38906446956437,114.68907117491435,114.99169684779892,115.29683258127989,115.604373216288,115.91421720078181,116.22626645484864,116.5404262414653,116.85660504265473,117.17471444078524,117.49466900477377,117.8163861809675,118.1397861884867,118.46479191882803,118.791328839531,119.11932490172664,119.44871045139196,119.77941814414513,120.11138286342276,120.44454164189091,120.77883358594514,121.11419980316589,121.45058333259911,121.78792907774012,122.12618374210219,122.46529576726142,122.8052152732692,123.14589400133322,123.48728525866896,123.82934386543278,124.1720261036461,124.51528966802996,124.85909361866891],[112.81623830813763,112.20007654817248,111.62419429241362,111.08680335010682,110.58620611411375,110.12079023901022,109.68902367689211,109.28945004380407,108.92068429198328,108.58140866518215,108.27036891621053,107.98637076754784,107.72827659743008,107.49500233523159,107.28551455125447,107.09882772721217,106.93400169477272,106.79013923050813,106.66638379649183,106.56191741661509,106.4759586794387,106.40776085909317,106.35661014636864,106.3218239827213,106.30274949045463,106.29876199282438,106.30926361827048,106.3336819833913,106.37146894966151,106.42209944924551,106.4850703755863,106.55989953474692,106.64612465376312,106.74330244251857,106.85100770589337,106.9688325031552,107.09638535176535,107.2332904729606,107.37918707664566,107.53372868329329,107.69658248069723,107.86742871356667,108.0459601040741,108.23188130159524,108.42490835998571,108.62476824084796,108.831198341334,109.04394604512568,109.26276829531007,109.48743118795495,109.71770958525518,109.95338674719197,110.19425398071097,110.44011030548334,110.69076213536955,110.94602297475873,111.20571312900292,111.46965942821288,111.73769496372371,112.00965883657729,112.28539591740893,112.56475661715636,112.84759666804487,113.13377691433311,113.42316311233013,113.71562573922536,114.01103981029459,114.30928470407176,114.61024399509746,114.91380529387622,115.21986009369495,115.52830362397262,115.83903470983026,116.15195563758543,116.46697202589129,116.78399270225593,117.10292958469005,117.42369756824506,117.74621441621547,118.0704006557915,118.39617947795807,118.72347664144725,119.05222038056083,119.38234131668865,119.71377237335729,120.04644869465167,120.38030756686051,120.71528834320276,121.05133237150027,121.38838292466814,121.72638513389995,122.06528592443136,122.40503395377182,122.7455795522972,123.08687466610505,123.42887280203402,123.7715289747579,124.11479965586618,124.45864272484896,124.80301742190537],[112.60325889604567,111.99133542638096,111.41956619537275,110.88616790048033,110.38944758664515,109.92779733794571,109.49968932606095,109.10367118852513,108.73836171202738,108.40244679807707,108.09467569022667,107.81385744375332,107.55885762024369,107.32859519094637,107.12203963403979,106.93820821213711,106.77616341742578,106.63501057281537,106.5138955783668,106.41200279309349,106.32855304297848,106.26280174673806,106.2140371514971,106.18157867111732,106.16477532045568,106.16300423931801,106.17566930032396,106.20219979531407,106.24204919531132,106.29469397940217,106.35963252822657,106.43638407806564,106.52448773179388,106.62350152321679,106.73300153155263,106.85258104303524,106.98184975681804,107.12043303254571,107.26797117713512,107.42411876846896,107.58854401385219,107.76092814122414,107.94096482124564,108.12835961850092,108.32282947016651,108.52410219060127,108.73191600041073,108.94601907862572,109.1661691367227,109.39213301328765,109.62368628820045,109.8606129152847,110.10270487243001,110.34976182825362,110.60159082442445,110.85800597282274,111.11882816675882,111.38388480551755,111.65300953153921,111.92604197958663,112.20282753728497,112.48321711645661,112.76706693470464,113.05423830673084,113.34459744490137,113.63801526860095,113.9343672219414,114.23353309941523,114.53539687910492,114.83984656308283,115.14677402465274,115.45607486210704,115.76764825868588,116.08139684844562,116.39722658775723,116.71504663217034,117.03476921839081,117.3563095511378,117.67958569465036,118.00451846863351,118.33103134843921,118.65905036928943,118.98850403435914,119.31932322654512,119.65144112375549,119.98479311756303,120.31931673507344,120.65495156386659,120.99163917987588,121.3293230780771,121.66794860586565,122.00746289900442,122.34781482003329,122.68895489903336,123.03083527664722,123.37340964925701,123.71663321623281,124.06046262916084,124.40485594297063,124.74977256888238],[112.40160485891533,111.79369430458971,111.22581938448035,110.69620142432558,110.20315187376801,109.74506701084566,109.32042300244062,108.92777129373037,108.56573430195546,108.23300139187725,107.92832511216811,107.6505176736777,107.39844765206621,107.17103689870197,106.9672576450106,106.78612978662822,106.62671833478586,106.4881310233271,106.36951606065806,106.27006001674229,106.18898583600762,106.12555096771625,106.0790456059801,106.04879103218194,106.03413805309408,106.03446552847552,106.04917898237754,106.07770929279997,106.11951145472523,106.17406341190258,106.240864953086,106.31943666872162,106.40931896436111,106.51007112733097,106.62127044342364,106.74251136059405,106.87340469685022,107.0135768897086,107.16266928476398,107.32033746108006,107.48625059125948,107.66009083418768,107.84155275857702,108.03034279555335,108.22617871864249,108.42878914961395,108.63791308873819,108.85329946810243,109.07470672671235,109.30190240618782,109.53466276593046,109.77277241671077,110.01602397168386,110.26421771390488,110.51716127946678,110.77466935543724,111.03656339181966,111.30267132680639,111.5728273246378,111.84687152541611,112.12464980626507,112.40601355325677,112.69081944356178,112.97892923730876,113.27020957866961,113.56453180571009,113.86177176857449,114.16180965559492,114.46452982693698,114.76982065541864,115.07757437415333,115.3876869306914,115.70005784734853,116.014590087429,116.33118992706315,116.64976683239773,116.97023334188749,117.29250495345202,117.61650001627204,117.94213962701264,118.26934753027142,118.59805002305754,118.9281758631215,119.25965618096141,119.59242439533982,119.9264161321568,120.26156914652954,120.59782324793659,120.93512022829266,121.27340379282606,121.61261949363715,121.95271466582122,122.29363836604587,122.63534131347802,122.97777583295971,123.32089580033804,123.66465658985771,124.00901502353004,124.35392932239519,124.69935905959981],[112.21127619674685,111.60715318279824,111.04295385973631,110.51690392164257,110.02731897548217,109.57259925771012,109.15122470603121,108.76175035941978,108.40280206176733,108.07307244658286,107.77131718203481,107.49635145732125,107.24704669289778,107.02232745849838,106.82116858416684,106.64259245068534,106.48566644685276,106.34950058204336,106.23324524336584,106.13608908756153,106.05725705852622,105.99600852202772,105.95163550981772,105.92346106591521,105.91083768836975,105.91314586029694,105.92979266443101,105.960210475849,106.0038557279031,106.06020774674666,106.12876765016465,106.2090573067149,106.30061835146479,106.40301125486117,106.51581444150634,106.63862345583165,106.7710501718617,106.91272204444945,107.0632813995323,107.22238476112665,107.3897022129191,107.56491679245745,107.7477239160684,107.93783083275267,108.13495610541379,108.33882911788582,108.5491896063166,108.76578721355583,108.98838106527896,109.21673936665563,109.45063901844551,109.6898652514701,109.9342112784724,110.18347796243701,110.43747350049652,110.69601312260234,110.95891880418533,111.22601899207959,111.49714834301933,111.77214747406556,112.05086272434924,112.33314592755707,112.61885419461638,112.90784970606686,113.19999951363459,113.49517535055266,113.79325345019393,114.0941143726107,114.39764283859334,114.70372757088367,115.01226114219669,115.32313982972549,115.63626347581837,115.95153535453579,116.26886204380899,116.58815330293828,116.90932195518008,117.23228377518775,117.55695738108055,117.88326413092906,118.21112802345471,118.54047560275153,118.87123586684817,119.20334017993754,119.5367221881102,119.87131773843296,120.20706480122894,120.5439033954128,120.88177551675059,121.220625068915,121.56039779721449,121.90104122488172,122.24250459180962,122.58473879563097,122.92769633504265,123.27133125527712,123.61559909563246,123.9604568389737,124.30586286312256,124.65177689405766],[112.03227290953994,111.43171206100683,110.87096962114065,110.34827539243135,109.86194889178783,109.41039407853908,108.99209443683263,108.60560838559338,108.24956499146302,107.92265996219379,107.62365189982671,107.35135879468378,107.10465474273843,106.88246687033559,106.68377245150857,106.50759620430841,106.35300775362677,106.21911924896419,106.10508312648997,106.01009000555096,105.93336671053429,105.87417440967263,105.83180686300985,105.80558877231715,105.79487422628279,105.7990452347822,105.81751034648448,105.8497033444611,105.89508201484497,105.95312698393455,106.02334061946256,106.10524599204535,106.19838589310483,106.30232190580736,106.41663352580089,106.54091732874802,106.67478618185281,106.81786849676807,106.96980752144003,107.13026066860853,107.29889887883112,107.47540601603325,107.65947829371969,107.85082373009877,108.04916163048034,108.25422209541701,108.46574555314596,108.68348231498615,108.90719215242254,109.13664389469092,109.37161504574549,109.61189141956281,109.85726679279573,110.10754257384998,110.36252748751374,110.62203727431789,110.88589440385597,111.15392780133686,111.42597258668378,111.70186982553513,111.98146629153754,112.2646142393573,112.55117118786838,112.84099971300492,113.13396724979654,113.42994590312878,113.72881226679941,114.03044725046249,114.33473591407427,114.64156730947796,114.95083432878283,115.26243355920946,115.57626514409537,115.8922326497658,116.21024293799476,116.53020604379201,116.85203505826865,117.17564601634504,117.5009577890759,117.82789198038263,118.1563728279891,118.48632710837146,118.81768404553881,119.1503752234736,119.4843345020666,119.81949793639153,120.15580369917159,120.49319200629516,120.83160504524972,121.17098690634381,121.51128351659764,121.85244257618606,122.19441349732446,122.53714734549229,122.88059678289601,123.22471601407419,123.56946073355719,123.91478807549198,124.26065656515267,124.60702607225601],[111.86459499729492,111.26737093921551,110.70986666869345,110.19031583669179,109.70704162268487,109.25845147333251,108.84303219484501,108.45934537225109,108.10602309104254,107.78176393871004,107.48532926554392,107.21553968576526,106.971271801588,106.75145513421359,106.55506924703569,106.38114104749758,106.22874225510773,106.09698702408943,105.98502971003045,105.89206277071091,105.81731479203177,105.76004863065079,105.7195596655565,105.69517415138769,105.68624766683315,105.69216365193145,105.71233202853801,105.74618789863639,105.79319031555089,105.85282112346617,105.92458386097961,106.00800272471319,106.10262158928145,106.20800308016952,106.3237276963072,106.44939297934312,106.58461272682321,106.72901624666466,106.88224765048717,107.0439651835259,107.21384058899551,107.39155850491524,107.57681589153103,107.76932148759158,107.96879529384223,108.17496808220741,108.3875809292261,108.60638477239303,108.83113998814318,109.06161599029386,109.29759084783036,109.53885092098889,109.78519051465381,110.03641154814382,110.2923232405184,110.55274181058391,110.81749019083145,111.08639775457837,111.35930005563122,111.63603857982477,111.91646050782984,112.20041848865756,112.48777042331787,112.77837925812334,113.07211278715535,113.36884346343827,113.66844821839119,113.97080828915047,114.27580905337955,114.58333987120153,114.89329393391168,115.20556811914318,115.52006285217942,115.83668197311917,116.1553326096205,116.47592505495875,116.79837265115309,117.1225916769238,117.44850124025811,117.77602317537334,118.10508194387454,118.43560453991734,118.76752039919366,119.1007613115694,119.43526133720898,119.77095672603257,120.10778584035742,120.44568908058372,120.78460881379002,121.12448930511263,121.46527665178668,121.80691871973421,122.14936508259031,122.4925669630619,122.83647717651949,123.18105007672925,123.52624150363175,123.87200873308488,124.21831042848542,124.56510659419466],[111.70824246001163,111.1141298174241,110.55964500239466,110.04302525442407,109.56259716817316,109.11677144209051,108.70403798006822,108.32296131939287,107.972176360506,107.65038437613178,107.35634927918645,107.08889413056576,106.84689786944664,106.62929225013245,106.43505897074824,106.26322698025274,106.11286995129575,105.98310390741929,105.87308499398742,105.78200738304112,105.7091013030187,105.65363118496238,105.61489391745775,105.59221720312689,105.58495801002077,105.59250111174455,105.61425771059147,105.64966413837469,105.69818063002087,105.75929016534157,105.83249737471596,105.91732750471832,106.01332543999446,106.12005477794771,106.23709695302529,106.36405040761701,106.50052980677306,106.646165294139,106.80060178667377,106.96349830587866,107.13452734341224,107.31337425910321,107.49973670950222,107.69332410523124,107.8938570954993,108.10106707825705,108.31469573455726,108.53449458577671,108.7602245724408,108.99165565346435,109.22856642470015,109.47074375574825,109.71798244404653,109.97008488531871,110.22686075951047,110.48812673140053,110.75370616511181,111.02342885180414,111.29713074986164,111.57465373693444,111.8558453732262,112.1405586754578,112.42865190096481,112.71998834142184,113.01443612571103,113.31186803148134,113.61216130496922,113.91519748867461,114.22086225650932,114.52904525605439,114.83963995758337,115.15254350952675,115.46765660007058,115.78488332459588,116.10413105868611,116.42531033643866,116.74833473383345,117.07312075692394,117.39958773462705,117.72765771590122,118.05725537111111,118.38830789738911,118.72074492781265,119.05449844422513,119.38950269353752,119.72569410735602,120.06301122478656,120.40139461827837,120.74078682237149,121.08113226522151,121.42237720278149,121.76446965552603,122.10735934760737,122.45099764833985,122.7953375159135,123.14033344324233,123.4859414058562,123.83211881175224,124.17882445312108,124.5260184598739],[111.56321529768999,110.97198869563267,110.42030462224432,109.906403645628,109.42861552825293,108.98535398481296,108.57511179250231,108.19645622701898,107.84802479985314,107.5285212744588,107.23671194075412,106.97142212908524,106.7315329463143,106.51597821809219,106.32374162264632,106.15385400257401,106.00539084219072,105.87746989895366,105.76924897836071,105.67992384254167,105.60872624349511,105.55492207260725,105.51780961871364,105.49671792753472,105.49100525584578,105.50005761422153,105.52328739264506,105.56013206367622,105.61005295825485,105.6725341095607,105.7470811606715,105.83322033206068,105.93049744524393,106.03847699914181,106.15674129595511,106.28488961356967,106.42253742170239,106.56931563919122,106.72486992999977,106.88886003566681,107.06095914208142,107.24085327859741,107.42824074763348,107.6228315830177,107.82434703545167,108.03251908356599,108.24708996913915,108.46781175513708,108.69444590531518,108.92676288420238,109.16454177635481,109.40756992384097,109.65564258097424,109.90856258537428,110.16614004449005,110.42819203676763,110.6945423266971,110.96502109301414,111.23946466937518,111.51771529686424,111.79962088772666,112.08503479975803,112.3738156208092,112.66582696290057,112.96093726546366,113.25901960725788,113.55995152653342,113.86361484903485,114.16989552346354,114.47868346403645,114.78987239979774,115.10335973036025,115.41904638776894,115.73683670419589,116.05663828519168,116.37836188823169,116.7019213063097,117.0272332563456,117.35421727218288,117.68279560196632,118.01289310969872,118.3444371807868,118.67735763139578,119.01158662144059,119.34705857105212,119.68371008036183,120.02147985245884,120.36030861937932,120.70013907099418,121.04091578667027,121.38258516958207,121.72509538356165,122.06839629237554,122.41243940132613,122.75717780107783,123.10256611361336,123.44856044023057,123.79511831149414,124.14219863905966,124.48976166929349],[111.42951351033014,110.84094757384133,110.29184552824236,109.78045101030374,109.30509670292409,108.86419910149996,108.45625363214738,108.07983009512925,107.73356840908416,107.4161746336911,107.12641725024709,106.86312368132374,106.62517703219092,106.41151303809266,106.22111720272981,106.05302211446116,105.90630492779276,105.78008499869253,105.67352166315037,105.58581214921264,105.51618961346092,105.46392129358549,105.42830676932398,105.40867632461118,105.40438940430809,105.41483315936236,105.43942107469854,105.47759167454076,105.52880730025286,105.59255295612355,105.66833521884627,105.75568120674031,105.85413760502988,105.96326974375187,106.08266072509677,106.21191059720114,106.35063557161105,106.49846728182133,106.65505208046517,106.82005037289046,106.99313598500292,107.17399556339778,107.36232800592458,107.55784392095096,107.76026511369933,107.96932409813421,108.18476363297202,108.40633628047419,108.63380398676681,108.86693768250802,109.10551690279445,109.34932942526706,109.59817092543655,109.85184464831087,110.11016109545703,110.37293772668517,110.63999867558724,110.91117447820837,111.18630181417146,111.46522325961395,111.74778705133122,112.03384686155827,112.323261582851,112.61589512255937,112.91161620641313,113.21029819076793,113.51181888308389,113.81606037023111,114.12290885424221,114.4322544951478,114.74399126055496,115.05801678164347,115.37423221527432,115.69254211191917,116.01285428913724,116.33507971033792,116.65913236858191,116.98492917518878,117.31238985292545,117.64143683356862,117.97199515963744,118.30399239011048,118.63735850994304,118.97202584321599,119.30792896975274,119.64500464505015,119.98319172337445,120.32243108388633,120.66266555965805,121.00383986945907,121.34590055218854,121.68879590384104,122.03247591689475,122.37689222202074,122.72199803201254,123.06774808784247,123.41409860675491,123.7610072323106,124.10843298630097,124.45633622245354],[111.30713709793199,110.72100645204989,110.17426772038883,109.66516734845116,109.19204069218657,108.75330679215134,108.34746349900324,107.97308292372351,107.62880718819908,107.31334445382882,107.02546520766529,106.76399878728137,106.52783012707658,106.31589671013393,106.12718571099876,105.96073131591434,105.81561220810165,105.69094920663585,105.58590304835649,105.49967230305393,105.43149141291624,105.38062884789693,105.34638536928885,105.32809239435633,105.32511045540764,105.33682774716715,105.362658756752,105.40204297096845,105.45444365601493,105.51934670503017,105.59625954924023,105.68471012875725,105.78424591935226,105.89443301177792,106.01485524045016,106.14511335851135,106.28482425649922,106.43362022202929,106.59114823807012,106.75706931754945,106.93105787217678,107.11280111350422,107.30199848437569,107.498361119031,107.70161133024224,107.91148212196161,108.12771672605581,108.35006816178804,108.5782988167953,108.81218004838121,109.05149180401892,109.2960222600264,109.54556747743365,109.79993107412831,110.0589239124115,110.32236380115334,110.59007521178229,110.86188900738675,111.13764218425084,111.41717762518384,111.70034386403978,111.98699486085849,112.2769897870903,112.5701928203983,112.86647294855938,113.16570378201151,113.46776337462055,113.77253405226351,114.07990224884533,114.38975834938832,114.70199653985493,115.01651466337657,115.33321408258686,115.65199954776585,115.97277907052271,116.29546380275723,116.61996792065004,116.94620851345343,117.27410547685498,117.60358141070799,117.93456152092723,118.26697352536004,118.60074756345442,118.93581610955107,119.27211388963948,119.60957780142078,119.94814683753329,120.28776201179954,120.62836628836305,120.96990451358775,121.31232335060093,121.65557121636422,121.999598221165,122.34435611042367,122.68979820871758,123.0358793659296,123.38255590542913,123.72978557420173,124.07752749484492,124.42574211935401],[111.19608606049573,110.61216533025849,110.06757119868372,109.56055266007034,109.08944749604052,108.6526770567673,108.24874139307005,107.87621471280198,107.53374113719774,107.22003073487181,106.9338558130088,106.67404744695787,106.43949223097128,106.2291292342161,106.0419471474531,105.87698160693364,105.73331268311767,105.61006252278376,105.50639313397899,105.42150430406556,105.35463164186096,105.30504473554186,105.27204541860823,105.25496613677001,105.25316840914465,105.26604137763586,105.29300043880554,105.33348595295926,105.38696202554102,105.45291535628053,105.5308541518534,105.62030709811148,105.72082238821103,105.8319668032199,105.95332484201528,106.08449789750031,106.22510347636678,106.37477445981511,106.53315840281438,106.69991686964387,106.87472480360297,107.05726992891672,107.24725218298668,107.44438317725786,107.6483856850804,107.85899315504832,108.07594924839046,108.29900739907866,108.52793039540077,108.76248998182193,109.0024664800284,109.24764842811913,109.49783223696551,109.75282186282665,110.01242849535335,110.276470260172,110.5447719352823,110.81716468054941,111.09348577961318,111.37357839357381,111.65729132585253,111.94447879765877,112.23500023352697,112.52872005641744,112.82550749190264,113.12523638098847,113.42778500114349,113.7330358951321,114.04087570727292,114.35119502675823,114.66388823769762,114.97885337555948,115.29599198970651,115.61520901173571,115.9364126293482,116.25951416548955,116.5844279625141,116.9110712711396,117.23936414397127,117.56922933338463,117.90059219356812,118.23338058653557,118.56752479192986,118.90295742044613,119.2396133307123,119.57742954947395,119.9163451949354,120.25630140311893,120.59724125710922,120.93910971905648,121.28185356481903,121.62542132113114,121.9697632051865,122.31483106653491,122.66057833119299,123.00695994787473,123.35393233625324,123.70145333716727,124.04948216469181,124.39797935999489],[111.09636039802105,110.51442420846718,109.97175596312699,109.46660694516129,108.9973171144858,108.56230989534779,108.16008731434766,107.78922546236463,107.44837025608027,107.13623347682022,106.85158906627764,106.59326966035334,106.36016334387496,106.15121061033901,105.96540151209297,105.8017729875189,105.65940635284058,105.53742494713619,105.43499192001782,105.3513081522476,105.28561030029508,105.23716895652008,105.20528691728227,105.18929755185239,105.18856326551888,105.20247405076837,105.23044612085907,105.2719206205132,105.32636240883114,105.39325890987466,105.4721190266859,105.56247211480296,105.66386701160631,105.775871118078,105.89806952979224,106.03006421416809,106.17147323121372,106.32192999517876,106.48108257469816,106.64859302917371,106.82413677928156,107.0074020096354,107.19808910175769,107.39591009563151,107.60058817821388,107.81185719739435,108.02946119997598,108.25315399234593,108.48269872258328,108.71786748283021,108.95844093082282,109.20420792954513,109.45496520403215,109.71051701440588,109.97067484428261,110.23525710374116,110.5040888460871,110.77700149769632,111.0538326002585,111.33442556478377,111.61862943676917,111.90629867195901,112.19729292216118,112.49147683061676,112.78871983644277,113.08889598769902,113.39188376265258,113.69756589883684,114.00582922952489,114.31656452725726,114.62966635408313,114.94503291819221,115.26256593663327,115.58217050382895,115.90375496561356,116.22723079853513,116.55251249417408,116.87951744824721,117.20816585427434,117.53838060159842,117.87008717756005,118.203213573637,118.53769019536955,118.87344977590094,119.21042729297115,119.54855988920946,119.88778679558074,120.22804925784452,120.56929046589663,120.91145548586518,121.25449119484301,121.5983462181418,121.94297086895907,122.28831709035457,122.63433839943869,122.98098983367781,123.32822789922717,123.6760105212074,124.02429699584141,124.37304794437627],[111.00796011050812,110.42778308667576,109.88682201371871,109.38333020372394,108.91564954752246,108.48220530789268,108.08150126283614,107.71211517241146,107.37269454484661,107.06195267967398,106.77866496747157,106.52166542746788,106.2898434657875,106.08214083850277,105.89754880491827,105.73510545767014,105.59389321727055,105.47303647969308,105.37169940647301,105.28908384759991,105.2244273882187,105.17700151083156,105.14610986531083,105.13108663960342,105.13129502453042,105.14612576656477,105.17499580291256,105.2173469736302,105.27264480588531,105.3403773658125,105.4200541737374,105.51120517883173,105.61337978953796,105.72614595635197,105.84908930378094,105.98181230851461,106.12393352104013,106.27508682812024,106.43492075372134,106.60309779613895,106.77929379921252,106.96319735566024,107.15450924068863,107.35294187415195,107.5582188096426,107.77007424899956,107.98825258081247,108.21250794159003,108.44260379834273,108.67831255140612,108.91941515640215,109.16570076430452,109.41696637863352,109.67301652886592,109.93366295919935,110.1987243318608,110.46802594419681,110.74139945882737,111.0186826461867,111.29971913881383,111.58435819679001,111.8724544837592,112.16386785299277,112.45846314299618,112.75610998217977,113.05668260214304,113.36005965914795,113.66612406337762,113.97476281560134,114.2858668508857,114.59933088901141,114.91505329127479,115.23293592336718,115.55288402404547,115.87480607931886,116.19861370189368,116.5242215156299,116.85154704477635,117.18051060776429,117.51103521534938,117.84304647290304,118.17647248666432,118.51124377377332,118.8472931759156,119.18455577641598,119.52296882062737,119.86247163946926,120.20300557597631,120.54451391472526,120.88694181401377,121.23023624067282,121.57434590739634,121.91922121248273,122.2648141818825,122.61107841345488,122.9579690233389,123.30544259435106,123.65345712632205,124.0019719882939,124.35094787249801],[110.93088519795698,110.35224196488437,109.81276935045881,109.31072243575844,108.84444479515049,108.41236329440216,108.01298323853558,107.64488384294241,107.30671400349684,106.99718834343311,106.71508351659094,106.45923474830155,106.22853259670929,106.0219199187073,105.83838902592899,105.67697901738742,105.53677327640749,105.41689712045459,105.31651559334473,105.23483139012265,105.17108290563168,105.12454239847644,105.09451426269389,105.08033340002302,105.0813636861793,105.09699652502513,105.12664948496608,105.16976501231035,105.22580921670341,105.29427072409413,105.37465959300833,105.46650629019776,105.56936072200617,105.68279131804192,105.80638416398145,105.93974218053984,106.08248434584596,106.23424495863959,106.39467293988396,106.56343117053956,106.74019586339581,106.92465596699108,107.11651259977958,107.31547851281918,107.52127757936663,107.73364430986415,107.95232339089979,108.17706924681085,108.40764562267915,108.64382518754952,108.88538915676637,109.13212693239726,109.38383576076973,109.64032040620695,109.90139284010357,110.166871944531,110.43658322961137,110.71035856394265,110.98803591739798,111.26945911566392,111.55447760591487,111.84294623305948,112.13472502602184,112.42967899355571,112.72767792911355,113.02859622432051,113.33231269062955,113.63871038875452,113.94767646550225,114.2591019976432,114.57288184248246,114.8889144948072,115.20710194990818,115.5273495723853,115.84956597046406,116.1736628755655,116.49955502688177,116.82716006072697,117.15639840444108,117.4871931746376,117.81947007959721,118.15315732561756,118.48818552714116,118.82448762049015,119.16199878104699,119.50065634372775,119.84039972660111,120.18117035751419,120.52291160359498,120.86556870350246,121.20908870230843,121.55342038889449,121.89851423575745,122.24432234111876,122.59079837324131,122.93789751685807,123.28557642162492,123.6337931525114,123.98250714204903,124.33167914436024],[110.86513566036757,110.28780084309298,109.74959797334738,109.24878364126455,108.78370285736995,108.35278385487609,107.95453324144596,107.58753147395761,107.25042863203092,106.9419404680975,106.66084471363544,106.40597762285408,106.17623073663997,105.97054785095273,105.78792217512522,105.6273936666708,105.48804653025145,105.3690068694205,105.26944048063277,105.18855077981566,105.12557685253415,105.07979161945468,105.05050010943155,105.03703783311137,105.03876925046556,105.05508632614936,105.08540716701958,105.12917473655362,105.18585564128561,105.25493898471953,105.33593528449833,105.42837544890104,105.53180980901074,105.64580720314781,105.76995411039368,105.90385383024392,106.04712570563116,106.19940438673683,106.36033913318602,106.52959315237571,106.70684297183148,106.89177784362818,107.08409917903042,107.28352001163319,107.4897644873859,107.7025673799878,107.92167363023802,108.14683790800828,108.37782419559257,108.6144053912605,108.8563629319155,109.10348643382336,109.35557335044054,109.61242864642881,109.87386448699519,110.13969994175174,110.40976070233094,110.68387881304213,110.96189241389229,111.24364549533406,111.52898766414388,111.8177739198597,112.10986444124838,112.40512438229547,112.70342367724433,113.00463685423149,113.30864285709731,113.61532487496756,113.92457017922757,114.23626996753002,114.55031921449626,114.86661652878939,115.1850640162564,115.50556714884846,115.82803463904929,116.15237831955032,116.47851302792938,116.80635649609901,117.13582924430466,117.46685447946294,117.79935799764239,118.13326809049677,118.46851545547328,118.80503310962443,119.14275630686397,119.4816224585106,119.82157105697614,120.1625436024583,120.50448353250584,120.84733615433103,121.19104857974989,121.53556966263658,121.8808499387833,122.22684156806341,122.57349827879813,122.92077531423523,123.26862938104854,123.61701859977511,123.96590245710703,124.31524175996283],[110.81071149773987,110.23445972130159,109.69730788238439,109.19751382024245,108.73342373418079,108.30346698931451,107.90615127156708,107.54005806545695,107.2038384304488,106.89620905366729,106.61594855860518,106.36189405112565,106.13293788557964,105.92802463523884,105.74614825250681,105.58634940552015,105.44771297880231,105.32936572659101,105.23047406833723,105.15024201667906,105.08790922892618,105.0427491737662,105.01406740552382,105.00119993886834,105.00351171738907,105.02039516993746,105.05126884907307,105.09557614635997,105.15278407963177,105.22238214768865,105.30388124820766,105.39681265494168,105.50072705055182,105.61519361166981,105.73979914301763,105.8741472576268,106.01785760039583,106.17056511241189,106.33191933362755,106.50158374164714,106.67923512451962,106.86456298557135,107.05726897844117,107.25706637059405,107.46367953370043,107.67684345937079,107.89630329882711,108.12181392518251,108.35313951708302,108.59005316253915,108.83233648184957,109.07977926858271,109.33217914764623,109.58934124953154,109.85107789987421,110.11720832352295,110.38755836235526,110.6619602061259,110.94025213566945,111.22227827782437,111.50788837147689,111.79693754415993,112.08928609867232,112.38479930921544,112.68334722657201,112.98480449187599,113.28905015855139,113.59596752201671,113.90544395677735,114.21737076054616,114.53164300505277,114.84815939322148,115.16682212241173,115.48753675343494,115.81021208507443,116.13476003384831,116.46109551877309,116.78913635089268,117.11880312735502,117.45001912982544,117.78271022703866,118.11680478130191,118.45223355876944,118.78892964331865,119.12682835386701,119.46586716497576,119.80598563059444,120.14712531080862,120.48922970145799,120.83224416649966,121.17611587299719,121.52079372862234,121.86622832156024,122.21237186271638,122.5591781301253,122.90660241547035,123.25460147262218,123.60313346811344,123.95215793346784,124.30163571930595],[110.76761271007391,110.19221859951017,109.65589907756973,109.1569129726921,108.69360742558302,108.26441269771745,107.86783732889914,107.50246361744038,107.16694339875045,106.85999410014247,106.58039505150026,106.32698403311622,106.09865404352834,105.8943502715659,105.71306725807389,105.5538462339355,105.41577262206025,105.29797369196604,105.19961635645805,105.11990510071284,105.05808003480747,105.01341506141107,104.98521615097054,104.9728197172938,104.97559108694989,104.99292305638946,105.02423453112665,105.06896924172958,105.12659453174204,105.19660021300153,105.27849748413612,105.37181790831956,105.47611244662936,105.5909505436077,105.71591926185347,105.85062246268836,105.99468003013993,106.14772713566481,106.30941354120841,106.47940293835401,106.65737232146003,106.84301139282066,107.0360219980119,107.23611758970168,107.44302271831025,107.6564725480131,107.87621239666707,108.10199729833352,108.33359158715037,108.57076850138529,108.81330980656848,109.06100543667542,109.31365315238665,109.57105821551519,109.83303307874075,110.0993970898446,110.36997620968461,110.64460274319394,110.92311508272961,111.20535746313463,111.49117972791396,111.7804371059602,112.07298999829365,112.36870377431552,112.66744857709649,112.96909913725402,113.27353459499159,113.580638329902,113.89029779815158,114.20240437669148,114.51685321415211,114.83354308810334,115.15237626837404,115.47325838614474,115.79609830853944,116.12080801845943,116.44730249941252,116.77549962510771,117.10532005359229,117.4366871257252,117.76952676778603,118.10376739803293,118.43933983702969,118.77617722157258,119.11421492205618,119.45339046312341,119.79364344745593,120.13491548256501,120.47715011045122,120.82029274000818,121.1642905820502,121.50909258685179,121.85464938408832,122.20091322507763,122.54783792722283,122.89537882056355,123.24349269634568,123.5921377575264,123.94127357113145,124.29086102238944],[110.73583929736975,110.16107747771879,109.62537155890355,109.12698109861347,108.66425393157661,108.2356209800849,107.83959141344214,107.47474812990795,107.13974353693594,106.83329560752296,106.55418419232055,106.3012475688258,106.07337921048611,105.86952475993375,105.68867919182645,105.52988415191695,105.39222546002524,105.27483076554552,105.17686734499527,105.09754003191692,105.03608927017834,104.99178928238925,104.96394634577193,104.95189716838806,104.95500735914808,104.97266998550539,105.00430421318011,105.04935402266209,105.10728699761631,105.17759318065818,105.25978399228387,105.35339120903471,105.45796599724332,105.57307799896159,105.69831446690095,105.8332794454287,105.97759299486344,106.13089045649558,106.29282175592883,106.46305074249635,106.64125456265283,106.82712306537607,107.02035823774263,107.22067366895608,107.42779404121529,107.64145464591468,107.86140092375804,108.08738802746129,108.31918040579477,108.55655140779903,108.79928290607245,109.04716493810149,109.29999536466177,109.55757954437975,109.8197300235947,110.08626624071691,110.35701424431876,110.63180642424612,110.91048125507277,111.19288305126489,111.47886173345513,111.76827260526041,112.06097614011249,112.35683777759569,112.65572772881796,112.95752079036546,113.26209616641817,113.56933729862338,113.87913170335034,114.19137081596612,114.50594984179429,114.822767613435,115.14172645414357,115.46273204697785,115.78569330944448,116.11052227338362,116.43713396984795,116.76544631874424,117.09538002301632,117.42685846716198,117.75980761988446,118.09415594068997,118.42983429025416,118.76677584438647,119.10491601143138,119.44419235295339,119.78454450756074,120.12591411772759,120.46824475948573,120.81148187485667,121.15557270690925,121.50046623732506,121.8461131263675,122.19246565514725,122.53947767009073,122.8871045295146,123.23530305221912,123.58403146801381,123.93324937009781,124.28291766921342],[110.71539125962734,110.1410363559274,109.60572532638577,109.10771819800661,108.64536325216154,108.21709183641681,107.82141352519598,107.45691160285976,107.12223884500527,106.81611357580879,106.53731598106616,106.28468465825439,106.05711338645284,105.85354810034237,105.6729840537644,105.51446315946433,105.37707149269714,105.25993694732962,105.16222703394894,105.08314681029142,105.02193693503858,104.97787183670077,104.95025798992776,104.93843229215092,104.94176053398355,104.9596359572852,104.99147789523366,105.03673048915783,105.0948614772547,105.16536105065849,105.24774077265084,105.34153255708715,105.44628770239368,105.56157597773142,105.68698475816034,105.82211820584789,105.96659649456643,106.12005507490424,106.28214397778848,106.4525271540741,106.63088184809804,106.81689800323764,107.01027769763327,107.21073460835726,107.4179935024157,107.63178975307541,107.85186888009986,108.07798611256565,108.30990597301607,108.54740188178032,108.79025578036129,109.03825777286086,109.29120578447176,109.54890523612512,109.81116873443608,110.07781577613962,110.34867246625781,110.62357124928249,110.90235065269881,111.18485504221536,111.47093438810032,111.76044404206064,112.05324452412879,112.34920131905606,112.64818468173625,112.95006945121047,113.25473487283085,113.56206442818076,113.87194567237339,114.18427007836991,114.49893288797912,114.81583296921653,115.13487267972012,115.45595773593415,115.77899708778945,116.10390279862101,116.43058993007944,116.75897643180234,117.08898303562724,117.42053315413609,117.75355278333393,118.08797040927288,118.42371691844278,118.7607255117602,119.09893162199265,119.43827283446595,119.77868881090879,120.12012121629647,120.46251364856134,120.8058115710452,121.14996224757402,121.49491468004219,121.84061954839775,122.18702915292512,122.53409735872901,122.88177954232387,123.23003254024241,123.57881459957581,123.92808533036703,124.27780565977775],[110.70626859684654,110.13209523413603,109.59696038001638,109.09912427087147,108.63693538733797,108.20882526671321,107.81330366416067,107.44895403629575,107.11442932295853,106.808448005,106.52979041773695,106.27729530140205,106.04985657142858,105.84642029279185,105.66598184388789,105.50758325657779,105.37031072007608,105.25329223731816,105.15569542331892,105.07672543583625,105.01562302938829,104.97166272434561,104.94415108343814,104.93242508858232,104.93585061145633,104.95382097172883,104.98575557728714,105.03109864121672,105.08931797065699,105.15990382300262,105.24236782523695,105.33624195247681,105.44107756208055,105.55644447991727,105.68193013563136,105.81713874394582,105.9616905292488,106.11522099089069,106.27738020678777,106.44783217308722,106.62625417779559,106.81233620640519,107.00578037768385,107.2063004079053,107.4136211019113,107.62747786949552,107.84761626569251,108.07379155364676,108.30576828881443,108.54331992332911,108.78622842943503,109.03428394095359,109.28728441181642,109.54503529075151,109.80734921126493,110.07404569611289,110.34495087550177,110.61989721830311,110.89872327560795,111.18127343598584,111.46739769184968,111.75695141636093,112.0497951503425,112.34579439869665,112.64481943585142,112.9467451197889,113.25145071422979,113.55881971857437,113.86873970522102,114.18110216390305,114.49580235270672,114.81273915544784,115.13181494510391,115.45293545301389,115.77600964357433,116.10094959417157,116.42767038010675,116.75608996428187,117.08612909142485,117.41771118664732,117.75076225813457,118.08521080378173,118.42098772159547,118.75802622369376,119.0962617537399,119.43563190766081,119.7760763575,120.11753677827143,120.45995677767817,120.80328182857363,121.14745920404462,121.49243791500302,121.83816865017914,122.18460371841141,122.5316969931376,122.87940385899105,123.22768116041559,123.57648715221237,123.92578145193897,124.27552499408266],[110.70847130902752,110.13425411234462,109.59907671979545,109.10119931720811,108.63897033710572,108.21082127097417,107.81526183033624,107.45087543021576,107.11631497079551,106.81029889509654,106.53160750233307,106.27907949826869,106.05160876541328,105.84814133728214,105.66767256219674,105.50924444325719,105.37194314216192,105.25489663551123,105.15727251310531,105.07827590855143,105.01714755322743,104.97316194532382,104.94562562630315,104.93387555768244,104.93727759156647,104.95522502883642,104.98713725934064,105.03245847883861,105.09065647782329,105.16122149769049,105.24366515004229,105.33751939520378,105.44233557630383,105.55768350551908,105.68315059931423,105.81834105972243,105.96287509891057,106.11638820445502,106.27853044292631,106.44896579953571,106.62737155174545,106.81343767487908,107.00686627789442,107.20737106760005,107.41467683970218,107.6285189951748,107.84864308053605,108.07480435070471,108.30676735318973,108.54430553244558,108.78720085329363,109.0352434423796,109.28823124669582,109.54596970825867,109.80827145408118,110.0749560006367,110.34584947205066,110.62078433130797,110.89959912380003,111.18213823257641,111.46825164470309,111.75779472816104,112.05062801875366,112.34661701651726,112.64563199116348,112.94754779610084,113.2522436906149,113.55960316980411,113.86951380189299,114.18186707256537,114.49655823597715,114.81348617212905,115.13255325029475,115.453665198217,115.77673097679916,116.10166266003507,116.42837531992996,116.75678691618293,117.08681819040937,117.41839256469572,117.75143604428627,118.08587712421648,118.42164669971235,118.75867798018714,119.09690640667336,119.43626957253807,119.77670714733452,120.11816080365256,120.46057414683618,120.8038926474421,121.14806357632099,121.49303594220764,121.83876043171158,122.18518935160598,122.53227657331655,122.87997747951623,123.22824891273869,123.57704912592348,123.92633773481371,124.27607567212786],[110.72199939617028,110.14751299055324,109.6120743457229,109.11394333701647,108.65146810146487,108.22307984919956,107.82728802372276,107.46267578462006,107.12789578851638,106.82166624609842,106.54276723485437,106.29003724885432,106.06236996840707,105.85871123381327,105.67805620869109,105.51944671950262,105.38196875895486,105.26475014190881,105.16695830330812,105.08779822843692,105.02651050655598,104.98236949963541,104.95468161852267,104.94278369945125,104.94604147431394,104.96384812860791,104.99562294139417,105.04081000202366,105.09887699875368,105.1693140747221,105.25163274706689,105.34536488526808,105.45006174506365,105.56529305453691,105.69064614920889,105.82572515317793,105.9701502035518,106.12355671559727,106.28559468620446,106.45592803341972,106.63423396994774,106.82020240865896,107.01353539826491,107.21394658744171,107.42116071578836,107.63491313011333,107.85494932463048,108.08102450373933,108.31290316614204,108.55035870912958,108.79317305193723,109.041136277139,109.29404628911009,109.55170848864668,109.81393546288491,110.08054668971104,110.35136825590442,110.6262325882971,110.90497819727506,111.18744943198695,111.47349624666047,111.7629739774614,112.0557431293623,112.35166917251816,112.6506223476724,112.95247748014629,113.25711380198634,113.56441478186989,113.87426796238948,114.18656480435698,114.50120053779035,114.8180740192601,115.1370875952928,115.45814697154327,115.78116108746399,116.10604199621177,116.43270474954912,116.76106728750538,117.09105033258075,117.42257728828135,117.75557414178904,118.08996937057712,118.42569385279327,118.76268078124025,119.10086558079284,119.44018582909786,119.78058118041223,120.12199329243991,120.46436575603535,120.80764402765057,121.15177536440324,121.49670876165602,121.84239489299522,122.188786052509,122.53583609926589,122.88350040389946,123.23173579721174,123.58050052070917,123.92975417899123,124.27945769391351],[110.74685285827481,110.17187186876184,109.6359532577988,109.13735633029656,108.67442868041536,108.24560100138946,107.84938224432014,107.48435509950846,107.14917177612104,106.84255005800567,106.56326961530097,106.31016855315893,106.08214018040984,105.87812998238515,105.69713278337082,105.53819008531413,105.40038757045474,105.28285275651098,105.18475279392729,105.1052923954928,105.04371188937405,104.99928538728024,104.97131906009679,104.95914951388863,104.96214225969872,104.97969027104332,105.01121262344765,105.05615321077184,105.11397953344807,105.18418155409745,105.26627061631071,105.35977842266963,105.46425606835986,105.57927312697068,105.70441678531527,105.8392910243121,105.98351584317241,106.1367265243173,106.29857293662192,106.46871887473903,106.64684143240238,106.83263040774492,107.02578773879539,107.22602696743013,107.43307273016983,107.64666027431116,107.86653499797582,108.09245201275068,108.3241757276713,108.5614794533811,108.80414502536577,109.05196244523171,109.30472953905903,109.56225163191569,109.82434123767607,110.09081776333576,110.36150722706304,110.63624198927037,110.91486049603303,111.19720703421761,111.48313149772201,111.7724891642616,112.0651404821684,112.36095086669916,112.65979050537821,112.96153417192519,113.26606104834394,113.57325455477186,113.88300218671036,114.19519535927782,114.50972925814628,114.82650269684096,115.14541798009786,115.46638077299288,115.78929997556865,116.11408760270159,116.4406586689641,116.76893107824938,117.09882551793889,117.43026535740407,117.76317655064285,118.09748754286375,118.43312918083843,118.77003462685333,119.10813927609827,119.44738067733989,119.78769845673332,120.12903424463339,120.47133160527572,120.81453596919887,121.15859456829133,121.50345637334811,121.84907203402989,122.19539382112028,122.54237557098554,122.88997263214065,123.23814181383457,123.58684133656939,123.93603078447154,124.28567105943968],[110.78303169534098,110.2073307469704,109.67071345602305,109.17143829704837,108.70785207395726,108.27838472754389,107.88154449212841,107.51591337488098,107.18014293360956,106.87295033081826,106.59311464367283,106.33947341118258,106.11091940142163,105.90639758299785,105.72490228623606,105.56547454069164,105.42719957666164,105.30920447931756,105.21065598496286,105.13075840971902,105.06875170168151,105.02390960825853,104.99553795102534,104.98297300099468,104.98557994772082,105.00275145614253,105.0339063055012,105.07848810508314,105.13596408190655,105.20582393581662,105.28757875777366,105.38076000740845,105.48491854619246,105.59962372282043,105.72446250763348,105.8590386731251,106.00297201777252,106.15589763061523,106.31746519417889,106.48733832349387,106.66519393910937,106.85072167213706,107.04362329948586,107.24361220756529,107.45041288284652,107.66376042776822,107.88340010057215,108.1090868777388,108.34058503777753,108.57766776520026,108.82011677357913,109.06772194665774,109.32028099654275,109.57759913806548,109.83948877845472,110.10576922151115,110.37626638552653,110.65081253422782,110.92924602007402,111.21141103926828,111.49715739788766,111.78634028856182,112.07882007717187,112.37446209906035,112.67313646428092,112.9747178714376,113.27908542968774,113.58612248850997,113.89571647485577,114.20775873732794,114.52214439704493,114.83877220487157,115.15754440471005,115.47836660256586,115.8011476411133,116.12579947950459,116.4522370781751,116.78037828841488,117.11014374648394,117.44145677206411,117.77424327084783,118.10843164107625,118.44395268384767,118.78073951702619,119.11872749258985,119.45785411726453,119.79805897629751,120.13928366023305,120.48147169455727,120.82456847208725,121.16852118798518,121.51327877728411,121.85879185481559,122.20501265743987,122.55189498847557,122.89939416423985,123.24746696260749,123.59607157350419,123.94516755125471,124.29471576870628],[110.83053590736901,110.25388962517901,109.71635494039577,109.21618923727192,108.75173828209056,108.32143102766281,107.92377476714761,107.5573506107377,107.22080926098191,106.91286706453626,106.63230231996994,106.37795182292523,106.14870763144238,105.94351403565143,105.76136471728674,105.60130008563515,105.46240477757551,105.34380531032878,105.24466787641487,105.16419627111564,105.10162994347843,105.05624216257,105.02733829130857,105.01425416076931,105.01635453838016,105.03303168390568,105.06370398755469,105.1078146849576,105.16483064412897,105.23424121987945,105.31555717145596,105.40830963948461,105.51204917856153,105.62634484208617,105.75078331616342,105.88496809961688,106.02851872735201,106.18107003449099,106.34227145887523,106.5117863796841,106.68929149006874,106.87447620183536,107.06704208033617,107.26670230784732,107.47318117381852,107.68621359048454,107.90554463241929,108.13092909870353,108.3621310964608,108.5989236445869,108.84108829657751,109.08841478141714,109.34070066156117,109.59775100709624,109.85937808522074,110.12540106423694,110.39564573129496,110.66994422316961,110.94813476939795,111.23006144713915,111.51557394715721,111.80452735036206,112.09678191437283,112.39220286960156,112.69066022438051,112.99202857868353,113.29618694601791,113.60301858308416,113.91241082682558,114.22425493850727,114.53844595448646,114.85488254335206,115.17346686912941,115.49410446026209,115.81670408409791,116.14117762662067,116.46743997718202,116.79540891800183,117.12500501821575,117.4561515322612,117.78877430240379,118.12280166521477,118.45816436182103,118.79479545175886,119.13263023026751,119.4716061488715,119.811662739105,120.15274153923885,120.49478602388,120.83774153631559,121.18155522348496,121.52617597346371,121.8715543553525,122.2176425614678,122.56439435173597,122.91176500019711,123.25971124353009,123.60819123151347,123.95716447934062,124.30659182171323],[110.88936549435869,110.31154850338766,109.7728777109169,109.27160915096725,108.80608730481526,108.37473990174614,107.97607306937756,107.60866680707859,107.27117075823811,106.96230025915952,106.68083264419234,106.42560378838691,106.19550487047225,105.9894793403458,105.80652007652286,105.64566672014463,105.50600317319638,105.38665524954446,105.28678846828322,105.20560597968257,105.14234661476475,105.09628305021482,105.06672008094634,105.0529929932126,105.05446603167695,105.07053095433267,105.10060566960817,105.14413295039505,105.20057922011547,105.26943340628613,105.35020585735735,105.44242731889796,105.54564796546704,105.65943648476789,105.78337921090511,105.91707930378745,106.06015597191085,106.21224373594461,106.37299173071106,106.54206304330968,106.71913408528047,106.90389399683973,107.09604408134648,107.29529726827617,107.50137760308571,107.7140197624602,107.93296859351729,108.1579786756451,108.38881390372096,108.62524709154115,108.86705959436075,109.1140409495098,109.36598853411438,109.62270723900788,109.88400915797415,110.14971329151329,110.41964526436828,110.69363705609558,110.97152674400488,111.25315825782999,111.53838114553093,111.82705034966229,112.11902599377126,112.4141731783231,112.71236178567707,113.0134662936629,113.3173655973342,113.62394283849446,113.93308524261988,114.24468396281581,114.55863393047073,114.87483371228237,115.19318537335597,115.51359434608165,115.83596930452245,116.1602220440498,116.4862673659848,116.81402296701027,117.14340933313437,117.47434963799549,117.80676964531092,118.14059761527908,118.47576421475863,118.81220243105146,119.14984748913115,119.48863677216093,119.82850974515576,120.16940788165091,120.51127459324384,120.85405516188391,121.19769667479049,121.54214796188717,121.88735953564056,122.23328353320409,122.57987366076669,122.92708514001225,123.27487465660275,123.62320031059731,123.97202156872929,124.32129921846061],[110.95952045631012,110.38030738159625,109.84028176758649,109.33769803813436,108.87089914213134,108.43831134979406,108.03843939881853,107.6698619639036,107.33122742537812,107.02124991468816,106.73870561634003,106.48242930756759,106.251311118511,106.04429349708097,105.86036836394449,105.69857444422027,105.55799476352429,105.4377542969646,105.337017760568,105.25498753541987,105.1909017155406,105.1440322711931,105.1136833199386,105.09918949832452,105.09991442761093,105.11524926742362,105.14461135166171,105.18744290139571,105.24320980986595,105.31140049503648,105.39152481547801,105.48311304564861,105.58571490690908,105.69889865086554,105.82225019185853,105.95537228563668,106.09788375144912,106.24941873497608,106.40962600968628,106.57816831437073,106.75472172474457,106.93897505715027,107.13062930251681,107.32939708885166,107.53500217064827,107.74717894369508,107.96567198386619,108.19023560856344,108.42063345955822,108.656638106063,108.8980306669289,109.14460045093591,109.39614461420233,109.65246783380043,109.91338199671507,110.17870590334014,110.4482649847464,110.72189103300573,110.99942194389483,111.28070147134083,111.56557899300878,111.8539092864625,112.14555231536713,112.44037302522472,112.73824114817035,113.03903101637582,113.34262138363665,113.64889525474089,113.95773972223854,114.26904581025371,114.58270832499771,114.89862571166253,115.21669991738949,115.5368362600245,115.85894330238695,116.18293273179215,116.50871924458362,116.83622043544024,117.16535669123979,117.49605108926703,117.82822929956905,118.16181949126941,118.49675224266019,118.83296045490381,119.17037926918096,119.50894598713279,119.84859999444967,120.18928268746906,120.53093740264896,120.87350934879213,121.21694554190199,121.56119474255439,121.90620739567963,122.25193557264869,122.59833291556779,122.94535458368557,123.29295720182529,123.64109881075578,123.98973881942082,124.33883795894853],[111.04100079322328,110.46016625980485,109.91856711040454,109.41445589877311,108.94617379403878,108.51214537180651,108.11087375547035,107.74093608121278,107.40097926240205,107.08971603112209,106.80592123641286,106.54842838046719,106.31612637555882,106.10795650585696,105.92290957955144,105.76002325786183,105.61837954855916,105.49710245258927,105.39535575326914,105.31234093832752,105.24729524580584,105.19948982550461,105.16822800828548,105.15284367610509,105.15269972618238,105.16718662317844,105.19572103371523,105.2377445379595,105.29272241338053,105.36014248613061,105.439514045818,105.53036681973659,105.63225000288753,105.74473134037919,105.86739625902378,105.99984704516477,106.14170206596694,106.29259503158536,106.45217429580089,106.62010219286712,106.79605440846109,106.9797193827669,107.17079774384698,107.36900176957404,107.57405487650614,107.78569113418915,108.00365480346601,108.22769989745841,108.45758976397239,108.69309668815245,108.93400151428203,109.18009328569526,109.43116890182512,109.68703279147377,109.94749660144346,110.21237889971761,110.48150489242954,110.75470615390014,111.03182036906766,111.31269108767184,111.59716748959062,111.88510416076279,112.17636087916037,112.47080241030653,112.76829831186058,113.06872274682217,113.37195430492545,113.67787583182336,113.98637426568169,114.29734048082085,114.61066913806754,114.92625854149246,115.24401050123021,115.56383020209074,115.88562607769141,116.20930968984752,116.53479561297824,116.86200132329168,117.19084709253205,117.52125588607574,117.85315326517826,118.18646729318564,118.52112844552599,118.85706952331603,119.19422557041673,119.53253379378698,119.87193348698692,120.2123659566934,120.55377445209524,120.89610409704042,121.23930182481912,121.58331631546531,121.92809793546978,122.27359867980169,122.61977211613926,122.96657333121682,123.31395887919764,123.66188673198869,124.01031623141509,124.35920804317679],[111.13380650509825,110.55112513801352,110.00773373937085,109.50188273288367,109.03191126053757,108.59624196778337,108.19337613933303,107.82188915900612,107.48042626930967,107.16769860846151,106.88247950441102,106.62360100708594,106.38995064161568,106.18046836667376,105.99414372334397,105.83001316106945,105.68715752830103,105.56469971641856,105.46180244638664,105.37766618840553,105.31152720556048,105.26265571314948,105.23035414598679,105.21395552655433,105.21282192739099,105.22634302159717,105.25393471576874,105.29503786008634,105.3491170306591,105.41565937956847,105.49417354837711,105.58418864116173,105.68525325340251,105.79693455330886,105.91881741240088,106.0505035823716,106.1916109154641,106.34177262577249,106.50063658905505,106.66786467879896,106.8431321364299,107.02612697368967,107.2165494053372,107.41411131044319,107.61853572065915,107.82955633394258,108.04691705231672,108.2703715423302,108.4996828169636,108.73462283780941,108.97497213641996,109.220519453788,109.47106139698263,109.72640211202811,109.98635297215928,110.25073228064554,110.51936498741749,110.79208241877875,111.06872201952352,111.34912710682282,111.63314663527652,111.92063497256302,112.21145168515118,112.50546133356845,112.80253327674772,113.10254148500206,113.4053643612004,113.71088456974203,114.01898887294928,114.32956797451715,114.64251636968002,114.95773220177229,115.27511712487802,115.59457617228021,115.91601763043572,116.23935291821611,116.56449647116879,116.89136563056464,117.21988053701124,117.54996402842153,117.88154154213863,118.21454102102787,118.54889282335593,118.88452963628806,119.22138639283864,119.55940019212366,119.89851022276736,120.23865768932396,120.57978574158267,120.92183940662859,121.26476552354218,121.60851268062004,121.95303115501106,122.29827285466294,122.64419126248104,122.99074138260603,123.33787968871992,123.68556407429629,124.03375380471213,124.38240947114555],[111.23793759193489,110.65318401622211,110.10778165448563,109.59997854046597,109.1281115416278,108.69060113772473,108.28594655040656,107.91272119728369,107.56956844610119,107.25519764670616,106.96838042033446,106.70794718742361,106.47278391668146,106.2618290795314,106.07407079532183,105.9085441538431,105.76432870274981,105.64054608845228,105.53635783992064,105.45096328565388,105.38359759480464,105.33352993412764,105.30006173304277,105.2825250496722,105.280281031237,105.29271846267976,105.31925239782224,105.35932286777633,105.41239366170166,105.47795117535014,105.55550332315536,105.64457850992419,105.7447246584538,105.85550828965447,105.97651365198968,106.10734189725724,106.24761029994076,106.39695151753762,106.55501288944849,106.72145577216621,106.89595490865113,107.07819782991852,107.26788428698734,107.46472571145929,107.66844470310748,107.87877454295521,108.09545873041831,108.31825054317865,108.54691261853171,108.78121655503392,109.02094253334297,109.26587895521402,109.51582209967492,109.77057579546327,110.02995110886252,110.29376604612391,110.5618452697104,110.83401982764157,111.11012689526233,111.39000952879393,111.67351643006651,111.96050172186328,112.25082473333937,112.54434979501052,112.84094604283179,113.14048723091548,113.44285155246156,113.74792146849677,114.05558354404135,114.36572829134285,114.67825001983539,114.99304669250189,115.31001978833297,115.62907417059296,115.95011796062002,116.27306241689779,116.59782181915524,116.92431335725904,117.25245702467721,117.58217551630464,117.9133941304501,118.24604067479594,118.58004537615,118.91534079381992,119.2518617364466,119.58954518214273,119.92833020179107,120.26815788536068,120.60897127111124,120.95071527755685,121.29333663807107,121.63678383801854,121.98100705430346,122.32595809723252,122.67159035459331,123.01785873785332,123.3647196303922,123.71213083767834,124.06005153931196,124.4084422428547],[111.35339405373331,110.76634289443069,110.21871085574882,109.70874332151996,109.2347746373094,108.79522288163062,108.38858498869102,108.0134321960453,107.66840579277658,107.35221314585627,107.06362398418314,106.80146692148028,106.56462620075624,106.35203864442987,106.16269079548525,105.99561623618283,105.84989307190571,105.72464156869053,105.61902193387094,105.53223223007257,105.46350641353817,105.41211248843921,105.37735076945329,105.3585522454587,105.35507703772026,105.36631294642629,105.39167407987576,105.43059956102942,105.48255230650831,105.5470178734755,105.62350337015292,105.71153642602401,105.81066421804158,105.92045254941603,106.04048497779019,106.17036198982161,106.30970021939672,106.45813170688052,106.6153031969815,106.78087547296886,106.95452272512476,107.13593195145356,107.32480238879735,107.52084497262199,107.72378182385113,107.93334576122714,108.14927983777082,108.37133690000385,108.59927916867683,108.83287783982601,109.07191270505081,109.31617178997341,109.56545100990193,109.8195538417793,110.07829101155322,110.34148019615284,110.60894573930814,110.88051838048867,111.15603499628413,111.43533835358508,111.71827687396062,112.00470440866349,112.29448002372501,112.58746779463274,112.88353661011266,113.18255998456235,113.48441587870897,113.7889865280877,114.0961582789578,114.40582143129772,114.71787008853347,115.03220201368133,115.34871849159505,115.66732419702919,115.9879270682443,116.31043818589258,116.63477165693766,116.96084450337494,117.28857655552993,117.61789034972486,117.94871103011258,118.28096625448995,118.61458610390818,118.94950299591162,119.28565160124056,119.62296876384426,119.96139342405799,120.30086654480358,120.641331040681,120.98273170982495,121.32501516840577,121.6681297876608,122.01202563334694,122.35665440751045,122.7019693924758,123.04792539695865,123.39447870421428,123.74158702213499,124.08920943521467,124.43730635830434],[111.4801758904934,110.8906017726393,110.34052134316057,109.82817707604578,109.35190054758242,108.91010719950104,108.50129145418634,108.12402215529112,107.77693830933573,107.45874510591158,107.16821019595707,106.90416020925603,106.66547749384011,106.45109706136917,106.26000372383403,106.09122940808847,105.94385063576854,105.81698615713337,105.70979472823772,105.62147302166159,105.55125366176122,105.49840337608407,105.46222125521837,105.4420371139138,105.43720994684089,105.44712647283663,105.47119976192924,105.50886793984564,105.55959296507898,105.62285947394456,105.69817368936967,105.78506238946102,105.88307193216582,105.99176733259377,106.11073138980251,106.23956386006478,106.37788067383222,106.52531319380118,106.68150751165392,106.846123781207,107.01883558585065,107.19932933829463,107.3873037107674,107.58246909393154,107.78454708289001,107.99326998875826,108.20838037437422,108.42963061280581,108.65678246739895,108.88960669218569,109.1278826515436,109.37139795806615,109.61994812766369,109.87333625097625,110.13137268023124,110.39387473073231,110.66066639621084,110.93157807732001,111.20644632258889,111.4851135811963,111.76742796695875,112.05324303296378,112.34241755630802,112.63481533243505,112.93030497859043,113.22875974594271,113.53005733994266,113.83407974851464,114.14071307769879,114.44984739438181,114.76137657577435,115.07519816531064,115.39121323466425,115.70932625158858,116.02944495330848,116.35148022520045,116.67534598451596,117.00095906891229,117.32823912956952,117.65710852868219,117.98749224112615,118.31931776010993,118.65251500663055,118.98701624256323,119.32275598722063,119.65967093722821,119.99769988956814,120.33678366765263,120.67686505029201,121.01788870343316,121.35980111454634,121.70255052954687,122.04608689214162,122.39036178549674,122.73532837612863,123.08094135992192,123.42715691018633,123.7739326276662,124.12122749242006,124.46900181749433],[111.6182831022153,111.02596065084794,110.47321311672056,109.95827980404326,109.47948927244677,109.03525409133591,108.6240659468926,108.2444910750211,107.89516599577873,107.57479352687228,107.28213905565624,107.01602705075081,106.77533779593303,106.55900433034915,106.36600958036833,106.19538366956019,106.04620139433838,105.91757985378067,105.80867622302083,105.71868566042107,105.64683933947371,105.59240259706226,105.55467319033788,105.53297965503761,105.5266797585989,105.53515904191096,105.55782944398277,105.59412800422496,105.64351563741366,105.70547597675746,105.77951428080569,105.86515640023535,105.96194780082649,106.06945263918723,106.18725288802665,106.31494750798673,106.45215166324708,106.59849597829984,106.75362583346573,106.91720069688047,107.08889349082899,107.26838999044199,107.45538825289741,107.64959807538794,107.85074048022412,108.05854722554871,108.27276034022842,108.4931316815844,108.71942251469805,108.95140311211289,109.18885237282132,109.43155745949221,109.67931345296024,109.93192302305407,110.18919611489682,110.45094964986225,110.71700724041831,110.98719891813542,111.26136087417662,111.53933521162752,111.82096970906093,112.10611759476403,112.39463733108863,112.68639240841772,112.98125114826506,113.2790865150566,113.57977593616251,113.88320112977779,114.18924794026412,114.49780618059515,114.80876948155796,115.12203514738982,115.43750401754052,115.7550803342713,116.07467161581268,116.39618853482148,116.71954480189022,117.04465705387121,117.3714447467959,117.69983005317678,118.02973776349084,118.36109519165568,118.69383208431695,119.02788053377461,119.36317489438669,119.69965170229449,120.03724959832164,120.37590925390791,120.71557329994414,121.05618625838122,121.3976944764927,121.74004606367669,122.0831908306873,122.42708023119137,122.77166730555183,123.11690662674323,123.4627542483083,123.80916765427192,124.15610571092834,124.50352862042482],[111.76771568889887,111.17241952905651,110.61678617642906,110.09905150551249,109.61754081190251,109.17066355713527,108.75690846680966,108.37483895523528,108.02308885210562,107.70035840873844,107.40541056328065,107.13706744596446,106.89420710703484,106.67576045137014,106.48070836508808,106.30807902059784,106.15694534761515,106.02642265863243,105.91566641822034,105.82387014635083,105.75026344667562,105.69411015137378,105.65470657481215,105.63137986882997,105.62348647299412,105.63041065364909,105.65156312603632,105.68637975416736,105.73432032351238,105.79486738191407,105.86752514446086,105.95181845834702,106.04729182402363,106.15350846919674,106.27004947246246,106.39651293358745,106.53251318764137,106.67768006037623,106.83165816241694,106.99410621998942,107.16469644005967,107.34311390789533,107.52905601518731,107.72223191699103,107.92236201585352,108.12917747159837,108.34241973533361,108.56184010633986,108.78719931057414,109.01826709960771,109.25482186888394,109.49665029425155,109.74354698579147,109.99531415801277,110.25176131554987,110.51270495354265,110.77796827193072,111.04738090293513,111.32077865104729,111.59800324487887,111.87890210026724,112.16332809406424,112.45113934806659,112.74219902258035,113.03637511913662,113.33354029190394,113.63357166736863,113.93635067187701,114.241762866654,114.54969778993774,114.86004880588432,115.17271295991866,115.48759084022394,115.80458644507735,116.12360705575665,116.44456311475565,116.76736810906043,117.09193845825152,117.41819340720913,117.74605492320855,118.07544759720656,118.40629854912754,118.73853733696755,119.07209586954586,119.40690832273889,119.74291105904327,120.08004255031823,120.41824330356927,120.75745578963752,121.09762437466932,121.43869525424479,121.78061639005027,122.12333744898413,122.46680974459429,122.8109861807455,123.15582119742248,123.5012707185801,123.84729210195218,124.19384409073935,124.54088676709573],[111.92847365054426,111.32997840726516,110.77124052228586,110.25049218045355,109.76605516594964,109.31633559689924,108.89981901393767,108.51506579593358,108.1607068783163,107.8354397515099,107.53802471883044,107.26728139489721,107.02208542714574,106.80136542443182,106.60410007799324,106.42931546120155,106.27608249559904,106.14351457168877,106.03076531383624,105.93702647945092,105.86152598336695,105.80352603901862,105.76232140864079,105.73723775529102,105.72763009002679,105.73288130805112,105.75240080808977,105.7856231896729,105.8320070233751,105.89103368941443,105.96220628033531,106.04504856379592,106.13910400175723,106.24393482262226,106.35912114311012,106.48426013686687,106.61896524701505,106.76286544003061,106.91560449850765,107.07684035053367,107.24624443354276,107.4235010906548,107.60830699763721,107.80037061874097,107.99941168977826,108.20516072690722,108.41735855968966,108.63575588707199,108.86011285502717,109.0901986546701,109.32579113973144,109.56667646234428,109.81264872615752,110.06350965585237,110.31906828219026,110.57914064177372,110.84354949074806,111.11212403171912,111.38469965320103,111.66111768095026,111.94122514057761,112.2248745308645,112.51192360724197,112.80223517492324,113.09567689120503,113.39212107648471,113.69144453356101,113.99352837481231,114.29825785686826,114.60552222240963,114.91521454875348,115.22723160289746,115.54147370271453,115.85784458400676,116.17625127314064,116.49660396500293,116.81881590602643,117.14280328205339,117.4684851108092,117.79578313877745,118.1246217422734,118.45492783252524,118.78663076458231,119.11966224987687,119.45395627227718,119.78944900747446,120.12607874555822,120.46378581663693,120.80251251937197,121.14220305229739,121.48280344780289,121.82426150866763,122.16652674703207,122.50955032570553,122.85328500170942,123.19768507195982,123.54270632100177,123.88830597070705,124.2344426318532,124.58107625750708],[112.10055698715136,111.49863728547372,110.9365761542912,110.41260182886622,109.92503233458817,109.47227021062751,109.05279758827659,108.66517159711603,108.30802007441076,107.98003755518663,107.67998152230537,107.40666889754894,107.15897275626558,106.9358192495343,106.73618471908381,106.55909299137133,106.40361283828982,106.26885559294968,106.15397290986854,106.05815465972138,105.98062694954768,105.92065025999688,105.87751769182412,105.85055331442068,105.8391106096967,105.84257100511712,105.86034249014331,105.89185831074158,105.93657573700189,105.99397489925853,106.0635576884289,106.14484671658202,106.23738433402724,106.34073169946376,106.45446789996957,106.57818911782518,106.71150784136827,106.85405211726274,107.00546484173778,107.16540308851344,107.33353747127818,107.50955153872046,107.693141200247,107.88401418063779,108.08188950199823,108.28649699147546,108.49757681329662,108.71487902378088,108.93816314805717,109.16719777730005,109.40176018536393,109.64163596377026,109.88661867405828,110.13650951657287,110.39111701481818,110.6502567145552,110.91375089687024,111.1814283044873,111.45312388063769,111.72867851984169,112.00793882999207,112.29075690516471,112.57699010861484,112.86650086544628,113.1591564644704,113.454828868799,113.75339453473948,114.05473423858382,114.35873291090704,114.66527947801079,114.97426671016537,115.28559107632604,115.59915260501215,115.91485475105944,116.2326042679646,116.55231108556329,116.87388819278846,117.19725152527671,117.52231985759605,117.8490146998836,118.17726019869124,118.5069830418489,118.83811236716116,119.17057967476775,119.50431874300145,119.83926554758801,120.17535818404137,120.51253679311066,120.8507434891477,121.18992229126538,121.53001905716677,121.87098141952872,122.21275872483105,122.55530197452512,122.89856376844368,123.24249825035515,123.58706105557341,123.9322092605365,124.27790133426977,124.62409709165884],[112.28396569872018,111.67839616368235,111.11279307244489,110.58538045075073,110.09447231781806,109.63846739832046,109.21584418982631,108.82515635878265,108.46502844038912,108.1341518197688,107.83128097370565,107.55522995391969,107.30486909439453,107.07912192667769,106.87696228835989,106.69741161110707,106.53953637568762,106.40244572241507,106.28528920631724,106.18725468716225,106.10756634521789,106.0454828143084,106.00029542436189,105.97132654621898,105.95792803200391,105.95947974484693,105.97538817219676,106.00508511737333,106.04802646439268,106.10369101144644,106.17157936874175,106.25121291670546,106.3421328208337,106.44389909972125,106.55608974304067,106.67829987646208,106.81014097070084,106.95124009207277,107.10123919210731,107.2597944339286,107.42657555326598,107.60126525209212,107.78355862301683,107.97316260268131,108.1697954525134,108.37318626530293,108.58307449615451,108.79920951646643,109.02135018966418,109.24926446749751,109.48272900578129,109.72152879852969,109.96545682949389,110.21431374017428,110.46790751343349,110.72605317188716,110.98857249029743,111.25529372123968,111.52605133335726,111.80068576155324,112.07904316851054,112.36097521696493,112.6463388521852,112.93499609414948,113.22681383893254,113.52166366884684,113.81942167090429,114.11996826319123,114.42318802877021,114.72896955674115,115.03720529012018,115.34779138020438,115.66062754711693,115.97561694623538,116.29266604022853,116.61168447643676,116.93258496934635,117.25528318792158,117.5796976475698,117.90574960652683,118.23336296646028,118.56246417709843,118.89298214470416,119.22484814421854,119.55799573491183,119.8923606793841,120.22788086576782,120.56449623299058,120.90214869896457,121.24078209157341,121.58034208233646,121.92077612263364,122.26203338238123,122.60406469105311,122.94682248094841,123.29026073260842,123.63433492229498,123.97900197144038,124.32422019798921,124.66994926955114],[112.47869978525077,111.86925504189094,111.29989127674702,110.76882804610689,110.27437511563939,109.81492715997776,109.38895881858697,108.99502008093344,108.6317319762513,108.29778254525627,107.99192307303116,107.71296456400943,107.45977444153242,107.23127345586177,107.02643278582143,106.84427132040885,106.68385310779246,106.54428496008494,106.42471420318229,106.32432656177345,106.24234417037756,106.17802370195326,106.13065460625425,106.09955745068592,106.08408235694847,106.08360752724069,106.09753785425033,106.12530360956829,106.16635920554749,106.22018202597805,106.2862713212738,106.36414716416613,106.45334946217667,106.55343702339469,106.66398667232365,106.78459241277791,106.91486463501278,107.05442936446066,107.20292754961628,107.36001438677917,107.52535867950606,107.69864223076998,107.87955926594658,108.06781588487164,108.26312954132399,108.46522854838963,108.67385160826319,108.88874736512875,109.10967397984825,109.33639872526255,109.56869760098351,109.80635496662241,110.04916319246423,110.29692232665653,110.54943977803624,110.80653001376974,111.06801427102934,111.33372028197628,111.60348201135987,111.87713940608475,112.15453815613314,112.43552946626519,112.71996983795292,113.00772086103279,113.29864901459165,113.59262547662819,113.88952594205529,114.18923044863506,114.49162321045777,114.79659245860074,115.10403028861758,115.41383251453266,115.72589852902881,116.04013116953465,116.35643658993237,116.67472413762336,116.99490623570014,117.31689826998786,117.64061848073032,117.96598785870738,118.29293004558033,118.62137123827398,118.95124009721137,119.28246765822911,119.61498724800822,119.9487344028625,120.28364679073742,120.61966413627668,120.95672814882262,121.29478245322136,121.63377252331195,121.97364561798221,122.31435071968248,122.65583847528946,122.9980611392234,123.34097251871974,123.68452792116643,124.02868410341893,124.37339922301133,124.71863279118359],[112.68475924674306,112.07121392009958,111.49787076719761,110.96294461493491,110.46474072805204,110.00164949559966,109.57214147455851,109.17476276356838,108.8081306819974,108.47092973164918,108.16190782028184,107.87987272781828,107.62368879767928,107.39227383708682,107.1845962114684,106.99967211927668,106.83656303460427,106.69437330595933,106.57224790046371,106.46937028355495,106.38496042502675,106.31827292293147,106.26859523750117,106.23524602782153,106.21757358453034,106.21495435229829,106.22679153630384,106.25251378732629,106.29157396046637,106.34344794285344,106.40763354602507,106.48364945896419,106.57103425805602,106.66934547048405,106.77815868781833,106.89706672677241,107.02567883430423,107.16361993442636,107.31052991426473,107.46606294706513,107.62988684999863,107.80168247475399,107.98114312903623,108.16797402720883,108.36189176842971,108.56262384073565,108.76990814962282,108.98349256976778,109.20313451860928,109.42860055059518,109.65966597097071,109.89611446804848,110.13773776296924,110.38433527601963,110.63571380862645,110.89168724020274,111.1520762390662,111.41670798669716,111.68541591464549,111.95803945343641,112.23442379285974,112.51441965306537,112.79788306591813,113.08467516609632,113.37466199144761,113.66771429214295,113.96370734819251,114.26252079491481,114.56403845596986,114.86814818358967,115.17474170565782,115.48371447931066,115.79496555074789,116.10839742095726,116.42391591707619,116.74143006912317,117.06085199184996,117.38209677147567,117.70508235707767,118.029729456425,118.35596143605153,118.68370422537539,119.01288622468256,119.34343821679951,119.67529328229077,120.0083867180234,120.34265595895032,120.67804050296895,121.01448183872184,121.35192337620936,121.69031038009327,122.02958990557465,122.36971073673475,122.71062332723403,123.05227974326876,123.39463360868915,123.73764005218779,124.08125565647198,124.42543840933638,124.77014765655679],[112.90214408319713,112.28427279830822,111.70673154379656,111.16773015723463,110.66556915505609,110.19863440518596,109.76539215774091,109.36438440668748,108.99422455762722,108.65359337894731,108.34123521545779,108.05595444534598,107.79661216283527,107.56212307035254,107.3514525653008,107.16361400771052,106.99766615612303,106.85271076003825,106.72789029816161,106.62238585250685,106.53541510916527,106.466230477243,106.41411731810263,106.37839227762575,106.35840171474953,106.35352022001982,106.36314921835738,106.3867156506474,106.42367072914924,106.47348876207255,106.5356660429956,106.60971980109943,106.69518720847191,106.79162444098948,106.89860578952488,107.01572281844578,107.14258356857506,107.27881180196997,107.42404628605259,107.57794011478654,107.74016006474355,107.91038598404413,108.08831021228592,108.27363702969271,108.4660821338308,108.66537214234087,108.87124412023333,109.08344513038358,109.30173180594718,109.52586994349542,109.75563411574294,109.99080730280789,110.23118054100911,110.47655258826367,110.72672960520408,110.98152485118632,111.24075839440803,111.50425683540215,111.77185304321411,112.04338590360808,112.31870007869047,112.59764577736568,112.88007853608077,113.16585900933994,113.45485276950048,113.74693011539125,114.04196588931593,114.3398393020307,114.64043376530638,114.94363673170787,115.24933954124079,115.55743727453864,115.86782861227401,116.18041570050318,116.49510402165983,116.81180227093603,117.13042223779559,117.45087869238493,117.7730892766118,118.09697439967985,118.42245713787374,118.74946313840277,119.07792052711795,119.40775981992975,119.73891383775926,120.07131762486665,120.40490837040645,120.73962533306742,121.07540976866223,121.41220486053726,121.7499556526804,122.08860898541077,122.42811343353814,122.76841924688699,123.10947829308451,123.45124400251648,123.79367131535892,124.13671663059964,124.48033775696406,124.82449386567028],[113.13085429461286,112.50843167651679,111.92647360654396,111.38318467300604,110.87686039665159,110.40588188873687,109.96871086813418,109.56388501029066,109.19001360314087,108.84577348715086,108.52990525855905,108.24120971659281,107.97854453700016,107.74082115565919,107.52700184731862,107.33609698571033,107.16716247234883,107.01929732232173,106.89164139627586,106.78337326862916,106.69370822279328,106.6218963648879,106.56722084805862,106.52899620009859,106.50656674760606,106.49930513040528,106.50661090041081,106.52790919953161,106.56264951159613,106.61030448363543,106.67036881218527,106.74235819057202,106.82580831342418,106.92027393491088,107.02532797744311,107.14056068779784,107.26557883782539,107.40000496709135,107.54347666497986,107.69564588994336,107.85617832374076,108.02475275864032,108.20106051569542,108.38480489232344,108.57570063752713,108.77347345320533,108.97785952009474,109.18860504697609,109.4054658418621,109.62820690396322,109.8566020353,110.09043347090055,110.32949152658369,110.57357426338859,110.82248716776921,111.07604284672043,111.3340607370547,111.5963668280914,111.86279339706549,112.13317875659982,112.40736701362522,112.68520783916591,112.96655624844087,113.25127239076373,113.5392213487502,113.83027294637303,114.12430156542563,114.42118596998279,114.72080913846736,115.02305810295515,115.3278237953666,115.6350009002163,115.94448771360726,116.25618600817236,116.57000090368348,116.885840743062,117.20361697353725,117.52324403271568,117.84463923933282,118.16772268847181,118.49241715104699,118.81864797735598,119.14634300451755,119.47543246761984,119.80584891441387,120.13752712339233,120.47040402510584,120.80441862657203,121.13951193864375,121.47562690620514,121.81270834107343,122.15070285749083,122.48955881009273,122.82922623424824,123.16965678867059,123.51080370020181,123.85262171068007,124.19506702580176,124.53809726589465,124.88167141852418],[113.37088988099038,112.74369055472543,112.15709695543977,111.60930816224918,111.09861445283845,110.62339194625223,110.18209760573843,109.77326457437808,109.39549781853836,109.0474700562598,108.72791794958562,108.43563854155857,108.16948592017413,107.92836809300663,107.71124405752197,107.51712105327626,107.34505198328165,107.19413299280966,107.06350119480659,106.95233253192168,106.85983976591069,106.78527058586604,106.72790582736923,106.68705779524011,106.66206868309987,106.6523090834545,106.65717658246434,106.67609443397897,106.70851030780705,106.75389510754204,106.81174185359427,106.88156462738182,106.96289757291288,107.05529395224822,107.1583252515732,107.27158033482868,107.39466464205498,107.5271994297907,107.66882105104654,107.81918027253559,107.97794162699043,108.14478279854269,108.31939403926503,108.50147761510095,108.69074727951865,108.88692777332911,109.08975434920704,109.29897231954537,109.51433662635401,109.73561143199849,109.9625697296419,110.19499297232665,110.43267071969304,110.6754003013944,110.92298649632173,111.17524122680503,111.43198326700623,111.69303796476493,111.95823697620007,112.22741801241165,112.50042459766402,112.77710583846614,113.05731620299846,113.34091531036768,113.62776772919682,113.91774278508829,114.21071437652155,114.50656079877086,114.80516457545275,115.10641229733181,115.41019446803517,115.7164053563439,116.02494285474769,116.3357083439649,116.64860656314713,116.96354548550111,117.28043619907469,117.599192792468,117.9197322452407,118.24197432280107,118.56584147557142,118.89125874223518,119.21815365688113,119.54645615986981,119.87609851225456,120.20701521360041,120.53914292304837,120.87242038348285,121.20678834866668,121.54218951321299,121.87856844527226,122.21587152181451,122.55404686639831,122.89304428931781,123.232815230027,123.57331270174515,123.91449123815111,124.25630684207844,124.59871693612799,124.9416803151186],[113.62225084232969,112.99004943293409,112.39860159048399,111.84610062496418,111.33083132361661,110.85116457773209,110.40555237055351,109.99252309894963,109.61067720381969,109.25868308627396,108.93527328853739,108.63924092024341,108.3694363123571,108.12476388239484,107.90417919591067,107.70668621040815,107.53133468892148,107.37721777150215,107.24346969375357,107.12926364238467,107.03380973851759,106.9563531401776,106.89617225603432,106.85257706305025,106.82490752123101,106.81253207916768,106.81484626451781,106.83127135398944,106.86125311778203,106.9042606337924,106.95978516722235,107.0273391115289,107.10645498693809,107.19668449300157,107.29759761191495,107.40878175953831,107.52984098126412,107.66039519006782,107.80007944425272,107.94854326256315,108.10544997449242,108.27047610375114,108.44331078299449,108.62365519802526,108.81122205980553,109.00573510271205,109.20692860757023,109.4145469480914,109.62834415942291,109.84808352760145,110.07353719876882,110.30448580708601,110.54071812033712,110.78203070228112,111.02822759086168,111.27911999144008,111.53452598426269,111.79427024542261,112.05818378061745,112.32610367104358,112.59787283080702,112.8733397752664,113.15235839975342,113.43478776815174,113.72049191084027,114.00933963153709,114.30120432260374,114.59596378839518,114.89350007626261,115.19369931483769,115.49645155924637,115.80165064292126,116.10919403569515,116.41898270788073,116.73092100005063,117.0449164982533,117.36087991440814,117.67872497164169,117.99836829433525,118.31972930266735,118.64273011144692,118.96729543304035,119.29335248420891,119.62083089667956,119.94966263128129,120.27978189549103,120.61112506423424,120.94363060379983,121.2772389987306,121.61189268156087,121.94753596527694,122.28411497838194,122.62157760245503,122.9598734120958,123.29895361715384,123.63877100714653,123.97927989777206,124.32043607942974,124.66219676766417,125.00452055545342],[113.88493717863066,113.24750831114264,112.65098751167666,112.09356206115086,111.57351100898619,111.08919978317645,110.63907516257942,110.22166058400542,109.83555175898492,109.47941257719353,109.15197127541443,108.85201685264721,108.57839571354906,108.33000852382389,108.10580726248497,107.90479245710604,107.72601058926817,107.56855165839917,107.431546893117,107.31416660001793,107.21561814061391,107.13514402782242,107.07202013405404,107.02555400352904,106.99508326199944,106.97997411754478,106.97961994657139,106.99343995956302,107.02087794152098,107.06140106238657,107.11449875306978,107.17968164301331,107.25648055549971,107.34444555717089,107.44314505846852,107.55216496192676,107.67110785545275,107.79959224792282,107.93725184459828,108.08373486002617,108.2387033662468,108.40183267426579,108.57281074688395,108.75133764109644,108.93712497838776,109.12989544135434,109.32938229518429,109.53532893261404,109.7474884410689,109.96562319077194,110.18950444268067,110.41891197517873,110.65363372851594,110.89346546604865,111.1382104513891,111.38767914062571,111.64168888882399,111.90006367006457,112.16263381031787,112.42923573249543,112.699711713054,112.97390964956659,113.25168283870592,113.53288976411604,113.81739389368073,114.10506348571937,114.395771403672,114.68939493885554,114.98581564089699,115.28491915547278,115.58659506900048,115.8907367599484,116.19724125644983,116.50600909991985,116.81694421439414,117.12995378131862,117.44494811953747,117.76184057023701,118.08054738661681,118.40098762807099,118.72308305867344,119.0467580497714,119.37193948650086,119.69855667804903,120.02654127149403,120.35582716906399,120.68635044866336,121.01804928752296,121.3508638888356,121.68473641124866,122.01961090108736,122.35543322719322,122.69215101826293,123.02971360258202,123.36807195005096,123.70717861640593,124.04698768954289,124.38745473785548,124.72853676050313,125.07019213952861],[114.15894888989341,113.51606718935123,112.91425471901765,112.35169247080921,111.82665350894716,111.33749756258527,110.88266598181623,110.46067702954525,110.07012148403385,109.70965852901858,109.37801191021673,109.07396633877002,108.79636412375001,108.54410201729375,108.3161282572446,108.11143979337,107.92907968432198,107.76813465350072,107.62773279289681,107.50704140482158,107.40526497219969,107.32164324880068,107.25544946142827,107.20598861667642,107.17259590540526,107.15463519858579,107.15149762862487,107.16260025069968,107.18738477902401,107.22531639332443,107.2758826111364,107.33859222183494,107.41297427859774,107.4985771447562,107.59496759123384,107.7017299419939,107.81846526462063,107.94479060335571,108.08033825208329,108.22475506492465,108.37770180225351,108.53885251008649,108.70789393093337,108.88452494431436,109.06845603526513,109.25940878925589,109.45711541204926,109.66131827311351,109.87176947129177,110.08823042150993,110.31047146137738,110.53827147660481,110.77141754422955,111.00970459269713,111.25293507790397,111.5009186743619,111.75347198069029,112.01041823869072,112.27158706530136,112.53681419676744,112.80594124440506,113.07881546136687,113.35528951985577,113.63522129826038,113.918473677718,114.2049143476351,114.49441561972667,114.78685425015198,115.08211126935566,115.3800718192372,115.68062499729733,115.98366370742548,116.28908451701156,116.5967875200824,116.90667620617758,117.21865733469708,117.53264081446268,117.84853958825374,118.16626952208506,118.48574929901163,118.80690031725109,119.12964659242834,119.45391466375693,119.77963350397845,120.10673443289292,120.43515103431936,120.76481907633566,121.09567643465226,121.42766301898199,121.76072070227642,122.09479325270365,122.42982626824822,122.76576711382189,123.10256486077667,123.44017022871846,123.77853552952334,124.11761461346366,124.45736281735586,124.7977369146448,125.13869506734436],[114.4442859761179,113.79572606755987,113.18840321250718,112.62049185393941,112.09025882349952,111.59605791595864,111.13632482826397,110.70957243556936,110.31438637896676,109.94942094174887,109.61339519294432,109.30508937861183,109.02334154295995,108.76704436280454,108.53514218018972,108.32662821919997,108.14054197408268,107.97596675680671,107.83202739309304,107.7078880567956,107.60275023327488,107.51585080311222,107.44646023815709,107.3938809024925,107.35744545144831,107.33651532229065,107.33047931067841,107.33875222739951,107.36077363029094,107.39600662660608,107.44393674142219,107.50407084799394,107.57593615623234,107.65907925575739,107.75306521021095,107.85747669973988,107.97191320876806,108.09599025636636,108.22933866670776,108.37160387725852,108.52244528251268,108.68153561121333,108.84856033514271,109.02321710767907,109.20521523043783,109.39427514641669,109.59012795816516,109.79251496958966,110.00118725009155,110.21590521981557,110.43643825485903,110.66256431136416,110.89406956747793,111.13074808222642,111.37240147040626,111.61883859264849,111.86987525986137,112.12533395130117,112.38504354556768,112.64883906385954,112.91656142486013,113.1880572106671,113.46317844320311,113.74178237058501,114.023731262952,114.3088922172843,114.59713697076747,114.88834172228462,115.18238696163887,115.47915730613086,115.77854134413697,116.08043148535234,116.3847238173804,116.69131796836812,117.00011697540091,117.31102715838864,117.62395799918389,117.93882202569195,118.25553470074014,118.57401431548958,118.89418188717983,119.2159610610113,119.53927801597716,119.86406137446775,120.19024211547782,120.51775349125712,120.84653094725131,121.17651204518783,121.50763638916948,121.83984555464421,122.17308302012582,122.50729410154702,122.84242588913192,123.17842718667964,123.51524845315629,123.85284174649868,124.1911606695343,124.53016031793075,124.86979723008932,125.21002933890047],[114.7409484373041,114.08648494576845,113.47343299214506,112.89996021054131,112.36432695264331,111.86488084329646,111.40005170192256,110.96834680207743,110.56834644378338,110.19869981538447,109.85812112359713,109.54538597217272,109.25932797117893,108.99883556035593,108.76284903132029,108.55035773459592,108.36039745855051,108.1920479683173,108.04443069370568,107.91670655593998,107.80807392383959,107.71776669075713,107.64505246424039,107.58923086097715,107.54963190012877,107.52561448865941,107.51656499273192,107.52189588966236,107.5410444953221,107.57347176223141,107.6186611439272,107.67611752149007,107.7453661884033,107.82595189017465,107.91743791539986,108.01940523516458,108.13145168789488,108.25319120695494,108.38425308847161,108.52428129702781,108.67293380702412,108.82988197764631,108.99480995951198,109.16741413119055,109.34740256390576,109.53449451283679,109.72841993353188,109.92891902204259,110.1357417774684,110.34864758568875,110.56740482312553,110.79179047945691,111.0215897982611,111.25659593463668,111.49660962889594,111.7414388954857,111.99089872633733,112.24481080789565,112.50300325111701,112.76531033377161,113.03157225441934,113.30163489746725,113.5753496087479,113.85257298108971,114.13316664938311,114.41699709466712,114.70393545679454,114.99385735525333,115.28664271774649,115.58217561615373,115.88034410951934,116.181040093729,116.48415915755639,116.78960044477725,117.09726652206429,117.40706325239334,117.71889967370099,118.03268788255166,118.34834292258213,118.66578267750471,118.98492776845963,119.30570145552011,119.62802954316145,119.95184028951685,120.27706431924881,120.60363453987742,120.93148606141017,121.2605561191295,121.59078399939817,121.92211096835199,122.25448020335379,122.58783672708957,122.92212734419316,123.25730058029096,123.59330662336461,123.93009726733213,124.26762585775478,124.60584723958031,124.94471770683667,125.28419495419706],[115.04893627345206,114.38834382397707,113.76934405793139,113.19009754061491,112.6488578963785,112.14396634459884,111.67384660279205,111.23700012906983,110.83200167848389,110.45749514992544,110.11218970217517,109.79485611945246,109.50432340840699,109.23947560994831,108.9992488106363,108.78262833955795,108.58864613772523,108.41637828803236,108.26494269473471,108.13349690225473,108.02123604389367,107.92739091173523,107.85122613967815,107.79203849213049,107.74915525144654,107.7219326976921,107.7097546747854,107.71203123748847,107.72819737411717,107.7577118002005,107.80005581865143,107.85473224232366,107.92126437511077,107.99919504800793,108.08808570680048,108.18751554826808,108.29708070200114,108.41639345512139,108.54508151737485,108.68278732423251,108.8291673757879,108.98389160938535,109.14664280404125,109.31711601484889,109.49501803566898,109.68006688851604,109.87199133814964,110.07053043047217,110.27543305342223,110.48645751912952,110.70337116617709,110.92594998088292,111.15397823657892,111.38724814992784,111.62555955337314,111.86871958287333,112.1165423801183,112.36884880847452,112.62546618194938,112.88622800650379,113.15097373308262,113.41954852176754,113.6918030164901,113.96759312977461,114.24677983701106,114.52922897978337,114.81481107780773,115.1034011490582,115.39487853767857,115.68912674930593,115.98603329344449,116.28548953255554,116.58739053753955,116.89163494930952,117.19812484616749,117.50676561671121,117.81746583801407,118.13013715883277,118.44469418761092,118.76105438505702,119.0791379610905,119.39886777595486,119.72016924531002,120.04297024912579,120.36720104420581,120.69279418018009,121.01968441881223,121.34780865647731,121.67710584966794,122.00751694339965,122.33898480238764,122.67145414487585,123.00487147900533,123.33918504161048,123.67434473934314,124.01030209202352,124.34701017812529,124.68442358230432,125.02249834488674,125.36119191323401],[115.36824948456177,114.7013027021857,114.07613640986611,113.4909038441603,112.9438516547049,112.4333144198657,111.95770953087236,111.51553241654635,111.10535208306828,110.7258069453718,110.37560092867855,110.05349982045138,109.75832785464398,109.48896451158144,109.24434151813772,109.02344003408594,108.82528801160699,108.64895771595197,108.49356339618009,108.35825909573983,108.24223659343716,108.14472346604681,108.06498126447069,108.00230379595241,107.95601550540155,107.92546994938866,107.91004835683886,107.90915827087753,107.92223226667633,107.94872674051345,107.98812076559493,108.03991501049438,108.10363071635457,108.1788087292571,108.26500858441293,108.36180763905034,108.46880025108671,108.5855970008656,108.71182395341762,108.84712195887258,108.99114598880416,109.14356450643061,109.30405886873046,109.47232275865399,109.64806164572744,109.83099227345464,110.02084217201808,110.21734919487855,110.42026107795307,110.62933502013784,110.84433728401348,111.06504281564231,111.2912348824316,111.52270472809981,111.75925124383771,112.00068065481153,112.24680622120404,112.49744795303752,112.75243233806472,113.01159208205603,113.27476586084994,113.54179808356777,113.81253866642972,114.08684281663969,114.36457082583586,114.64558787263312,114.92976383380721,115.21697310369913,115.50709442143513,115.80001070558725,116.09560889591238,116.3937798018319,116.69441795732978,116.99742148196525,117.30269194771067,117.61013425134213,117.91965649212293,118.23116985453549,118.54458849582645,118.85982943814643,119.17681246507243,119.4954600223155,119.81569712242253,120.13745125329449,120.46065229034892,120.78523241216507,121.11112601945754,121.43826965723127,121.76660193997898,122.09606347978739,122.42659681722718,122.75814635490602,123.09065829356869,123.42408057063844,123.75836280109203,124.09345622057292,124.42931363064562,124.76588934610284,125.10313914423956,125.44102021601144],[115.69888807063315,115.02536158039432,114.39381004794919,113.80237912117745,113.24930822762292,112.73292506909701,112.25164048616371,111.80394366450706,111.38839765753647,111.00363520172345,110.64835480310711,110.32131707516925,110.02134130988996,109.74730226525541,109.49812715382464,109.27279281817994,109.07032308019575,108.88978625207602,108.73029279804177,108.59099313639517,108.4710755724702,108.36976435369171,108.28631783861769,108.22002677244308,108.17021266199394,108.13622624374906,108.11744603889248,108.11327698982984,108.1231491729995,108.14651658317004,108.1828559847575,108.23166582600244,108.29246521213486,108.36479293392225,108.4482065482371,108.54228150751129,108.64661033515178,108.76080184418777,108.88448039659977,109.01728520094807,109.15886964607266,109.3089006687819,109.46705815357963,109.63303436260593,109.8065333940812,109.9872706676524,110.17497243513755,110.36937531526171,110.57022585106087,110.77728008871371,110.99030317663475,111.20906898373499,111.43335973581904,111.66296566915273,111.89768470028973,112.13732211130019,112.38169024959475,112.63060824158485,112.88390171946297,113.14140256042838,113.40294863772138,113.66838358286802,113.93755655856684,114.21032204168488,114.48653961585754,114.76607377321626,115.04879372479294,115.33457321917621,115.62329036901612,115.91482748499794,116.20907091692307,116.50591090155798,116.80524141692717,117.10696004274429,117.41096782669383,117.71716915628615,118.0254716360278,118.33578596965965,118.64802584722888,118.96210783677304,119.2779512804055,119.59547819460217,119.91461317449928,120.23528330202311,120.55741805767803,120.88094923583249,121.20581086334614,121.53193912139155,121.85927227033119,122.18775057751499,122.51731624787264,122.84791335717985,123.17948778788326,123.51198716737474,123.84536080861136,124.17955965298044,124.51453621531589,124.8502445309761,125.18664010489533,125.52367986252931],[116.04085203166636,115.36052045860288,114.72236497218077,114.1245233716663,113.56522761513216,113.04279829229282,112.55563946866577,112.10223387295186,111.68113840188845,111.29097991898047,110.93045132546096,110.59830788360613,110.29336377414499,110.01448887097021,109.76060571769698,109.53068669183999,109.32375134349148,109.13886389640476,108.97513090032007,108.83169902422094,108.70775298099259,108.60251357466993,108.51523586211923,108.44520742160232,108.39174672122364,108.35420158077345,108.33194772094593,108.32438739434524,108.33094809308665,108.35108132817041,108.38426147613949,108.42998468884772,108.48776786245172,108.55714766200347,108.63767959827308,108.72893715365107,108.83051095419631,108.94200798508774,109.06305084692139,109.193277050459,109.33233834759366,109.47990009643932,109.63564065858876,109.79925082670458,109.97043328073026,110.1489020711095,110.33438212750782,110.52660879162148,110.72532737274564,110.93029272485711,111.14126884404108,111.35802848516106,111.58035279674115,111.80803097308655,112.04085992272928,112.27864395233949,112.52119446529029,112.76832967411633,113.01987432614422,113.2756594416207,113.53552206369683,113.79930501966825,114.06685669290144,114.33803080491023,114.61268620707605,114.89068668153287,115.17190075076486,115.45620149548941,115.74346638042155,116.03357708753785,116.32641935647652,116.62188283173401,116.91986091633164,117.22025063164656,117.52295248311694,117.82787033154334,118.13491126972865,118.4439855042053,118.75500624181811,119.06788958093681,119.38255440708963,119.6989222928147,120.01691740154017,120.33646639531156,120.65749834619329,120.97994465118248,121.30373895047794,121.62881704895786,121.95511684072459,122.28257823658261,122.61114309432388,122.94075515169749,123.27135996194876,123.60290483181926,123.93533876190102,124.26861238924583,124.60267793213602,124.9374891369237,125.27300122685381,125.60917085278754],[116.39414136766122,115.70677933681151,115.06180118256076,114.45733659562687,113.8916098172328,113.36293408945308,112.8697064783788,112.41040304188078,111.98357431612426,111.58784109714294,111.22189049574003,110.88447224576196,110.57439524740897,110.29052432872577,110.03177720975478,109.79712165506614,109.58557280149414,109.3961906489379,109.22807770301469,109.08037675921705,108.95226881900446,108.8429711289814,108.75173533497535,108.67784574343023,108.62061768309063,108.57939596046164,108.5535534029994,108.54248948442371,108.54562902693786,108.56242097551456,108.59233723974054,108.63487159903045,108.68953866730496,108.75587291350054,108.83342773452077,108.92177457746966,109.02050210822023,109.1292154235656,109.24753530438242,109.37509750740539,109.51155209336692,109.65656278940294,109.80980638375776,109.97097215095008,110.1397613056746,110.31588648382582,110.49907124912912,110.68904962395804,110.88556564300737,111.08837292856815,111.29723428623221,111.51192131992045,111.73221406519804,111.95790063990114,112.18877691115618,112.42464617792915,112.66531886829078,112.910612250632,113.16035015810843,113.41436272563313,113.67248613877641,113.93456239396848,114.20043906943336,114.46996910631567,114.74301059949157,115.01942659758316,115.29908491172311,115.58185793263867,115.86762245565137,116.15625951320703,116.44765421457278,116.74169559235985,117.03827645554311,117.33729324867217,117.6386459169799,117.94223777711362,118.24797539322527,118.55576845817241,118.8655296795942,119.17717467063785,119.49062184512481,119.80579231695313,120.12260980354523,120.44100053315982,120.76089315589459,121.08221865821474,121.404910280853,121.72890343993045,122.05413565115913,122.38054645699017,122.70807735658107,123.03667173845882,123.36627481576538,123.69683356397223,124.02829666096105,124.36061442936931,124.69373878110603,125.0276231639459,125.362222510115,125.6974931867863],[116.75875607861796,116.06413821502012,115.41211867908915,114.80081879305926,114.22845483392493,113.69333246057801,113.19384151530274,112.728451171294,112.29570540024392,111.89421873621065,111.52267231394441,111.17981016163688,110.86443572968206,110.57540863852212,110.31164162999811,110.07209770785821,109.85578745420393,109.6617665096755,109.48913320612563,109.33702634138352,109.20462308650578,109.09113701662626,108.99581625718596,108.91794173792667,108.85682554759495,108.81180938281375,108.782263085053,108.76758326006536,108.76719197455307,108.7805355252024,108.80708327556087,108.84632655655025,108.89777762669462,108.9609686884137,109.03545095698027,109.12079377896708,109.21658379722362,109.32242415962125,109.4379337689829,109.5627465717871,109.69651088339263,109.8388887476726,109.98955532908677,110.14819833534236,110.3145174689141,110.48822390580149,110.66903980000123,110.85669781227135,111.05094066184607,111.25152069984672,111.45819950320831,111.67074748801312,111.88894354118972,112.11257466959673,112.34143566557056,112.57532878806943,112.81406345859614,113.05745597113193,113.30532921535564,113.55751241246561,113.81384086296001,114.07415570576882,114.3383036881629,114.60613694590133,114.8775127931039,115.1522935213669,115.43034620766741,115.71154253062407,115.99575859470569,116.28287476200535,116.57277549121173,116.86534918343553,117.16048803456192,117.45808789382113,117.75804812828279,118.06027149299703,118.36466400651788,118.67113483156106,118.97959616055707,119.28996310587598,119.60215359451115,119.91608826701751,120.23169038051439,120.54888571556799,120.86760248678186,121.18777125692949,121.50932485447127,121.83219829430918,122.15632870163488,122.48165523873782,122.80811903464392,123.13566311746405,123.4642323493332,123.79377336383355,124.12423450579134,124.45556577335074,124.78771876222598,125.12064661204271,125.45430395467905,125.78864686452548],[117.13469616453628,116.43259709322872,115.77331746176594,115.1549699639633,114.57576266520834,114.03399340566729,113.52804457943756,113.05637826119134,112.61753165424746,112.21011283618371,111.83279678007408,111.48432163123073,111.16348522096409,110.86914180035942,110.60019897842672,110.3556148502163,110.13439530162069,109.93559147861775,109.75829740965301,109.60164777072038,109.46481578349656,109.34701123760448,109.24747862875118,109.16549540509186,109.10037031473672,109.05144184782976,109.01807676710648,108.99966872127004,108.9956369359324,109.005424977234,109.02849958360041,109.06434956140741,109.11248474062066,109.1724349867428,109.24374926565159,109.3259947581431,109.41875602120638,109.52163419325477,109.63424624072279,109.75622424360428,109.88721471767064,110.0268779712484,110.17488749457574,110.33092937988143,110.49470177044897,110.66591433703634,110.84428778012423,111.02955335656142,111.22145242926177,111.41973603869292,111.62416449496931,111.83450698943918,112.05054122471614,112.27205306217319,112.49883618597244,112.73069178276025,112.96742823620635,113.20886083561602,113.45481149788586,113.70510850211818,113.95958623624774,114.21808495506899,114.48045054908972,114.74653432366719,115.0161927879131,115.28928745288403,115.56568463859807,115.84525528944562,116.12787479758454,116.41342283393303,116.70178318639346,116.99284360496091,117.28649565338775,117.58263456709338,117.88115911702572,118.18197147919352,118.48497710960636,118.79008462437122,119.09720568470671,119.40625488665137,119.71714965524846,120.02981014300785,120.3441591324476,120.66012194253589,120.97762633885534,121.29660244732662,121.61698267133281,121.93870161209402,122.26169599215179,122.5859045818253,122.91126812851273,123.23772928871293,123.56523256265199,123.89372423140314,124.2231522963921,124.55346642119018,124.88461787549581,125.21655948121402,125.54924556054584,125.88263188600503],[117.52196162541647,116.81215597143733,116.14539753059113,115.51979010833911,114.93353331108322,114.38491692472107,113.87231567078327,113.39418431157274,112.94905307813475,112.53552339706215,112.15226389412894,111.79800665454364,111.47154372125509,111.17172381423748,110.89744925504093,110.64767308214044,110.42139634374428,110.21766555576444,110.03557031359674,109.8742410472276,109.73284690997676,109.61059379191599,109.5067224496709,109.42050674492569,109.35125198451557,109.29829335550961,109.26099444915999,109.23874586803788,109.23096391107561,109.23708933160937,109.25658616385921,109.28894061360187,109.33366000908326,109.39027180848787,109.45832266053465,109.53737751499797,109.62701878016857,109.72684552446626,109.83647271960216,109.95553052285688,110.08366359620108,110.22053046013038,110.36580288022465,110.51916528456732,110.68031421027906,110.84895777753043,111.02481518949806,111.20761625682813,111.39710094525444,111.59301894510662,111.79512926151526,112.00319982419863,112.21700711577735,112.43633581763055,112.66097847236169,112.89073516200149,113.12541320112152,113.36482684408438,113.60879700569893,113.85715099459078,114.10972225863951,114.36635014186921,114.62687965221409,114.89116123961315,115.15905058391922,115.43040839213471,115.70510020451488,115.98299620910329,116.26397106428766,116.54790372898991,116.83467730011803,117.12417885693624,117.41629931202064,117.71093326848892,118.00797888320855,118.3073377357032,118.60891470249085,118.91261783660279,119.21835825204327,119.52605001296385,119.83561002733693,120.14695794492404,120.46001605934505,120.77470921406362,121.09096471211478,121.40871222940615,121.72788373143764,122.04841339328512,122.37023752270991,122.69329448625287,123.0175246381873,123.3428702522056,123.66927545572211,123.99668616668116,124.32505003276319,124.65431637288765,124.98443612091563,125.31536177145995,125.64704732771551,125.97944825122502],[117.92055246125828,117.20281484964597,116.52835888556471,115.89527922618669,115.30176677154948,114.74610301773939,114.22665478933972,113.74186932243842,113.29026967190597,112.87045041884596,112.48107365610909,112.12086523157555,111.78861123055516,111.48315468015633,111.20339245984046,110.94827240363063,110.71679058057504,110.5079887411157,110.32095191795689,110.15480617090518,110.00871646594642,109.8818846795609,109.77354771994519,109.68297575742803,109.60947055693194,109.55236390585341,109.51101613121348,109.48481470036882,109.47317289998294,109.47552858832853,109.49134301633717,109.52009971313362,109.56130343208228,109.61447915364893,109.67917114162941,109.75494204953165,109.8413720741102,109.93805815325555,110.04461320562093,110.16066540954479,110.28585751898387,110.4198462143185,110.56230148603355,110.71290604940002,110.87135478840446,111.03735422728383,111.21062202812281,111.39088651307164,111.57788620982411,111.77136941908792,111.97109380284613,112.17682599229133,112.38834121437331,112.60542293596869,112.82786252473838,113.05545892579327,113.28801835334151,113.52535399653698,113.76728573879504,114.01363988988342,114.26424893013528,114.51895126616947,114.77759099753594,115.04001769373929,115.30608618112214,115.57565633911886,115.84859290541803,116.12476528959702,116.40404739481545,116.68631744717607,116.97145783238533,117.25935493936142,117.54989901046071,117.84298399800784,118.13850742683134,118.43637026252598,118.73647678517119,119.03873446825585,119.34305386256661,119.64934848481353,119.95753471077651,120.26753167276621,120.57926116120656,120.89264753015128,121.20761760656029,121.52410060316822,121.84202803478559,122.16133363788229,122.48195329330915,122.80382495202034,123.12688856366776,123.45108600794204,123.77636102854322,124.10265916966745,124.42992771490462,124.75811562844319,125.08717349848526,125.4170534827804,125.74770925618797,126.07909596018561],[118.33046867206185,117.60457372785457,116.92220152668689,116.28143731750598,115.68046304660702,115.11755168472222,114.59106193510723,114.09943329378815,113.6411814355609,113.21489390153504,112.81922606601448,112.4528973623265,112.11468774886427,111.80343439811598,111.51802859282553,111.25741281468676,111.02057801211274,110.80656103467146,110.61444222273342,110.44334314175309,110.29242445140547,110.1608839005391,110.04795443957408,109.95290244259913,109.8750260319855,109.81365349886117,109.76814181326698,109.73787521826286,109.72226390265429,109.72074274739138,109.73277014103438,109.7578268600026,109.79541500961773,109.84505702222587,109.90629470893604,109.97868836174408,110.06181590303122,110.15527207962252,110.25866769877904,110.3716289036682,110.49379648601898,110.62482523381269,110.76438331200234,110.91215167437949,111.0678235048252,111.23110368629645,111.40170829599853,111.57936412529182,111.76380822297084,111.95478746063668,112.15205811896186,112.35538549371735,112.56454352050402,112.77931441718781,112.99948834310251,113.22486307413557,113.45524369286649,113.6904422929738,113.93027769717418,114.17457518799615,114.42316625073522,114.67588832796972,114.93258458505507,115.19310368604556,115.45729957952206,115.72503129383654,115.99616274130729,116.27056253092694,116.54810378916756,116.8286639884915,117.11212478319536,117.39837185223638,117.6872947487079,117.97878675564999,118.27274474789401,118.56906905966186,118.86766335764749,119.16843451933049,119.47129251627679,119.77615030220045,120.08292370556707,120.39153132653428,120.70189443803226,121.01393689079869,121.32758502219188,121.6427675686126,121.95941558137693,122.27746234588571,122.59684330394963,122.91749597912775,123.23935990495403,123.56237655592226,123.88648928111536,124.21164324036197,124.53778534281639,124.86486418785663,125.19283000820484,125.52163461517534,125.85123134596309,126.18157501288646],[118.75171025782724,118.01743260606314,117.3269254539573,116.67826438229704,116.06962213625599,115.49926292566951,114.9655371080855,114.46687622562203,114.00178836909976,113.5688538451296,113.16672112384512,112.79410304679641,112.44977327618237,112.13256296811645,111.84135765399604,111.575094315309,111.33275863835743,111.11338243643168,110.91604122792639,110.73985195977124,110.58397086635401,110.44759145485062,110.32994260855746,110.2302868004388,110.14791840967642,110.08216213453272,110.03237149532058,109.99792742172008,109.97823691908964,109.97273180879803,109.98086753795079,110.0021220542089,110.03599474168968,110.0820054142189,110.13969336245438,110.20861645163519,110.28835026693173,110.37848730356755,110.47863619907665,110.58842100522706,110.70748049730653,110.83546751861294,110.9720483581311,111.11690215950573,111.2697203595411,111.43020615456837,111.59807399312517,111.77304909348877,111.95486698469448,112.14327306975315,112.33802220986259,112.53887832847671,112.74561403416949,112.9580102612878,113.17585592745412,113.39894760702836,113.62708921969624,113.86009173339477,114.09777288083617,114.33995688892891,114.58647422043919,114.83716132726997,115.09186041477183,115.35041921653196,115.61269077911879,115.87853325628764,116.14780971218285,116.42038793309294,116.69614024734415,116.97494335293617,117.25667815254818,117.54122959556112,117.82848652676223,118.11834154141549,118.41069084639675,118.70543412711091,119.00247441991969,119.30171798982651,119.60307421317385,119.90645546512457,120.2117770117088,120.51895690622835,120.82791588982207,121.13857729600601,121.45086695900953,121.76471312573949,122.08004637121135,122.39679951729536,122.71490755463125,123.03430756757521,123.35493866204607,123.67674189614634,123.99966021343863,124.32363837876497,124.64862291649851,124.97456205112819,125.30140565007426,125.62910516864494,125.95761359704113,126.28688540932775],[119.18427721855429,118.44139148427179,117.74253066737622,117.08576042055982,116.46924404049633,115.89123674058133,115.3500803082748,114.84419811794019,114.37209047252247,113.93233024962942,113.52355882960104,113.14448228498533,112.79386781250952,112.47054039015772,112.17337964335201,111.90131690549721,111.65333245930915,111.42845294639646,111.22574893353574,111.04433262495985,110.88335571079203,110.74200734249547,110.61951222689544,110.51512883094721,110.42814769000476,110.35788981286818,110.30370517737398,110.26497131074036,110.24109194928913,110.2314957725484,110.23563520708649,110.25298529575241,110.28304262829801,110.32532432962796,110.37936710218446,110.44472631920517,110.52097516581165,110.6077038250904,110.70451870651375,110.81104171422126,110.92690955284638,111.05177306871934,111.18529662441979,111.32715750477881,111.47704535255231,111.63466163209952,111.79971911950257,111.97194141766244,112.15106249499506,112.33682624643717,112.52898607554816,112.72730449656942,112.93155275536969,113.14151046826863,113.35696527779312,113.57771252447165,113.80355493383094,114.03430231780005,114.26977128978123,114.50978499268182,114.75417283924722,115.00277026407018,115.25541848668598,115.5119642851986,115.77225977991243,116.03616222647229,116.30353381804451,116.57424149609506,116.84815676934512,117.12515554051006,117.40511794044377,117.68792816933571,117.97347434462365,118.26164835530427,118.5523457223394,118.84546546487303,119.14090997198778,119.43858487974407,119.73839895325769,120.04026397358568,120.34409462920158,120.64980841184824,120.95732551657596,121.26656874577314,121.57746341701326,121.8899372745487,122.20392040428914,122.51934515211119,122.83614604535404,123.15425971736259,123.47362483494393,123.79418202861402,124.11587382551309,124.43864458487616,124.76244043595099,125.08720921825761,125.41290042409366,125.73946514318902,126.06685600942197,126.39502714950957],[119.62816955424313,118.87645036248036,118.16901716694353,117.50392543229438,116.87932875932813,116.29347312945768,115.74469153567482,115.23139897074236,114.75208774582902,114.30532311503464,113.88973918328224,113.50403507689322,113.14697135784553,112.81736666423984,112.5140945608934,112.23608058525144,111.98229947496779,111.75177256456581,111.54356533956138,111.35678513731884,111.19057898471937,111.04413156347366,110.91666329458799,110.8074285341241,110.71571387297024,110.64083653386753,110.58214285942756,110.5390068853237,110.51082899325253,110.49703463864249,110.49707314844132,110.51041658463325,110.53655866944277,110.57501376845288,110.62531592812634,110.68701796445386,110.75969059967095,110.84292164419104,110.93631522109025,111.03949103065091,111.15208365263865,111.27374188413199,111.40412811086857,111.54291771019869,111.68979848385877,111.84447011888992,112.00664367513095,112.17604109781284,112.35239475387262,112.5354469906887,112.72494971601866,112.92066399799553,113.12235968410467,113.32981503813045,113.54281639411954,113.76115782646553,113.98464083527047,114.21307404618952,114.44627292400925,114.68405949925469,114.92626210715939,115.17271513837042,115.4232588007975,115.67773889204534,115.93600658190293,116.19791820439046,116.46333505889253,116.73212321993324,117.00415335517054,117.27930055121321,117.55744414688215,117.83846757356018,118.12225820229222,118.40870719731633,118.69770937572184,118.9891630729482,119.28297001385187,119.57903518908314,119.87726673652827,120.17757582758422,120.47987655804543,120.78408584339414,121.09012331829412,121.39791124010014,121.70737439620301,122.01844001504044,122.33103768061004,122.6450992503331,122.96055877611812,123.27735242848995,123.59541842364773,123.91469695332556,124.23513011733853,124.55666185869586,124.87923790117388,125.20280568924514,125.52731433026293,125.85271453880772,126.17895858310555,126.50600023343178],[120.08338726489369,119.32260924068902,118.60638495265921,117.93275941750068,117.29987629275126,116.70597209229844,116.14937079028586,115.6284787840288,115.1417801890193,114.68783244134511,114.26526218488868,113.87276142252021,113.5090839121907,113.17304179036279,112.8635024066202,112.57938535457168,112.31965968533351,112.0833412909396,111.86949044600351,111.67720949684808,111.50564068813622,111.35396411778522,111.22139581163502,111.1071859099697,111.01061695857317,110.93100229753081,110.86768454148104,110.82003414547025,110.78744805098,110.76934840708037,110.76518136201535,110.77441592085137,110.79654286512408,110.83107373069383,110.87753984027999,110.93549138738133,111.00449656850962,111.0841407608696,111.17402574280611,111.27376895451602,111.38300279668329,111.50137396485064,111.62854281747715,111.76418277576533,111.90797975346049,112.05963161493962,112.21884766001016,112.38534813394004,112.55886376132727,112.73913530250786,112.92591313127409,113.1189568327549,113.31803482037436,113.52292397087309,113.73340927643348,113.94928351300997,114.17034692401501,114.39640691856327,114.6272777835202,114.86278040864777,115.10274202417548,115.34699595017072,115.59538135710649,115.84774303707228,116.10393118509033,116.36380119004208,116.62721343472673,116.89403310460762,117.16413000482046,117.43737838504563,117.7136567718633,117.9928478082344,118.2748380997679,118.55951806745172,118.84678180654434,119.13652695133659,119.42865454551176,119.72306891784361,120.01967756298571,120.31839102711977,120.61912279824035,120.92178920086593,121.22630929497626,121.53260477898684,121.84059989657878,122.15022134721447,122.46139820017434,122.77406181196112,123.08814574692323,123.40358570095738,123.72031942815732,124.03828667028088,124.3574290889152,124.67769020022375,124.99901531216716,125.3213514640907,125.64464736858204,125.96885335550085,126.29392131809189,126.61980466109441],[120.54993035050595,119.77986811889764,119.05463402452337,118.37226237617865,117.73088664076583,117.12873362910368,116.56411807210772,116.03543755779945,115.54116780209344,115.07985822856098,114.65012783442037,114.25066132186615,113.88020547554477,113.53756576852656,113.2216031805325,112.93123121345801,112.66541309040613,112.42315912551788,112.20352425286205,112.00560570354777,111.82854082104249,111.67150500543006,111.53370977803665,111.41440095848394,111.31285694681335,111.22838710385791,111.1603302235346,111.10805309117985,111.07094912247148,111.04843707786198,111.03995984780867,111.04498330440678,111.06299521534177,111.09350421635069,111.13603883864542,111.19014658798763,111.25539307232785,111.33136117512596,111.41765027166149,111.51387548581646,111.61966698498026,111.73466931087543,111.85854074424573,111.9909527014788,112.13158916135751,112.28014612024857,112.43633107414034,112.59986252604384,112.77046951735878,112.94789118189452,113.13187632131445,113.32218300084762,113.51857816417886,113.72083726649657,113.92874392473482,114.14208958410475,114.36067320006434,114.58430093492122,114.81278586831421,115.0459477208607,115.28361259029575,115.52561269947088,115.771786155613,116.02197672027931,116.27603358947465,116.53381118342715,116.7951689455472,117.05997115011805,117.32808671829483,117.59938904200729,117.87375581538718,118.15106887335851,118.43121403705064,118.71408096571052,118.99956301480678,119.2875571000381,119.57796356696768,119.87068606602564,120.16563143262999,120.46270957219257,120.76183334978643,121.06291848426368,121.36588344662265,121.67064936243352,121.97713991814072,122.28528127107103,122.59500196298185,122.9062328369954,123.21890695776958,123.53295953476467,123.84832784847264,124.16495117947989,124.48277074024286,124.80172960946004,125.12177266893066,125.44284654279421,125.76489953905116,126.08788159326862,126.41174421438116,126.73644043249742],[121.02779881107995,120.2482269971062,119.51376438253592,118.82243430832838,118.17235980337169,117.56175773987353,116.98893338114047,116.45227529205417,115.95025058505145,115.48140047668227,115.04433613187736,114.63773477493112,114.26033604790796,113.91093859873111,113.58839688263026,113.29161816191025,113.01955969018589,112.77122606830079,112.54566676013697,112.34197375741776,112.15927938343823,111.99675422640829,111.8536051937928,111.72907367966694,111.62243383769089,111.53299095284891,111.46007990558803,111.40306372245267,111.36133220772692,111.3343006509874,111.32140860582118,111.32211873529943,111.33591572009585,111.3623052254236,111.40081292322267,111.45098356627273,111.51238011112537,111.58458288696021,111.66718880765627,111.75981062455239,111.86207621752956,111.97362792220633,112.0941218911743,112.22322748733906,112.36062670754984,112.50601363481671,112.6590939175214,112.81958427412447,112.98721202196735,113.16171462884876,113.34283928613978,113.53034250227367,113.72398971551807,113.92355492500108,114.12882033902355,114.3395760397502,114.55561966341864,114.77675609526329,115.00279717839113,115.23356143589379,115.46887380552006,115.70856538627113,115.95247319631687,116.2004399416665,116.45231379505586,116.70794818454581,116.9672015913538,117.22993735646462,117.49602349559358,117.76533252209818,118.03774127745386,118.31313076893237,118.59138601414055,118.87239589209248,119.15605300050917,119.44225351905268,119.73089707821947,120.02188663362921,120.31512834546113,120.61053146280251,120.90800821268351,121.20747369358735,121.5088457732332,121.81204499044001,122.11699446088862,122.4236197866099,122.73184896903261,123.04161232543584,123.35284240865707,123.66547392991191,123.97944368459385,124.29469048092274,124.61115507132169,124.9287800864047,125.24750997146455,125.56729092535579,125.88807084167011,126.2097992521109,126.53242727197308,126.85590754764098]],"x":[0.5,0.50505050505050508,0.51010101010101006,0.51515151515151514,0.52020202020202022,0.5252525252525253,0.53030303030303028,0.53535353535353536,0.54040404040404044,0.54545454545454541,0.5505050505050505,0.55555555555555558,0.56060606060606055,0.56565656565656564,0.57070707070707072,0.5757575757575758,0.58080808080808077,0.58585858585858586,0.59090909090909094,0.59595959595959602,0.60101010101010099,0.60606060606060608,0.61111111111111116,0.61616161616161613,0.62121212121212122,0.6262626262626263,0.63131313131313127,0.63636363636363635,0.64141414141414144,0.64646464646464641,0.65151515151515149,0.65656565656565657,0.66161616161616166,0.66666666666666674,0.67171717171717171,0.6767676767676768,0.68181818181818188,0.68686868686868685,0.69191919191919193,0.69696969696969702,0.70202020202020199,0.70707070707070707,0.71212121212121215,0.71717171717171713,0.72222222222222221,0.72727272727272729,0.73232323232323238,0.73737373737373746,0.74242424242424243,0.74747474747474751,0.7525252525252526,0.75757575757575757,0.76262626262626265,0.76767676767676774,0.77272727272727271,0.77777777777777779,0.78282828282828287,0.78787878787878785,0.79292929292929293,0.79797979797979801,0.80303030303030298,0.80808080808080818,0.81313131313131315,0.81818181818181823,0.82323232323232332,0.82828282828282829,0.83333333333333337,0.83838383838383845,0.84343434343434343,0.84848484848484851,0.85353535353535359,0.85858585858585856,0.86363636363636365,0.86868686868686873,0.8737373737373737,0.8787878787878789,0.88383838383838387,0.88888888888888884,0.89393939393939403,0.89898989898989901,0.90404040404040409,0.90909090909090917,0.91414141414141414,0.91919191919191923,0.92424242424242431,0.92929292929292928,0.93434343434343436,0.93939393939393945,0.94444444444444442,0.94949494949494961,0.95454545454545459,0.95959595959595956,0.96464646464646475,0.96969696969696972,0.97474747474747481,0.97979797979797989,0.98484848484848486,0.98989898989898994,0.99494949494949503,1],"y":[0.5,0.50505050505050508,0.51010101010101006,0.51515151515151514,0.52020202020202022,0.5252525252525253,0.53030303030303028,0.53535353535353536,0.54040404040404044,0.54545454545454541,0.5505050505050505,0.55555555555555558,0.56060606060606055,0.56565656565656564,0.57070707070707072,0.5757575757575758,0.58080808080808077,0.58585858585858586,0.59090909090909094,0.59595959595959602,0.60101010101010099,0.60606060606060608,0.61111111111111116,0.61616161616161613,0.62121212121212122,0.6262626262626263,0.63131313131313127,0.63636363636363635,0.64141414141414144,0.64646464646464641,0.65151515151515149,0.65656565656565657,0.66161616161616166,0.66666666666666674,0.67171717171717171,0.6767676767676768,0.68181818181818188,0.68686868686868685,0.69191919191919193,0.69696969696969702,0.70202020202020199,0.70707070707070707,0.71212121212121215,0.71717171717171713,0.72222222222222221,0.72727272727272729,0.73232323232323238,0.73737373737373746,0.74242424242424243,0.74747474747474751,0.7525252525252526,0.75757575757575757,0.76262626262626265,0.76767676767676774,0.77272727272727271,0.77777777777777779,0.78282828282828287,0.78787878787878785,0.79292929292929293,0.79797979797979801,0.80303030303030298,0.80808080808080818,0.81313131313131315,0.81818181818181823,0.82323232323232332,0.82828282828282829,0.83333333333333337,0.83838383838383845,0.84343434343434343,0.84848484848484851,0.85353535353535359,0.85858585858585856,0.86363636363636365,0.86868686868686873,0.8737373737373737,0.8787878787878789,0.88383838383838387,0.88888888888888884,0.89393939393939403,0.89898989898989901,0.90404040404040409,0.90909090909090917,0.91414141414141414,0.91919191919191923,0.92424242424242431,0.92929292929292928,0.93434343434343436,0.93939393939393945,0.94444444444444442,0.94949494949494961,0.95454545454545459,0.95959595959595956,0.96464646464646475,0.96969696969696972,0.97474747474747481,0.97979797979797989,0.98484848484848486,0.98989898989898994,0.99494949494949503,1],"type":"surface","contours":{"z":{"show":true,"usecolormap":true,"highlightcolor":"#ff0000","start":104.93242508858232,"end":128.76351163328218,"size":1,"project":{"z":true}}},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-r-likelihood-plot-3d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.5: Likelihood Surface for Happiness and Life Expectancy (interactive)
</figcaption>
</figure>
</div>
</div>
<p>We can also see the path our estimates take. Starting at a fairly bad estimate, the optimization algorithm quickly updates to estimates that result in a better likelihood value. We also see little exploratory jumps creating a star like pattern, before things ultimately settle to the best values. In general, these updates and paths are dependent on the optimization algorithm one uses.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-r-likelihood-path" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-r-likelihood-path-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estimation_files/figure-html/fig-r-likelihood-path-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-r-likelihood-path-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.6: Optimization Path for Two Parameters
</figcaption>
</figure>
</div>
</div>
</div>
<p>What we’ve shown here with maximum likelihood applies in general to searching for the best solution along an objective function surface. In most modeling circumstances, the surface is very complex with lots of points that might represent ‘local’ minimums, even though we’d ideally find the ‘global’ minimum. This is why we need optimization algorithms to help us find the best solution<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>. The optimization algorithms we’ll use are general purpose, and can be used for many different types of problems. The key is to define an appropriate objective function, and then let the algorithm do the work.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="MLE &amp; OLS">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
MLE &amp; OLS
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>For linear regression assuming a normal distribution, the maximum likelihood estimate of the standard deviation is the OLS estimate of the standard deviation of the residuals. Furthermore, the maximum likelihood coefficient estimates and OLS estimates converge to the same estimates as the sample size increases. In practice these estimates are indistinguishable, and the OLS estimate is the maximum likelihood estimate for linear regression. So OLS and variants (such as those used for GLM) are maximum likelihood estimation methods.</p>
</div>
</div>
</div>
</section>
</section>
<section id="sec-estim-penalty" class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="sec-estim-penalty"><span class="header-section-number">6.8</span> Penalized Objectives</h2>
<p>One thing we may want to take into account with our models is their complexity, especially in the context of <strong>overfitting</strong>. We talk about this with machine learning also (<a href="machine_learning.html" class="quarto-xref"><span>Chapter 9</span></a>), but the basic idea is that we can get too familiar with the data we have, and when we try to predict on new data the model hasn’t seen before, model performance suffers. In other words, we are not generalizing well (<a href="machine_learning.html#sec-ml-generalization" class="quarto-xref"><span>Section 9.4</span></a>).</p>
<p>One way to deal with this is to penalize the objective function value for complexity, or at least favor simpler models that might do as well. In some contexts this is called <strong>regularization</strong>, and in other contexts <strong>shrinkage</strong>, since the parameter estimates are typically shrunk toward some specific value (e.g., zero).</p>
<p>As a starting point, in our basic linear model we can add a penalty that is applied to the size of coefficients. This is called <strong>ridge regression</strong>, or, more mathily, as <strong>L2 regularization</strong>. We can write this formally as:</p>
<div id="eq-ols-ridge" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/eq-penalized-reg.png" class="img-fluid figure-img"></p>
<figcaption>A penalized model</figcaption>
</figure>
</div>
<p>The first part is the same as basic OLS (<a href="#eq-ols" class="quarto-xref">Equation&nbsp;<span>6.1</span></a>), but the second part is the penalty for <span class="math inline">\(p\)</span> features. The penalty is the sum of the squared coefficients multiplied by some value, which we call <span class="math inline">\(\lambda\)</span>. This is an additional model parameter that we typically want to estimate, for example, through <a href="../ml-common-models#sec-ml-cv">cross-validation</a>. This kind of parameter is often called a <strong>hyperparameter</strong>, mostly just to distinguish it from those that may be of actual interest. For example, we could probably care less what the actual value for <span class="math inline">\(\lambda\)</span> is, but we would still be interested in the coefficients.</p>
<p>In the end this is just a small change to ordinary least squares (OLS) regression (<a href="#eq-ols" class="quarto-xref">Equation&nbsp;<span>6.1</span></a>), but it can make a big difference. It introduces some bias in the coefficients - recall that OLS is unbiased if assumptions are met - but it can help to reduce variance, which can help the model perform better on new data (<a href="machine_learning.html#sec-ml-generalization-understanding" class="quarto-xref"><span>Section 9.4.2</span></a>). In other words, we are willing to accept some bias in order to get a model that generalizes better.</p>
<p>But let’s get to an example to demystify this a bit! Here is an example of a function that calculates the ridge objective. To make things interesting, let’s add the other features we talked about regarding GDP per capita and perceptions of corruption.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>ridge <span class="ot">=</span> <span class="cf">function</span>(par, X, y, <span class="at">lambda =</span> <span class="dv">0</span>) {</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add a column of 1s for the intercept</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span>, X)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">=</span> X <span class="sc">%*%</span> par <span class="co"># linear predictor</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the value as sum squared error</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    error <span class="ot">=</span> <span class="fu">sum</span>((y <span class="sc">-</span> mu)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add the penalty</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    value <span class="ot">=</span> error <span class="sc">+</span> lambda <span class="sc">*</span> <span class="fu">sum</span>(par<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(value)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> df_happiness <span class="sc">|&gt;</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>happiness, <span class="sc">-</span>country) <span class="sc">|&gt;</span> </span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.matrix</span>()</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>our_ridge <span class="ot">=</span> <span class="fu">optim</span>(</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">par =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">fn =</span> ridge,</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">X =</span> X,</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> df_happiness<span class="sc">$</span>happiness,</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">lambda =</span> <span class="fl">0.1</span>,</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">'BFGS'</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>our_ridge<span class="sc">$</span>par</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we use lambda_ because lambda is a reserved word in python</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ridge(par, X, y, lambda_ <span class="op">=</span> <span class="dv">0</span>):</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add a column of 1s for the intercept</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.c_[np.ones(X.shape[<span class="dv">0</span>]), X]</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the predicted values</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> X <span class="op">@</span> par</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the error</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    value <span class="op">=</span> np.<span class="bu">sum</span>((y <span class="op">-</span> mu)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add the penalty</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    value <span class="op">=</span> value <span class="op">+</span> lambda_ <span class="op">*</span> np.<span class="bu">sum</span>(par<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> value</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>our_ridge <span class="op">=</span> minimize(</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    fun  <span class="op">=</span> ridge,</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    x0   <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]),</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> (</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>        np.array(df_happiness.drop(columns<span class="op">=</span>[<span class="st">'happiness'</span>, <span class="st">'country'</span>])),</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>        np.array(df_happiness[<span class="st">'happiness'</span>]), </span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0.1</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>our_ridge[<span class="st">'x'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>We can compare this to built-in functions as we have before<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a>, and can see that the results are very similar, but not exactly the same. We would not worry about such differences in practice, but the main point is again, we can use simple functions that do just about as well as any what we’d get from package output.</p>
<div class="cell">
<div id="tbl-r-ridge" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-r-ridge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6.5: Comparison of Ridge Regression Results
</figcaption>
<div aria-describedby="tbl-r-ridge-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="kvnsncupwo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#kvnsncupwo table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kvnsncupwo thead, #kvnsncupwo tbody, #kvnsncupwo tfoot, #kvnsncupwo tr, #kvnsncupwo td, #kvnsncupwo th {
  border-style: none;
}

#kvnsncupwo p {
  margin: 0;
  padding: 0;
}

#kvnsncupwo .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kvnsncupwo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kvnsncupwo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kvnsncupwo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kvnsncupwo .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kvnsncupwo .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kvnsncupwo .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kvnsncupwo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kvnsncupwo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kvnsncupwo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kvnsncupwo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kvnsncupwo .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kvnsncupwo .gt_spanner_row {
  border-bottom-style: hidden;
}

#kvnsncupwo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kvnsncupwo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kvnsncupwo .gt_from_md > :first-child {
  margin-top: 0;
}

#kvnsncupwo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kvnsncupwo .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kvnsncupwo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kvnsncupwo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kvnsncupwo .gt_row_group_first td {
  border-top-width: 2px;
}

#kvnsncupwo .gt_row_group_first th {
  border-top-width: 2px;
}

#kvnsncupwo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvnsncupwo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kvnsncupwo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kvnsncupwo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kvnsncupwo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvnsncupwo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kvnsncupwo .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kvnsncupwo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kvnsncupwo .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#kvnsncupwo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kvnsncupwo .gt_footnote {
  margin: 0px;
  font-size: 10px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvnsncupwo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kvnsncupwo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kvnsncupwo .gt_left {
  text-align: left;
}

#kvnsncupwo .gt_center {
  text-align: center;
}

#kvnsncupwo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kvnsncupwo .gt_font_normal {
  font-weight: normal;
}

#kvnsncupwo .gt_font_bold {
  font-weight: bold;
}

#kvnsncupwo .gt_font_italic {
  font-style: italic;
}

#kvnsncupwo .gt_super {
  font-size: 65%;
}

#kvnsncupwo .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kvnsncupwo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kvnsncupwo .gt_indent_1 {
  text-indent: 5px;
}

#kvnsncupwo .gt_indent_2 {
  text-indent: 10px;
}

#kvnsncupwo .gt_indent_3 {
  text-indent: 15px;
}

#kvnsncupwo .gt_indent_4 {
  text-indent: 20px;
}

#kvnsncupwo .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Parameter">Parameter</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Standard<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>">Standard<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Our Result">Our Result</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Intercept</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.44</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.44</td></tr>
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">life_exp_sc</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.49</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.52</td></tr>
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">corrupt_sc</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.12</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.11</td></tr>
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">gdp_pc_sc</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.42</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.44</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> Showing results from R glmnet package with alpha = 0, lambda = .1</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Analytical Solution for Ridge Regression">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Analytical Solution for Ridge Regression
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>It turns out that given a fixed <span class="math inline">\(\lambda\)</span> penalty ridge regression estimates can be derived analytically. Michael has an example if interested at his <a href="https://m-clark.github.io/models-by-example/penalized-maximum-likelihood.html#l2-ridge-regularization">Model Estimation by Example</a> demos (<span class="citation" data-cites="clark_model_2021">Clark (<a href="references.html#ref-clark_model_2021" role="doc-biblioref">2021</a>)</span>).</p>
</div>
</div>
</div>
<p>Another very common penalized approach is to use the sum of the absolute value of the coefficients, which is called <strong>lasso regression</strong> or <strong>L1 regularization</strong>. An interesting property of the lasso is that in typical implementations, it will potentially produce a value of zero for some coefficients, which is the same as dropping the associated feature from the model altogether. This is a form of <strong>feature selection</strong> or <strong>variable selection</strong>. The true values are never zero, but if we want to use a ‘best subset’ of features, this is one way we could do so. We can write the lasso objective as follows. The chapter exercise asks you to implement this yourself.</p>
<div id="eq-estim-lasso" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/eq-lasso.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>Lasso Penalty</figcaption>
</figure>
</div>
</section>
<section id="sec-estim-classification" class="level2" data-number="6.9">
<h2 data-number="6.9" class="anchored" data-anchor-id="sec-estim-classification"><span class="header-section-number">6.9</span> Classification</h2>
<p>So far, we’ve been assuming a continuous target, but what if we have a categorical target? Now we have to learn a bunch of new stuff for that situation, right? Actually, no! <em>When we want to model categorical targets, conceptually, nothing changes with our estimation approach</em>! We still have an objective function that maximizes or minimizes some goal, and we can use the same algorithms to estimate parameters. However, we need to think about how we can do this in a way that makes sense for the binary target, or generalize to the multi-class case.</p>
<section id="sec-estim-misclass" class="level3" data-number="6.9.1">
<h3 data-number="6.9.1" class="anchored" data-anchor-id="sec-estim-misclass"><span class="header-section-number">6.9.1</span> Misclassification Error</h3>
<p>A straightforward correspondence to MSE is a function that minimizes classification error, or by the same token, maximizes accuracy. In other words, we can think of the objective function as the proportion of incorrect classifications. This is called the <strong>misclassification rate</strong>.</p>
<p><span id="eq-estim-misclassification"><span class="math display">\[
\text{Value} = \frac{1}{n} \sum_{i=1}^{n} \mathbb{1}(y_i \neq \hat{y_i})
\tag{6.2}\]</span></span></p>
<p>In the equation, <span class="math inline">\(y_i\)</span> is the actual value of the target for observation <span class="math inline">\(i\)</span>, arbitrarily coded as 1 or 0, and <span class="math inline">\(\hat{y_i}\)</span> is the predicted class from the model. The <span class="math inline">\(\mathbb{1}\)</span> is an indicator function that returns 1 if the condition is true, and 0 otherwise. In other words, we are counting the number of times the predicted value is not equal to the actual value, and dividing by the number of observations. Very straightforward, so let’s do this ourselves!</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>misclassification <span class="ot">=</span> <span class="cf">function</span>(par, X, y, <span class="at">class_threshold =</span> .<span class="dv">5</span>) {</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span>, X)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the 'linear predictor'</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">=</span> X <span class="sc">%*%</span> par</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to a probability ('sigmoid' function)</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">=</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>mu))</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to a class</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    predicted_class <span class="ot">=</span> <span class="fu">as.integer</span>(</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ifelse</span>(p <span class="sc">&gt;</span> class_threshold, <span class="st">'good'</span>, <span class="st">'bad'</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the mean error</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    value <span class="ot">=</span> <span class="fu">mean</span>(y <span class="sc">-</span> predicted_class)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(value)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> misclassification_rate(par, X, y, class_threshold <span class="op">=</span> <span class="fl">.5</span>):</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add a column of 1s for the intercept</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.c_[np.ones(X.shape[<span class="dv">0</span>]), X]</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the 'linear predictor'</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> X <span class="op">@</span> par </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to a probability ('sigmoid' function)</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span>mu))</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to a class</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    predicted_class <span class="op">=</span> np.where(p <span class="op">&gt;</span> class_threshold, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the mean error</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    value <span class="op">=</span> np.mean(y <span class="op">-</span> predicted_class)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Note that our function first adds a step to convert the linear combination of features, the linear predictor (called <code>mu</code>), to a probability. Once we have a probability, we use some threshold to convert it to a ‘class’. In this case, we use 0.5 as the threshold, but this could be different depending on the context, something we talk more about elsewhere (<a href="understanding_models.html#sec-knowing-class-metrics" class="quarto-xref"><span>Section 4.2.2</span></a>). We’ll leave it as an exercise for you to play around with this function, as the next objective function is far more commonly used. But at least you can see how easy it can be to switch from a numeric target to the classification case.</p>
</section>
<section id="sec-estim-logloss" class="level3" data-number="6.9.2">
<h3 data-number="6.9.2" class="anchored" data-anchor-id="sec-estim-logloss"><span class="header-section-number">6.9.2</span> Log loss</h3>
<p>A very common objective function for classification is <strong>log loss</strong>, sometimes called logistic loss, or <strong>cross-entropy</strong><a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a>. For a binary target it is:</p>
<p><span id="eq-estim-logloss"><span class="math display">\[
\text{Value} = -\sum_{i=1}^{n} y_i \log(\hat{y_i}) + (1 - y_i) \log(1 - \hat{y_i})
\tag{6.3}\]</span></span></p>
<p>Where <span class="math inline">\(y_i\)</span> is the actual value of the target for observation <span class="math inline">\(i\)</span>, and <span class="math inline">\(\hat{y_i}\)</span> is the predicted value from the model (essentially a probability). It turns out that <em>this is the same as the log-likelihood used in a maximum likelihood approach for logistic regression</em>, made negative so we can minimize it.</p>
<p>We typically prefer this objective function to classification error because it results in a <em>smooth</em> optimization surface, like in the visualization we showed before for maximum likelihood (<a href="#sec-estim-likelihood-deeper" class="quarto-xref"><span>Section 6.7.1</span></a>), which means it is <em>differentiable</em> in a mathematical sense. This is important because it allows us to use optimization algorithms that rely on derivatives in updating the parameter estimates. You don’t really need to get into that too much, but just know that a smoother objective function is something we prefer. Here’s some code to try out.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>log_loss <span class="ot">=</span> <span class="cf">function</span>(par, X, y) {</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span>, X)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the predicted values on the raw scale</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    y_hat <span class="ot">=</span> X <span class="sc">%*%</span> par</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to a probability ('sigmoid' function)</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    y_hat <span class="ot">=</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>y_hat))</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># likelihood</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    ll <span class="ot">=</span> y <span class="sc">*</span> <span class="fu">log</span>(y_hat) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> y) <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> y_hat)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># alternative</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># dbinom(y, size = 1, prob = y_hat, log = TRUE)</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    value <span class="ot">=</span> <span class="sc">-</span><span class="fu">sum</span>(ll)</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(value)</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> log_loss(par, X, y):</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add a column of 1s for the intercept</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.c_[np.ones(X.shape[<span class="dv">0</span>]), X]</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the predicted values</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    y_hat <span class="op">=</span> X <span class="op">@</span> par</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to a probability ('sigmoid' function)</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    y_hat <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span>y_hat))</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># likelihood</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    ll <span class="op">=</span> y <span class="op">*</span> np.log(y_hat) <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> y) <span class="op">*</span> np.log(<span class="dv">1</span> <span class="op">-</span> y_hat)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    value <span class="op">=</span> <span class="op">-</span>np.<span class="bu">sum</span>(ll)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Let’s go ahead and demonstrate this. To create a classification problem, we’ll say that a country is ‘happy’ if the happiness score is greater than 5.5, and ‘unhappy’ otherwise. We’ll use the same features as before.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>df_happiness_bin <span class="ot">=</span> df_happiness <span class="sc">|&gt;</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">happiness =</span> <span class="fu">ifelse</span>(happiness <span class="sc">&gt;</span> <span class="fl">5.5</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>model_logloss <span class="ot">=</span> <span class="fu">optim</span>(</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">par =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">fn =</span> log_loss,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">X =</span> df_happiness_bin <span class="sc">|&gt;</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(life_exp_sc<span class="sc">:</span>gdp_pc_sc) <span class="sc">|&gt;</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.matrix</span>(),</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> df_happiness_bin<span class="sc">$</span>happiness</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>model_glm <span class="ot">=</span> <span class="fu">glm</span>(</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    happiness <span class="sc">~</span> life_exp_sc <span class="sc">+</span> corrupt_sc <span class="sc">+</span> gdp_pc_sc,</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">data   =</span> df_happiness_bin,</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> binomial</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>model_logloss<span class="sc">$</span>par</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df_happiness_bin <span class="op">=</span> df_happiness.copy()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>df_happiness_bin[<span class="st">'happiness'</span>] <span class="op">=</span> np.where(df_happiness[<span class="st">'happiness'</span>] <span class="op">&gt;</span> <span class="fl">5.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>model_logloss <span class="op">=</span> minimize(</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    log_loss,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    x0 <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]),</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    args <span class="op">=</span> (</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>        df_happiness_bin[[<span class="st">'life_exp_sc'</span>, <span class="st">'corrupt_sc'</span>, <span class="st">'gdp_pc_sc'</span>]],</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>        df_happiness_bin[<span class="st">'happiness'</span>]</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>model_glm <span class="op">=</span> smf.glm(</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'happiness ~ life_exp_sc + corrupt_sc + gdp_pc_sc'</span>,</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    data   <span class="op">=</span> df_happiness_bin,</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    family <span class="op">=</span> sm.families.Binomial()</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>).fit()</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>model_logloss[<span class="st">'x'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Once again, we can see that the results are very similar between our classification result and the built-in function.</p>
<div class="cell">
<div id="tbl-logloss" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-logloss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6.6: Comparison of Log-Loss Results
</figcaption>
<div aria-describedby="tbl-logloss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="rzfnlyjscu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#rzfnlyjscu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rzfnlyjscu thead, #rzfnlyjscu tbody, #rzfnlyjscu tfoot, #rzfnlyjscu tr, #rzfnlyjscu td, #rzfnlyjscu th {
  border-style: none;
}

#rzfnlyjscu p {
  margin: 0;
  padding: 0;
}

#rzfnlyjscu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rzfnlyjscu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rzfnlyjscu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rzfnlyjscu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rzfnlyjscu .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rzfnlyjscu .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rzfnlyjscu .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rzfnlyjscu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rzfnlyjscu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rzfnlyjscu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rzfnlyjscu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rzfnlyjscu .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rzfnlyjscu .gt_spanner_row {
  border-bottom-style: hidden;
}

#rzfnlyjscu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rzfnlyjscu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rzfnlyjscu .gt_from_md > :first-child {
  margin-top: 0;
}

#rzfnlyjscu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rzfnlyjscu .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rzfnlyjscu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rzfnlyjscu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rzfnlyjscu .gt_row_group_first td {
  border-top-width: 2px;
}

#rzfnlyjscu .gt_row_group_first th {
  border-top-width: 2px;
}

#rzfnlyjscu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rzfnlyjscu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rzfnlyjscu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rzfnlyjscu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rzfnlyjscu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rzfnlyjscu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rzfnlyjscu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rzfnlyjscu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rzfnlyjscu .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#rzfnlyjscu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rzfnlyjscu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rzfnlyjscu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rzfnlyjscu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rzfnlyjscu .gt_left {
  text-align: left;
}

#rzfnlyjscu .gt_center {
  text-align: center;
}

#rzfnlyjscu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rzfnlyjscu .gt_font_normal {
  font-weight: normal;
}

#rzfnlyjscu .gt_font_bold {
  font-weight: bold;
}

#rzfnlyjscu .gt_font_italic {
  font-style: italic;
}

#rzfnlyjscu .gt_super {
  font-size: 65%;
}

#rzfnlyjscu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rzfnlyjscu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rzfnlyjscu .gt_indent_1 {
  text-indent: 5px;
}

#rzfnlyjscu .gt_indent_2 {
  text-indent: 10px;
}

#rzfnlyjscu .gt_indent_3 {
  text-indent: 15px;
}

#rzfnlyjscu .gt_indent_4 {
  text-indent: 20px;
}

#rzfnlyjscu .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="parameter">parameter</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Standard">Standard</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Our result">Our result</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">LogLike</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">40.6635</td>
<td headers="Our result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">40.6635</td></tr>
    <tr><td headers="parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">intercept</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.1637</td>
<td headers="Our result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.1642</td></tr>
    <tr><td headers="parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">life_exp_sc</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">1.8172</td>
<td headers="Our result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">1.8168</td></tr>
    <tr><td headers="parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">corrupt_sc</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.4648</td>
<td headers="Our result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.4638</td></tr>
    <tr><td headers="parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">gdp_pc_sc</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">1.1311</td>
<td headers="Our result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">1.1307</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>So, when it comes to classification, you should feel confident in what’s going on under the hood, just like you did with a numeric target. Too much is made of the distinction between ‘regression’ and ‘classification’ and it can be confusing to those starting out. In reality, classification just requires a slightly different way of thinking about the target, not something fundamentally different about the modeling process.</p>
</section>
</section>
<section id="sec-estim-opt-algos" class="level2" data-number="6.10">
<h2 data-number="6.10" class="anchored" data-anchor-id="sec-estim-opt-algos"><span class="header-section-number">6.10</span> Optimization Algorithms</h2>
<p>When it comes to optimization, there are many algorithms that have been developed over time. The main thing to keep in mind is that these are all just different ways to find the best fitting parameters for a model. Some may be better suited for certain data tasks, or provide computational advantages, but usually the choice of algorithm is not as important as many other modeling choices you’ll have to make.</p>
<section id="sec-estim-opt-algos-common" class="level3" data-number="6.10.1">
<h3 data-number="6.10.1" class="anchored" data-anchor-id="sec-estim-opt-algos-common"><span class="header-section-number">6.10.1</span> Common Methods</h3>
<p>Here are some of the options available in R’s <code>optim</code> or scipy’s <code>minimize</code> function. In addition, they are commonly used behind the scenes in many modeling functions.</p>
<ul>
<li>Nelder-Mead</li>
<li>BFGS</li>
<li>L-BFGS-B (provides constraints)</li>
<li>Conjugate gradient</li>
<li>Simulated annealing</li>
<li>Newton’s method</li>
</ul>
<p>Other common optimization methods include:</p>
<ul>
<li>Genetic algorithms</li>
<li>Other Popular SGD extensions and variants
<ul>
<li>RMSProp</li>
<li>Adam/momentum</li>
<li>Adagrad</li>
</ul></li>
</ul>
<p>The main reason to choose one method over another usually is based on factors like speed, memory use, or how well they work for certain models. For statistical contexts, many functions for generalized linear models use Newton’s method by default, but more complicated models, for example, mixed models, may implement a different approach for better convergence. In machine learning, stochastic gradient descent is popular because it can be relatively efficient in large data settings and easy to implement.</p>
<p>In general, we can always try different methods to see which works best, but usually the results will be similar if the results reach convergence. We’ll now demonstrate one of more common methods to get a sense of how these work.</p>
</section>
<section id="sec-estim-opt-algos-gd" class="level3" data-number="6.10.2">
<h3 data-number="6.10.2" class="anchored" data-anchor-id="sec-estim-opt-algos-gd"><span class="header-section-number">6.10.2</span> Gradient descent</h3>
<p>One of the most popular approaches in optimization is called <strong>gradient descent</strong>. It uses the <a href="https://en.wikipedia.org/wiki/Gradient">gradient</a> of the function we’re trying to optimize to find the best parameters. We still use objective functions as before, and gradient descent is just a way to find that path along the objective function surface as we discussed previously in the deep dive (<a href="#sec-estim-likelihood-deeper" class="quarto-xref"><span>Section 6.7.1</span></a>).</p>
<p>More formally, the gradient is the vector of partial derivatives of the objective function with respect to each parameter. That may not mean much to you, but the basic idea is that the gradient provides a direction that points in the direction of steepest increase in the function. So if we want to maximize the objective function, we can take a step in the direction of the gradient, and if we want to minimize it, we can take a step in the opposite direction of the gradient (use the negative gradient).</p>
<p>The size of the ‘step’ is called the <strong>learning rate</strong>. Like the penalty parameter we saw with penalized regression, it is a <em>hyperparameter</em> that we can tune through cross-validation (<a href="machine_learning.html#sec-ml-tuning" class="quarto-xref"><span>Section 9.7</span></a>). If the learning rate is too small, it will take a longer time to converge. If it’s too large, we might overshoot the objective and miss the best parameters. There are a number of variations on gradient descent that have been developed over time. Let’s see this in action with the world happiness model.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>gradient_descent <span class="ot">=</span> <span class="cf">function</span>(</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    par,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    X,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    y,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">tolerance =</span> <span class="fl">1e-3</span>,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxit =</span> <span class="dv">1000</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">learning_rate =</span> <span class="fl">1e-3</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>) {</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span>, X) <span class="co"># add a column of 1s for the intercept</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">=</span> <span class="fu">nrow</span>(X)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># initialize</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    beta <span class="ot">=</span> par</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(beta) <span class="ot">=</span> <span class="fu">colnames</span>(X)</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>    mse <span class="ot">=</span> <span class="fu">crossprod</span>(X <span class="sc">%*%</span> beta <span class="sc">-</span> y) <span class="sc">/</span> N  <span class="co"># crossprod provides sum(x^2)</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>    tol <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>    iter <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> (tol <span class="sc">&gt;</span> tolerance <span class="sc">&amp;&amp;</span> iter <span class="sc">&lt;</span> maxit) {</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>        LP <span class="ot">=</span> X <span class="sc">%*%</span> beta</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>        grad <span class="ot">=</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> (LP <span class="sc">-</span> y)</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>        betaCurrent <span class="ot">=</span> beta <span class="sc">-</span> learning_rate <span class="sc">*</span> grad</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>        tol <span class="ot">=</span> <span class="fu">max</span>(<span class="fu">abs</span>(betaCurrent <span class="sc">-</span> beta))</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>        beta <span class="ot">=</span> betaCurrent</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>        mse <span class="ot">=</span> <span class="fu">append</span>(mse, <span class="fu">crossprod</span>(LP <span class="sc">-</span> y) <span class="sc">/</span> N)</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>        iter <span class="ot">=</span> iter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>    output <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">par    =</span> beta,</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">loss   =</span> mse,</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">MSE    =</span> <span class="fu">crossprod</span>(LP <span class="sc">-</span> y) <span class="sc">/</span> <span class="fu">nrow</span>(X),</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">iter   =</span> iter,</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">predictions =</span> LP</span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(output)</span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> df_happiness <span class="sc">|&gt;</span></span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(life_exp_sc<span class="sc">:</span>gdp_pc_sc) <span class="sc">|&gt;</span></span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.matrix</span>()</span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a>our_gd <span class="ot">=</span> <span class="fu">gradient_descent</span>(</span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">par =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">X =</span> X,</span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> df_happiness<span class="sc">$</span>happiness,</span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">learning_rate =</span> <span class="fl">1e-3</span></span>
<span id="cb37-50"><a href="#cb37-50" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gradient_descent(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    par, </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    X, </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    y, </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    tolerance <span class="op">=</span> <span class="fl">1e-3</span>, </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    maxit <span class="op">=</span> <span class="dv">1000</span>, </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    learning_rate <span class="op">=</span> <span class="fl">1e-3</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add a column of 1s for the intercept</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.c_[np.ones(X.shape[<span class="dv">0</span>]), X]</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># initialize</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>    beta <span class="op">=</span> par</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>    loss <span class="op">=</span> np.<span class="bu">sum</span>((X <span class="op">@</span> beta <span class="op">-</span> y)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    tol <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">iter</span> <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> (tol <span class="op">&gt;</span> tolerance <span class="kw">and</span> <span class="bu">iter</span> <span class="op">&lt;</span> maxit):</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>        LP <span class="op">=</span> X <span class="op">@</span> beta</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>        grad <span class="op">=</span> X.T <span class="op">@</span> (LP <span class="op">-</span> y)</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>        betaCurrent <span class="op">=</span> beta <span class="op">-</span> learning_rate <span class="op">*</span> grad</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>        tol <span class="op">=</span> np.<span class="bu">max</span>(np.<span class="bu">abs</span>(betaCurrent <span class="op">-</span> beta))</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>        beta <span class="op">=</span> betaCurrent</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>        loss <span class="op">=</span> np.append(loss, np.<span class="bu">sum</span>((LP <span class="op">-</span> y)<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>        <span class="bu">iter</span> <span class="op">=</span> <span class="bu">iter</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>    output <span class="op">=</span> {</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">'par'</span>: beta,</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">'loss'</span>: loss,</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">'MSE'</span>: np.mean((LP <span class="op">-</span> y)<span class="op">**</span><span class="dv">2</span>),</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">'iter'</span>: <span class="bu">iter</span>,</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>        <span class="st">'predictions'</span>: LP</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> output</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>our_gd <span class="op">=</span> gradient_descent(</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>    par <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]),</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> df_happiness[[<span class="st">'life_exp_sc'</span>, <span class="st">'corrupt_sc'</span>, <span class="st">'gdp_pc_sc'</span>]].to_numpy(),</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> df_happiness[<span class="st">'happiness'</span>].to_numpy(),</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>    learning_rate <span class="op">=</span> <span class="fl">1e-3</span></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Comparing our results, we have the following table. As usual, we see that the results are very similar to the standard linear regression approach. Once again, we have demystified a step in the modeling process!</p>
<div class="cell">
<div id="tbl-gradient-descent" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-gradient-descent-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6.7: Comparison of Gradient Descent Results
</figcaption>
<div aria-describedby="tbl-gradient-descent-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="xhflgeqohp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#xhflgeqohp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xhflgeqohp thead, #xhflgeqohp tbody, #xhflgeqohp tfoot, #xhflgeqohp tr, #xhflgeqohp td, #xhflgeqohp th {
  border-style: none;
}

#xhflgeqohp p {
  margin: 0;
  padding: 0;
}

#xhflgeqohp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xhflgeqohp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xhflgeqohp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xhflgeqohp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xhflgeqohp .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xhflgeqohp .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xhflgeqohp .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xhflgeqohp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xhflgeqohp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xhflgeqohp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xhflgeqohp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xhflgeqohp .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xhflgeqohp .gt_spanner_row {
  border-bottom-style: hidden;
}

#xhflgeqohp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xhflgeqohp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xhflgeqohp .gt_from_md > :first-child {
  margin-top: 0;
}

#xhflgeqohp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xhflgeqohp .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xhflgeqohp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xhflgeqohp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xhflgeqohp .gt_row_group_first td {
  border-top-width: 2px;
}

#xhflgeqohp .gt_row_group_first th {
  border-top-width: 2px;
}

#xhflgeqohp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xhflgeqohp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xhflgeqohp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xhflgeqohp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xhflgeqohp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xhflgeqohp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xhflgeqohp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xhflgeqohp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xhflgeqohp .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#xhflgeqohp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xhflgeqohp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xhflgeqohp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xhflgeqohp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xhflgeqohp .gt_left {
  text-align: left;
}

#xhflgeqohp .gt_center {
  text-align: center;
}

#xhflgeqohp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xhflgeqohp .gt_font_normal {
  font-weight: normal;
}

#xhflgeqohp .gt_font_bold {
  font-weight: bold;
}

#xhflgeqohp .gt_font_italic {
  font-style: italic;
}

#xhflgeqohp .gt_super {
  font-size: 65%;
}

#xhflgeqohp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xhflgeqohp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xhflgeqohp .gt_indent_1 {
  text-indent: 5px;
}

#xhflgeqohp .gt_indent_2 {
  text-indent: 10px;
}

#xhflgeqohp .gt_indent_3 {
  text-indent: 15px;
}

#xhflgeqohp .gt_indent_4 {
  text-indent: 20px;
}

#xhflgeqohp .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Value">Value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Standard">Standard</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Our Result">Our Result</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Value" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Intercept</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.445</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.437</td></tr>
    <tr><td headers="Value" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">life_exp_sc</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.525</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.521</td></tr>
    <tr><td headers="Value" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">corrupt_sc</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.105</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.107</td></tr>
    <tr><td headers="Value" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">gdp_pc_sc</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.438</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.439</td></tr>
    <tr><td headers="Value" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">MSE</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.367</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.367</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>In addition, when we visualize the loss function across iterations, we see a smooth decline in the MSE value as we go along each iteration. This is a good sign that we are converging to an optimal solution.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-r-gradient-descent" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-r-gradient-descent-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estimation_files/figure-html/fig-r-gradient-descent-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-r-gradient-descent-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.7: Loss with Gradient Descent
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-estim-opt-algos-sgd" class="level3" data-number="6.10.3">
<h3 data-number="6.10.3" class="anchored" data-anchor-id="sec-estim-opt-algos-sgd"><span class="header-section-number">6.10.3</span> Stochastic gradient descent</h3>
<p><strong>Stochastic gradient descent</strong> (SGD) is a version of gradient descent that uses a random sample of data to calculate the gradient, instead of using all the data. This makes it less accurate in some ways, but it’s faster, and can be parallelized across the CPU/GPU cores of the computing hardware environment. This speed is useful in machine learning when there’s a lot of data, which often makes the discrepancy of results between standard GD and SGD small. As such, you will see variants of it incorporated in many models in deep learning, but know that it can be used with much simpler models as well.</p>
<p>Let’s see this in action with the happiness model. The following is a conceptual version of the <em>AdaGrad</em> approach<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a>, which is a variation of SGD that adjusts the learning rate for each parameter. We will also add a variation that you can explore that averages the parameter estimates across iterations, which is a common approach to improve the performance of SGD.</p>
<p>We are going to use a <strong>batch size</strong> of one, which is similar to a ‘streaming’ or ‘online’ version where we update the model with each observation. Since our data are alphabetically ordered, we’ll shuffle the data first. We’ll also use a <code>stepsize_tau</code> parameter, which is a way to adjust the learning rate at early iterations. The values for the learning rate and <code>stepsize_tau</code> are arbitrary, selected after some initial playing around, but you can play with them to see how they affect the results.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>stochastic_gradient_descent <span class="ot">=</span> <span class="cf">function</span>(</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    par, <span class="co"># parameter estimates</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    X,   <span class="co"># model matrix</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    y,   <span class="co"># target variable</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">learning_rate =</span> <span class="dv">1</span>, <span class="co"># the learning rate</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">stepsize_tau =</span> <span class="dv">0</span>,   <span class="co"># if &gt; 0, a check on the LR at early iterations</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">123</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>) {</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># initialize</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(seed)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># shuffle the data</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    idx <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(X), <span class="fu">nrow</span>(X))</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">=</span> X[idx, ]</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">=</span> y[idx]</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span>, X)</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>    beta <span class="ot">=</span> par</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Collect all estimates</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    betamat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(X), <span class="at">ncol =</span> <span class="fu">length</span>(beta))</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Collect fitted values at each point))</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>    fits <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Collect loss at each point</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>    loss <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># adagrad per parameter learning rate adjustment</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>    s <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># a smoothing term to avoid division by zero</span></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>    eps <span class="ot">=</span> <span class="fl">1e-8</span></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(X)) {</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>        Xi <span class="ot">=</span> X[i, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>        yi <span class="ot">=</span> y[i]</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># matrix operations not necessary here,</span></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># but makes consistent with previous gd func</span></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>        LP <span class="ot">=</span> Xi <span class="sc">%*%</span> beta</span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>        grad <span class="ot">=</span> <span class="fu">t</span>(Xi) <span class="sc">%*%</span> (LP <span class="sc">-</span> yi)</span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>        s <span class="ot">=</span> s <span class="sc">+</span> grad<span class="sc">^</span><span class="dv">2</span>  <span class="co"># adagrad approach</span></span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># update</span></span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>        beta <span class="ot">=</span> beta <span class="sc">-</span> learning_rate <span class="sc">/</span> </span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>            (stepsize_tau <span class="sc">+</span> <span class="fu">sqrt</span>(s <span class="sc">+</span> eps)) <span class="sc">*</span> grad</span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>        betamat[i, ] <span class="ot">=</span> beta</span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>        fits[i] <span class="ot">=</span> LP</span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a>        loss[i] <span class="ot">=</span> <span class="fu">crossprod</span>(LP <span class="sc">-</span> yi)</span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a>    LP <span class="ot">=</span> X <span class="sc">%*%</span> beta</span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a>    lastloss <span class="ot">=</span> <span class="fu">crossprod</span>(LP <span class="sc">-</span> y)</span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a>    output <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">par =</span> beta,           <span class="co"># final estimates</span></span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">par_chain =</span> betamat,  <span class="co"># estimates at each iteration</span></span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">MSE =</span> <span class="fu">sum</span>(lastloss) <span class="sc">/</span> <span class="fu">nrow</span>(X),</span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">predictions =</span> LP</span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(output)</span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> df_happiness <span class="sc">|&gt;</span></span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(life_exp_sc, corrupt_sc, gdp_pc_sc) <span class="sc">|&gt;</span></span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.matrix</span>()</span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-73"><a href="#cb39-73" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> df_happiness<span class="sc">$</span>happiness</span>
<span id="cb39-74"><a href="#cb39-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-75"><a href="#cb39-75" aria-hidden="true" tabindex="-1"></a>our_sgd <span class="ot">=</span> <span class="fu">stochastic_gradient_descent</span>(</span>
<span id="cb39-76"><a href="#cb39-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">par =</span> <span class="fu">c</span>(<span class="fu">mean</span>(df_happiness<span class="sc">$</span>happiness), <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb39-77"><a href="#cb39-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">X =</span> X,</span>
<span id="cb39-78"><a href="#cb39-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> y,</span>
<span id="cb39-79"><a href="#cb39-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">learning_rate =</span> .<span class="dv">15</span>,</span>
<span id="cb39-80"><a href="#cb39-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">stepsize_tau =</span> .<span class="dv">1</span></span>
<span id="cb39-81"><a href="#cb39-81" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-82"><a href="#cb39-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-83"><a href="#cb39-83" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(our_sgd<span class="sc">$</span>par, our_sgd<span class="sc">$</span>MSE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> stochastic_gradient_descent(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    par, <span class="co"># parameter estimates</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    X,   <span class="co"># model matrix</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    y,   <span class="co"># target variable</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    learning_rate <span class="op">=</span> <span class="dv">1</span>, <span class="co"># the learning rate</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    stepsize_tau <span class="op">=</span> <span class="dv">0</span>,  <span class="co"># if &gt; 0, a check on the LR at early iterations</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    average <span class="op">=</span> <span class="va">False</span>    <span class="co"># a variation of the approach</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># initialize</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    np.random.seed(<span class="dv">1234</span>)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># shuffle the data</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    idx <span class="op">=</span> np.random.choice(</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>        df_happiness.shape[<span class="dv">0</span>], </span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>        df_happiness.shape[<span class="dv">0</span>], </span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>        replace <span class="op">=</span> <span class="va">False</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> X[idx, :]</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> y[idx]</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.c_[np.ones(X.shape[<span class="dv">0</span>]), X]</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>    beta <span class="op">=</span> par</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Collect all estimates</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>    betamat <span class="op">=</span> np.zeros((X.shape[<span class="dv">0</span>], beta.shape[<span class="dv">0</span>]))</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Collect fitted values at each point))</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>    fits <span class="op">=</span> np.zeros(X.shape[<span class="dv">0</span>])</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Collect loss at each point</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>    loss <span class="op">=</span> np.zeros(X.shape[<span class="dv">0</span>])</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># adagrad per parameter learning rate adjustment</span></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># a smoothing term to avoid division by zero</span></span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>    eps <span class="op">=</span> <span class="fl">1e-8</span></span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(X.shape[<span class="dv">0</span>]):</span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>        Xi <span class="op">=</span> X[<span class="va">None</span>, i, :]</span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>        yi <span class="op">=</span> y[i]</span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># matrix operations not necessary here,</span></span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># but makes consistent with previous gd func</span></span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>        LP <span class="op">=</span> Xi <span class="op">@</span> beta</span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>        grad <span class="op">=</span> Xi.T <span class="op">@</span> (LP <span class="op">-</span> yi)</span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> s <span class="op">+</span> grad<span class="op">**</span><span class="dv">2</span> <span class="co"># adagrad approach</span></span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># update</span></span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a>        beta <span class="op">=</span> beta <span class="op">-</span> learning_rate <span class="op">/</span> <span class="op">\</span></span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a>            (stepsize_tau <span class="op">+</span> np.sqrt(s <span class="op">+</span> eps)) <span class="op">*</span> grad</span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a>        betamat[i, :] <span class="op">=</span> beta</span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a>        fits[i] <span class="op">=</span> LP</span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a>        loss[i] <span class="op">=</span> np.<span class="bu">sum</span>((LP <span class="op">-</span> yi)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a>    LP <span class="op">=</span> X <span class="op">@</span> beta</span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a>    lastloss <span class="op">=</span> np.<span class="bu">sum</span>((LP <span class="op">-</span> y)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a>    output <span class="op">=</span> {</span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a>        <span class="st">'par'</span>: beta,          <span class="co"># final estimates</span></span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a>        <span class="st">'par_chain'</span>: betamat, <span class="co"># estimates at each iteration</span></span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a>        <span class="st">'MSE'</span>: lastloss <span class="op">/</span> X.shape[<span class="dv">0</span>],</span>
<span id="cb40-65"><a href="#cb40-65" aria-hidden="true" tabindex="-1"></a>        <span class="st">'predictions'</span>: LP</span>
<span id="cb40-66"><a href="#cb40-66" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb40-67"><a href="#cb40-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-68"><a href="#cb40-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> output</span>
<span id="cb40-69"><a href="#cb40-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-70"><a href="#cb40-70" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df_happiness[[<span class="st">'life_exp_sc'</span>, <span class="st">'corrupt_sc'</span>, <span class="st">'gdp_pc_sc'</span>]].to_numpy()</span>
<span id="cb40-71"><a href="#cb40-71" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df_happiness[<span class="st">'happiness'</span>].to_numpy()</span>
<span id="cb40-72"><a href="#cb40-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-73"><a href="#cb40-73" aria-hidden="true" tabindex="-1"></a>our_sgd <span class="op">=</span> stochastic_gradient_descent(</span>
<span id="cb40-74"><a href="#cb40-74" aria-hidden="true" tabindex="-1"></a>    par <span class="op">=</span> np.array([np.mean(df_happiness[<span class="st">'happiness'</span>]), <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]),</span>
<span id="cb40-75"><a href="#cb40-75" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> X,</span>
<span id="cb40-76"><a href="#cb40-76" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> y,</span>
<span id="cb40-77"><a href="#cb40-77" aria-hidden="true" tabindex="-1"></a>    learning_rate <span class="op">=</span> <span class="fl">.15</span>,</span>
<span id="cb40-78"><a href="#cb40-78" aria-hidden="true" tabindex="-1"></a>    stepsize_tau <span class="op">=</span> <span class="fl">.1</span></span>
<span id="cb40-79"><a href="#cb40-79" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-80"><a href="#cb40-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-81"><a href="#cb40-81" aria-hidden="true" tabindex="-1"></a>our_sgd[<span class="st">'par'</span>], our_sgd[<span class="st">'MSE'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Next we’ll compare it to OLS estimates and our previous ‘batch’ gradient descent results. Even though SGD normally would not be used for such a small dataset, we at least get close<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a>!</p>
<div class="cell">
<div id="tbl-stochastic-gradient-descent" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-stochastic-gradient-descent-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6.8: Comparison of Stochastic Gradient Descent Results
</figcaption>
<div aria-describedby="tbl-stochastic-gradient-descent-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="owzfngjefp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#owzfngjefp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#owzfngjefp thead, #owzfngjefp tbody, #owzfngjefp tfoot, #owzfngjefp tr, #owzfngjefp td, #owzfngjefp th {
  border-style: none;
}

#owzfngjefp p {
  margin: 0;
  padding: 0;
}

#owzfngjefp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#owzfngjefp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#owzfngjefp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#owzfngjefp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#owzfngjefp .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#owzfngjefp .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#owzfngjefp .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#owzfngjefp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#owzfngjefp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#owzfngjefp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#owzfngjefp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#owzfngjefp .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#owzfngjefp .gt_spanner_row {
  border-bottom-style: hidden;
}

#owzfngjefp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#owzfngjefp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#owzfngjefp .gt_from_md > :first-child {
  margin-top: 0;
}

#owzfngjefp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#owzfngjefp .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#owzfngjefp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#owzfngjefp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#owzfngjefp .gt_row_group_first td {
  border-top-width: 2px;
}

#owzfngjefp .gt_row_group_first th {
  border-top-width: 2px;
}

#owzfngjefp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#owzfngjefp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#owzfngjefp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#owzfngjefp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#owzfngjefp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#owzfngjefp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#owzfngjefp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#owzfngjefp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#owzfngjefp .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#owzfngjefp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#owzfngjefp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#owzfngjefp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#owzfngjefp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#owzfngjefp .gt_left {
  text-align: left;
}

#owzfngjefp .gt_center {
  text-align: center;
}

#owzfngjefp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#owzfngjefp .gt_font_normal {
  font-weight: normal;
}

#owzfngjefp .gt_font_bold {
  font-weight: bold;
}

#owzfngjefp .gt_font_italic {
  font-style: italic;
}

#owzfngjefp .gt_super {
  font-size: 65%;
}

#owzfngjefp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#owzfngjefp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#owzfngjefp .gt_indent_1 {
  text-indent: 5px;
}

#owzfngjefp .gt_indent_2 {
  text-indent: 10px;
}

#owzfngjefp .gt_indent_3 {
  text-indent: 15px;
}

#owzfngjefp .gt_indent_4 {
  text-indent: 20px;
}

#owzfngjefp .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Value">Value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Standard">Standard</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Our Result">Our Result</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Batch SGD">Batch SGD</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Value" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Intercept</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.445</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.469</td>
<td headers="Batch SGD" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.437</td></tr>
    <tr><td headers="Value" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">life_exp_sc</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.525</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.514</td>
<td headers="Batch SGD" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.521</td></tr>
    <tr><td headers="Value" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">corrupt_sc</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.105</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.111</td>
<td headers="Batch SGD" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.107</td></tr>
    <tr><td headers="Value" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">gdp_pc_sc</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.438</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.390</td>
<td headers="Batch SGD" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.439</td></tr>
    <tr><td headers="Value" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">MSE</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.367</td>
<td headers="Our Result" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.370</td>
<td headers="Batch SGD" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.367</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>Here’s a plot of the estimates as they moved along the data. For this plot we don’t include the intercept as it’s on a notably different scale. We can see that the estimates are moving around a bit, but they appear to be converging to a solution.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-r-stochastic-gradient-descent" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-r-stochastic-gradient-descent-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estimation_files/figure-html/fig-r-stochastic-gradient-descent-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-r-stochastic-gradient-descent-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.8: Stochastic Gradient Descent Path
</figcaption>
</figure>
</div>
</div>
</div>
<!-- ![Stochastic Gradient Descent Path](img/sgd.gif) -->
<p>To wrap things up, here are the results for the happiness model using different optimization algorithms, with a comparison to the standard linear regression model function. We can see that the results are very similar, and for simpler modeling endeavors they should converge on the same result.</p>
<div class="cell">
<div id="tbl-optim-compare" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-optim-compare-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6.9: Comparison of Optimization Results
</figcaption>
<div aria-describedby="tbl-optim-compare-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="xuwkdlnsyg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#xuwkdlnsyg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xuwkdlnsyg thead, #xuwkdlnsyg tbody, #xuwkdlnsyg tfoot, #xuwkdlnsyg tr, #xuwkdlnsyg td, #xuwkdlnsyg th {
  border-style: none;
}

#xuwkdlnsyg p {
  margin: 0;
  padding: 0;
}

#xuwkdlnsyg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xuwkdlnsyg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xuwkdlnsyg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xuwkdlnsyg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xuwkdlnsyg .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xuwkdlnsyg .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xuwkdlnsyg .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xuwkdlnsyg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xuwkdlnsyg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xuwkdlnsyg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xuwkdlnsyg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xuwkdlnsyg .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xuwkdlnsyg .gt_spanner_row {
  border-bottom-style: hidden;
}

#xuwkdlnsyg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xuwkdlnsyg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xuwkdlnsyg .gt_from_md > :first-child {
  margin-top: 0;
}

#xuwkdlnsyg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xuwkdlnsyg .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xuwkdlnsyg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xuwkdlnsyg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xuwkdlnsyg .gt_row_group_first td {
  border-top-width: 2px;
}

#xuwkdlnsyg .gt_row_group_first th {
  border-top-width: 2px;
}

#xuwkdlnsyg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xuwkdlnsyg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xuwkdlnsyg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xuwkdlnsyg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xuwkdlnsyg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xuwkdlnsyg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xuwkdlnsyg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xuwkdlnsyg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xuwkdlnsyg .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#xuwkdlnsyg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xuwkdlnsyg .gt_footnote {
  margin: 0px;
  font-size: 10px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xuwkdlnsyg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xuwkdlnsyg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xuwkdlnsyg .gt_left {
  text-align: left;
}

#xuwkdlnsyg .gt_center {
  text-align: center;
}

#xuwkdlnsyg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xuwkdlnsyg .gt_font_normal {
  font-weight: normal;
}

#xuwkdlnsyg .gt_font_bold {
  font-weight: bold;
}

#xuwkdlnsyg .gt_font_italic {
  font-style: italic;
}

#xuwkdlnsyg .gt_super {
  font-size: 65%;
}

#xuwkdlnsyg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xuwkdlnsyg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xuwkdlnsyg .gt_indent_1 {
  text-indent: 5px;
}

#xuwkdlnsyg .gt_indent_2 {
  text-indent: 10px;
}

#xuwkdlnsyg .gt_indent_3 {
  text-indent: 15px;
}

#xuwkdlnsyg .gt_indent_4 {
  text-indent: 20px;
}

#xuwkdlnsyg .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="parameter">parameter</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="NM<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>">NM<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="BFGS<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>2</sup></span>">BFGS<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="CG<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>3</sup></span>">CG<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>3</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="GD<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>4</sup></span>">GD<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>4</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Standard<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>5</sup></span>">Standard<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>5</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Intercept</td>
<td headers="NM" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.445</td>
<td headers="BFGS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.445</td>
<td headers="CG" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.445</td>
<td headers="GD" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.437</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.445</td></tr>
    <tr><td headers="parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">life_exp_sc</td>
<td headers="NM" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.525</td>
<td headers="BFGS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.525</td>
<td headers="CG" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.525</td>
<td headers="GD" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.521</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.525</td></tr>
    <tr><td headers="parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">gdp_pc_sc</td>
<td headers="NM" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.105</td>
<td headers="BFGS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.105</td>
<td headers="CG" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.105</td>
<td headers="GD" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.107</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.105</td></tr>
    <tr><td headers="parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">corrupt_sc</td>
<td headers="NM" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.437</td>
<td headers="BFGS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.438</td>
<td headers="CG" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.438</td>
<td headers="GD" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.439</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.438</td></tr>
    <tr><td headers="parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">MSE</td>
<td headers="NM" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.367</td>
<td headers="BFGS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.367</td>
<td headers="CG" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.367</td>
<td headers="GD" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.367</td>
<td headers="Standard" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.367</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="6"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> NM = Nelder-Mead</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="6"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>2</sup></span> BFGS = Broyden–Fletcher–Goldfarb–Shanno</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="6"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>3</sup></span> CG = Conjugate gradient</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="6"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>4</sup></span> GD = Our gradient descent function</td>
    </tr>
    <tr>
      <td class="gt_footnote" colspan="6"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>5</sup></span> Standard = Standard package function</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>Before leaving our estimation discussion, we should mention there are other approaches one could use to estimate model parameters, including variations on least squares, the <strong>method of moments</strong>, <strong>generalized estimating equations</strong>, <strong>robust</strong> estimation, and more. We’ve focused on the most common ones generally, but it’s good to be aware of others that might be more popular in some domains.</p>
</section>
</section>
<section id="sec-estim-other" class="level2" data-number="6.11">
<h2 data-number="6.11" class="anchored" data-anchor-id="sec-estim-other"><span class="header-section-number">6.11</span> Estimating Uncertainty</h2>
<p>Our focus thus far has been on estimating the best parameters for a model. But we also want to know how certain we are about those estimates. There are different ways to estimate <strong>uncertainty</strong>, and understanding the uncertainty in our results helps us make better decisions from our model. We’ll briefly cover a few approaches here, but realize we are but merely scratching the surface on these approaches. There are whole books, and even philosophies, dedicated to the topic of uncertainty estimation.</p>
<section id="sec-estim-frequentist" class="level3" data-number="6.11.1">
<h3 data-number="6.11.1" class="anchored" data-anchor-id="sec-estim-frequentist"><span class="header-section-number">6.11.1</span> Standard Frequentist</h3>
<p>We talked a bit about the frequentist approach in our discussion of confidence intervals (<a href="linear_models.html#sec-lm-interpretation-feature" class="quarto-xref"><span>Section 3.4.1</span></a>). There we described the process using the interval to <em>capture</em> the ‘true’ parameter value a certain percentage of the time. The key assumption is that the true parameter is fixed, and the interval is a random variable that will contain the true value with some percentage frequency. With this approach, if you were to repeat the experiment, i.e.&nbsp;data collection and analysis, many times, each interval would be slightly different. Although they would be different, any one of the intervals is as good or valid as the others. You also know that a certain percentage of them will contain the true value, and a (usually small) percentage will not. You will never know if a specific interval does actually capture the true value, because we don’t know the true value in practice.</p>
<p>This is a common approach in traditional statistical analysis, and so it’s used in many modeling contexts. If no particular estimation approach is specified, the default is usually a frequentist one. The approach not only provides confidence intervals for the parameters, but we can also get them for predictions, which is typically also a goal.</p>
<p>Here is an example using our previous model to get interval estimates for predictions. Here we get so-called ‘confidence’ or ‘prediction’ intervals. Both are confidence intervals in the frequentist sense, just for different purposes. The confidence interval is for the average prediction, while the prediction interval is for a future observation. The prediction interval is always wider because it includes the uncertainty in the model parameters as well as the uncertainty in the prediction itself.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">=</span> <span class="fu">lm</span>(happiness <span class="sc">~</span> life_exp_sc <span class="sc">+</span> corrupt_sc <span class="sc">+</span> gdp_pc_sc, <span class="at">data =</span> df_happiness)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(model)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(model, <span class="at">interval =</span> <span class="st">'confidence'</span>)  <span class="co"># for an average prediction</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(model, <span class="at">interval =</span> <span class="st">'prediction'</span>)  <span class="co"># for a future observation (always wider)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> smf.ols(</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'happiness ~ life_exp_sc + corrupt_sc + gdp_pc_sc'</span>,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> df_happiness</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>).fit()</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>model.conf_int()</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>model.get_prediction().summary_frame() <span class="co"># both 'confidence' and 'prediction' intervals</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>These interval estimates for parameters and predictions are actually not easy to get right for more complicated models beyond generalized linear models. Given this, one should be cautious when moving beyond standard linear models. The next two approaches we’ll discuss are often used within the frequentist framework to estimate uncertainty in more complex models.</p>
</section>
<section id="monte-carlo" class="level3" data-number="6.11.2">
<h3 data-number="6.11.2" class="anchored" data-anchor-id="monte-carlo"><span class="header-section-number">6.11.2</span> Monte Carlo</h3>
<p>Monte Carlo methods derive their name from the famous casino in Monaco<a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a>. The idea is to use random sampling to estimate a value. With statistical models, we can use Monte Carlo methods to estimate uncertainty in our model parameters and predictions. The general idea is as follows:</p>
<ol type="1">
<li><strong>Estimate the model parameters</strong> using the data and their range of possible values (e.g.&nbsp;based on a probability distribution).</li>
<li><strong>Simulate new data</strong> from the model using the estimated parameters and assumed probability distributions for those parameters.</li>
<li><strong>Estimate the metrics of interest</strong> using the simulated data.</li>
<li><strong>Repeat</strong> many times.</li>
</ol>
<p>The result is a distribution of the value of interest, be it a parameter, a prediction, or maybe an evaluation metric like RMSE. This distribution can then be used to provide a sense of uncertainty in the value, such as an interval estimate. We can use Monte Carlo methods to estimate the uncertainty in predictions for our happiness model as follows.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we'll use the model from the previous section</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">=</span> <span class="fu">lm</span>(happiness <span class="sc">~</span> life_exp_sc <span class="sc">+</span> corrupt_sc <span class="sc">+</span> gdp_pc_sc, <span class="at">data =</span> df_happiness)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># number of simulations</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>mc_predictions <span class="ot">=</span> <span class="cf">function</span>(</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    model,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">nsim =</span> <span class="dv">2500</span>,</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">42</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>) {</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(seed)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    params_est <span class="ot">=</span> <span class="fu">coef</span>(model)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>    params <span class="ot">=</span> mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">n =</span> nsim,</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean =</span> params_est,</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">sigma =</span> <span class="fu">vcov</span>(model)</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>    sigma <span class="ot">=</span> <span class="fu">summary</span>(model)<span class="sc">$</span>sigma</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">=</span> <span class="fu">model.matrix</span>(model)</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>    y_hat <span class="ot">=</span> X <span class="sc">%*%</span> <span class="fu">t</span>(params) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">nrow</span>(X) <span class="sc">*</span> nsim, <span class="at">sd =</span> sigma)</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>    pred_int <span class="ot">=</span> <span class="fu">apply</span>(y_hat, <span class="dv">1</span>, quantile, <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">975</span>))</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(pred_int)</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>our_mc <span class="ot">=</span> <span class="fu">mc_predictions</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we'll use the model from the previous section</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> smf.ols(</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'happiness ~ life_exp_sc + corrupt_sc + gdp_pc_sc'</span>,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> df_happiness</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>).fit()</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mc_predictions(model, nsim<span class="op">=</span><span class="dv">2500</span>, seed<span class="op">=</span><span class="dv">42</span>):</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    np.random.seed(seed)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    params_est <span class="op">=</span> model.params</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    params <span class="op">=</span> np.random.multivariate_normal(</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>        mean <span class="op">=</span> params_est,</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>        cov <span class="op">=</span> model.cov_params(),</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>        size <span class="op">=</span> nsim</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>    sigma <span class="op">=</span> model.mse_resid<span class="op">**</span><span class="fl">.5</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> model.model.exog</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>    y_hat <span class="op">=</span> X <span class="op">@</span> params.T <span class="op">+</span> np.random.normal(scale <span class="op">=</span> sigma, size <span class="op">=</span> (X.shape[<span class="dv">0</span>], nsim))</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>    pred_int <span class="op">=</span> np.quantile(y_hat, q <span class="op">=</span> [<span class="fl">.025</span>, <span class="fl">.975</span>], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pred_int</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>our_mc <span class="op">=</span> mc_predictions(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Here are the results of the Monte Carlo simulation for the prediction intervals. They are pretty close to what we’d already have available from the model package used for linear regression. However, we can use this for other models where uncertainty estimates are not readily available, can help us estimate values and intervals in a general way.</p>
<div class="cell">
<div id="tbl-monte-carlo" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-monte-carlo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6.10: Monte Carlo Prediction Intervals
</figcaption>
<div aria-describedby="tbl-monte-carlo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="coqyckhhoz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#coqyckhhoz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#coqyckhhoz thead, #coqyckhhoz tbody, #coqyckhhoz tfoot, #coqyckhhoz tr, #coqyckhhoz td, #coqyckhhoz th {
  border-style: none;
}

#coqyckhhoz p {
  margin: 0;
  padding: 0;
}

#coqyckhhoz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#coqyckhhoz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#coqyckhhoz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#coqyckhhoz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#coqyckhhoz .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#coqyckhhoz .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#coqyckhhoz .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#coqyckhhoz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#coqyckhhoz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#coqyckhhoz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#coqyckhhoz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#coqyckhhoz .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#coqyckhhoz .gt_spanner_row {
  border-bottom-style: hidden;
}

#coqyckhhoz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#coqyckhhoz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#coqyckhhoz .gt_from_md > :first-child {
  margin-top: 0;
}

#coqyckhhoz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#coqyckhhoz .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#coqyckhhoz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#coqyckhhoz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#coqyckhhoz .gt_row_group_first td {
  border-top-width: 2px;
}

#coqyckhhoz .gt_row_group_first th {
  border-top-width: 2px;
}

#coqyckhhoz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#coqyckhhoz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#coqyckhhoz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#coqyckhhoz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#coqyckhhoz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#coqyckhhoz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#coqyckhhoz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#coqyckhhoz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#coqyckhhoz .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#coqyckhhoz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#coqyckhhoz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#coqyckhhoz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#coqyckhhoz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#coqyckhhoz .gt_left {
  text-align: left;
}

#coqyckhhoz .gt_center {
  text-align: center;
}

#coqyckhhoz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#coqyckhhoz .gt_font_normal {
  font-weight: normal;
}

#coqyckhhoz .gt_font_bold {
  font-weight: bold;
}

#coqyckhhoz .gt_font_italic {
  font-style: italic;
}

#coqyckhhoz .gt_super {
  font-size: 65%;
}

#coqyckhhoz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#coqyckhhoz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#coqyckhhoz .gt_indent_1 {
  text-indent: 5px;
}

#coqyckhhoz .gt_indent_2 {
  text-indent: 10px;
}

#coqyckhhoz .gt_indent_3 {
  text-indent: 15px;
}

#coqyckhhoz .gt_indent_4 {
  text-indent: 20px;
}

#coqyckhhoz .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="observed_value">observed_value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="prediction">prediction</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="lower">lower</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="upper">upper</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="lower_lm">lower_lm</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="upper_lm">upper_lm</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="observed_value" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">3.63</td>
<td headers="prediction" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">3.99</td>
<td headers="lower" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">2.78</td>
<td headers="upper" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.19</td>
<td headers="lower_lm" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">2.74</td>
<td headers="upper_lm" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.24</td></tr>
    <tr><td headers="observed_value" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">4.59</td>
<td headers="prediction" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.50</td>
<td headers="lower" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">4.32</td>
<td headers="upper" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">6.73</td>
<td headers="lower_lm" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">4.26</td>
<td headers="upper_lm" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">6.74</td></tr>
    <tr><td headers="observed_value" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">6.39</td>
<td headers="prediction" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.68</td>
<td headers="lower" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">4.43</td>
<td headers="upper" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">6.84</td>
<td headers="lower_lm" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">4.44</td>
<td headers="upper_lm" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">6.91</td></tr>
    <tr><td headers="observed_value" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">4.32</td>
<td headers="prediction" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.41</td>
<td headers="lower" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">4.21</td>
<td headers="upper" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">6.67</td>
<td headers="lower_lm" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">4.17</td>
<td headers="upper_lm" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">6.65</td></tr>
    <tr><td headers="observed_value" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">7.27</td>
<td headers="prediction" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">6.97</td>
<td headers="lower" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.71</td>
<td headers="upper" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">8.19</td>
<td headers="lower_lm" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.72</td>
<td headers="upper_lm" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">8.21</td></tr>
    <tr><td headers="observed_value" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">7.14</td>
<td headers="prediction" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">6.88</td>
<td headers="lower" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.63</td>
<td headers="upper" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">8.13</td>
<td headers="lower_lm" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.64</td>
<td headers="upper_lm" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">8.12</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="6"> Results based on the R simulation</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>Monte Carlo simulation is a very popular approach in modeling, and a variant of it, markov chain monte carlo (MCMC), is the basis for Bayesian estimation, which we’ll also talk about in more detail later.</p>
</section>
<section id="sec-estim-bootstrap" class="level3" data-number="6.11.3">
<h3 data-number="6.11.3" class="anchored" data-anchor-id="sec-estim-bootstrap"><span class="header-section-number">6.11.3</span> Bootstrap</h3>
<p>An extremely common method for estimating uncertainty is the <strong>bootstrap</strong>. The bootstrap is a method where we create new datasets by randomly sampling the original data with replacement. This means that each new dataset is the same size as the original, but some observations may be selected multiple times while others may not be selected at all. We then estimate our model with each data set, and each time, we can collect parameter estimates, predictions, or any other calculations we are interested in. Ultimately, we end up with a <em>distribution</em> of all the things we calculated. The nice thing about this we don’t need to know the specific distribution (e.g., normal, or t-distribution) of the values we want to get uncertainty estimates for, we can just use the data we have to produce that distribution. And this is a key distinction from the Monte Carlo method just discussed.</p>
<p>The results of bootstrapping give us a range of possible values, which is useful for inference<a href="#fn16" class="footnote-ref" id="fnref16" role="doc-noteref"><sup>16</sup></a>, as we can use the distribution to calculate interval estimates. The average parameter estimate is typically the same as whatever the underlying model used would produce, so not really useful for that in the context of simpler linear models. Even so, we can calculate derivatives of the parameters, like say a ratio or sum, or a model metric like R<sup>2</sup>, or a prediction. Some of these normally would not be estimated as part of the model, or maybe the model tool does not provide anything beyond the value itself. Yet the bootstrap provides a way to get at a measure of uncertainty for the values of interest, with fewer assumptions about how that distribution should take shape.</p>
<p>The approach bootstrap very flexible, and it can potentially be used with any model whether in a statistical or machine learning context. Let’s see this in action with the happiness model. We’ll create a bootstrap function, then use it to estimate the uncertainty in the coefficients for the happiness model.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>bootstrap <span class="ot">=</span> <span class="cf">function</span>(X, y, <span class="at">nboot =</span> <span class="dv">100</span>, <span class="at">seed =</span> <span class="dv">123</span>) {</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">=</span> <span class="fu">nrow</span>(X)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">=</span> <span class="fu">ncol</span>(X) <span class="sc">+</span> <span class="dv">1</span> <span class="co"># add one for intercept</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># initialize</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    beta <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, p<span class="sc">*</span>nboot, <span class="at">nrow =</span> nboot, <span class="at">ncol =</span> p)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(beta) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'Intercept'</span>, <span class="fu">colnames</span>(X))</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    mse <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nboot)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># set seed</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(seed)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nboot) {</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sample with replacement</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>        idx <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N, N, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>        Xi <span class="ot">=</span> X[idx,]</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>        yi <span class="ot">=</span> y[idx]</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># estimate model</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>        mod <span class="ot">=</span> <span class="fu">lm</span>(yi <span class="sc">~</span>., <span class="at">data =</span> Xi)</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># save results</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>        beta[i, ] <span class="ot">=</span> <span class="fu">coef</span>(mod)</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>        mse[i] <span class="ot">=</span> <span class="fu">sum</span>((mod<span class="sc">$</span>fitted <span class="sc">-</span> yi)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> N</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># given mean estimates, calculate MSE</span></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>    y_hat <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span>, <span class="fu">as.matrix</span>(X)) <span class="sc">%*%</span> <span class="fu">colMeans</span>(beta)</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>    final_mse <span class="ot">=</span> <span class="fu">sum</span>((y <span class="sc">-</span> y_hat)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> N</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>    output <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">par =</span> <span class="fu">as_tibble</span>(beta),</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">MSE =</span> mse,</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">final_mse =</span> final_mse</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(output)</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> df_happiness <span class="sc">|&gt;</span></span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(life_exp_sc<span class="sc">:</span>gdp_pc_sc)</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> df_happiness<span class="sc">$</span>happiness</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>our_boot <span class="ot">=</span> <span class="fu">bootstrap</span>(</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">X =</span> X,</span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> y,</span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">nboot =</span> <span class="dv">1000</span></span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bootstrap(X, y, nboot<span class="op">=</span><span class="dv">100</span>, seed<span class="op">=</span><span class="dv">123</span>):</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add a column of 1s for the intercept</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.c_[np.ones(X.shape[<span class="dv">0</span>]), X]</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> X.shape[<span class="dv">0</span>]</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># initialize</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    beta <span class="op">=</span> np.empty((nboot, X.shape[<span class="dv">1</span>]))</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># beta = pd.DataFrame(beta, columns=['Intercept'] + list(cn))</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>    mse <span class="op">=</span> np.empty(nboot)    </span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># set seed</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>    np.random.seed(seed)</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(nboot):</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sample with replacement</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>        idx <span class="op">=</span> np.random.randint(<span class="dv">0</span>, N, N)</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>        Xi <span class="op">=</span> X[idx, :]</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>        yi <span class="op">=</span> y[idx]</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># estimate model</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> LinearRegression(fit_intercept<span class="op">=</span><span class="va">False</span>) <span class="co"># from sklearn</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>        mod <span class="op">=</span> model.fit(Xi, yi)</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># save results</span></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>        beta[i, :] <span class="op">=</span> mod.coef_</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>        mse[i] <span class="op">=</span> np.<span class="bu">sum</span>((mod.predict(Xi) <span class="op">-</span> yi)<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> N</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># given mean estimates, calculate MSE</span></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>    y_hat <span class="op">=</span> X <span class="op">@</span> beta.mean(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>    final_mse <span class="op">=</span> np.<span class="bu">sum</span>((y <span class="op">-</span> y_hat)<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> N</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>    output <span class="op">=</span> {</span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">'par'</span>: beta,</span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>        <span class="st">'mse'</span>: mse,</span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">'final_mse'</span>: final_mse</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> output</span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>our_boot <span class="op">=</span> bootstrap(</span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> df_happiness[[<span class="st">'life_exp_sc'</span>, <span class="st">'corrupt_sc'</span>, <span class="st">'gdp_pc_sc'</span>]],</span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> df_happiness[<span class="st">'happiness'</span>],</span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>    nboot <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>Here are the results of the interval estimates for the coefficients. Each parameter has the mean estimate, the lower and upper bounds of the 95% confidence interval, and the width of the interval. The bootstrap intervals are a bit wider than the OLS intervals, but for this model these should converge as the number of observations increases.</p>
<div class="cell">
<div id="tbl-bootstrap" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-bootstrap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6.11: Bootstrap Parameter Estimates
</figcaption>
<div aria-describedby="tbl-bootstrap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="tcqdnsahsb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#tcqdnsahsb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tcqdnsahsb thead, #tcqdnsahsb tbody, #tcqdnsahsb tfoot, #tcqdnsahsb tr, #tcqdnsahsb td, #tcqdnsahsb th {
  border-style: none;
}

#tcqdnsahsb p {
  margin: 0;
  padding: 0;
}

#tcqdnsahsb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tcqdnsahsb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tcqdnsahsb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tcqdnsahsb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tcqdnsahsb .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tcqdnsahsb .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tcqdnsahsb .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tcqdnsahsb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tcqdnsahsb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tcqdnsahsb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tcqdnsahsb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tcqdnsahsb .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tcqdnsahsb .gt_spanner_row {
  border-bottom-style: hidden;
}

#tcqdnsahsb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tcqdnsahsb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tcqdnsahsb .gt_from_md > :first-child {
  margin-top: 0;
}

#tcqdnsahsb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tcqdnsahsb .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tcqdnsahsb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tcqdnsahsb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tcqdnsahsb .gt_row_group_first td {
  border-top-width: 2px;
}

#tcqdnsahsb .gt_row_group_first th {
  border-top-width: 2px;
}

#tcqdnsahsb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tcqdnsahsb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tcqdnsahsb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tcqdnsahsb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tcqdnsahsb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tcqdnsahsb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tcqdnsahsb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tcqdnsahsb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tcqdnsahsb .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#tcqdnsahsb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tcqdnsahsb .gt_footnote {
  margin: 0px;
  font-size: 10px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tcqdnsahsb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tcqdnsahsb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tcqdnsahsb .gt_left {
  text-align: left;
}

#tcqdnsahsb .gt_center {
  text-align: center;
}

#tcqdnsahsb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tcqdnsahsb .gt_font_normal {
  font-weight: normal;
}

#tcqdnsahsb .gt_font_bold {
  font-weight: bold;
}

#tcqdnsahsb .gt_font_italic {
  font-style: italic;
}

#tcqdnsahsb .gt_super {
  font-size: 65%;
}

#tcqdnsahsb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tcqdnsahsb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tcqdnsahsb .gt_indent_1 {
  text-indent: 5px;
}

#tcqdnsahsb .gt_indent_2 {
  text-indent: 10px;
}

#tcqdnsahsb .gt_indent_3 {
  text-indent: 15px;
}

#tcqdnsahsb .gt_indent_4 {
  text-indent: 20px;
}

#tcqdnsahsb .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Parameter">Parameter</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="mean">mean</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Lower BS">Lower BS</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Upper BS">Upper BS</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Lower OLS">Lower OLS</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Upper OLS">Upper OLS</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Diff Width<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>">Diff Width<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">Intercept</td>
<td headers="mean" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.45</td>
<td headers="Lower BS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.34</td>
<td headers="Upper BS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.55</td>
<td headers="Lower OLS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.33</td>
<td headers="Upper OLS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">5.56</td>
<td headers="Diff Width" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.01</td></tr>
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">life_exp_sc</td>
<td headers="mean" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.52</td>
<td headers="Lower BS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.30</td>
<td headers="Upper BS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.74</td>
<td headers="Lower OLS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.35</td>
<td headers="Upper OLS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.70</td>
<td headers="Diff Width" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.09</td></tr>
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">corrupt_sc</td>
<td headers="mean" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.11</td>
<td headers="Lower BS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.30</td>
<td headers="Upper BS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.08</td>
<td headers="Lower OLS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">−0.25</td>
<td headers="Upper OLS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.04</td>
<td headers="Diff Width" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.09</td></tr>
    <tr><td headers="Parameter" class="gt_row gt_left" style="font-family: 'Source Sans Pro'; font-weight: 400;">gdp_pc_sc</td>
<td headers="mean" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.45</td>
<td headers="Lower BS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.17</td>
<td headers="Upper BS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.76</td>
<td headers="Lower OLS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.24</td>
<td headers="Upper OLS" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.64</td>
<td headers="Diff Width" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.19</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="7"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> Width of bootstrap estimate minus width of OLS estimate</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>Let’s look more closely at the distributions for each coefficient. Standard statistical estimates assume a specific distribution like the normal. But the bootstrap method provides more flexibility, even though it often leans towards the assumed distribution. We can see these distributions aren’t perfectly symmetrical like a normal distribution, but they suit our needs in that we can extract the lower and upper quantiles to create an interval estimate.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-r-bootstrap" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-r-bootstrap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estimation_files/figure-html/fig-r-bootstrap-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-r-bootstrap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.9: Bootstrap Distributions of Parameter Estimates
</figcaption>
</figure>
</div>
</div>
</div>
<p>As mentioned, the bootstrap is often used to provide uncertainty for unmodeled parameters, predictions, and other metrics. However, because we repeatedly run the model or some aspect of it over and over, it is computationally inefficient, and might not be suitable with large data sizes. It also may not estimate the appropriate uncertainty for some types of statistics (e.g.&nbsp;extreme values) or <a href="https://stats.stackexchange.com/questions/9664/what-are-examples-where-a-naive-bootstrap-fails">in some data contexts</a> (e.g.&nbsp;correlated observations) without extra considerations. Variants exist to help deal with some of these issues, and despite limitations, the bootstrap method is a useful tool and can be used together with other methods to understand uncertainty in a model.</p>
</section>
<section id="sec-estim-bayes" class="level3" data-number="6.11.4">
<h3 data-number="6.11.4" class="anchored" data-anchor-id="sec-estim-bayes"><span class="header-section-number">6.11.4</span> Bayesian estimation</h3>
<p>The <strong>Bayesian</strong> approach to modeling is many things - a philosophical viewpoint, an entirely different way to think about probability, a different way to measure uncertainty, and on a practical level, just another way to get model parameter estimates. It can be as frustrating as it is fun to use, and one of the really nice things about using Bayesian estimation is that it can handle model complexities that other approaches don’t do well or at all.</p>
<p>The basis of Bayesian estimation is the <strong>likelihood</strong>, the same as with maximum likelihood, and everything we did there applies here. So you need a good grasp of maximum likelihood to understand the Bayesian approach. However, the Bayesian approach is different because it also lets us use our knowledge about the parameters through <strong>prior distributions</strong>. For example, we may think that the coefficients for a linear model come from a normal distribution centered on zero with some variance. That would serve as our prior distribution for those parameters.</p>
<p>The combination of a prior distribution with the likelihood results in the <strong>posterior distribution</strong>, which is a <em>distribution</em> of possible parameter values. It falls somewhere between the prior and the likelihood. With more data, it tends toward the likelihood result, and with less data, it tends toward what the prior would have suggested. The posterior distribution is what we ultimately use to make inferences about the parameters, and it can be used to estimate uncertainty in the same way as the bootstrap.</p>
<div id="fig-bayesian-prior-posterior" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bayesian-prior-posterior-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/prior2post_clean.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bayesian-prior-posterior-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.10: Prior, likelihood, posterior and distributions
</figcaption>
</figure>
</div>
<section id="example" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="example">Example</h4>
<p>Let’s do a simple example to show how this comes about. We’ll use a binomial model where we have penalty kicks taken for a soccer player, and we want to estimate the probability of the player making a goal, which we’ll call <span class="math inline">\(\theta\)</span>.</p>
<p>For our prior distribution, we’ll use a <a href="https://en.wikipedia.org/wiki/Beta_distribution">beta distribution</a> that has a mean of 0.5, suggesting that we think this person would have about a 50% chance of converting the kick on average. However, we will keep this prior fairly loose, with a range that spans most of the (0, 1) interval. For the likelihood, we’ll use a binomial distribution. We also use this in our GLM chapter (<a href="generalized_linear_models.html#eq-binomial" class="quarto-xref">Equation&nbsp;<span>7.3</span></a>), which, as we noted earlier in this chapter, is akin to using the log loss (<a href="#sec-estim-logloss" class="quarto-xref"><span>Section 6.9.2</span></a>). We’ll then calculate the posterior distribution for the probability of making a shot, given our prior and the evidence at hand, i.e., the data.</p>
<p>Let’s start with some data, and just like our other estimation approaches, we’ll have some guesses for <span class="math inline">\(\theta\)</span> which represents the probability of making a goal. We’ll use the prior distribution to represent our beliefs about those parameter values, assigning more weight to values around 0.5. We’ll then calculate the likelihood of the data given the parameter, which will put more weight on values closer to the observed chance of scoring a goal. Finally, we calculate the posterior distribution.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>pk <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'goal'</span>,<span class="st">'goal'</span>,<span class="st">'goal'</span>,<span class="st">'miss'</span>,<span class="st">'miss'</span>,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'goal'</span>,<span class="st">'goal'</span>,<span class="st">'miss'</span>,<span class="st">'goal'</span>,<span class="st">'goal'</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to numeric, arbitrarily picking goal=1, miss=0</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">length</span>(pk)               <span class="co"># sample size</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>n_goal <span class="ot">=</span> <span class="fu">sum</span>(pk <span class="sc">==</span> <span class="st">'goal'</span>)   <span class="co"># number of pk made</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>n_miss <span class="ot">=</span> <span class="fu">sum</span>(pk <span class="sc">==</span> <span class="st">'miss'</span>)   <span class="co"># number of those miss</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="co"># grid of potential theta values</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">=</span> <span class="fu">seq</span>(</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> <span class="dv">1</span> <span class="sc">/</span> (N <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> N <span class="sc">/</span> (N <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">length =</span> <span class="dv">10</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="do">### prior distribution</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="co"># beta prior with mean = .5, but fairly diffuse</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a><span class="co"># examine the prior</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a><span class="co"># theta = rbeta(1000, 5, 5)</span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a><span class="co"># hist(theta, main = 'Prior Distribution', xlab = 'Theta', col = 'lightblue')</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>p_theta <span class="ot">=</span> <span class="fu">dbeta</span>(theta, <span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize so that values sum to 1</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>p_theta <span class="ot">=</span> p_theta <span class="sc">/</span> <span class="fu">sum</span>(p_theta) </span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood (binomial)</span></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>p_data_given_theta <span class="ot">=</span> <span class="fu">choose</span>(N, n_goal) <span class="sc">*</span> theta<span class="sc">^</span>n_goal <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> theta)<span class="sc">^</span>n_miss</span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a><span class="co"># posterior (combination of prior and likelihood)</span></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a><span class="co"># p_data is the marginal probability of the data used for normalization</span></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>p_data <span class="ot">=</span> <span class="fu">sum</span>(p_data_given_theta <span class="sc">*</span> p_theta)</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>p_theta_given_data <span class="ot">=</span> p_data_given_theta<span class="sc">*</span>p_theta <span class="sc">/</span> p_data  <span class="co"># Bayes theorem</span></span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a><span class="co"># final estimate</span></span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>theta_est <span class="ot">=</span> <span class="fu">sum</span>(theta <span class="sc">*</span> p_theta_given_data)</span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>theta_est</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6</code></pre>
</div>
</div>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> beta</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>pk <span class="op">=</span> np.array([</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'goal'</span>,<span class="st">'goal'</span>,<span class="st">'goal'</span>,<span class="st">'miss'</span>,<span class="st">'miss'</span>,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'goal'</span>,<span class="st">'goal'</span>,<span class="st">'miss'</span>,<span class="st">'goal'</span>,<span class="st">'goal'</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to numeric, arbitrarily picking goal=1, miss=0</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="bu">len</span>(pk)                     <span class="co"># sample size</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>n_goal <span class="op">=</span> np.<span class="bu">sum</span>(pk <span class="op">==</span> <span class="st">'goal'</span>)   <span class="co"># number of pk made</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>n_miss <span class="op">=</span> np.<span class="bu">sum</span>(pk <span class="op">==</span> <span class="st">'miss'</span>)   <span class="co"># number of those miss</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="co"># grid of potential theta values</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>theta <span class="op">=</span> np.linspace(<span class="dv">1</span> <span class="op">/</span> (N <span class="op">+</span> <span class="dv">1</span>), N <span class="op">/</span> (N <span class="op">+</span> <span class="dv">1</span>), <span class="dv">10</span>)</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="co">### prior distribution</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="co"># beta prior with mean = .5, but fairly diffuse</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a><span class="co"># examine the prior</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="co"># theta = beta.rvs(5, 5, size = 1000)</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.hist(theta, bins = 20, color = 'lightblue')</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>p_theta <span class="op">=</span> beta.pdf(theta, <span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize so that values sum to 1</span></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>p_theta <span class="op">=</span> p_theta <span class="op">/</span> np.<span class="bu">sum</span>(p_theta)</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a><span class="co"># likelihood (binomial)</span></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>p_data_given_theta <span class="op">=</span> np.math.comb(N, n_goal) <span class="op">*</span> theta<span class="op">**</span>n_goal <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> theta)<span class="op">**</span>n_miss</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a><span class="co"># posterior (combination of prior and likelihood)</span></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a><span class="co"># p_data is the marginal probability of the data used for normalization</span></span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>p_data <span class="op">=</span> np.<span class="bu">sum</span>(p_data_given_theta <span class="op">*</span> p_theta) </span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>p_theta_given_data <span class="op">=</span> p_data_given_theta <span class="op">*</span> p_theta <span class="op">/</span> p_data  <span class="co"># Bayes theorem</span></span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a><span class="co"># final estimate</span></span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>theta_est <span class="op">=</span> np.<span class="bu">sum</span>(theta <span class="op">*</span> p_theta_given_data)</span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a>theta_est</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.599999996503221</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Here is the table that puts all this together. Our prior distribution is centered around a <span class="math inline">\(\theta\)</span> of 0.5 because we made it that way. The likelihood is centered closer to 0.7 because that’s the observed chance of scoring a goal. The posterior distribution is a combination of the two. It gives no weight to smaller values, or to the max value. Our final estimate is 0.6, which falls between the prior and likelihood values that have the most weight. With more evidence in the form of data, our estimate will shift more and more towards what the likelihood would suggest. This is a simple example, but it shows how the Bayesian approach works, and this conceptually holds for more complex parameter estimation as well.</p>
<div class="cell">
<div id="tbl-bayesian-demo" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-bayesian-demo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6.12: Bayesian Demo Results
</figcaption>
<div aria-describedby="tbl-bayesian-demo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="fqhhbdilyv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#fqhhbdilyv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fqhhbdilyv thead, #fqhhbdilyv tbody, #fqhhbdilyv tfoot, #fqhhbdilyv tr, #fqhhbdilyv td, #fqhhbdilyv th {
  border-style: none;
}

#fqhhbdilyv p {
  margin: 0;
  padding: 0;
}

#fqhhbdilyv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fqhhbdilyv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fqhhbdilyv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fqhhbdilyv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fqhhbdilyv .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fqhhbdilyv .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fqhhbdilyv .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fqhhbdilyv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fqhhbdilyv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fqhhbdilyv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fqhhbdilyv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fqhhbdilyv .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fqhhbdilyv .gt_spanner_row {
  border-bottom-style: hidden;
}

#fqhhbdilyv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fqhhbdilyv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fqhhbdilyv .gt_from_md > :first-child {
  margin-top: 0;
}

#fqhhbdilyv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fqhhbdilyv .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fqhhbdilyv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#fqhhbdilyv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fqhhbdilyv .gt_row_group_first td {
  border-top-width: 2px;
}

#fqhhbdilyv .gt_row_group_first th {
  border-top-width: 2px;
}

#fqhhbdilyv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fqhhbdilyv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fqhhbdilyv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fqhhbdilyv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fqhhbdilyv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fqhhbdilyv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fqhhbdilyv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fqhhbdilyv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fqhhbdilyv .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#fqhhbdilyv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fqhhbdilyv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fqhhbdilyv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fqhhbdilyv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fqhhbdilyv .gt_left {
  text-align: left;
}

#fqhhbdilyv .gt_center {
  text-align: center;
}

#fqhhbdilyv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fqhhbdilyv .gt_font_normal {
  font-weight: normal;
}

#fqhhbdilyv .gt_font_bold {
  font-weight: bold;
}

#fqhhbdilyv .gt_font_italic {
  font-style: italic;
}

#fqhhbdilyv .gt_super {
  font-size: 65%;
}

#fqhhbdilyv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fqhhbdilyv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fqhhbdilyv .gt_indent_1 {
  text-indent: 5px;
}

#fqhhbdilyv .gt_indent_2 {
  text-indent: 10px;
}

#fqhhbdilyv .gt_indent_3 {
  text-indent: 15px;
}

#fqhhbdilyv .gt_indent_4 {
  text-indent: 20px;
}

#fqhhbdilyv .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="theta">theta</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="prior">prior</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="like">like</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="post">post</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="theta" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.09</td>
<td headers="prior" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.00</td>
<td headers="like" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.00</td>
<td headers="post" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.00</td></tr>
    <tr><td headers="theta" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.18</td>
<td headers="prior" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.03</td>
<td headers="like" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.00</td>
<td headers="post" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.00</td></tr>
    <tr><td headers="theta" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.27</td>
<td headers="prior" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.09</td>
<td headers="like" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.01</td>
<td headers="post" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.00</td></tr>
    <tr><td headers="theta" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.36</td>
<td headers="prior" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.16</td>
<td headers="like" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.03</td>
<td headers="post" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.03</td></tr>
    <tr><td headers="theta" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.45</td>
<td headers="prior" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.22</td>
<td headers="like" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.08</td>
<td headers="post" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.14</td></tr>
    <tr><td headers="theta" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.55</td>
<td headers="prior" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: bold;">0.22</td>
<td headers="like" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.16</td>
<td headers="post" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.28</td></tr>
    <tr><td headers="theta" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.64</td>
<td headers="prior" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.16</td>
<td headers="like" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.24</td>
<td headers="post" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: bold;">0.32</td></tr>
    <tr><td headers="theta" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.73</td>
<td headers="prior" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.09</td>
<td headers="like" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: bold;">0.26</td>
<td headers="post" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.19</td></tr>
    <tr><td headers="theta" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.82</td>
<td headers="prior" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.03</td>
<td headers="like" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.18</td>
<td headers="post" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.04</td></tr>
    <tr><td headers="theta" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.91</td>
<td headers="prior" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.00</td>
<td headers="like" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.05</td>
<td headers="post" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.00</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Priors as Regularization">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Priors as Regularization
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In the context of penalized estimation and machine learning, the prior distribution can be thought of as a form of <strong>regularization</strong> (See <a href="#sec-estim-penalty" class="quarto-xref"><span>Section 6.8</span></a> and <a href="machine_learning.html#sec-ml-regularization" class="quarto-xref"><span>Section 9.5</span></a> later). In this context, the prior shrinks the estimate, pulling the parameter estimates towards it, just like the penalty parameter does in the penalized estimation methods. In fact, many penalized methods can be thought of as a Bayesian approach with a specific prior distribution. An example would be ridge regression, which can be thought of as a Bayesian linear regression with a normal prior distribution for the coefficients. The variance of the prior is inversely related to the ridge penalty parameter.</p>
</div>
</div>
</div>
</section>
<section id="application" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="application">Application</h4>
<p>Just like with the bootstrap which also provided distributions for the parameters, we can use the Bayesian approach to understand how certain we are about our estimates. We can look at any range of values in the posterior distribution to get what is often referred to as a <strong>credible interval</strong>, which is the Bayesian equivalent of a confidence interval<a href="#fn17" class="footnote-ref" id="fnref17" role="doc-noteref"><sup>17</sup></a>. Here is an example of the posterior distribution for the parameters of our happiness model, along with 95% intervals<a href="#fn18" class="footnote-ref" id="fnref18" role="doc-noteref"><sup>18</sup></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-r-bayesian-posterior" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-r-bayesian-posterior-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estimation_files/figure-html/fig-r-bayesian-posterior-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-r-bayesian-posterior-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.11: Posterior Distribution of Parameters
</figcaption>
</figure>
</div>
</div>
</div>
<p>With Bayesian estimation we also provide starting values for the algorithm, which is a form of Monte Carlo estimation<a href="#fn19" class="footnote-ref" id="fnref19" role="doc-noteref"><sup>19</sup></a>, to get things going. We also typically specify a number of iterations, or times the model will run, as the <strong>stopping rule</strong>. Each iteration gives us a new guess for each parameter, which amounts to a random draw from the posterior distribution. With more iterations the model takes longer to run, but the length often reflects the complexity of the model.</p>
<p>We also specify multiple <strong>chains</strong>, which do the same estimation procedure, but due to the random nature of the Bayesian approach and starting point, take different estimation paths<a href="#fn20" class="footnote-ref" id="fnref20" role="doc-noteref"><sup>20</sup></a>. We can then compare the chains to see if they are converging to the same result, which is a check on the model. If they are not converging, we may need to run the model longer, or it may indicate a problem with how we set up the model.</p>
<p>Here’s an example of the four chains for our happiness model for the life expectancy coefficient. The chains bounce around a bit from one iteration to the next, but on average, they’re giving very similar results, so we know the model is working well. Nowadays, we have default statistics in the output that also provide this information, which makes it easier to quickly check convergence for many parameters.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-r-bayesian-chains" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-r-bayesian-chains-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estimation_files/figure-html/fig-r-bayesian-chains-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-r-bayesian-chains-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.12: Bayesian Chains for Life Expectancy Coefficient
</figcaption>
</figure>
</div>
</div>
</div>
<p>When we are interested in making predictions, we can use the results to generate a distribution of possible predictions <em>for each observation</em>, which can be very useful when we want to quantify uncertainty for complex models. This is referred to as <strong>posterior predictive distribution</strong>, which is explored in a non-bayesian context in <a href="understanding_models.html#sec-knowing-model-vis" class="quarto-xref"><span>Section 4.4</span></a>. Here is a plot of several draws of predicted values against the true happiness scores.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-r-bayesian-posterior-predictive" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-r-bayesian-posterior-predictive-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estimation_files/figure-html/fig-r-bayesian-posterior-predictive-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-r-bayesian-posterior-predictive-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.13: Posterior Predictive Distribution of Happiness Values
</figcaption>
</figure>
</div>
</div>
</div>
<p>With the Bayesian approach, every metric we calculate has a range of possible values, not just one. For example, if you have a classification model and want to know the accuracy, AUROC, or true positive rate of the model. Instead of a single number, you would now have access to a whole distribution of values for that metric. How? For each possible set of model parameters from the posterior distribution, we apply those values and model to data to make a prediction. We can then assign it to a class, and compare it to the actual class. This gives us a range of possible predictions and classes. We can then calculate metrics like accuracy or true positive rate for each possible prediction set. As an example, we did this for our happiness model with a numeric target to obtain the interval estimate for R-squared. Pretty neat!</p>
<div class="cell">
<div id="tbl-r-bayesian-metrics" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-r-bayesian-metrics-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6.13: Bayesian R<sup>2</sup>
</figcaption>
<div aria-describedby="tbl-r-bayesian-metrics-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="jnhpshykhu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#jnhpshykhu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jnhpshykhu thead, #jnhpshykhu tbody, #jnhpshykhu tfoot, #jnhpshykhu tr, #jnhpshykhu td, #jnhpshykhu th {
  border-style: none;
}

#jnhpshykhu p {
  margin: 0;
  padding: 0;
}

#jnhpshykhu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jnhpshykhu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jnhpshykhu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jnhpshykhu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jnhpshykhu .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jnhpshykhu .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jnhpshykhu .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jnhpshykhu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jnhpshykhu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jnhpshykhu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jnhpshykhu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jnhpshykhu .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jnhpshykhu .gt_spanner_row {
  border-bottom-style: hidden;
}

#jnhpshykhu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jnhpshykhu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jnhpshykhu .gt_from_md > :first-child {
  margin-top: 0;
}

#jnhpshykhu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jnhpshykhu .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jnhpshykhu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jnhpshykhu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jnhpshykhu .gt_row_group_first td {
  border-top-width: 2px;
}

#jnhpshykhu .gt_row_group_first th {
  border-top-width: 2px;
}

#jnhpshykhu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jnhpshykhu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jnhpshykhu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jnhpshykhu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jnhpshykhu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jnhpshykhu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jnhpshykhu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jnhpshykhu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jnhpshykhu .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#jnhpshykhu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jnhpshykhu .gt_footnote {
  margin: 0px;
  font-size: 10px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jnhpshykhu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jnhpshykhu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jnhpshykhu .gt_left {
  text-align: left;
}

#jnhpshykhu .gt_center {
  text-align: center;
}

#jnhpshykhu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jnhpshykhu .gt_font_normal {
  font-weight: normal;
}

#jnhpshykhu .gt_font_bold {
  font-weight: bold;
}

#jnhpshykhu .gt_font_italic {
  font-style: italic;
}

#jnhpshykhu .gt_super {
  font-size: 65%;
}

#jnhpshykhu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jnhpshykhu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jnhpshykhu .gt_indent_1 {
  text-indent: 5px;
}

#jnhpshykhu .gt_indent_2 {
  text-indent: 10px;
}

#jnhpshykhu .gt_indent_3 {
  text-indent: 15px;
}

#jnhpshykhu .gt_indent_4 {
  text-indent: 20px;
}

#jnhpshykhu .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Bayes R2">Bayes R2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Lower">Lower</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase;" scope="col" id="Upper">Upper</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="Bayes R2" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.71</td>
<td headers="Lower" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.65</td>
<td headers="Upper" class="gt_row gt_right" style="color: #404040; font-family: 'Source Sans Pro'; font-weight: 400;">0.75</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="3"> 95% Credible interval for R-squared</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Frequentist PP check">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Frequentist PP check
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>As we saw in <a href="understanding_models.html#sec-knowing-model-vis" class="quarto-xref"><span>Section 4.4</span></a>, nothing is keeping you from doing ‘predictive checks’ with other estimation approaches, and it’s a very good idea to do so. For example, with a GLM you can use Monte Carlo simulation or the Bootstrap to generate a distribution of predictions, and then compare that to the actual data. This is a good way to check the model’s assumptions and see if it’s doing what you think it’s doing. It’s more straightforward with the Bayesian approach, since many modeling packages will do it for you with little effort.</p>
</div>
</div>
</div>
</section>
<section id="additional-thoughts" class="level4" data-number="6.11.4.1">
<h4 data-number="6.11.4.1" class="anchored" data-anchor-id="additional-thoughts"><span class="header-section-number">6.11.4.1</span> Additional Thoughts</h4>
<p>It turns out that any standard (frequentist) statistical model can be seen as a Bayesian one from a certain point of view<a href="#fn21" class="footnote-ref" id="fnref21" role="doc-noteref"><sup>21</sup></a>. Here are a couple.</p>
<ul>
<li>GLM and related models estimated via maximum likelihood: Bayesian estimation with a flat/uniform prior on the parameters.</li>
<li>Ridge Regression: Bayesian estimation with a normal prior on the coefficients, penalty parameter is related to the variance of the prior.</li>
<li>Lasso Regression: Bayesian estimation with a Laplace prior on the coefficients, penalty parameter is related to the variance of the prior.</li>
<li>Mixed Models: random effects are, as the name suggests, random, and so are estimated as a distribution of possible values, which is conceptually in line with the Bayesian approach.</li>
</ul>
<!-- At some point using un/numbered lists has f'd up the outline view in VS Code, but not the actual content shown. No obvious fix, and a simple demo still works fine so can't really file a demonstrable issue. -->
<p>So, in many modeling contexts, you’re actually doing a restrictive form of Bayesian estimation already.</p>
<p>The Bayesian approach is very flexible, and can be used for many different types of models, and can be used to get at uncertainty in a model in ways that other approaches can’t. It’s not always the best approach, even when appropriate due to the computational burden and just diagnostic complexity, but it’s a good one to have in your toolbox<a href="#fn22" class="footnote-ref" id="fnref22" role="doc-noteref"><sup>22</sup></a>. Hopefully we’ve helped to demystify the Bayesian approach a bit here, and you feel more comfortable trying it out.</p>
</section>
</section>
<section id="sec-estim-conformal" class="level3" data-number="6.11.5">
<h3 data-number="6.11.5" class="anchored" data-anchor-id="sec-estim-conformal"><span class="header-section-number">6.11.5</span> Conformal Methods</h3>
<p>Conformal approaches bring us back to the frequentist world, and specifically regard prediction uncertainty. One of the primary strengths of the approach is that it is model agnostic and theoretically can work for any model, from linear regression to deep learning. Like the bootstrap and Bayesian methods, conformal prediction makes us think in terms of distributions of possible values, but it focuses on residuals or errors in prediction.</p>
<p>It is based on the idea that we can estimate the uncertainty in our predictions by looking at the distribution of the predictions from the model, or more specifically, the prediction error. Using the observed prediction error on a calibration set that was not used to train the model, we can order those errors and find the quantile corresponding to the desired uncertainty coverage/error rate<a href="#fn23" class="footnote-ref" id="fnref23" role="doc-noteref"><sup>23</sup></a>. When predicting on new data, we assume the predictions and corresponding errors come from a similar distribution as what we’ve seen already in our training/calibration process. We do this with no particular assumption about that distribution. We then use the estimated quantile to create upper and lower bounds for a prediction for a new observation.</p>
<p>While the implementation for various settings can get quite complicated, the conceptual approach is mostly straightforward. As an example, we can demonstrate the <strong>split-conformal</strong> procedure with the following steps.</p>
<ol type="1">
<li><strong>Split Data</strong>: Split the dataset into training and calibration sets.</li>
<li><strong>Train Model</strong>: Train the model using the training set.</li>
<li><strong>Calculate Scores</strong>: Calculate conformity scores on the calibration set. These are the <em>absolute</em> residuals between the predicted and actual values on the calibration set.</li>
<li><strong>Quantile Calculation</strong>: Determine the quantile value of the conformity scores for the desired confidence level.</li>
<li><strong>Generate Intervals</strong>: Generate prediction intervals for new data points. For new data points, use the trained model to make predictions. Adjust these predictions by adding and subtracting the quantile value obtained from the conformity scores to generate the lower and upper bounds of the prediction intervals.</li>
</ol>
<p>Let’s now demonstrate the split-conformal method with our happiness model. We’ll start by defining the split-conformal function. The function takes the training data, the target variable, and new data for which we want to make predictions. It also takes an <span class="math inline">\(\alpha\)</span> value, which is the error rate we want to control, and a calibration split, which is the proportion of the data we use for calibration. And finally, we designate new data for which we want to make predictions.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>split_conformal <span class="ot">=</span> <span class="cf">function</span>(</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    X,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    y,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    new_data,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">05</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">calibration_split =</span> .<span class="dv">5</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>) {</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Splitting the data into training and calibration sets</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    idx <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(X), <span class="at">size =</span> <span class="fu">floor</span>(<span class="fu">nrow</span>(X) <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    train_data <span class="ot">=</span> X <span class="sc">|&gt;</span> <span class="fu">slice</span>(idx)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>    cal_data   <span class="ot">=</span> X <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="sc">-</span>idx)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    train_y <span class="ot">=</span> y[idx]</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    cal_y   <span class="ot">=</span> y[<span class="sc">-</span>idx]</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">=</span> <span class="fu">nrow</span>(train_data)</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Train the base model</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">=</span> <span class="fu">lm</span>(train_y <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate residuals on calibration set</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>    cal_preds <span class="ot">=</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> cal_data)</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>    residuals <span class="ot">=</span> <span class="fu">abs</span>(cal_y <span class="sc">-</span> cal_preds)</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sort residuals and find the quantile corresponding to (1-alpha)</span></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>    residuals <span class="ot">=</span> <span class="fu">sort</span>(residuals)</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>    quantile  <span class="ot">=</span> <span class="fu">quantile</span>(residuals, (<span class="dv">1</span> <span class="sc">-</span> alpha) <span class="sc">*</span> (N <span class="sc">/</span> (N <span class="sc">+</span> <span class="dv">1</span>)))</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make predictions on new data and calculate prediction intervals</span></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>    preds <span class="ot">=</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> new_data)</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>    lower_bounds <span class="ot">=</span> preds <span class="sc">-</span> quantile</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>    upper_bounds <span class="ot">=</span> preds <span class="sc">+</span> quantile</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return predictions and prediction intervals</span></span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(</span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>        <span class="fu">list</span>(</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">cp_error     =</span> quantile, </span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">preds        =</span> preds, </span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">lower_bounds =</span> lower_bounds, </span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">upper_bounds =</span> upper_bounds</span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> split_conformal(X, y, new_data, alpha <span class="op">=</span> <span class="fl">.05</span>, calibration_split <span class="op">=</span> <span class="fl">.5</span>):</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Splitting the data into training and calibration sets</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    X_train, X_cal, y_train, y_cal <span class="op">=</span> train_test_split(</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>        X, </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>        y,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>        test_size <span class="op">=</span> calibration_split,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>        random_state <span class="op">=</span> <span class="dv">123</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> X_train.shape[<span class="dv">0</span>]</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Train the base model</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> LinearRegression().fit(X_train, y_train)</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate residuals on calibration set</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>    cal_preds <span class="op">=</span> model.predict(X_cal)</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>    residuals <span class="op">=</span> np.<span class="bu">abs</span>(y_cal <span class="op">-</span> cal_preds)</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sort residuals and find the quantile corresponding to (1-alpha)</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>    residuals <span class="op">=</span> np.sort(residuals)</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The correction here is useful for small sample sizes</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>    quantile  <span class="op">=</span> np.quantile(residuals, (<span class="dv">1</span> <span class="op">-</span> alpha) <span class="op">*</span> (N <span class="op">/</span> (N <span class="op">+</span> <span class="dv">1</span>)))</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make predictions on new data and calculate prediction intervals</span></span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>    preds <span class="op">=</span> model.predict(new_data)</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>    lower_bounds <span class="op">=</span> preds <span class="op">-</span> quantile</span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>    upper_bounds <span class="op">=</span> preds <span class="op">+</span> quantile</span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return predictions and prediction intervals</span></span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>        <span class="st">'cp_error'</span>: quantile,</span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a>        <span class="st">'preds'</span>: preds,</span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">'lower_bounds'</span>: lower_bounds,</span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a>        <span class="st">'upper_bounds'</span>: upper_bounds</span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a>    }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>With our functions in place, we can now use them to calculate the prediction intervals for the happiness model. The <code>cp_error</code> value gives us the quantile value that we use to generate the prediction intervals. The table below shows the first few predictions and their corresponding prediction intervals.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># split data</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>idx_train <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(df_happiness), <span class="fu">nrow</span>(df_happiness) <span class="sc">*</span> .<span class="dv">8</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>idx_test <span class="ot">=</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df_happiness), idx_train)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>df_train <span class="ot">=</span> df_happiness <span class="sc">|&gt;</span> </span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(idx_train) <span class="sc">|&gt;</span> </span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(happiness, life_exp_sc, gdp_pc_sc, corrupt_sc)</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>y_train <span class="ot">=</span> df_happiness<span class="sc">$</span>happiness[idx_train]</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>df_test <span class="ot">=</span> df_happiness <span class="sc">|&gt;</span> </span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(idx_test) <span class="sc">|&gt;</span> </span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(life_exp_sc, gdp_pc_sc, corrupt_sc)</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>y_test <span class="ot">=</span> df_happiness<span class="sc">$</span>happiness[idx_test]</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>cp_error <span class="ot">=</span> <span class="fu">split_conformal</span>(</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>    df_train <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>happiness),</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>    y_train,</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>    df_test,</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">1</span></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a><span class="co"># cp_error[['cp_error']]</span></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">preds =</span> cp_error[[<span class="st">'preds'</span>]],</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower_bounds =</span> cp_error[[<span class="st">'lower_bounds'</span>]],</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper_bounds =</span> cp_error[[<span class="st">'upper_bounds'</span>]]</span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-22-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># split data</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df_happiness[[<span class="st">'life_exp_sc'</span>, <span class="st">'corrupt_sc'</span>, <span class="st">'gdp_pc_sc'</span>]]</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df_happiness[<span class="st">'happiness'</span>]</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    df_happiness[[<span class="st">'life_exp_sc'</span>, <span class="st">'corrupt_sc'</span>, <span class="st">'gdp_pc_sc'</span>]],</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    df_happiness[<span class="st">'happiness'</span>],</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    test_size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    random_state <span class="op">=</span> <span class="dv">123</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>our_cp_error <span class="op">=</span> split_conformal(</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>    X_train,</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>    y_train,</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>    X_test,</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>    alpha <span class="op">=</span> <span class="fl">.1</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a><span class="co"># print(our_cp_error['cp_error'])</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>pd.DataFrame({</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'preds'</span>: our_cp_error[<span class="st">'preds'</span>],</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">'lower_bounds'</span>: our_cp_error[<span class="st">'lower_bounds'</span>],</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'upper_bounds'</span>: our_cp_error[<span class="st">'upper_bounds'</span>]</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>}).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>As a method of uncertainty estimation, conformal prediction is not without its challenges. It is computationally intensive for large datasets or complex models. There are multiple variants of conformal prediction, most of which attempt to alleviate a deficiency of simpler approaches. But they generally further increase the computational burden.</p>
<p>Conformal prediction still relies on the assumptions about the data and the underlying model, and violations of these assumptions can lead to invalid prediction intervals. Furthermore, conformal prediction methods assume that the training and test data come from the same distribution, which may not always be the case in real-world applications due to distribution shifts or domain changes. In addition, validation sets must be viable splits of the data, which default splitting methods may not always provide. In general, for conformal prediction provides an alternative to other frequentist or Bayesian approaches that, under the right circumstances, may produce a better estimate of uncertainty, but does not come for free.</p>
</section>
</section>
<section id="sec-estim-wrap" class="level2" data-number="6.12">
<h2 data-number="6.12" class="anchored" data-anchor-id="sec-estim-wrap"><span class="header-section-number">6.12</span> Wrapping Up</h2>
<p>Wow, we covered a lot here! But this is the sort of stuff that can take you from just having some fun with data, to doing that and also understanding how things are actually happening. Just having the basics of how modeling actually is done ‘under the hood’ makes so many other things make sense, and can give you a lot of confidence, even in less familiar modeling domains.</p>
<section id="sec-estim-thread" class="level3" data-number="6.12.1">
<h3 data-number="6.12.1" class="anchored" data-anchor-id="sec-estim-thread"><span class="header-section-number">6.12.1</span> The common thread</h3>
<p>Simply put, the content in this chapter ties together any and every model you will ever undertake, from linear regression to reinforcement learning, computer vision, and large language models. Estimation and optimization are the core of any modeling process, and understanding the basics is key to understanding how models work in general.</p>
</section>
<section id="sec-estim-choose" class="level3" data-number="6.12.2">
<h3 data-number="6.12.2" class="anchored" data-anchor-id="sec-estim-choose"><span class="header-section-number">6.12.2</span> Choose your own adventure</h3>
<p>Seriously, after this chapter, you should feel fine with any of the others in this book, so dive in!</p>
</section>
<section id="sec-estim-add-res" class="level3" data-number="6.12.3">
<h3 data-number="6.12.3" class="anchored" data-anchor-id="sec-estim-add-res"><span class="header-section-number">6.12.3</span> Additional resources</h3>
<p><strong>OLS and Maximum Likelihood Estimation</strong>:</p>
<p>For OLS and maximum likelihood estimation, there are so many resources out there, we recommend just taking a look and seeing which one suits you best. Practically any more technical statistical book will cover these topics in detail.</p>
<ul>
<li><a href="https://stats.stackexchange.com/questions/33197/advanced-statistics-books-recommendation">A list of classical references</a></li>
</ul>
<p><strong>Gradient Descent</strong>:</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=sDv4f4s2SB8">Gradient Descent, Step-by-Step</a> <span class="citation" data-cites="statquest_with_josh_starmer_gradient_2019">StatQuest with Josh Starmer (<a href="references.html#ref-statquest_with_josh_starmer_gradient_2019" role="doc-biblioref">2019a</a>)</span></li>
<li><a href="https://www.youtube.com/watch?v=vMh0zPT0tLI">Stochastic Gradient Descent, Clearly Explained</a> <span class="citation" data-cites="statquest_with_josh_starmer_stochastic_2019">StatQuest with Josh Starmer (<a href="references.html#ref-statquest_with_josh_starmer_stochastic_2019" role="doc-biblioref">2019b</a>)</span></li>
<li><a href="https://towardsdatascience.com/a-visual-explanation-of-gradient-descent-methods-momentum-adagrad-rmsprop-adam-f898b102325c">A Visual Explanation of Gradient Descent Methods</a> <span class="citation" data-cites="jiang_visual_2020">Jiang (<a href="references.html#ref-jiang_visual_2020" role="doc-biblioref">2020</a>)</span></li>
</ul>
<p>More demonstration of the simple AdaGrad algorithm used above:</p>
<ul>
<li><span class="citation" data-cites="brownlee_gradient_2021">Brownlee (<a href="references.html#ref-brownlee_gradient_2021" role="doc-biblioref">2021</a>)</span></li>
<li><span class="citation" data-cites="databricks_what_2019">DataBricks (<a href="references.html#ref-databricks_what_2019" role="doc-biblioref">2019</a>)</span></li>
</ul>
<p><strong>Frequentist Approaches</strong>:</p>
<ul>
<li>Most statistical texts cover uncertainty estimation from the frequentist perspective. Pick one you like.</li>
<li><a href="https://errorstatistics.com/about-2/">Error Statistics</a> Deborah Mayo’s blog and comments on other blogs have always provided a strong philosophical defense of frequentist statistics.</li>
</ul>
<p><strong>Monte Carlo</strong>:</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=OgO1gpXSUzU">Monte Carlo Methods</a> John Guttag’s MIT Course lecture on YouTube.</li>
</ul>
<p><strong>Bootstrap</strong>:</p>
<p>Classical treatments:</p>
<ul>
<li><span class="citation" data-cites="efron_introduction_1994">Efron and Tibshirani (<a href="references.html#ref-efron_introduction_1994" role="doc-biblioref">1994</a>)</span></li>
<li><span class="citation" data-cites="davison_bootstrap_1997">Davison and Hinkley (<a href="references.html#ref-davison_bootstrap_1997" role="doc-biblioref">1997</a>)</span></li>
</ul>
<p>More fun demo:</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=sDv4f4s2SB8">Bootstrapping Main Ideas</a> <span class="citation" data-cites="statquest_with_josh_starmer_bootstrapping_2021">StatQuest with Josh Starmer (<a href="references.html#ref-statquest_with_josh_starmer_bootstrapping_2021" role="doc-biblioref">2021</a>)</span></li>
</ul>
<p><strong>Bayesian</strong>:</p>
<ul>
<li>BDA <span class="citation" data-cites="gelman_bayesian_2013">Gelman et al. (<a href="references.html#ref-gelman_bayesian_2013" role="doc-biblioref">2013</a>)</span></li>
<li>Statistical Rethinking <span class="citation" data-cites="mcelreath_statistical_2020">McElreath (<a href="references.html#ref-mcelreath_statistical_2020" role="doc-biblioref">2020</a>)</span></li>
<li><a href="https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations">Choosing priors</a></li>
</ul>
<p><strong>Conformal Prediction</strong>:</p>
<p>General:</p>
<ul>
<li>A Gentle Introduction to Conformal Prediction and Distribution-Free Uncertainty Quantification (<span class="citation" data-cites="angelopoulos_gentle_2022">Angelopoulos and Bates (<a href="references.html#ref-angelopoulos_gentle_2022" role="doc-biblioref">2022</a>)</span>); <a href="https://github.com/aangelopoulos/conformal-prediction">Example Python Notebooks</a></li>
</ul>
<p>R demos:</p>
<ul>
<li><a href="https://www.tidymodels.org/learn/models/conformal-regression/">Conformal inference for regression models</a></li>
<li><a href="https://marginaleffects.com/vignettes/conformal.html">Conformal prediction</a></li>
</ul>
<p>Python demos:</p>
<ul>
<li>Introduction To Conformal Prediction With Python (<span class="citation" data-cites="molnar_introduction_2024">Molnar (<a href="references.html#ref-molnar_introduction_2024" role="doc-biblioref">2024</a>)</span>)</li>
<li><a href="https://mapie.readthedocs.io/en/latest/">Mapie Docs</a></li>
</ul>
</section>
</section>
<section id="sec-estim-exercise" class="level2" data-number="6.13">
<h2 data-number="6.13" class="anchored" data-anchor-id="sec-estim-exercise"><span class="header-section-number">6.13</span> Guided Exploration</h2>
<p>For this exercise you’ll have two tasks:</p>
<ul>
<li><p>Try creating an objective function for a continuous target that uses the mean absolute error, and compare your estimated parameters to the previous results for ordinary least squares. Use the OLS function from the chapter as a basis (<a href="#sec-estim-ols" class="quarto-xref"><span>Section 6.5</span></a>), but modify it for the new objective.</p></li>
<li><p>Use the estimation function we demonstrated for ridge regression (<a href="#sec-estim-penalty" class="quarto-xref"><span>Section 6.8</span></a>) and change it to use the lasso approach.</p></li>
</ul>
<p>Both of these can be done by changing one line in the previous functions used.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-angelopoulos_gentle_2022" class="csl-entry" role="listitem">
Angelopoulos, Anastasios N., and Stephen Bates. 2022. <span>“A <span>Gentle</span> <span>Introduction</span> to <span>Conformal</span> <span>Prediction</span> and <span>Distribution</span>-<span>Free</span> <span>Uncertainty</span> <span>Quantification</span>.”</span> arXiv. <a href="https://doi.org/10.48550/arXiv.2107.07511">https://doi.org/10.48550/arXiv.2107.07511</a>.
</div>
<div id="ref-brownlee_gradient_2021" class="csl-entry" role="listitem">
Brownlee, Jason. 2021. <span>“Gradient <span>Descent</span> <span>With</span> <span>AdaGrad</span> <span>From</span> <span>Scratch</span>.”</span> <em>MachineLearningMastery.com</em>. <a href="https://machinelearningmastery.com/gradient-descent-with-adagrad-from-scratch/">https://machinelearningmastery.com/gradient-descent-with-adagrad-from-scratch/</a>.
</div>
<div id="ref-clark_model_2021" class="csl-entry" role="listitem">
Clark, Michael. 2021. <em>Model <span>Estimation</span> by <span>Example</span></em>. <a href="https://m-clark.github.io/models-by-example/">https://m-clark.github.io/models-by-example/</a>.
</div>
<div id="ref-databricks_what_2019" class="csl-entry" role="listitem">
DataBricks. 2019. <span>“What Is <span>AdaGrad</span>?”</span> <em>Databricks</em>. <a href="https://www.databricks.com/glossary/adagrad">https://www.databricks.com/glossary/adagrad</a>.
</div>
<div id="ref-davison_bootstrap_1997" class="csl-entry" role="listitem">
Davison, A. C., and D. V. Hinkley. 1997. <em>Bootstrap <span>Methods</span> and Their <span>Application</span></em>. Cambridge <span>Series</span> in <span>Statistical</span> and <span>Probabilistic</span> <span>Mathematics</span>. Cambridge: Cambridge University Press. <a href="https://doi.org/10.1017/CBO9780511802843">https://doi.org/10.1017/CBO9780511802843</a>.
</div>
<div id="ref-efron_introduction_1994" class="csl-entry" role="listitem">
Efron, Bradley, and R. J. Tibshirani. 1994. <em>An <span>Introduction</span> to the <span>Bootstrap</span></em>. New York: Chapman; Hall/CRC. <a href="https://doi.org/10.1201/9780429246593">https://doi.org/10.1201/9780429246593</a>.
</div>
<div id="ref-gelman_bayesian_2013" class="csl-entry" role="listitem">
Gelman, Andrew, John B. Carlin, Hal S. Stern, David B. Dunson, Aki Vehtari, and Donald B. Rubin. 2013. <em>Bayesian <span>Data</span> <span>Analysis</span>, <span>Third</span> <span>Edition</span></em>. CRC Press.
</div>
<div id="ref-jiang_visual_2020" class="csl-entry" role="listitem">
Jiang, Lili. 2020. <span>“A <span>Visual</span> <span>Explanation</span> of <span>Gradient</span> <span>Descent</span> <span>Methods</span> (<span>Momentum</span>, <span>AdaGrad</span>, <span>RMSProp</span>, <span>Adam</span>).”</span> <em>Medium</em>. <a href="https://towardsdatascience.com/a-visual-explanation-of-gradient-descent-methods-momentum-adagrad-rmsprop-adam-f898b102325c">https://towardsdatascience.com/a-visual-explanation-of-gradient-descent-methods-momentum-adagrad-rmsprop-adam-f898b102325c</a>.
</div>
<div id="ref-mcelreath_statistical_2020" class="csl-entry" role="listitem">
McElreath, Richard. 2020. <span>“Statistical <span>Rethinking</span>: <span>A</span> <span>Bayesian</span> <span>Course</span> with <span>Examples</span> in <span>R</span> and <span>STAN</span>.”</span> <em>Routledge &amp; CRC Press</em>. <a href="https://www.routledge.com/Statistical-Rethinking-A-Bayesian-Course-with-Examples-in-R-and-STAN/McElreath/p/book/9780367139919">https://www.routledge.com/Statistical-Rethinking-A-Bayesian-Course-with-Examples-in-R-and-STAN/McElreath/p/book/9780367139919</a>.
</div>
<div id="ref-molnar_introduction_2024" class="csl-entry" role="listitem">
Molnar, Christoph. 2024. <em>Introduction <span>To</span> <span>Conformal</span> <span>Prediction</span> <span>With</span> <span>Python</span></em>. <a href="https://christophmolnar.com/books/conformal-prediction/">https://christophmolnar.com/books/conformal-prediction/</a>.
</div>
<div id="ref-murphy_machine_2012" class="csl-entry" role="listitem">
Murphy, Kevin P. 2012. <span>“Machine <span>Learning</span>: <span>A</span> <span>Probabilistic</span> <span>Perspective</span>.”</span> <em>MIT Press</em>. <a href="https://mitpress.mit.edu/9780262018029/machine-learning/">https://mitpress.mit.edu/9780262018029/machine-learning/</a>.
</div>
<div id="ref-raschka_losses_2022" class="csl-entry" role="listitem">
Raschka, Sebastian. 2022. <span>“Losses <span>Learned</span>.”</span> <em>Sebastian Raschka, PhD</em>. <a href="https://sebastianraschka.com/blog/2022/losses-learned-part1.html">https://sebastianraschka.com/blog/2022/losses-learned-part1.html</a>.
</div>
<div id="ref-statquest_with_josh_starmer_gradient_2019" class="csl-entry" role="listitem">
StatQuest with Josh Starmer. 2019a. <span>“Gradient <span>Descent</span>, <span>Step</span>-by-<span>Step</span>.”</span> <a href="https://www.youtube.com/watch?v=sDv4f4s2SB8">https://www.youtube.com/watch?v=sDv4f4s2SB8</a>.
</div>
<div id="ref-statquest_with_josh_starmer_stochastic_2019" class="csl-entry" role="listitem">
———. 2019b. <span>“Stochastic <span>Gradient</span> <span>Descent</span>, <span>Clearly</span> <span>Explained</span>!!!”</span> <a href="https://www.youtube.com/watch?v=vMh0zPT0tLI">https://www.youtube.com/watch?v=vMh0zPT0tLI</a>.
</div>
<div id="ref-statquest_with_josh_starmer_bootstrapping_2021" class="csl-entry" role="listitem">
———. 2021. <span>“Bootstrapping <span>Main</span> <span>Ideas</span>!!!”</span> <a href="https://www.youtube.com/watch?v=Xz0x-8-cgaQ">https://www.youtube.com/watch?v=Xz0x-8-cgaQ</a>.
</div>
<div id="ref-wikipedia_relationships_2023" class="csl-entry" role="listitem">
Wikipedia. 2023. <span>“Relationships Among Probability Distributions.”</span> <em>Wikipedia</em>. <a href="https://en.wikipedia.org/wiki/Relationships_among_probability_distributions">https://en.wikipedia.org/wiki/Relationships_among_probability_distributions</a>.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Since life expectancy is scaled, a standard deviation is 1, and in this case represents about 7 years.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>It turns out that our error metric is itself an <em>estimate</em> of the true error. We’ll get more into this later, but for now this means that we can’t ever know the true error, and so we can’t ever really know the best or true model. However, we can still choose a good or better model relative to others based on our error estimate.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>We don’t have to do it this way, but it’s the default in most scenarios. As an example, maybe for your situation overshooting is worse than undershooting, and so you might want to use an approach that would weight those errors more heavily.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Some disciplines seem to confuse models with estimation methods and link functions. It doesn’t really make sense, nor is it informative, to call something an OLS model or a logit model. Many models are estimated using a least squares objective function, even deep learning, and different types of models use a logit link, from logistic regression, to beta regression, to activation functions used in deep learning.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>You may find that some packages will <em>only</em> minimize (or maximize) a function, even to the point of reporting nonsensical things like negative squared values, so you’ll need to take care when implementing your own metrics.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>The actual probability of a <em>specific value</em> in this setting is 0, but the probability of a range of values is greater than 0. You can find out more about likelihoods and probabilities at the discussion <a href="https://stats.stackexchange.com/questions/2641/what-is-the-difference-between-likelihood-and-probability">here</a>, but many traditional statistical texts will cover this also.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>The negative log-likelihood is often what is reported in the model output as well.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>Those who have experience here will notice we aren’t putting a lower bound on sigma. You typically want to do this otherwise you may get nonsensical results by not keeping sigma positive. You can do this by setting a specific argument for an algorithm that uses boundaries, or more simply by exponentiating the parameter so that it can only be positive. In the latter case, you’ll have to exponentiate the final parameter estimate to get back to the correct scale. We leave this detail out of the code for now to keep things simple.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>Linear regression will settle on a line that cuts through the means, and when standardizing all variables, the mean of the features and target are both zero, so the line goes through the origin.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>There is no way to know if we have found a global minimum, and truthfully, we probably rarely do with complex models. But optimization algorithms are designed to find the best solution they can under the data circumstances, and some minimums maybe practically indistinguishable from the global minimum anyway (we hope!).<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>For R, one can use the <span class="pack">glmnet</span>, while for Python, the <span class="function">Ridge</span> class in <span class="pack">scikit-learn</span> is a good choice.<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>A nice demo from the <span class="pack">pytorch</span> perspective can be found at <span class="citation" data-cites="raschka_losses_2022">Raschka (<a href="references.html#ref-raschka_losses_2022" role="doc-biblioref">2022</a>)</span>.<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>MC wrote this function a long time ago, but does not recall exactly what the origin is, except that Murphy’s PML book was something he was poring through at the time (<span class="citation" data-cites="murphy_machine_2012">Murphy (<a href="references.html#ref-murphy_machine_2012" role="doc-biblioref">2012</a>)</span>).<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p>You’d get better results a couple of ways. The easiest is just to repeat the process a couple of times and average the results. This is a common approach in SGD. The initial shuffling that we did can help with convergence as well, and it would be done each repetition . When we’re dealing with larger data and repeated runs/epochs, shuffling allows the samples/batches to be more representative of the entire data set. Also, we had to ‘hand-tune’ our learning rate and step size, which is not ideal, and normally we would use cross-validation to find the best values.<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn15"><p>The name originates with Stanislav Ulam, who worked on the Manhattan Project and would actually come up with the idea from playing solitaire. He is also the one who inspired the name of the Bayesian probabilistic programming language Stan!<a href="#fnref15" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn16"><p>We’re using inference here in the standard statistical/philosophical sense, not as a synonym for prediction or generalization, which is how it is often used in machine learning. We’re not exactly sure how that terminological muddling arose in ML, but be on the lookout for it.<a href="#fnref16" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn17"><p>Many people’s default interpretation of a standard confidence interval is usually something like ‘the range we expect the parameter to reside within’. Unfortunately, that’s not quite right, though it is how you interpret the Bayesian interval. The frequentist confidence interval is a range that, if we were to repeat the experiment/data collection many times, contains the true parameter value a certain percentage of the time. For the Bayesian, the parameter is assumed to be random, and so the interval is that which we expect the parameter to fall within a certain percentage of the time. The Bayesian is probably a bit more intuitive for most, even if it’s not the more widely used.<a href="#fnref17" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn18"><p>We used the R package for <span class="pack">brms</span> for these results.<a href="#fnref18" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn19"><p>The most common method for the Bayesian approach is Markov Chain Monte Carlo (MCMC), which is a way to sample from the posterior distribution. There are many MCMC algorithms, many of which are a form of the now fairly old Metropolis-Hastings algorithm, which you can find a demo of at <a href="https://m-clark.github.io/models-by-example/metropolis-hastings.html">Michael’s doc</a>.<a href="#fnref19" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn20"><p>Some deep learning implementations will use multiple random starts for similar reasons.<a href="#fnref20" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn21"><p>Cue <a href="https://www.youtube.com/watch?v=pSOBeD1GC_Y">Obi Wan Kenobi</a>.<a href="#fnref21" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn22"><p>R has excellent tools here for modeling and post-processing, like <span class="pack">brms</span> and <span class="pack">tidybayes</span>, and Python has <span class="pack">pymc3</span>, <span class="pack">numpyro</span>, and <span class="pack">arviz</span>, which are also useful. Honestly R has way more going on here, with many packages devoted to Bayesian estimation of specific models even, but if you want to stick with Python it’s gotten a lot better recently.<a href="#fnref22" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn23"><p>The error rate (<span class="math inline">\(\alpha\)</span>) is the proportion of the data that would fall outside the prediction interval, while the coverage rate/interval is 1 - <span class="math inline">\(\alpha\)</span>.<a href="#fnref23" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./understanding_features.html" class="pagination-link" aria-label="Understanding the Features">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Understanding the Features</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./generalized_linear_models.html" class="pagination-link" aria-label="Generalized Linear Models">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Generalized Linear Models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2024 CC-BY-NC-SA</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/m-clark/book-of-models/edit/dev/estimation.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/m-clark/book-of-models">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/statsdatasci">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/michael-clark-b475b5170/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>